nohup: ignoring input
2023-07-15 06:05:11.171097: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-07-15 06:05:11.341901: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-07-15 06:05:11.880533: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-07-15 06:05:11.880608: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-07-15 06:05:11.880616: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
-->device cuda:0
-->device cuda:0
-->arguments:
ModelArguments(model_name_or_path='./output/hate_speech_white/', config_name=None, tokenizer_name=None, cache_dir=None, use_fast_tokenizer=True, model_revision='main', use_auth_token=False, ignore_mismatched_sizes=False)
DataTrainingArguments(task_name=None, dataset_name=None, dataset_config_name=None, max_seq_length=128, overwrite_cache=False, pad_to_max_length=True, max_train_samples=None, max_eval_samples=None, max_predict_samples=None, train_file='dataset/hate_speech_white/train.csv', validation_file='dataset/hate_speech_white/test.csv', test_file='dataset/hate_speech_white/test.csv')
TrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
bf16=False,
bf16_full_eval=False,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=False,
do_predict=False,
do_train=False,
eval_accumulation_steps=None,
eval_delay=0,
eval_steps=None,
evaluation_strategy=no,
fp16=true,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=./output/test/runs/Jul15_06-05-12_SJgroup,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=500,
logging_strategy=steps,
lr_scheduler_type=linear,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=3,
optim=adamw_hf,
output_dir=./output/test/,
overwrite_output_dir=true,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=['tensorboard'],
resume_from_checkpoint=None,
run_name=./output/test/,
save_on_each_node=False,
save_steps=500,
save_strategy=steps,
save_total_limit=None,
seed=42,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_ipex=False,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
-->device cuda:0
-->is_available True
Tesla T4
-->current_device:  0
-->n_gpu 1
07/15/2023 06:05:12 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 1distributed training: False, 16-bits training: true
07/15/2023 06:05:12 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
bf16=False,
bf16_full_eval=False,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=False,
do_predict=False,
do_train=False,
eval_accumulation_steps=None,
eval_delay=0,
eval_steps=None,
evaluation_strategy=no,
fp16=true,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=./output/test/runs/Jul15_06-05-12_SJgroup,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=500,
logging_strategy=steps,
lr_scheduler_type=linear,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=3,
optim=adamw_hf,
output_dir=./output/test/,
overwrite_output_dir=true,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=['tensorboard'],
resume_from_checkpoint=None,
run_name=./output/test/,
save_on_each_node=False,
save_steps=3000,
save_strategy=steps,
save_total_limit=None,
seed=42,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_ipex=False,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
07/15/2023 06:05:12 - INFO - __main__ - load a local file for train: dataset/hate_speech_white/train.csv
07/15/2023 06:05:12 - INFO - __main__ - load a local file for validation: dataset/hate_speech_white/test.csv
07/15/2023 06:05:12 - INFO - __main__ - load a local file for test: dataset/hate_speech_white/test.csv
07/15/2023 06:05:13 - INFO - datasets.builder - Using custom data configuration default-8ecdaea4b8628304
07/15/2023 06:05:13 - INFO - datasets.info - Loading Dataset Infos from /home/mengdi/.local/lib/python3.8/site-packages/datasets/packaged_modules/csv
07/15/2023 06:05:13 - INFO - datasets.builder - Overwrite dataset info from restored data version if exists.
07/15/2023 06:05:13 - INFO - datasets.info - Loading Dataset info from /home/mengdi/.cache/huggingface/datasets/csv/default-8ecdaea4b8628304/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1
07/15/2023 06:05:13 - WARNING - datasets.builder - Found cached dataset csv (/home/mengdi/.cache/huggingface/datasets/csv/default-8ecdaea4b8628304/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1)
07/15/2023 06:05:13 - INFO - datasets.info - Loading Dataset info from /home/mengdi/.cache/huggingface/datasets/csv/default-8ecdaea4b8628304/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1

  0%|          | 0/3 [00:00<?, ?it/s]
100%|██████████| 3/3 [00:00<00:00, 1104.15it/s]
[INFO|configuration_utils.py:679] 2023-07-15 06:05:13,616 >> loading configuration file ./output/hate_speech_white/config.json
[INFO|configuration_utils.py:730] 2023-07-15 06:05:13,617 >> Model config BertConfig {
  "_name_or_path": "./output/hate_speech_white/",
  "adapters": {
    "adapters": {},
    "config_map": {},
    "fusion_config_map": {},
    "fusions": {}
  },
  "architectures": [
    "BertForSequenceClassification"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "id2label": {
    "0": 0,
    "1": 1
  },
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "0": 0,
    "1": 1
  },
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "output_attentions": true,
  "output_hidden_states": true,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "problem_type": "single_label_classification",
  "torch_dtype": "float32",
  "transformers_version": "4.21.3",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 28996
}

[INFO|tokenization_utils_base.py:1723] 2023-07-15 06:05:13,617 >> Didn't find file ./output/hate_speech_white/added_tokens.json. We won't load it.
[INFO|tokenization_utils_base.py:1801] 2023-07-15 06:05:13,618 >> loading file ./output/hate_speech_white/vocab.txt
[INFO|tokenization_utils_base.py:1801] 2023-07-15 06:05:13,618 >> loading file ./output/hate_speech_white/tokenizer.json
[INFO|tokenization_utils_base.py:1801] 2023-07-15 06:05:13,618 >> loading file None
[INFO|tokenization_utils_base.py:1801] 2023-07-15 06:05:13,618 >> loading file ./output/hate_speech_white/special_tokens_map.json
[INFO|tokenization_utils_base.py:1801] 2023-07-15 06:05:13,618 >> loading file ./output/hate_speech_white/tokenizer_config.json
[INFO|modeling_utils.py:2039] 2023-07-15 06:05:13,647 >> loading weights file ./output/hate_speech_white/pytorch_model.bin
[INFO|modeling_utils.py:2435] 2023-07-15 06:05:15,410 >> All model checkpoint weights were used when initializing BertForSequenceClassification.

[INFO|modeling_utils.py:2443] 2023-07-15 06:05:15,411 >> All the weights of BertForSequenceClassification were initialized from the model checkpoint at ./output/hate_speech_white/.
If your task is similar to the task the model of the checkpoint was trained on, you can already use BertForSequenceClassification for predictions without further training.
-->label_list [1, 0]
-->raw_datasets DatasetDict({
    train: Dataset({
        features: ['Unnamed: 0', 'text', 'label'],
        num_rows: 7492
    })
    validation: Dataset({
        features: ['Unnamed: 0', 'text', 'label'],
        num_rows: 3211
    })
    test: Dataset({
        features: ['Unnamed: 0', 'text', 'label'],
        num_rows: 3211
    })
})
07/15/2023 06:05:17 - WARNING - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x7fea480a1e50> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
07/15/2023 06:05:17 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/mengdi/.cache/huggingface/datasets/csv/default-8ecdaea4b8628304/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-1c80317fa3b1799d.arrow
07/15/2023 06:05:17 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x7fea480a1e50> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
07/15/2023 06:05:17 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/mengdi/.cache/huggingface/datasets/csv/default-8ecdaea4b8628304/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-bdd640fb06671ad1.arrow
07/15/2023 06:05:17 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x7fea480a1e50> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
07/15/2023 06:05:17 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/mengdi/.cache/huggingface/datasets/csv/default-8ecdaea4b8628304/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-3eb13b9046685257.arrow
[INFO|trainer.py:555] 2023-07-15 06:05:18,536 >> Using cuda_amp half precision backend
[INFO|modeling_utils.py:2039] 2023-07-15 06:05:18,537 >> loading weights file ./output/hate_speech_white/pytorch_model.bin
[INFO|modeling_utils.py:2435] 2023-07-15 06:05:19,364 >> All model checkpoint weights were used when initializing BertForSequenceClassification.

[INFO|modeling_utils.py:2443] 2023-07-15 06:05:19,364 >> All the weights of BertForSequenceClassification were initialized from the model checkpoint at ./output/hate_speech_white/.
If your task is similar to the task the model of the checkpoint was trained on, you can already use BertForSequenceClassification for predictions without further training.
-->Do Custom Model
-->gamma 0
-->model.parameters() <generator object Module.parameters at 0x7fea428b3970>
-->classifier <generator object Module.parameters at 0x7fea428b3970>
-->orig_weight tensor([[-0.0153,  0.0072, -0.0222,  ...,  0.0030,  0.0304, -0.0347],
        [-0.0036, -0.0129,  0.0329,  ...,  0.0022, -0.0106,  0.0357],
        [-0.0289,  0.0154, -0.0010,  ...,  0.0194,  0.0028, -0.0017],
        ...,
        [-0.0043, -0.0288, -0.0088,  ...,  0.0138,  0.0355,  0.0232],
        [ 0.0323, -0.0258,  0.0002,  ...,  0.0115,  0.0021,  0.0288],
        [ 0.0199,  0.0185,  0.0066,  ...,  0.0277,  0.0317, -0.0036]],
       device='cuda:0', grad_fn=<CloneBackward0>)
-->orig_bias tensor([-0.0154, -0.0195,  0.0195,  0.0179, -0.0157,  0.0325,  0.0289,  0.0058,
        -0.0116,  0.0227, -0.0167,  0.0213,  0.0117, -0.0140,  0.0187, -0.0304,
        -0.0207, -0.0191, -0.0019, -0.0283, -0.0069, -0.0283, -0.0303,  0.0349,
         0.0093,  0.0073,  0.0194,  0.0046,  0.0351, -0.0079, -0.0181, -0.0305,
        -0.0143, -0.0116,  0.0188,  0.0337, -0.0105, -0.0104, -0.0264,  0.0049,
        -0.0270, -0.0288, -0.0317,  0.0162, -0.0334,  0.0064, -0.0188, -0.0266,
         0.0158, -0.0136, -0.0107, -0.0051,  0.0295,  0.0126, -0.0286, -0.0360,
        -0.0248, -0.0211, -0.0207, -0.0330, -0.0103], device='cuda:0',
       grad_fn=<CloneBackward0>)
-->MinValue:-3.2998316455372216, MaxValue:4.6572209567471345
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.9836552748885586
-->F1 0.9905254091300603
-->FPR 0.05434782608695652
-->FNR 0.010327022375215147
-->positive probability:0.861812778603269, 580/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9690721649484536
-->F1 0.9817073170731708
-->FPR 0.11475409836065574
-->FNR 0.01529051987767584
-->positive probability:0.8479381443298969, 329/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.98
-->F1 0.988235294117647
-->FPR 0.0
-->FNR 0.023255813953488372
-->positive probability:0.84, 42/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9117647058823529
-->F1 0.9189189189189189
-->FPR 0.17647058823529413
-->FNR 0.0
-->positive probability:0.5882352941176471, 20/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9037433155080213
-->F1 0.9134615384615384
-->FPR 0.10843373493975904
-->FNR 0.08653846153846154
-->positive probability:0.5561497326203209, 104/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9567567567567568
-->F1 0.9676113360323886
-->FPR 0.049586776859504134
-->FNR 0.040160642570281124
-->positive probability:0.6621621621621622, 245/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9550561797752809
-->F1 0.9710144927536232
-->FPR 0.08163265306122448
-->FNR 0.0345821325648415
-->positive probability:0.7707865168539326, 686/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.004838363913043479, 0.05556790836065574, 0.011567142380952383, 0.05918619, 0.11728439823529413, 0.04924754493975904, 0.009599413140495866, 0.022446463061224484]
-->fnr_diff [0.003441825375215147, 0.008405322877675842, 0.09311480300000001, 0.016370616953488373, 0.006885197, 0.07965326453846154, 0.03327544557028112, 0.027696935564841502]
-->FPR: [0.05434782608695652, 0.11475409836065574, 0.047619047619047616, 0.0, 0.17647058823529413, 0.10843373493975904, 0.049586776859504134, 0.08163265306122448], mean FPR:0.0791055906453052, mean FPR diff:0.041217178003928136
-->FNR: [0.010327022375215147, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.08653846153846154, 0.040160642570281124, 0.0345821325648415], mean FNR:0.03876932410999544, mean FNR diff:0.033605426359995444
-->base group metric 0.041217178003928136 0.0791055906453052
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8698630136986302
-->F1 0.9233870967741935
-->FPR 0.45652173913043476
-->FNR 0.06910569105691057
-->positive probability:0.8561643835616438, 250/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8465909090909091
-->F1 0.9010989010989012
-->FPR 0.3953488372093023
-->FNR 0.07518796992481203
-->positive probability:0.7954545454545454, 140/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7058823529411765
-->FPR 0.6
-->FNR 0.25
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7222222222222222
-->F1 0.7368421052631579
-->FPR 0.4
-->FNR 0.125
-->positive probability:0.6111111111111112, 44/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7643312101910829
-->F1 0.8140703517587939
-->FPR 0.390625
-->FNR 0.12903225806451613
-->positive probability:0.6751592356687898, 106/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.821522309711286
-->F1 0.8877887788778878
-->FPR 0.5
-->FNR 0.08191126279863481
-->positive probability:0.821522309711286, 313/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.3973355491304348, 0.33616264720930233, 0.05918619, 0.6074804766666666, 0.54081381, 0.34081381, 0.33143881, 0.44081381]
-->fnr_diff [0.06222049405691057, 0.06830277292481203, 0.10422591411111111, 0.006885197, 0.243114803, 0.118114803, 0.12214706106451613, 0.07502606579863481]
-->FPR: [0.45652173913043476, 0.3953488372093023, 0.0, 0.6666666666666666, 0.6, 0.4, 0.390625, 0.5], mean FPR:0.42614528037580046, mean FPR diff:0.38175563787580047
-->FNR: [0.06910569105691057, 0.07518796992481203, 0.1111111111111111, 0.0, 0.25, 0.125, 0.12903225806451613, 0.08191126279863481], mean FNR:0.10516853661949807, mean FNR diff:0.10000463886949808
-->base group metric 0.38175563787580047 0.42614528037580046
-->epoch 0
-->start_index 0
-->batch_size 98
-->ACC 0.20408163265306123
-->F1 0.0
-->z_score:-3.2998318672180176, idi:0.0, p_hat:0.0, n:98.0
Epoch [1/20], Loss: 0.8069, acc_loss, 0.8069, bias_loss:0.0000
-->start_index 98
-->batch_size 98
-->ACC 0.6938775510204082
-->F1 0.819277108433735
-->z_score:-3.2998318672180176, idi:0.0, p_hat:0.0, n:98.0
Epoch [1/20], Loss: 0.7493, acc_loss, 0.7493, bias_loss:0.0000
-->start_index 196
-->batch_size 98
-->ACC 0.8163265306122449
-->F1 0.898876404494382
-->z_score:-3.2998318672180176, idi:0.0, p_hat:0.0, n:98.0
Epoch [1/20], Loss: 0.6359, acc_loss, 0.6359, bias_loss:0.0000
-->start_index 294
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9634146341463415
-->z_score:-0.16456757485866547, idi:9.311259269714355, p_hat:0.0950128510594368, n:98.0
Epoch [1/20], Loss: 0.4587, acc_loss, 0.4587, bias_loss:0.0000
-->start_index 392
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9625
-->z_score:-0.2284332811832428, idi:9.121587753295898, p_hat:0.09307742863893509, n:98.0
Epoch [1/20], Loss: 0.2113, acc_loss, 0.2113, bias_loss:0.0000
-->start_index 490
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.958904109589041
-->z_score:1.0197112560272217, idi:12.828388214111328, p_hat:0.13090191781520844, n:98.0
Epoch [1/20], Loss: -0.0669, acc_loss, -0.0669, bias_loss:0.0000
-->start_index 588
-->batch_size 98
-->ACC 0.9183673469387755
-->F1 0.9473684210526316
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [1/20], Loss: -0.1316, acc_loss, -0.1316, bias_loss:0.0000
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9878048780487805
-->z_score:3.0971643924713135, idi:18.99810791015625, p_hat:0.19385825097560883, n:98.0
Epoch [1/20], Loss: -0.4236, acc_loss, -0.4236, bias_loss:0.0000
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.2693740427494049, idi:9.0, p_hat:0.09183673560619354, n:98.0
Epoch [1/20], Loss: -0.4094, acc_loss, -0.4094, bias_loss:0.0000
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.7509312629699707, idi:15.0, p_hat:0.15306122601032257, n:98.0
Epoch [1/20], Loss: -0.2400, acc_loss, -0.2400, bias_loss:0.0000
-->start_index 980
-->batch_size 98
-->ACC 0.9183673469387755
-->F1 0.9506172839506173
-->z_score:0.740777850151062, idi:11.999998092651367, p_hat:0.12244895845651627, n:98.0
Epoch [1/20], Loss: 0.2936, acc_loss, 0.2936, bias_loss:0.0000
-->start_index 1078
-->batch_size 98
-->ACC 1.0
-->F1 1.0
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [1/20], Loss: -0.5951, acc_loss, -0.5951, bias_loss:0.0000
-->start_index 1176
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.987012987012987
-->z_score:0.7407746911048889, idi:11.999988555908203, p_hat:0.1224488615989685, n:98.0
Epoch [1/20], Loss: -0.3806, acc_loss, -0.3806, bias_loss:0.0000
-->start_index 1274
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:3.765078544616699, idi:20.981712341308594, p_hat:0.21409910917282104, n:98.0
Epoch [1/20], Loss: -0.3815, acc_loss, -0.3815, bias_loss:0.0000
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [1/20], Loss: -0.2278, acc_loss, -0.2278, bias_loss:0.0000
-->start_index 1470
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9722222222222222
-->z_score:0.7259952425956726, idi:11.956095695495605, p_hat:0.12200097739696503, n:98.0
Epoch [1/20], Loss: -0.1374, acc_loss, -0.1374, bias_loss:0.0000
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:2.0876481533050537, idi:15.999998092651367, p_hat:0.16326528787612915, n:98.0
Epoch [1/20], Loss: -0.3425, acc_loss, -0.3425, bias_loss:0.0000
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.09579017013311386, idi:10.084482192993164, p_hat:0.10290288180112839, n:98.0
Epoch [1/20], Loss: -0.3656, acc_loss, -0.3656, bias_loss:0.0000
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:0.31346917152404785, idi:10.730956077575684, p_hat:0.10949955135583878, n:98.0
Epoch [1/20], Loss: -0.4207, acc_loss, -0.4207, bias_loss:0.0000
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.2693757712841034, idi:8.999995231628418, p_hat:0.09183668345212936, n:98.0
Epoch [1/20], Loss: -0.4947, acc_loss, -0.4947, bias_loss:0.0000
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-0.6085806488990784, idi:2.0, p_hat:0.06666667014360428, n:30.0
Epoch [1/20], Loss: -0.4573, acc_loss, -0.4573, bias_loss:0.0000
-->after epoch 0
-->overall baseline on training dataset
-->ACC 0.9870528563801388
-->F1 0.9927476635514019
-->FPR: 0.06781750924784218
-->FNR: 0.006286484059272564
-->overall baseline on testing dataset
-->ACC 0.9159140454687014
-->F1 0.9528631284916202
-->FPR: 0.44935064935064933
-->FNR: 0.0343241330502477
training dataset
-->original metric score:
-->individual metric:0.13008538422903063, num_idi:259, num_all:1991
-->individual metric 0.13008538422903063
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.9836552748885586
-->F1 0.9905254091300603
-->FPR 0.05434782608695652
-->FNR 0.010327022375215147
-->positive probability:0.861812778603269, 580/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9716494845360825
-->F1 0.9832572298325722
-->FPR 0.11475409836065574
-->FNR 0.012232415902140673
-->positive probability:0.8505154639175257, 330/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.98
-->F1 0.988235294117647
-->FPR 0.0
-->FNR 0.023255813953488372
-->positive probability:0.84, 42/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9117647058823529
-->F1 0.9189189189189189
-->FPR 0.17647058823529413
-->FNR 0.0
-->positive probability:0.5882352941176471, 20/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9037433155080213
-->F1 0.9142857142857143
-->FPR 0.12048192771084337
-->FNR 0.07692307692307693
-->positive probability:0.5668449197860963, 106/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9513513513513514
-->F1 0.963855421686747
-->FPR 0.0743801652892562
-->FNR 0.03614457831325301
-->positive probability:0.672972972972973, 249/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9584269662921349
-->F1 0.9732465654374548
-->FPR 0.08163265306122448
-->FNR 0.03025936599423631
-->positive probability:0.7741573033707865, 689/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.013469683160885655, 0.046936589112813565, 0.02019846162879456, 0.06781750924784218, 0.10865307898745195, 0.0526644184630012, 0.006562656041414025, 0.013815143813382308]
-->fnr_diff [0.0040405383159425835, 0.005945931842868109, 0.09371351594072744, 0.016969329894215807, 0.006286484059272564, 0.07063659286380436, 0.029858094253980446, 0.023972881934963747]
-->FPR:[0.05434782608695652, 0.11475409836065574, 0.047619047619047616, 0.0, 0.17647058823529413, 0.12048192771084337, 0.0743801652892562, 0.08163265306122448], mean FPR:0.08371078829540976, mean FPR diff:0.041264692556948174
-->FNR:[0.010327022375215147, 0.012232415902140673, 0.1, 0.023255813953488372, 0.0, 0.07692307692307693, 0.03614457831325301, 0.03025936599423631], mean FNR:0.0361427841826763, mean FNR diff:0.03142792113822188
-->mean fnr diff metric 0.041264692556948174
testing dataset
-->original metric score:
-->individual metric:0.19148936170212766, num_idi:162, num_all:846
-->individual metric 0.19148936170212766
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8801369863013698
-->F1 0.9301397205588823
-->FPR 0.4782608695652174
-->FNR 0.052845528455284556
-->positive probability:0.8732876712328768, 255/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8409090909090909
-->F1 0.8992805755395683
-->FPR 0.46511627906976744
-->FNR 0.06015037593984962
-->positive probability:0.8238636363636364, 145/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7058823529411765
-->FPR 0.6
-->FNR 0.25
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7083333333333334
-->F1 0.7272727272727274
-->FPR 0.425
-->FNR 0.125
-->positive probability:0.625, 45/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7770700636942676
-->F1 0.8275862068965516
-->FPR 0.40625
-->FNR 0.0967741935483871
-->positive probability:0.7006369426751592, 110/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8293963254593176
-->F1 0.8932676518883416
-->FPR 0.5
-->FNR 0.07167235494880546
-->positive probability:0.8293963254593176, 316/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.028910220214568072, 0.0157656297191181, 0.44935064935064933, 0.2173160173160173, 0.15064935064935064, 0.024350649350649345, 0.043100649350649334, 0.050649350649350666]
-->fnr_diff [0.018521395405036854, 0.02582624288960192, 0.0767869780608634, 0.0343241330502477, 0.2156758669497523, 0.0906758669497523, 0.06245006049813939, 0.03734822189855776]
-->FPR:[0.4782608695652174, 0.46511627906976744, 0.0, 0.6666666666666666, 0.6, 0.425, 0.40625, 0.5], mean FPR:0.44266172691270644, mean FPR diff:0.12251156457504411
-->FNR:[0.052845528455284556, 0.06015037593984962, 0.1111111111111111, 0.0, 0.25, 0.125, 0.0967741935483871, 0.07167235494880546], mean FNR:0.09594419550042974, mean FNR diff:0.07020109571274395
-->mean fnr diff metric 0.12251156457504411
-->epoch 1
-->start_index 0
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:2.086817502975464, idi:15.99753189086914, p_hat:0.16324011981487274, n:98.0
Epoch [2/20], Loss: -0.2084, acc_loss, -0.2084, bias_loss:0.0000
-->start_index 98
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9852941176470589
-->z_score:1.6327100992202759, idi:14.648900985717773, p_hat:0.14947858452796936, n:98.0
Epoch [2/20], Loss: -0.3832, acc_loss, -0.3832, bias_loss:0.0000
-->start_index 196
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9685534591194969
-->z_score:1.4140565395355225, idi:13.999532699584961, p_hat:0.14285238087177277, n:98.0
Epoch [2/20], Loss: -0.3175, acc_loss, -0.3175, bias_loss:0.0000
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:2.7610838413238525, idi:18.0, p_hat:0.18367347121238708, n:98.0
Epoch [2/20], Loss: -0.3005, acc_loss, -0.3005, bias_loss:0.0000
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:-0.2693905234336853, idi:8.999951362609863, p_hat:0.09183623641729355, n:98.0
Epoch [2/20], Loss: -0.3372, acc_loss, -0.3372, bias_loss:0.0000
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.6077364683151245, idi:14.57473373413086, p_hat:0.14872176945209503, n:98.0
Epoch [2/20], Loss: -0.3141, acc_loss, -0.3141, bias_loss:0.0000
-->start_index 588
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9536423841059603
-->z_score:2.73254132270813, idi:17.915233612060547, p_hat:0.1828085035085678, n:98.0
Epoch [2/20], Loss: -0.0297, acc_loss, -0.0297, bias_loss:0.0000
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9876543209876543
-->z_score:3.738941192626953, idi:20.904088973999023, p_hat:0.21330702304840088, n:98.0
Epoch [2/20], Loss: -0.4178, acc_loss, -0.4178, bias_loss:0.0000
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.2693740427494049, idi:9.0, p_hat:0.09183673560619354, n:98.0
Epoch [2/20], Loss: -0.4232, acc_loss, -0.4232, bias_loss:0.0000
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.7396882772445679, idi:14.966609954833984, p_hat:0.15272051095962524, n:98.0
Epoch [2/20], Loss: -0.3755, acc_loss, -0.3755, bias_loss:0.0000
-->start_index 980
-->batch_size 98
-->ACC 0.9183673469387755
-->F1 0.9506172839506173
-->z_score:1.136052131652832, idi:13.17390251159668, p_hat:0.13442757725715637, n:98.0
Epoch [2/20], Loss: -0.2134, acc_loss, -0.2134, bias_loss:0.0000
-->start_index 1078
-->batch_size 98
-->ACC 1.0
-->F1 1.0
-->z_score:1.4123300313949585, idi:13.994405746459961, p_hat:0.14280006289482117, n:98.0
Epoch [2/20], Loss: -0.5165, acc_loss, -0.5165, bias_loss:0.0000
-->start_index 1176
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.987012987012987
-->z_score:1.4142128229141235, idi:13.99999713897705, p_hat:0.1428571194410324, n:98.0
Epoch [2/20], Loss: -0.4393, acc_loss, -0.4393, bias_loss:0.0000
-->start_index 1274
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:3.4345192909240723, idi:20.0, p_hat:0.20408163964748383, n:98.0
Epoch [2/20], Loss: -0.3760, acc_loss, -0.3760, bias_loss:0.0000
-->start_index 1372
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9577464788732395
-->z_score:1.6840578317642212, idi:14.801395416259766, p_hat:0.1510346531867981, n:98.0
Epoch [2/20], Loss: -0.3601, acc_loss, -0.3601, bias_loss:0.0000
-->start_index 1470
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9722222222222222
-->z_score:1.4051810503005981, idi:13.973175048828125, p_hat:0.14258341491222382, n:98.0
Epoch [2/20], Loss: -0.3106, acc_loss, -0.3106, bias_loss:0.0000
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:2.4243664741516113, idi:17.0, p_hat:0.1734693944454193, n:98.0
Epoch [2/20], Loss: -0.4099, acc_loss, -0.4099, bias_loss:0.0000
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [2/20], Loss: -0.2989, acc_loss, -0.2989, bias_loss:0.0000
-->start_index 1764
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9864864864864865
-->z_score:1.6982938051223755, idi:14.843674659729004, p_hat:0.15146607160568237, n:98.0
Epoch [2/20], Loss: -0.4280, acc_loss, -0.4280, bias_loss:0.0000
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.2693740427494049, idi:9.0, p_hat:0.09183673560619354, n:98.0
Epoch [2/20], Loss: -0.5275, acc_loss, -0.5275, bias_loss:0.0000
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-0.6085806488990784, idi:2.0, p_hat:0.06666667014360428, n:30.0
Epoch [2/20], Loss: -0.5007, acc_loss, -0.5007, bias_loss:0.0000
-->after epoch 1
-->overall baseline on training dataset
-->ACC 0.9869193806727176
-->F1 0.9926657685975153
-->FPR: 0.06041923551171394
-->FNR: 0.007334231402484658
-->overall baseline on testing dataset
-->ACC 0.9134226097788851
-->F1 0.9512622720897617
-->FPR: 0.42857142857142855
-->FNR: 0.0399858457183298
training dataset
-->original metric score:
-->individual metric:0.1411351079859367, num_idi:281, num_all:1991
-->individual metric 0.1411351079859367
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.9821693907875185
-->F1 0.9896551724137931
-->FPR 0.05434782608695652
-->FNR 0.012048192771084338
-->positive probability:0.8603268945022289, 579/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9690721649484536
-->F1 0.9817073170731708
-->FPR 0.11475409836065574
-->FNR 0.01529051987767584
-->positive probability:0.8479381443298969, 329/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.98
-->F1 0.988235294117647
-->FPR 0.0
-->FNR 0.023255813953488372
-->positive probability:0.84, 42/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9117647058823529
-->F1 0.9189189189189189
-->FPR 0.17647058823529413
-->FNR 0.0
-->positive probability:0.5882352941176471, 20/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9144385026737968
-->F1 0.9230769230769231
-->FPR 0.0963855421686747
-->FNR 0.07692307692307693
-->positive probability:0.5561497326203209, 104/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9594594594594594
-->F1 0.9696969696969697
-->FPR 0.049586776859504134
-->FNR 0.03614457831325301
-->positive probability:0.6648648648648648, 246/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9561797752808989
-->F1 0.9717595944967414
-->FPR 0.08163265306122448
-->FNR 0.03314121037463977
-->positive probability:0.7719101123595505, 687/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.006071409424757417, 0.0543348628489418, 0.01280018789266632, 0.06041923551171394, 0.11605135272358019, 0.03596630665696077, 0.010832458652209803, 0.021213417549510546]
-->fnr_diff [0.00471396136859968, 0.007956288475191184, 0.09266576859751535, 0.015921582551003715, 0.007334231402484658, 0.06958884552059227, 0.028810346910768354, 0.02580697897215511]
-->FPR:[0.05434782608695652, 0.11475409836065574, 0.047619047619047616, 0.0, 0.17647058823529413, 0.0963855421686747, 0.049586776859504134, 0.08163265306122448], mean FPR:0.07759956654891967, mean FPR diff:0.039711153907542596
-->FNR:[0.012048192771084338, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.07692307692307693, 0.03614457831325301, 0.03314121037463977], mean FNR:0.037100424026652284, mean FNR diff:0.03159975047478879
-->mean fnr diff metric 0.039711153907542596
testing dataset
-->original metric score:
-->individual metric:0.19739952718676124, num_idi:167, num_all:846
-->individual metric 0.19739952718676124
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8732876712328768
-->F1 0.9252525252525251
-->FPR 0.43478260869565216
-->FNR 0.06910569105691057
-->positive probability:0.8527397260273972, 249/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9044117647058822
-->FPR 0.37209302325581395
-->FNR 0.07518796992481203
-->positive probability:0.7897727272727273, 139/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7058823529411765
-->FPR 0.6
-->FNR 0.25
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7466666666666667
-->FPR 0.375
-->FNR 0.125
-->positive probability:0.5972222222222222, 43/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7515923566878981
-->F1 0.8020304568527918
-->FPR 0.390625
-->FNR 0.15053763440860216
-->positive probability:0.6624203821656051, 104/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.821522309711286
-->F1 0.8874172185430463
-->FPR 0.48863636363636365
-->FNR 0.08532423208191127
-->positive probability:0.8162729658792651, 311/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.006211180124223614, 0.0564784053156146, 0.42857142857142855, 0.23809523809523808, 0.17142857142857143, 0.05357142857142855, 0.03794642857142855, 0.0600649350649351]
-->fnr_diff [0.029119845338580773, 0.03520212420648223, 0.0711252653927813, 0.0399858457183298, 0.2100141542816702, 0.0850141542816702, 0.11055178869027235, 0.04533838636358147]
-->FPR:[0.43478260869565216, 0.37209302325581395, 0.0, 0.6666666666666666, 0.6, 0.375, 0.390625, 0.48863636363636365], mean FPR:0.415975457781812, mean FPR diff:0.13154595196785857
-->FNR:[0.06910569105691057, 0.07518796992481203, 0.1111111111111111, 0.0, 0.25, 0.125, 0.15053763440860216, 0.08532423208191127], mean FNR:0.10828332982291838, mean FNR diff:0.07829394553417104
-->mean fnr diff metric 0.13154595196785857
-->epoch 2
-->start_index 0
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9610389610389611
-->z_score:1.9132678508758545, idi:15.482114791870117, p_hat:0.1579807698726654, n:98.0
Epoch [3/20], Loss: -0.1435, acc_loss, -0.1435, bias_loss:0.0000
-->start_index 98
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9852941176470589
-->z_score:1.994170904159546, idi:15.72238540649414, p_hat:0.16043250262737274, n:98.0
Epoch [3/20], Loss: -0.4014, acc_loss, -0.4014, bias_loss:0.0000
-->start_index 196
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9685534591194969
-->z_score:1.7500231266021729, idi:14.997303009033203, p_hat:0.15303370356559753, n:98.0
Epoch [3/20], Loss: -0.3265, acc_loss, -0.3265, bias_loss:0.0000
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:2.7610838413238525, idi:18.0, p_hat:0.18367347121238708, n:98.0
Epoch [3/20], Loss: -0.3078, acc_loss, -0.3078, bias_loss:0.0000
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:-0.2707115113735199, idi:8.996027946472168, p_hat:0.09179620444774628, n:98.0
Epoch [3/20], Loss: -0.3659, acc_loss, -0.3659, bias_loss:0.0000
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:0.9134702682495117, idi:12.512868881225586, p_hat:0.12768232822418213, n:98.0
Epoch [3/20], Loss: -0.3290, acc_loss, -0.3290, bias_loss:0.0000
-->start_index 588
-->batch_size 98
-->ACC 0.9183673469387755
-->F1 0.9473684210526316
-->z_score:2.2272756099700928, idi:16.414670944213867, p_hat:0.16749663650989532, n:98.0
Epoch [3/20], Loss: -0.0800, acc_loss, -0.0800, bias_loss:0.0000
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9878048780487805
-->z_score:3.0498175621032715, idi:18.857494354248047, p_hat:0.19242341816425323, n:98.0
Epoch [3/20], Loss: -0.4213, acc_loss, -0.4213, bias_loss:0.0000
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.6060916781425476, idi:8.0, p_hat:0.08163265138864517, n:98.0
Epoch [3/20], Loss: -0.4185, acc_loss, -0.4185, bias_loss:0.0000
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.7203490734100342, idi:14.909175872802734, p_hat:0.15213444828987122, n:98.0
Epoch [3/20], Loss: -0.3802, acc_loss, -0.3802, bias_loss:0.0000
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.1618243157863617, idi:10.280593872070312, p_hat:0.10490401834249496, n:98.0
Epoch [3/20], Loss: -0.2353, acc_loss, -0.2353, bias_loss:0.0000
-->start_index 1078
-->batch_size 98
-->ACC 1.0
-->F1 1.0
-->z_score:0.740777850151062, idi:11.999998092651367, p_hat:0.12244895845651627, n:98.0
Epoch [3/20], Loss: -0.4940, acc_loss, -0.4940, bias_loss:0.0000
-->start_index 1176
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.987012987012987
-->z_score:0.40388813614845276, idi:10.999486923217773, p_hat:0.11223965883255005, n:98.0
Epoch [3/20], Loss: -0.4431, acc_loss, -0.4431, bias_loss:0.0000
-->start_index 1274
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:3.1766867637634277, idi:19.234277725219727, p_hat:0.19626814126968384, n:98.0
Epoch [3/20], Loss: -0.3672, acc_loss, -0.3672, bias_loss:0.0000
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:1.3376226425170898, idi:13.772536277770996, p_hat:0.1405360847711563, n:98.0
Epoch [3/20], Loss: -0.3828, acc_loss, -0.3828, bias_loss:0.0000
-->start_index 1470
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9722222222222222
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [3/20], Loss: -0.3505, acc_loss, -0.3505, bias_loss:0.0000
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [3/20], Loss: -0.4010, acc_loss, -0.4010, bias_loss:0.0000
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.067343570291996, idi:10.0, p_hat:0.10204081982374191, n:98.0
Epoch [3/20], Loss: -0.2902, acc_loss, -0.2902, bias_loss:0.0000
-->start_index 1764
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9864864864864865
-->z_score:1.0207164287567139, idi:12.83137321472168, p_hat:0.13093237578868866, n:98.0
Epoch [3/20], Loss: -0.4295, acc_loss, -0.4295, bias_loss:0.0000
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.25238239765167236, idi:9.05046272277832, p_hat:0.09235166013240814, n:98.0
Epoch [3/20], Loss: -0.5167, acc_loss, -0.5167, bias_loss:0.0000
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-0.6085806488990784, idi:2.0, p_hat:0.06666667014360428, n:30.0
Epoch [3/20], Loss: -0.4996, acc_loss, -0.4996, bias_loss:0.0000
-->after epoch 2
-->overall baseline on training dataset
-->ACC 0.9869193806727176
-->F1 0.9926690604428486
-->FPR: 0.06411837237977805
-->FNR: 0.006885196826822332
-->overall baseline on testing dataset
-->ACC 0.9134226097788851
-->F1 0.9513645906228131
-->FPR: 0.44415584415584414
-->FNR: 0.03786270346779901
training dataset
-->original metric score:
-->individual metric:0.13611250627825214, num_idi:271, num_all:1991
-->individual metric 0.13611250627825214
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.9836552748885586
-->F1 0.9905254091300603
-->FPR 0.05434782608695652
-->FNR 0.010327022375215147
-->positive probability:0.861812778603269, 580/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9690721649484536
-->F1 0.9817073170731708
-->FPR 0.11475409836065574
-->FNR 0.01529051987767584
-->positive probability:0.8479381443298969, 329/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.98
-->F1 0.988235294117647
-->FPR 0.0
-->FNR 0.023255813953488372
-->positive probability:0.84, 42/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9117647058823529
-->F1 0.9189189189189189
-->FPR 0.17647058823529413
-->FNR 0.0
-->positive probability:0.5882352941176471, 20/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9144385026737968
-->F1 0.9230769230769231
-->FPR 0.0963855421686747
-->FNR 0.07692307692307693
-->positive probability:0.5561497326203209, 104/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9594594594594594
-->F1 0.9696969696969697
-->FPR 0.049586776859504134
-->FNR 0.03614457831325301
-->positive probability:0.6648648648648648, 246/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9561797752808989
-->F1 0.9717595944967414
-->FPR 0.08163265306122448
-->FNR 0.03314121037463977
-->positive probability:0.7719101123595505, 687/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.009770546292821529, 0.05063572598087769, 0.016499324760730433, 0.06411837237977805, 0.11235221585551608, 0.032267169788896655, 0.014531595520273916, 0.017514280681446434]
-->fnr_diff [0.0034418255483928155, 0.008405323050853508, 0.09311480317317768, 0.01637061712666604, 0.006885196826822332, 0.0700378800962546, 0.029259381486430678, 0.026256013547817435]
-->FPR:[0.05434782608695652, 0.11475409836065574, 0.047619047619047616, 0.0, 0.17647058823529413, 0.0963855421686747, 0.049586776859504134, 0.08163265306122448], mean FPR:0.07759956654891967, mean FPR diff:0.039711153907542596
-->FNR:[0.010327022375215147, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.07692307692307693, 0.03614457831325301, 0.03314121037463977], mean FNR:0.03688527772716864, mean FNR diff:0.03172138010705189
-->mean fnr diff metric 0.039711153907542596
testing dataset
-->original metric score:
-->individual metric:0.19030732860520094, num_idi:161, num_all:846
-->individual metric 0.19030732860520094
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8698630136986302
-->F1 0.9233870967741935
-->FPR 0.45652173913043476
-->FNR 0.06910569105691057
-->positive probability:0.8561643835616438, 250/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8465909090909091
-->F1 0.9010989010989012
-->FPR 0.3953488372093023
-->FNR 0.07518796992481203
-->positive probability:0.7954545454545454, 140/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7058823529411765
-->FPR 0.6
-->FNR 0.25
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7222222222222222
-->F1 0.7368421052631579
-->FPR 0.4
-->FNR 0.125
-->positive probability:0.6111111111111112, 44/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7643312101910829
-->F1 0.8140703517587939
-->FPR 0.390625
-->FNR 0.12903225806451613
-->positive probability:0.6751592356687898, 106/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.821522309711286
-->F1 0.8877887788778878
-->FPR 0.5
-->FNR 0.08191126279863481
-->positive probability:0.821522309711286, 313/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.012365894974590619, 0.04880700694654183, 0.44415584415584414, 0.2225108225108225, 0.15584415584415584, 0.044155844155844115, 0.05353084415584414, 0.05584415584415586]
-->fnr_diff [0.031242987589111558, 0.037325266457013014, 0.07324840764331209, 0.03786270346779901, 0.21213729653220098, 0.08713729653220098, 0.0911695545967171, 0.0440485593308358]
-->FPR:[0.45652173913043476, 0.3953488372093023, 0.0, 0.6666666666666666, 0.6, 0.4, 0.390625, 0.5], mean FPR:0.42614528037580046, mean FPR diff:0.1296518210734749
-->FNR:[0.06910569105691057, 0.07518796992481203, 0.1111111111111111, 0.0, 0.25, 0.125, 0.12903225806451613, 0.08191126279863481], mean FNR:0.10516853661949807, mean FNR diff:0.07677150901864882
-->mean fnr diff metric 0.1296518210734749
-->epoch 3
-->start_index 0
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9610389610389611
-->z_score:1.7509312629699707, idi:15.0, p_hat:0.15306122601032257, n:98.0
Epoch [4/20], Loss: -0.1450, acc_loss, -0.1450, bias_loss:0.0000
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:2.266580581665039, idi:16.531400680541992, p_hat:0.16868776082992554, n:98.0
Epoch [4/20], Loss: -0.4078, acc_loss, -0.4078, bias_loss:0.0000
-->start_index 196
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9685534591194969
-->z_score:1.750284194946289, idi:14.998078346252441, p_hat:0.15304161608219147, n:98.0
Epoch [4/20], Loss: -0.3171, acc_loss, -0.3171, bias_loss:0.0000
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:2.7610838413238525, idi:18.0, p_hat:0.18367347121238708, n:98.0
Epoch [4/20], Loss: -0.2995, acc_loss, -0.2995, bias_loss:0.0000
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:-0.606092631816864, idi:7.999997138977051, p_hat:0.08163262158632278, n:98.0
Epoch [4/20], Loss: -0.3529, acc_loss, -0.3529, bias_loss:0.0000
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.3570448160171509, idi:13.830217361450195, p_hat:0.1411246657371521, n:98.0
Epoch [4/20], Loss: -0.3247, acc_loss, -0.3247, bias_loss:0.0000
-->start_index 588
-->batch_size 98
-->ACC 0.9183673469387755
-->F1 0.9473684210526316
-->z_score:2.404022693634033, idi:16.93958282470703, p_hat:0.17285288870334625, n:98.0
Epoch [4/20], Loss: -0.0925, acc_loss, -0.0925, bias_loss:0.0000
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9878048780487805
-->z_score:3.276454448699951, idi:19.53057289123535, p_hat:0.19929155707359314, n:98.0
Epoch [4/20], Loss: -0.4321, acc_loss, -0.4321, bias_loss:0.0000
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.6060916781425476, idi:8.0, p_hat:0.08163265138864517, n:98.0
Epoch [4/20], Loss: -0.4154, acc_loss, -0.4154, bias_loss:0.0000
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.7502752542495728, idi:14.998052597045898, p_hat:0.15304134786128998, n:98.0
Epoch [4/20], Loss: -0.3811, acc_loss, -0.3811, bias_loss:0.0000
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.3980984389781952, idi:10.982292175292969, p_hat:0.11206420511007309, n:98.0
Epoch [4/20], Loss: -0.2426, acc_loss, -0.2426, bias_loss:0.0000
-->start_index 1078
-->batch_size 98
-->ACC 1.0
-->F1 1.0
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [4/20], Loss: -0.4888, acc_loss, -0.4888, bias_loss:0.0000
-->start_index 1176
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.987012987012987
-->z_score:0.4039822816848755, idi:10.99976634979248, p_hat:0.11224251240491867, n:98.0
Epoch [4/20], Loss: -0.4405, acc_loss, -0.4405, bias_loss:0.0000
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9729729729729729
-->z_score:2.739297866821289, idi:17.935298919677734, p_hat:0.18301326036453247, n:98.0
Epoch [4/20], Loss: -0.3621, acc_loss, -0.3621, bias_loss:0.0000
-->start_index 1372
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9659863945578231
-->z_score:1.4067329168319702, idi:13.977783203125, p_hat:0.1426304429769516, n:98.0
Epoch [4/20], Loss: -0.3805, acc_loss, -0.3805, bias_loss:0.0000
-->start_index 1470
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9722222222222222
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [4/20], Loss: -0.3592, acc_loss, -0.3592, bias_loss:0.0000
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:2.422023296356201, idi:16.9930419921875, p_hat:0.17339839041233063, n:98.0
Epoch [4/20], Loss: -0.3971, acc_loss, -0.3971, bias_loss:0.0000
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.40405529737472534, idi:10.999982833862305, p_hat:0.11224472522735596, n:98.0
Epoch [4/20], Loss: -0.2797, acc_loss, -0.2797, bias_loss:0.0000
-->start_index 1764
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9864864864864865
-->z_score:1.1958591938018799, idi:13.351520538330078, p_hat:0.13624000549316406, n:98.0
Epoch [4/20], Loss: -0.4280, acc_loss, -0.4280, bias_loss:0.0000
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.4632067084312439, idi:8.424346923828125, p_hat:0.08596272021532059, n:98.0
Epoch [4/20], Loss: -0.5189, acc_loss, -0.5189, bias_loss:0.0000
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-0.6085806488990784, idi:2.0, p_hat:0.06666667014360428, n:30.0
Epoch [4/20], Loss: -0.5036, acc_loss, -0.5036, bias_loss:0.0000
-->after epoch 3
-->overall baseline on training dataset
-->ACC 0.9869193806727176
-->F1 0.9926701570680628
-->FPR: 0.06535141800246609
-->FNR: 0.00673551863493489
-->overall baseline on testing dataset
-->ACC 0.9137340392401121
-->F1 0.9515310586176728
-->FPR: 0.44155844155844154
-->FNR: 0.03786270346779901
training dataset
-->original metric score:
-->individual metric:0.13761928679055752, num_idi:274, num_all:1991
-->individual metric 0.13761928679055752
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.9836552748885586
-->F1 0.9905254091300603
-->FPR 0.05434782608695652
-->FNR 0.010327022375215147
-->positive probability:0.861812778603269, 580/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9690721649484536
-->F1 0.9817073170731708
-->FPR 0.11475409836065574
-->FNR 0.01529051987767584
-->positive probability:0.8479381443298969, 329/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.98
-->F1 0.988235294117647
-->FPR 0.0
-->FNR 0.023255813953488372
-->positive probability:0.84, 42/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9117647058823529
-->F1 0.9189189189189189
-->FPR 0.17647058823529413
-->FNR 0.0
-->positive probability:0.5882352941176471, 20/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9144385026737968
-->F1 0.9230769230769231
-->FPR 0.0963855421686747
-->FNR 0.07692307692307693
-->positive probability:0.5561497326203209, 104/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9594594594594594
-->F1 0.9696969696969697
-->FPR 0.049586776859504134
-->FNR 0.03614457831325301
-->positive probability:0.6648648648648648, 246/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9561797752808989
-->F1 0.9718004338394794
-->FPR 0.08673469387755102
-->FNR 0.03170028818443804
-->positive probability:0.7741573033707865, 689/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.011003591915509571, 0.04940268035818965, 0.017732370383418475, 0.06535141800246609, 0.11111917023282804, 0.031034124166208613, 0.015764641142961958, 0.02138327587508493]
-->fnr_diff [0.0035915037402802575, 0.008555001242740952, 0.09326448136506511, 0.016520295318553483, 0.00673551863493489, 0.07018755828814204, 0.02940905967831812, 0.024964769549503153]
-->FPR:[0.05434782608695652, 0.11475409836065574, 0.047619047619047616, 0.0, 0.17647058823529413, 0.0963855421686747, 0.049586776859504134, 0.08673469387755102], mean FPR:0.07823732165096048, mean FPR diff:0.04034890900958342
-->FNR:[0.010327022375215147, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.07692307692307693, 0.03614457831325301, 0.03170028818443804], mean FNR:0.03670516245339342, mean FNR diff:0.03165352347719225
-->mean fnr diff metric 0.04034890900958342
testing dataset
-->original metric score:
-->individual metric:0.19267139479905437, num_idi:163, num_all:846
-->individual metric 0.19267139479905437
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8732876712328768
-->F1 0.9252525252525251
-->FPR 0.43478260869565216
-->FNR 0.06910569105691057
-->positive probability:0.8527397260273972, 249/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9044117647058822
-->FPR 0.37209302325581395
-->FNR 0.07518796992481203
-->positive probability:0.7897727272727273, 139/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7058823529411765
-->FPR 0.6
-->FNR 0.25
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7466666666666667
-->FPR 0.375
-->FNR 0.125
-->positive probability:0.5972222222222222, 43/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7643312101910829
-->F1 0.8140703517587939
-->FPR 0.390625
-->FNR 0.12903225806451613
-->positive probability:0.6751592356687898, 106/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8241469816272966
-->F1 0.8896210873146624
-->FPR 0.5
-->FNR 0.07849829351535836
-->positive probability:0.8241469816272966, 314/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.006775832862789377, 0.06946541830262759, 0.44155844155844154, 0.2251082251082251, 0.15844155844155844, 0.06655844155844154, 0.05093344155844154, 0.05844155844155846]
-->fnr_diff [0.031242987589111558, 0.037325266457013014, 0.07324840764331209, 0.03786270346779901, 0.21213729653220098, 0.08713729653220098, 0.0911695545967171, 0.04063559004755935]
-->FPR:[0.43478260869565216, 0.37209302325581395, 0.0, 0.6666666666666666, 0.6, 0.375, 0.390625, 0.5], mean FPR:0.4173959123272666, mean FPR diff:0.13466036472901044
-->FNR:[0.06910569105691057, 0.07518796992481203, 0.1111111111111111, 0.0, 0.25, 0.125, 0.12903225806451613, 0.07849829351535836], mean FNR:0.10474191545908851, mean FNR diff:0.07634488785823926
-->mean fnr diff metric 0.13466036472901044
-->epoch 4
-->start_index 0
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9610389610389611
-->z_score:1.7509312629699707, idi:15.0, p_hat:0.15306122601032257, n:98.0
Epoch [5/20], Loss: -0.1463, acc_loss, -0.1463, bias_loss:0.0000
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:2.423220157623291, idi:16.996597290039062, p_hat:0.17343465983867645, n:98.0
Epoch [5/20], Loss: -0.4096, acc_loss, -0.4096, bias_loss:0.0000
-->start_index 196
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:2.087641716003418, idi:15.999979019165039, p_hat:0.16326509416103363, n:98.0
Epoch [5/20], Loss: -0.3248, acc_loss, -0.3248, bias_loss:0.0000
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:2.7610838413238525, idi:18.0, p_hat:0.18367347121238708, n:98.0
Epoch [5/20], Loss: -0.3002, acc_loss, -0.3002, bias_loss:0.0000
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:-0.6061000227928162, idi:7.999975204467773, p_hat:0.08163239806890488, n:98.0
Epoch [5/20], Loss: -0.3564, acc_loss, -0.3564, bias_loss:0.0000
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.39162015914917, idi:13.932901382446289, p_hat:0.1421724557876587, n:98.0
Epoch [5/20], Loss: -0.3278, acc_loss, -0.3278, bias_loss:0.0000
-->start_index 588
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9536423841059603
-->z_score:2.087364912033081, idi:15.999156951904297, p_hat:0.1632567048072815, n:98.0
Epoch [5/20], Loss: -0.0864, acc_loss, -0.0864, bias_loss:0.0000
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9878048780487805
-->z_score:3.371859550476074, idi:19.81391143798828, p_hat:0.20218276977539062, n:98.0
Epoch [5/20], Loss: -0.4422, acc_loss, -0.4422, bias_loss:0.0000
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.6060916781425476, idi:8.0, p_hat:0.08163265138864517, n:98.0
Epoch [5/20], Loss: -0.4224, acc_loss, -0.4224, bias_loss:0.0000
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.7474346160888672, idi:14.989616394042969, p_hat:0.15295526385307312, n:98.0
Epoch [5/20], Loss: -0.3901, acc_loss, -0.3901, bias_loss:0.0000
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.36319416761398315, idi:10.878631591796875, p_hat:0.11100644618272781, n:98.0
Epoch [5/20], Loss: -0.2504, acc_loss, -0.2504, bias_loss:0.0000
-->start_index 1078
-->batch_size 98
-->ACC 1.0
-->F1 1.0
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [5/20], Loss: -0.4980, acc_loss, -0.4980, bias_loss:0.0000
-->start_index 1176
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.7177656888961792, idi:11.931654930114746, p_hat:0.1217515841126442, n:98.0
Epoch [5/20], Loss: -0.4477, acc_loss, -0.4477, bias_loss:0.0000
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9729729729729729
-->z_score:2.4243664741516113, idi:17.0, p_hat:0.1734693944454193, n:98.0
Epoch [5/20], Loss: -0.3663, acc_loss, -0.3663, bias_loss:0.0000
-->start_index 1372
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9659863945578231
-->z_score:0.9050255417823792, idi:12.487789154052734, p_hat:0.127426415681839, n:98.0
Epoch [5/20], Loss: -0.3810, acc_loss, -0.3810, bias_loss:0.0000
-->start_index 1470
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9722222222222222
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [5/20], Loss: -0.3637, acc_loss, -0.3637, bias_loss:0.0000
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:2.416616916656494, idi:16.976985931396484, p_hat:0.17323455214500427, n:98.0
Epoch [5/20], Loss: -0.3941, acc_loss, -0.3941, bias_loss:0.0000
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.4040599465370178, idi:10.99999713897705, p_hat:0.1122448667883873, n:98.0
Epoch [5/20], Loss: -0.2917, acc_loss, -0.2917, bias_loss:0.0000
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:1.552061676979065, idi:14.409388542175293, p_hat:0.14703457057476044, n:98.0
Epoch [5/20], Loss: -0.4271, acc_loss, -0.4271, bias_loss:0.0000
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.6782407760620117, idi:7.7857279777526855, p_hat:0.0794462040066719, n:98.0
Epoch [5/20], Loss: -0.5126, acc_loss, -0.5126, bias_loss:0.0000
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-0.6085806488990784, idi:2.0, p_hat:0.06666667014360428, n:30.0
Epoch [5/20], Loss: -0.5006, acc_loss, -0.5006, bias_loss:0.0000
-->after epoch 4
-->overall baseline on training dataset
-->ACC 0.98718633208756
-->F1 0.9928197456993268
-->FPR: 0.06411837237977805
-->FNR: 0.006585840443047448
-->overall baseline on testing dataset
-->ACC 0.9134226097788851
-->F1 0.9513475673783689
-->FPR: 0.44155844155844154
-->FNR: 0.03821656050955414
training dataset
-->original metric score:
-->individual metric:0.13862380713209443, num_idi:276, num_all:1991
-->individual metric 0.13862380713209443
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.986627043090639
-->F1 0.9922480620155039
-->FPR 0.043478260869565216
-->FNR 0.008605851979345954
-->positive probability:0.861812778603269, 580/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9716494845360825
-->F1 0.983206106870229
-->FPR 0.09836065573770492
-->FNR 0.01529051987767584
-->positive probability:0.845360824742268, 328/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.98
-->F1 0.988235294117647
-->FPR 0.0
-->FNR 0.023255813953488372
-->positive probability:0.84, 42/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9117647058823529
-->F1 0.9189189189189189
-->FPR 0.17647058823529413
-->FNR 0.0
-->positive probability:0.5882352941176471, 20/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9144385026737968
-->F1 0.9230769230769231
-->FPR 0.0963855421686747
-->FNR 0.07692307692307693
-->positive probability:0.5561497326203209, 104/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9594594594594594
-->F1 0.9696969696969697
-->FPR 0.049586776859504134
-->FNR 0.03614457831325301
-->positive probability:0.6648648648648648, 246/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9561797752808989
-->F1 0.9717595944967414
-->FPR 0.08163265306122448
-->FNR 0.03314121037463977
-->positive probability:0.7719101123595505, 687/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.020640111510212833, 0.03424228335792687, 0.016499324760730433, 0.06411837237977805, 0.11235221585551608, 0.032267169788896655, 0.014531595520273916, 0.017514280681446434]
-->fnr_diff [0.002020011536298507, 0.008704679434628392, 0.09341415955695256, 0.016669973510440923, 0.006585840443047448, 0.07033723648002949, 0.029558737870205562, 0.02655536993159232]
-->FPR:[0.043478260869565216, 0.09836065573770492, 0.047619047619047616, 0.0, 0.17647058823529413, 0.0963855421686747, 0.049586776859504134, 0.08163265306122448], mean FPR:0.0741916905688769, mean FPR diff:0.03902066923184766
-->FNR:[0.008605851979345954, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.07692307692307693, 0.03614457831325301, 0.03314121037463977], mean FNR:0.036670131427684986, mean FNR diff:0.0317307510953994
-->mean fnr diff metric 0.03902066923184766
testing dataset
-->original metric score:
-->individual metric:0.19739952718676124, num_idi:167, num_all:846
-->individual metric 0.19739952718676124
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8732876712328768
-->F1 0.9252525252525251
-->FPR 0.43478260869565216
-->FNR 0.06910569105691057
-->positive probability:0.8527397260273972, 249/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9044117647058822
-->FPR 0.37209302325581395
-->FNR 0.07518796992481203
-->positive probability:0.7897727272727273, 139/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7058823529411765
-->FPR 0.6
-->FNR 0.25
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7466666666666667
-->FPR 0.375
-->FNR 0.125
-->positive probability:0.5972222222222222, 43/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7579617834394905
-->F1 0.8080808080808081
-->FPR 0.390625
-->FNR 0.13978494623655913
-->positive probability:0.6687898089171974, 105/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8241469816272966
-->F1 0.8896210873146624
-->FPR 0.5
-->FNR 0.07849829351535836
-->positive probability:0.8241469816272966, 314/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.006775832862789377, 0.06946541830262759, 0.44155844155844154, 0.2251082251082251, 0.15844155844155844, 0.06655844155844154, 0.05093344155844154, 0.05844155844155846]
-->fnr_diff [0.030889130547356432, 0.03697140941525789, 0.07289455060155697, 0.03821656050955414, 0.21178343949044587, 0.08678343949044587, 0.101568385727005, 0.040281733005804225]
-->FPR:[0.43478260869565216, 0.37209302325581395, 0.0, 0.6666666666666666, 0.6, 0.375, 0.390625, 0.5], mean FPR:0.4173959123272666, mean FPR diff:0.13466036472901044
-->FNR:[0.06910569105691057, 0.07518796992481203, 0.1111111111111111, 0.0, 0.25, 0.125, 0.13978494623655913, 0.07849829351535836], mean FNR:0.10608600148059388, mean FNR diff:0.0774235810984283
-->mean fnr diff metric 0.13466036472901044
-->epoch 5
-->start_index 0
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9610389610389611
-->z_score:1.7509312629699707, idi:15.0, p_hat:0.15306122601032257, n:98.0
Epoch [6/20], Loss: -0.1710, acc_loss, -0.1710, bias_loss:0.0000
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:2.087557554244995, idi:15.999730110168457, p_hat:0.16326254606246948, n:98.0
Epoch [6/20], Loss: -0.4259, acc_loss, -0.4259, bias_loss:0.0000
-->start_index 196
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:2.087646722793579, idi:15.999994277954102, p_hat:0.16326524317264557, n:98.0
Epoch [6/20], Loss: -0.3330, acc_loss, -0.3330, bias_loss:0.0000
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:2.7610838413238525, idi:18.0, p_hat:0.18367347121238708, n:98.0
Epoch [6/20], Loss: -0.3097, acc_loss, -0.3097, bias_loss:0.0000
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:-0.6060919165611267, idi:7.999999046325684, p_hat:0.08163264393806458, n:98.0
Epoch [6/20], Loss: -0.3521, acc_loss, -0.3521, bias_loss:0.0000
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.2768763303756714, idi:13.592129707336426, p_hat:0.13869519531726837, n:98.0
Epoch [6/20], Loss: -0.3279, acc_loss, -0.3279, bias_loss:0.0000
-->start_index 588
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9536423841059603
-->z_score:2.08713436126709, idi:15.998472213745117, p_hat:0.16324971616268158, n:98.0
Epoch [6/20], Loss: -0.0944, acc_loss, -0.0944, bias_loss:0.0000
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9878048780487805
-->z_score:3.431173324584961, idi:19.99006462097168, p_hat:0.2039802521467209, n:98.0
Epoch [6/20], Loss: -0.4485, acc_loss, -0.4485, bias_loss:0.0000
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.6060916781425476, idi:8.0, p_hat:0.08163265138864517, n:98.0
Epoch [6/20], Loss: -0.4234, acc_loss, -0.4234, bias_loss:0.0000
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.7493646144866943, idi:14.995347023010254, p_hat:0.15301375091075897, n:98.0
Epoch [6/20], Loss: -0.3915, acc_loss, -0.3915, bias_loss:0.0000
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.3493443429470062, idi:10.837499618530273, p_hat:0.1105867326259613, n:98.0
Epoch [6/20], Loss: -0.2547, acc_loss, -0.2547, bias_loss:0.0000
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [6/20], Loss: -0.5027, acc_loss, -0.5027, bias_loss:0.0000
-->start_index 1176
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.5130661725997925, idi:11.323728561401367, p_hat:0.11554825305938721, n:98.0
Epoch [6/20], Loss: -0.4534, acc_loss, -0.4534, bias_loss:0.0000
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9729729729729729
-->z_score:2.424344778060913, idi:16.999937057495117, p_hat:0.17346873879432678, n:98.0
Epoch [6/20], Loss: -0.3747, acc_loss, -0.3747, bias_loss:0.0000
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [6/20], Loss: -0.3854, acc_loss, -0.3854, bias_loss:0.0000
-->start_index 1470
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9722222222222222
-->z_score:1.0665371417999268, idi:12.967453956604004, p_hat:0.13232095539569855, n:98.0
Epoch [6/20], Loss: -0.3663, acc_loss, -0.3663, bias_loss:0.0000
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:2.4027457237243652, idi:16.935791015625, p_hat:0.17281419038772583, n:98.0
Epoch [6/20], Loss: -0.3926, acc_loss, -0.3926, bias_loss:0.0000
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.40403464436531067, idi:10.999921798706055, p_hat:0.11224409937858582, n:98.0
Epoch [6/20], Loss: -0.2907, acc_loss, -0.2907, bias_loss:0.0000
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:1.299808382987976, idi:13.660233497619629, p_hat:0.13939014077186584, n:98.0
Epoch [6/20], Loss: -0.4302, acc_loss, -0.4302, bias_loss:0.0000
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.9428090453147888, idi:7.0, p_hat:0.0714285746216774, n:98.0
Epoch [6/20], Loss: -0.5115, acc_loss, -0.5115, bias_loss:0.0000
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-0.6085806488990784, idi:2.0, p_hat:0.06666667014360428, n:30.0
Epoch [6/20], Loss: -0.4978, acc_loss, -0.4978, bias_loss:0.0000
-->after epoch 5
-->overall baseline on training dataset
-->ACC 0.9873198077949813
-->F1 0.9928950714232292
-->FPR: 0.06411837237977805
-->FNR: 0.006436162251160006
-->overall baseline on testing dataset
-->ACC 0.9137340392401121
-->F1 0.951548014693021
-->FPR: 0.44415584415584414
-->FNR: 0.03750884642604388
training dataset
-->original metric score:
-->individual metric:0.13561024610748368, num_idi:270, num_all:1991
-->individual metric 0.13561024610748368
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.986627043090639
-->F1 0.9922480620155039
-->FPR 0.043478260869565216
-->FNR 0.008605851979345954
-->positive probability:0.861812778603269, 580/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9716494845360825
-->F1 0.983206106870229
-->FPR 0.09836065573770492
-->FNR 0.01529051987767584
-->positive probability:0.845360824742268, 328/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.98
-->F1 0.988235294117647
-->FPR 0.0
-->FNR 0.023255813953488372
-->positive probability:0.84, 42/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9117647058823529
-->F1 0.9189189189189189
-->FPR 0.17647058823529413
-->FNR 0.0
-->positive probability:0.5882352941176471, 20/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9144385026737968
-->F1 0.9230769230769231
-->FPR 0.0963855421686747
-->FNR 0.07692307692307693
-->positive probability:0.5561497326203209, 104/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9594594594594594
-->F1 0.9696969696969697
-->FPR 0.049586776859504134
-->FNR 0.03614457831325301
-->positive probability:0.6648648648648648, 246/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9573033707865168
-->F1 0.9725036179450072
-->FPR 0.08163265306122448
-->FNR 0.03170028818443804
-->positive probability:0.7730337078651686, 688/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.020640111510212833, 0.03424228335792687, 0.016499324760730433, 0.06411837237977805, 0.11235221585551608, 0.032267169788896655, 0.014531595520273916, 0.017514280681446434]
-->fnr_diff [0.002169689728185949, 0.008854357626515836, 0.09356383774884, 0.016819651702328367, 0.006436162251160006, 0.07048691467191692, 0.029708416062093006, 0.025264125933278037]
-->FPR:[0.043478260869565216, 0.09836065573770492, 0.047619047619047616, 0.0, 0.17647058823529413, 0.0963855421686747, 0.049586776859504134, 0.08163265306122448], mean FPR:0.0741916905688769, mean FPR diff:0.03902066923184766
-->FNR:[0.008605851979345954, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.07692307692307693, 0.03614457831325301, 0.03170028818443804], mean FNR:0.036490016153909774, mean FNR diff:0.03166289446553977
-->mean fnr diff metric 0.03902066923184766
testing dataset
-->original metric score:
-->individual metric:0.1950354609929078, num_idi:165, num_all:846
-->individual metric 0.1950354609929078
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8732876712328768
-->F1 0.9252525252525251
-->FPR 0.43478260869565216
-->FNR 0.06910569105691057
-->positive probability:0.8527397260273972, 249/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9044117647058822
-->FPR 0.37209302325581395
-->FNR 0.07518796992481203
-->positive probability:0.7897727272727273, 139/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7058823529411765
-->FPR 0.6
-->FNR 0.25
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7466666666666667
-->FPR 0.375
-->FNR 0.125
-->positive probability:0.5972222222222222, 43/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7515923566878981
-->F1 0.8040201005025127
-->FPR 0.40625
-->FNR 0.13978494623655913
-->positive probability:0.6751592356687898, 106/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8241469816272966
-->F1 0.8896210873146624
-->FPR 0.5
-->FNR 0.07849829351535836
-->positive probability:0.8241469816272966, 314/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.009373235460191975, 0.07206282090003019, 0.44415584415584414, 0.2225108225108225, 0.15584415584415584, 0.06915584415584414, 0.03790584415584414, 0.05584415584415586]
-->fnr_diff [0.03159684463086669, 0.03767912349876815, 0.07360226468506723, 0.03750884642604388, 0.21249115357395612, 0.08749115357395612, 0.10227609981051525, 0.040989447089314485]
-->FPR:[0.43478260869565216, 0.37209302325581395, 0.0, 0.6666666666666666, 0.6, 0.375, 0.40625, 0.5], mean FPR:0.4193490373272666, mean FPR diff:0.13335659037836112
-->FNR:[0.06910569105691057, 0.07518796992481203, 0.1111111111111111, 0.0, 0.25, 0.125, 0.13978494623655913, 0.07849829351535836], mean FNR:0.10608600148059388, mean FNR diff:0.07795436666106098
-->mean fnr diff metric 0.13335659037836112
-->epoch 6
-->start_index 0
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9610389610389611
-->z_score:1.7509312629699707, idi:15.0, p_hat:0.15306122601032257, n:98.0
Epoch [7/20], Loss: -0.1764, acc_loss, -0.1764, bias_loss:0.0000
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [7/20], Loss: -0.4279, acc_loss, -0.4279, bias_loss:0.0000
-->start_index 196
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:2.087648630142212, idi:15.999999046325684, p_hat:0.16326530277729034, n:98.0
Epoch [7/20], Loss: -0.3377, acc_loss, -0.3377, bias_loss:0.0000
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:2.7610838413238525, idi:18.0, p_hat:0.18367347121238708, n:98.0
Epoch [7/20], Loss: -0.3152, acc_loss, -0.3152, bias_loss:0.0000
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:-0.6115730404853821, idi:7.983720779418945, p_hat:0.08146654069423676, n:98.0
Epoch [7/20], Loss: -0.3527, acc_loss, -0.3527, bias_loss:0.0000
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.0774959325790405, idi:12.999999046325684, p_hat:0.13265305757522583, n:98.0
Epoch [7/20], Loss: -0.3295, acc_loss, -0.3295, bias_loss:0.0000
-->start_index 588
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9536423841059603
-->z_score:2.069185256958008, idi:15.945165634155273, p_hat:0.16270577907562256, n:98.0
Epoch [7/20], Loss: -0.0959, acc_loss, -0.0959, bias_loss:0.0000
-->start_index 686
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9815950920245398
-->z_score:3.0972437858581543, idi:18.99834442138672, p_hat:0.19386065006256104, n:98.0
Epoch [7/20], Loss: -0.4584, acc_loss, -0.4584, bias_loss:0.0000
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.6060916781425476, idi:8.0, p_hat:0.08163265138864517, n:98.0
Epoch [7/20], Loss: -0.4287, acc_loss, -0.4287, bias_loss:0.0000
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.7499070167541504, idi:14.996957778930664, p_hat:0.1530301868915558, n:98.0
Epoch [7/20], Loss: -0.4009, acc_loss, -0.4009, bias_loss:0.0000
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.05327516794204712, idi:9.958219528198242, p_hat:0.10161448270082474, n:98.0
Epoch [7/20], Loss: -0.2589, acc_loss, -0.2589, bias_loss:0.0000
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [7/20], Loss: -0.5076, acc_loss, -0.5076, bias_loss:0.0000
-->start_index 1176
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [7/20], Loss: -0.4579, acc_loss, -0.4579, bias_loss:0.0000
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9729729729729729
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [7/20], Loss: -0.3782, acc_loss, -0.3782, bias_loss:0.0000
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [7/20], Loss: -0.3887, acc_loss, -0.3887, bias_loss:0.0000
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:1.736393690109253, idi:14.956826210021973, p_hat:0.15262067317962646, n:98.0
Epoch [7/20], Loss: -0.3689, acc_loss, -0.3689, bias_loss:0.0000
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:2.39274001121521, idi:16.90607452392578, p_hat:0.17251096665859222, n:98.0
Epoch [7/20], Loss: -0.3930, acc_loss, -0.3930, bias_loss:0.0000
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.06731997430324554, idi:9.999930381774902, p_hat:0.10204010456800461, n:98.0
Epoch [7/20], Loss: -0.3067, acc_loss, -0.3067, bias_loss:0.0000
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:1.3345558643341064, idi:13.763427734375, p_hat:0.14044314622879028, n:98.0
Epoch [7/20], Loss: -0.4335, acc_loss, -0.4335, bias_loss:0.0000
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.9428090453147888, idi:7.0, p_hat:0.0714285746216774, n:98.0
Epoch [7/20], Loss: -0.5099, acc_loss, -0.5099, bias_loss:0.0000
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-0.6085806488990784, idi:2.0, p_hat:0.06666667014360428, n:30.0
Epoch [7/20], Loss: -0.4962, acc_loss, -0.4962, bias_loss:0.0000
-->after epoch 6
-->overall baseline on training dataset
-->ACC 0.9873198077949813
-->F1 0.9928950714232292
-->FPR: 0.06411837237977805
-->FNR: 0.006436162251160006
-->overall baseline on testing dataset
-->ACC 0.9137340392401121
-->F1 0.9515140906704007
-->FPR: 0.43896103896103894
-->FNR: 0.03821656050955414
training dataset
-->original metric score:
-->individual metric:0.13561024610748368, num_idi:270, num_all:1991
-->individual metric 0.13561024610748368
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.986627043090639
-->F1 0.9922480620155039
-->FPR 0.043478260869565216
-->FNR 0.008605851979345954
-->positive probability:0.861812778603269, 580/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9716494845360825
-->F1 0.983206106870229
-->FPR 0.09836065573770492
-->FNR 0.01529051987767584
-->positive probability:0.845360824742268, 328/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.96
-->F1 0.9767441860465116
-->FPR 0.14285714285714285
-->FNR 0.023255813953488372
-->positive probability:0.86, 43/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9117647058823529
-->F1 0.9189189189189189
-->FPR 0.17647058823529413
-->FNR 0.0
-->positive probability:0.5882352941176471, 20/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9144385026737968
-->F1 0.9230769230769231
-->FPR 0.0963855421686747
-->FNR 0.07692307692307693
-->positive probability:0.5561497326203209, 104/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9594594594594594
-->F1 0.9696969696969697
-->FPR 0.049586776859504134
-->FNR 0.03614457831325301
-->positive probability:0.6648648648648648, 246/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9561797752808989
-->F1 0.9717595944967414
-->FPR 0.08163265306122448
-->FNR 0.03314121037463977
-->positive probability:0.7719101123595505, 687/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.020640111510212833, 0.03424228335792687, 0.016499324760730433, 0.0787387704773648, 0.11235221585551608, 0.032267169788896655, 0.014531595520273916, 0.017514280681446434]
-->fnr_diff [0.002169689728185949, 0.008854357626515836, 0.09356383774884, 0.016819651702328367, 0.006436162251160006, 0.07048691467191692, 0.029708416062093006, 0.026705048123479763]
-->FPR:[0.043478260869565216, 0.09836065573770492, 0.047619047619047616, 0.14285714285714285, 0.17647058823529413, 0.0963855421686747, 0.049586776859504134, 0.08163265306122448], mean FPR:0.09204883342601974, mean FPR diff:0.040848218994046004
-->FNR:[0.008605851979345954, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.07692307692307693, 0.03614457831325301, 0.03314121037463977], mean FNR:0.036670131427684986, mean FNR diff:0.03184300973931498
-->mean fnr diff metric 0.040848218994046004
testing dataset
-->original metric score:
-->individual metric:0.1950354609929078, num_idi:165, num_all:846
-->individual metric 0.1950354609929078
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8698630136986302
-->F1 0.9233870967741935
-->FPR 0.45652173913043476
-->FNR 0.06910569105691057
-->positive probability:0.8561643835616438, 250/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9044117647058822
-->FPR 0.37209302325581395
-->FNR 0.07518796992481203
-->positive probability:0.7897727272727273, 139/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7058823529411765
-->FPR 0.6
-->FNR 0.25
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7466666666666667
-->FPR 0.375
-->FNR 0.125
-->positive probability:0.5972222222222222, 43/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7388535031847133
-->F1 0.7918781725888324
-->FPR 0.40625
-->FNR 0.16129032258064516
-->positive probability:0.6624203821656051, 104/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.821522309711286
-->F1 0.8877887788778878
-->FPR 0.5
-->FNR 0.08191126279863481
-->positive probability:0.821522309711286, 313/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.017560700169395815, 0.06686801570522499, 0.43896103896103894, 0.2277056277056277, 0.16103896103896104, 0.06396103896103894, 0.03271103896103894, 0.06103896103896106]
-->fnr_diff [0.030889130547356432, 0.03697140941525789, 0.07289455060155697, 0.03821656050955414, 0.21178343949044587, 0.08678343949044587, 0.12307376207109103, 0.04369470228908067]
-->FPR:[0.45652173913043476, 0.37209302325581395, 0.0, 0.6666666666666666, 0.6, 0.375, 0.40625, 0.5], mean FPR:0.4220664286316144, mean FPR diff:0.13373067281766093
-->FNR:[0.06910569105691057, 0.07518796992481203, 0.1111111111111111, 0.0, 0.25, 0.125, 0.16129032258064516, 0.08191126279863481], mean FNR:0.1092007946840142, mean FNR diff:0.0805383743018486
-->mean fnr diff metric 0.13373067281766093
-->epoch 7
-->start_index 0
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9610389610389611
-->z_score:1.7509312629699707, idi:15.0, p_hat:0.15306122601032257, n:98.0
Epoch [8/20], Loss: -0.1850, acc_loss, -0.1850, bias_loss:0.0000
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [8/20], Loss: -0.4309, acc_loss, -0.4309, bias_loss:0.0000
-->start_index 196
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:2.3734869956970215, idi:16.848896026611328, p_hat:0.17192751169204712, n:98.0
Epoch [8/20], Loss: -0.3420, acc_loss, -0.3420, bias_loss:0.0000
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:2.7610838413238525, idi:18.0, p_hat:0.18367347121238708, n:98.0
Epoch [8/20], Loss: -0.3190, acc_loss, -0.3190, bias_loss:0.0000
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:-0.942809522151947, idi:6.999999046325684, p_hat:0.0714285597205162, n:98.0
Epoch [8/20], Loss: -0.3505, acc_loss, -0.3505, bias_loss:0.0000
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [8/20], Loss: -0.3292, acc_loss, -0.3292, bias_loss:0.0000
-->start_index 588
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9605263157894737
-->z_score:1.4142138957977295, idi:14.0, p_hat:0.1428571492433548, n:98.0
Epoch [8/20], Loss: -0.0979, acc_loss, -0.0979, bias_loss:0.0000
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9876543209876543
-->z_score:2.761051893234253, idi:17.99990463256836, p_hat:0.18367250263690948, n:98.0
Epoch [8/20], Loss: -0.4648, acc_loss, -0.4648, bias_loss:0.0000
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.30067676305770874, idi:8.907035827636719, p_hat:0.0908881202340126, n:98.0
Epoch [8/20], Loss: -0.4308, acc_loss, -0.4308, bias_loss:0.0000
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.7506976127624512, idi:14.999306678771973, p_hat:0.1530541479587555, n:98.0
Epoch [8/20], Loss: -0.4046, acc_loss, -0.4046, bias_loss:0.0000
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.3992414176464081, idi:10.985686302185059, p_hat:0.11209884285926819, n:98.0
Epoch [8/20], Loss: -0.2622, acc_loss, -0.2622, bias_loss:0.0000
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [8/20], Loss: -0.5097, acc_loss, -0.5097, bias_loss:0.0000
-->start_index 1176
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [8/20], Loss: -0.4612, acc_loss, -0.4612, bias_loss:0.0000
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9729729729729729
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [8/20], Loss: -0.3818, acc_loss, -0.3818, bias_loss:0.0000
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [8/20], Loss: -0.3928, acc_loss, -0.3928, bias_loss:0.0000
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:1.7509273290634155, idi:14.999988555908203, p_hat:0.15306110680103302, n:98.0
Epoch [8/20], Loss: -0.3721, acc_loss, -0.3721, bias_loss:0.0000
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:2.0352723598480225, idi:15.844449996948242, p_hat:0.16167806088924408, n:98.0
Epoch [8/20], Loss: -0.3928, acc_loss, -0.3928, bias_loss:0.0000
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.06709010154008865, idi:9.999247550964355, p_hat:0.10203313827514648, n:98.0
Epoch [8/20], Loss: -0.3055, acc_loss, -0.3055, bias_loss:0.0000
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:1.1044211387634277, idi:13.079963684082031, p_hat:0.13346901535987854, n:98.0
Epoch [8/20], Loss: -0.4356, acc_loss, -0.4356, bias_loss:0.0000
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.9428090453147888, idi:7.0, p_hat:0.0714285746216774, n:98.0
Epoch [8/20], Loss: -0.5100, acc_loss, -0.5100, bias_loss:0.0000
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-0.6085806488990784, idi:2.0, p_hat:0.06666667014360428, n:30.0
Epoch [8/20], Loss: -0.4930, acc_loss, -0.4930, bias_loss:0.0000
-->after epoch 7
-->overall baseline on training dataset
-->ACC 0.9874532835024026
-->F1 0.9929703858809452
-->FPR: 0.06411837237977805
-->FNR: 0.006286484059272564
-->overall baseline on testing dataset
-->ACC 0.9140454687013392
-->F1 0.9516975848792439
-->FPR: 0.43896103896103894
-->FNR: 0.03786270346779901
training dataset
-->original metric score:
-->individual metric:0.1341034655951783, num_idi:267, num_all:1991
-->individual metric 0.1341034655951783
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.986627043090639
-->F1 0.9922480620155039
-->FPR 0.043478260869565216
-->FNR 0.008605851979345954
-->positive probability:0.861812778603269, 580/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9716494845360825
-->F1 0.983206106870229
-->FPR 0.09836065573770492
-->FNR 0.01529051987767584
-->positive probability:0.845360824742268, 328/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.96
-->F1 0.9767441860465116
-->FPR 0.14285714285714285
-->FNR 0.023255813953488372
-->positive probability:0.86, 43/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9117647058823529
-->F1 0.9189189189189189
-->FPR 0.17647058823529413
-->FNR 0.0
-->positive probability:0.5882352941176471, 20/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9197860962566845
-->F1 0.9282296650717704
-->FPR 0.0963855421686747
-->FNR 0.0673076923076923
-->positive probability:0.5614973262032086, 105/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9621621621621622
-->F1 0.9717741935483871
-->FPR 0.049586776859504134
-->FNR 0.0321285140562249
-->positive probability:0.6675675675675675, 247/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9561797752808989
-->F1 0.9717595944967414
-->FPR 0.08163265306122448
-->FNR 0.03314121037463977
-->positive probability:0.7719101123595505, 687/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.020640111510212833, 0.03424228335792687, 0.016499324760730433, 0.0787387704773648, 0.11235221585551608, 0.032267169788896655, 0.014531595520273916, 0.017514280681446434]
-->fnr_diff [0.002319367920073391, 0.009004035818403276, 0.09371351594072744, 0.016969329894215807, 0.006286484059272564, 0.061021208248419744, 0.025842029996952332, 0.026854726315367203]
-->FPR:[0.043478260869565216, 0.09836065573770492, 0.047619047619047616, 0.14285714285714285, 0.17647058823529413, 0.0963855421686747, 0.049586776859504134, 0.08163265306122448], mean FPR:0.09204883342601974, mean FPR diff:0.040848218994046004
-->FNR:[0.008605851979345954, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.0321285140562249, 0.03314121037463977], mean FNR:0.03496620031863339, mean FNR diff:0.030251337274178967
-->mean fnr diff metric 0.040848218994046004
testing dataset
-->original metric score:
-->individual metric:0.1938534278959811, num_idi:164, num_all:846
-->individual metric 0.1938534278959811
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8698630136986302
-->F1 0.9233870967741935
-->FPR 0.45652173913043476
-->FNR 0.06910569105691057
-->positive probability:0.8561643835616438, 250/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9044117647058822
-->FPR 0.37209302325581395
-->FNR 0.07518796992481203
-->positive probability:0.7897727272727273, 139/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7058823529411765
-->FPR 0.6
-->FNR 0.25
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7466666666666667
-->FPR 0.375
-->FNR 0.125
-->positive probability:0.5972222222222222, 43/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7452229299363057
-->F1 0.7979797979797979
-->FPR 0.40625
-->FNR 0.15053763440860216
-->positive probability:0.6687898089171974, 105/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8241469816272966
-->F1 0.8896210873146624
-->FPR 0.5
-->FNR 0.07849829351535836
-->positive probability:0.8241469816272966, 314/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.017560700169395815, 0.06686801570522499, 0.43896103896103894, 0.2277056277056277, 0.16103896103896104, 0.06396103896103894, 0.03271103896103894, 0.06103896103896106]
-->fnr_diff [0.031242987589111558, 0.037325266457013014, 0.07324840764331209, 0.03786270346779901, 0.21213729653220098, 0.08713729653220098, 0.11267493094080314, 0.04063559004755935]
-->FPR:[0.45652173913043476, 0.37209302325581395, 0.0, 0.6666666666666666, 0.6, 0.375, 0.40625, 0.5], mean FPR:0.4220664286316144, mean FPR diff:0.13373067281766093
-->FNR:[0.06910569105691057, 0.07518796992481203, 0.1111111111111111, 0.0, 0.25, 0.125, 0.15053763440860216, 0.07849829351535836], mean FNR:0.10743008750209929, mean FNR diff:0.07903305990125002
-->mean fnr diff metric 0.13373067281766093
-->epoch 8
-->start_index 0
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9610389610389611
-->z_score:1.7509312629699707, idi:15.0, p_hat:0.15306122601032257, n:98.0
Epoch [9/20], Loss: -0.1885, acc_loss, -0.1885, bias_loss:0.0000
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [9/20], Loss: -0.4304, acc_loss, -0.4304, bias_loss:0.0000
-->start_index 196
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:2.3616814613342285, idi:16.81383514404297, p_hat:0.17156974971294403, n:98.0
Epoch [9/20], Loss: -0.3442, acc_loss, -0.3442, bias_loss:0.0000
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:2.760310411453247, idi:17.997703552246094, p_hat:0.18365003168582916, n:98.0
Epoch [9/20], Loss: -0.3227, acc_loss, -0.3227, bias_loss:0.0000
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:-0.9428125023841858, idi:6.999989986419678, p_hat:0.07142847031354904, n:98.0
Epoch [9/20], Loss: -0.3506, acc_loss, -0.3506, bias_loss:0.0000
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [9/20], Loss: -0.3294, acc_loss, -0.3294, bias_loss:0.0000
-->start_index 588
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9673202614379085
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [9/20], Loss: -0.0966, acc_loss, -0.0966, bias_loss:0.0000
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9876543209876543
-->z_score:2.7610435485839844, idi:17.999879837036133, p_hat:0.1836722493171692, n:98.0
Epoch [9/20], Loss: -0.4729, acc_loss, -0.4729, bias_loss:0.0000
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.2696014642715454, idi:8.999324798583984, p_hat:0.09182984381914139, n:98.0
Epoch [9/20], Loss: -0.4343, acc_loss, -0.4343, bias_loss:0.0000
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.7507026195526123, idi:14.999320983886719, p_hat:0.15305429697036743, n:98.0
Epoch [9/20], Loss: -0.4118, acc_loss, -0.4118, bias_loss:0.0000
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.3998735249042511, idi:10.987564086914062, p_hat:0.11211799830198288, n:98.0
Epoch [9/20], Loss: -0.2661, acc_loss, -0.2661, bias_loss:0.0000
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [9/20], Loss: -0.5150, acc_loss, -0.5150, bias_loss:0.0000
-->start_index 1176
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [9/20], Loss: -0.4662, acc_loss, -0.4662, bias_loss:0.0000
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9729729729729729
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [9/20], Loss: -0.3856, acc_loss, -0.3856, bias_loss:0.0000
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [9/20], Loss: -0.3968, acc_loss, -0.3968, bias_loss:0.0000
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:1.7509312629699707, idi:15.0, p_hat:0.15306122601032257, n:98.0
Epoch [9/20], Loss: -0.3744, acc_loss, -0.3744, bias_loss:0.0000
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:2.0349791049957275, idi:15.843579292297363, p_hat:0.16166917979717255, n:98.0
Epoch [9/20], Loss: -0.3931, acc_loss, -0.3931, bias_loss:0.0000
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.06656888127326965, idi:9.997699737548828, p_hat:0.102017343044281, n:98.0
Epoch [9/20], Loss: -0.3161, acc_loss, -0.3161, bias_loss:0.0000
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:1.233253002166748, idi:13.462574005126953, p_hat:0.1373732089996338, n:98.0
Epoch [9/20], Loss: -0.4378, acc_loss, -0.4378, bias_loss:0.0000
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.9428090453147888, idi:7.0, p_hat:0.0714285746216774, n:98.0
Epoch [9/20], Loss: -0.5086, acc_loss, -0.5086, bias_loss:0.0000
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-0.6087154746055603, idi:1.9997785091400146, p_hat:0.06665928661823273, n:30.0
Epoch [9/20], Loss: -0.4901, acc_loss, -0.4901, bias_loss:0.0000
-->after epoch 8
-->overall baseline on training dataset
-->ACC 0.9875867592098239
-->F1 0.993045689075002
-->FPR: 0.06411837237977805
-->FNR: 0.006136805867385122
-->overall baseline on testing dataset
-->ACC 0.9134226097788851
-->F1 0.9513645906228131
-->FPR: 0.44415584415584414
-->FNR: 0.03786270346779901
training dataset
-->original metric score:
-->individual metric:0.1341034655951783, num_idi:267, num_all:1991
-->individual metric 0.1341034655951783
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.986627043090639
-->F1 0.9922480620155039
-->FPR 0.043478260869565216
-->FNR 0.008605851979345954
-->positive probability:0.861812778603269, 580/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9742268041237113
-->F1 0.9847094801223242
-->FPR 0.08196721311475409
-->FNR 0.01529051987767584
-->positive probability:0.8427835051546392, 327/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.96
-->F1 0.9767441860465116
-->FPR 0.14285714285714285
-->FNR 0.023255813953488372
-->positive probability:0.86, 43/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9411764705882353
-->F1 0.9444444444444444
-->FPR 0.11764705882352941
-->FNR 0.0
-->positive probability:0.5588235294117647, 19/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9197860962566845
-->F1 0.9282296650717704
-->FPR 0.0963855421686747
-->FNR 0.0673076923076923
-->positive probability:0.5614973262032086, 105/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9621621621621622
-->F1 0.9717741935483871
-->FPR 0.049586776859504134
-->FNR 0.0321285140562249
-->positive probability:0.6675675675675675, 247/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9573033707865168
-->F1 0.972463768115942
-->FPR 0.07653061224489796
-->FNR 0.03314121037463977
-->positive probability:0.7707865168539326, 686/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.020640111510212833, 0.017848840734976043, 0.016499324760730433, 0.0787387704773648, 0.05352868644375136, 0.032267169788896655, 0.014531595520273916, 0.012412239865119912]
-->fnr_diff [0.002469046111960833, 0.00915371401029072, 0.09386319413261489, 0.01711900808610325, 0.006136805867385122, 0.06117088644030718, 0.025991708188839776, 0.027004404507254647]
-->FPR:[0.043478260869565216, 0.08196721311475409, 0.047619047619047616, 0.14285714285714285, 0.11764705882352941, 0.0963855421686747, 0.049586776859504134, 0.07653061224489796], mean FPR:0.08200895681963949, mean FPR diff:0.030808342387665746
-->FNR:[0.008605851979345954, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.0321285140562249, 0.03314121037463977], mean FNR:0.03496620031863339, mean FNR diff:0.030363595918094552
-->mean fnr diff metric 0.030808342387665746
testing dataset
-->original metric score:
-->individual metric:0.1938534278959811, num_idi:164, num_all:846
-->individual metric 0.1938534278959811
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8698630136986302
-->F1 0.9233870967741935
-->FPR 0.45652173913043476
-->FNR 0.06910569105691057
-->positive probability:0.8561643835616438, 250/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9044117647058822
-->FPR 0.37209302325581395
-->FNR 0.07518796992481203
-->positive probability:0.7897727272727273, 139/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7058823529411765
-->FPR 0.6
-->FNR 0.25
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7466666666666667
-->FPR 0.375
-->FNR 0.125
-->positive probability:0.5972222222222222, 43/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7388535031847133
-->F1 0.7918781725888324
-->FPR 0.40625
-->FNR 0.16129032258064516
-->positive probability:0.6624203821656051, 104/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.821522309711286
-->F1 0.8877887788778878
-->FPR 0.5
-->FNR 0.08191126279863481
-->positive probability:0.821522309711286, 313/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.012365894974590619, 0.07206282090003019, 0.44415584415584414, 0.2225108225108225, 0.15584415584415584, 0.06915584415584414, 0.03790584415584414, 0.05584415584415586]
-->fnr_diff [0.031242987589111558, 0.037325266457013014, 0.07324840764331209, 0.03786270346779901, 0.21213729653220098, 0.08713729653220098, 0.12342761911284614, 0.0440485593308358]
-->FPR:[0.45652173913043476, 0.37209302325581395, 0.0, 0.6666666666666666, 0.6, 0.375, 0.40625, 0.5], mean FPR:0.4220664286316144, mean FPR diff:0.13373067281766093
-->FNR:[0.06910569105691057, 0.07518796992481203, 0.1111111111111111, 0.0, 0.25, 0.125, 0.16129032258064516, 0.08191126279863481], mean FNR:0.1092007946840142, mean FNR diff:0.08080376708316495
-->mean fnr diff metric 0.13373067281766093
-->epoch 9
-->start_index 0
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9610389610389611
-->z_score:1.750928282737732, idi:14.999991416931152, p_hat:0.1530611366033554, n:98.0
Epoch [10/20], Loss: -0.1977, acc_loss, -0.1977, bias_loss:0.0000
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [10/20], Loss: -0.4310, acc_loss, -0.4310, bias_loss:0.0000
-->start_index 196
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9811320754716981
-->z_score:2.4215052127838135, idi:16.99150276184082, p_hat:0.1733826845884323, n:98.0
Epoch [10/20], Loss: -0.3483, acc_loss, -0.3483, bias_loss:0.0000
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:2.716387987136841, idi:17.867259979248047, p_hat:0.18231898546218872, n:98.0
Epoch [10/20], Loss: -0.3273, acc_loss, -0.3273, bias_loss:0.0000
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:-0.94281005859375, idi:6.999997138977051, p_hat:0.07142854481935501, n:98.0
Epoch [10/20], Loss: -0.3501, acc_loss, -0.3501, bias_loss:0.0000
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [10/20], Loss: -0.3294, acc_loss, -0.3294, bias_loss:0.0000
-->start_index 588
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9673202614379085
-->z_score:1.299493670463562, idi:13.659299850463867, p_hat:0.13938060402870178, n:98.0
Epoch [10/20], Loss: -0.0993, acc_loss, -0.0993, bias_loss:0.0000
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9876543209876543
-->z_score:2.7610690593719482, idi:17.999956130981445, p_hat:0.18367302417755127, n:98.0
Epoch [10/20], Loss: -0.4767, acc_loss, -0.4767, bias_loss:0.0000
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.2694568932056427, idi:8.999753952026367, p_hat:0.09183422476053238, n:98.0
Epoch [10/20], Loss: -0.4357, acc_loss, -0.4357, bias_loss:0.0000
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.871801733970642, idi:15.358966827392578, p_hat:0.15672415494918823, n:98.0
Epoch [10/20], Loss: -0.4141, acc_loss, -0.4141, bias_loss:0.0000
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.40294548869132996, idi:10.996686935424805, p_hat:0.11221109330654144, n:98.0
Epoch [10/20], Loss: -0.2683, acc_loss, -0.2683, bias_loss:0.0000
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [10/20], Loss: -0.5174, acc_loss, -0.5174, bias_loss:0.0000
-->start_index 1176
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [10/20], Loss: -0.4696, acc_loss, -0.4696, bias_loss:0.0000
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9729729729729729
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [10/20], Loss: -0.3890, acc_loss, -0.3890, bias_loss:0.0000
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [10/20], Loss: -0.4003, acc_loss, -0.4003, bias_loss:0.0000
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:1.7509312629699707, idi:15.0, p_hat:0.15306122601032257, n:98.0
Epoch [10/20], Loss: -0.3756, acc_loss, -0.3756, bias_loss:0.0000
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.9906482696533203, idi:15.711923599243164, p_hat:0.16032575070858002, n:98.0
Epoch [10/20], Loss: -0.3937, acc_loss, -0.3937, bias_loss:0.0000
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.06615952402353287, idi:9.99648380279541, p_hat:0.10200493782758713, n:98.0
Epoch [10/20], Loss: -0.3144, acc_loss, -0.3144, bias_loss:0.0000
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:1.1052817106246948, idi:13.082518577575684, p_hat:0.13349509239196777, n:98.0
Epoch [10/20], Loss: -0.4405, acc_loss, -0.4405, bias_loss:0.0000
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.9428090453147888, idi:7.0, p_hat:0.0714285746216774, n:98.0
Epoch [10/20], Loss: -0.5096, acc_loss, -0.5096, bias_loss:0.0000
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [10/20], Loss: -0.4888, acc_loss, -0.4888, bias_loss:0.0000
-->after epoch 9
-->overall baseline on training dataset
-->ACC 0.987720234917245
-->F1 0.9931209810079259
-->FPR: 0.06411837237977805
-->FNR: 0.00598712767549768
-->overall baseline on testing dataset
-->ACC 0.913111180317658
-->F1 0.9511981808640897
-->FPR: 0.44675324675324674
-->FNR: 0.03786270346779901
training dataset
-->original metric score:
-->individual metric:0.13360120542440984, num_idi:266, num_all:1991
-->individual metric 0.13360120542440984
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.9881129271916791
-->F1 0.9931153184165232
-->FPR 0.043478260869565216
-->FNR 0.0068846815834767644
-->positive probability:0.8632986627043091, 581/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9742268041237113
-->F1 0.9847094801223242
-->FPR 0.08196721311475409
-->FNR 0.01529051987767584
-->positive probability:0.8427835051546392, 327/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.96
-->F1 0.9767441860465116
-->FPR 0.14285714285714285
-->FNR 0.023255813953488372
-->positive probability:0.86, 43/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9411764705882353
-->F1 0.9444444444444444
-->FPR 0.11764705882352941
-->FNR 0.0
-->positive probability:0.5588235294117647, 19/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9197860962566845
-->F1 0.9282296650717704
-->FPR 0.0963855421686747
-->FNR 0.0673076923076923
-->positive probability:0.5614973262032086, 105/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9621621621621622
-->F1 0.9717741935483871
-->FPR 0.049586776859504134
-->FNR 0.0321285140562249
-->positive probability:0.6675675675675675, 247/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9584269662921349
-->F1 0.9732078204199855
-->FPR 0.07653061224489796
-->FNR 0.03170028818443804
-->positive probability:0.7719101123595505, 687/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.020640111510212833, 0.017848840734976043, 0.016499324760730433, 0.0787387704773648, 0.05352868644375136, 0.032267169788896655, 0.014531595520273916, 0.012412239865119912]
-->fnr_diff [0.0008975539079790849, 0.00930339220217816, 0.09401287232450233, 0.01726868627799069, 0.00598712767549768, 0.061320564632194624, 0.026141386380727216, 0.02571316050894036]
-->FPR:[0.043478260869565216, 0.08196721311475409, 0.047619047619047616, 0.14285714285714285, 0.11764705882352941, 0.0963855421686747, 0.049586776859504134, 0.07653061224489796], mean FPR:0.08200895681963949, mean FPR diff:0.030808342387665746
-->FNR:[0.0068846815834767644, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.0321285140562249, 0.03170028818443804], mean FNR:0.03457093874537453, mean FNR diff:0.030080592988751268
-->mean fnr diff metric 0.030808342387665746
testing dataset
-->original metric score:
-->individual metric:0.1938534278959811, num_idi:164, num_all:846
-->individual metric 0.1938534278959811
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8698630136986302
-->F1 0.9233870967741935
-->FPR 0.45652173913043476
-->FNR 0.06910569105691057
-->positive probability:0.8561643835616438, 250/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9044117647058822
-->FPR 0.37209302325581395
-->FNR 0.07518796992481203
-->positive probability:0.7897727272727273, 139/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7058823529411765
-->FPR 0.6
-->FNR 0.25
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7466666666666667
-->FPR 0.375
-->FNR 0.125
-->positive probability:0.5972222222222222, 43/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.732484076433121
-->F1 0.787878787878788
-->FPR 0.421875
-->FNR 0.16129032258064516
-->positive probability:0.6687898089171974, 105/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8188976377952756
-->F1 0.8863261943986821
-->FPR 0.5113636363636364
-->FNR 0.08191126279863481
-->positive probability:0.8241469816272966, 314/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.00976849237718802, 0.07466022349743279, 0.44675324675324674, 0.2199134199134199, 0.15324675324675324, 0.07175324675324674, 0.024878246753246736, 0.06461038961038962]
-->fnr_diff [0.031242987589111558, 0.037325266457013014, 0.07324840764331209, 0.03786270346779901, 0.21213729653220098, 0.08713729653220098, 0.12342761911284614, 0.0440485593308358]
-->FPR:[0.45652173913043476, 0.37209302325581395, 0.0, 0.6666666666666666, 0.6, 0.375, 0.421875, 0.5113636363636364], mean FPR:0.42544000817706895, mean FPR diff:0.13319800236311546
-->FNR:[0.06910569105691057, 0.07518796992481203, 0.1111111111111111, 0.0, 0.25, 0.125, 0.16129032258064516, 0.08191126279863481], mean FNR:0.1092007946840142, mean FNR diff:0.08080376708316495
-->mean fnr diff metric 0.13319800236311546
-->epoch 10
-->start_index 0
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9610389610389611
-->z_score:1.7479474544525146, idi:14.99113941192627, p_hat:0.1529708057641983, n:98.0
Epoch [11/20], Loss: -0.1993, acc_loss, -0.1993, bias_loss:0.0000
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [11/20], Loss: -0.4311, acc_loss, -0.4311, bias_loss:0.0000
-->start_index 196
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9811320754716981
-->z_score:2.419992685317993, idi:16.987010955810547, p_hat:0.17333684861660004, n:98.0
Epoch [11/20], Loss: -0.3499, acc_loss, -0.3499, bias_loss:0.0000
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:2.424258232116699, idi:16.999679565429688, p_hat:0.17346611618995667, n:98.0
Epoch [11/20], Loss: -0.3315, acc_loss, -0.3315, bias_loss:0.0000
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:-0.9428169131278992, idi:6.999977111816406, p_hat:0.0714283362030983, n:98.0
Epoch [11/20], Loss: -0.3509, acc_loss, -0.3509, bias_loss:0.0000
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [11/20], Loss: -0.3299, acc_loss, -0.3299, bias_loss:0.0000
-->start_index 588
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9673202614379085
-->z_score:1.2296963930130005, idi:13.452012062072754, p_hat:0.1372654289007187, n:98.0
Epoch [11/20], Loss: -0.0994, acc_loss, -0.0994, bias_loss:0.0000
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9876543209876543
-->z_score:2.7610480785369873, idi:17.999893188476562, p_hat:0.18367238342761993, n:98.0
Epoch [11/20], Loss: -0.4810, acc_loss, -0.4810, bias_loss:0.0000
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.3472149670124054, idi:8.768824577331543, p_hat:0.08947779983282089, n:98.0
Epoch [11/20], Loss: -0.4382, acc_loss, -0.4382, bias_loss:0.0000
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.8255791664123535, idi:15.221693992614746, p_hat:0.15532340109348297, n:98.0
Epoch [11/20], Loss: -0.4187, acc_loss, -0.4187, bias_loss:0.0000
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.40151289105415344, idi:10.992432594299316, p_hat:0.11216767877340317, n:98.0
Epoch [11/20], Loss: -0.2728, acc_loss, -0.2728, bias_loss:0.0000
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [11/20], Loss: -0.5209, acc_loss, -0.5209, bias_loss:0.0000
-->start_index 1176
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [11/20], Loss: -0.4737, acc_loss, -0.4737, bias_loss:0.0000
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9729729729729729
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [11/20], Loss: -0.3922, acc_loss, -0.3922, bias_loss:0.0000
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [11/20], Loss: -0.4038, acc_loss, -0.4038, bias_loss:0.0000
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:1.7509312629699707, idi:15.0, p_hat:0.15306122601032257, n:98.0
Epoch [11/20], Loss: -0.3767, acc_loss, -0.3767, bias_loss:0.0000
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.9187332391738892, idi:15.498346328735352, p_hat:0.15814639627933502, n:98.0
Epoch [11/20], Loss: -0.3949, acc_loss, -0.3949, bias_loss:0.0000
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.06631367653608322, idi:9.996941566467285, p_hat:0.1020096093416214, n:98.0
Epoch [11/20], Loss: -0.3211, acc_loss, -0.3211, bias_loss:0.0000
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:1.0785285234451294, idi:13.003066062927246, p_hat:0.1326843500137329, n:98.0
Epoch [11/20], Loss: -0.4428, acc_loss, -0.4428, bias_loss:0.0000
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.9428090453147888, idi:7.0, p_hat:0.0714285746216774, n:98.0
Epoch [11/20], Loss: -0.5091, acc_loss, -0.5091, bias_loss:0.0000
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [11/20], Loss: -0.4875, acc_loss, -0.4875, bias_loss:0.0000
-->after epoch 10
-->overall baseline on training dataset
-->ACC 0.9878537106246663
-->F1 0.9931952441486578
-->FPR: 0.06288532675709001
-->FNR: 0.00598712767549768
-->overall baseline on testing dataset
-->ACC 0.913111180317658
-->F1 0.9511981808640897
-->FPR: 0.44675324675324674
-->FNR: 0.03786270346779901
training dataset
-->original metric score:
-->individual metric:0.13259668508287292, num_idi:264, num_all:1991
-->individual metric 0.13259668508287292
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.9881129271916791
-->F1 0.9931153184165232
-->FPR 0.043478260869565216
-->FNR 0.0068846815834767644
-->positive probability:0.8632986627043091, 581/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9742268041237113
-->F1 0.9847094801223242
-->FPR 0.08196721311475409
-->FNR 0.01529051987767584
-->positive probability:0.8427835051546392, 327/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.96
-->F1 0.9767441860465116
-->FPR 0.14285714285714285
-->FNR 0.023255813953488372
-->positive probability:0.86, 43/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9411764705882353
-->F1 0.9444444444444444
-->FPR 0.11764705882352941
-->FNR 0.0
-->positive probability:0.5588235294117647, 19/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9197860962566845
-->F1 0.9282296650717704
-->FPR 0.0963855421686747
-->FNR 0.0673076923076923
-->positive probability:0.5614973262032086, 105/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9621621621621622
-->F1 0.9717741935483871
-->FPR 0.049586776859504134
-->FNR 0.0321285140562249
-->positive probability:0.6675675675675675, 247/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9584269662921349
-->F1 0.9732078204199855
-->FPR 0.07653061224489796
-->FNR 0.03170028818443804
-->positive probability:0.7719101123595505, 687/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.01940706588752479, 0.019081886357664085, 0.01526627913804239, 0.07997181610005284, 0.0547617320664394, 0.0335002154115847, 0.013298549897585873, 0.013645285487807954]
-->fnr_diff [0.0008975539079790849, 0.00930339220217816, 0.09401287232450233, 0.01726868627799069, 0.00598712767549768, 0.061320564632194624, 0.026141386380727216, 0.02571316050894036]
-->FPR:[0.043478260869565216, 0.08196721311475409, 0.047619047619047616, 0.14285714285714285, 0.11764705882352941, 0.0963855421686747, 0.049586776859504134, 0.07653061224489796], mean FPR:0.08200895681963949, mean FPR diff:0.031116603793337756
-->FNR:[0.0068846815834767644, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.0321285140562249, 0.03170028818443804], mean FNR:0.03457093874537453, mean FNR diff:0.030080592988751268
-->mean fnr diff metric 0.031116603793337756
testing dataset
-->original metric score:
-->individual metric:0.1950354609929078, num_idi:165, num_all:846
-->individual metric 0.1950354609929078
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8698630136986302
-->F1 0.9233870967741935
-->FPR 0.45652173913043476
-->FNR 0.06910569105691057
-->positive probability:0.8561643835616438, 250/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9044117647058822
-->FPR 0.37209302325581395
-->FNR 0.07518796992481203
-->positive probability:0.7897727272727273, 139/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7058823529411765
-->FPR 0.6
-->FNR 0.25
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7466666666666667
-->FPR 0.375
-->FNR 0.125
-->positive probability:0.5972222222222222, 43/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.732484076433121
-->F1 0.787878787878788
-->FPR 0.421875
-->FNR 0.16129032258064516
-->positive probability:0.6687898089171974, 105/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8188976377952756
-->F1 0.8863261943986821
-->FPR 0.5113636363636364
-->FNR 0.08191126279863481
-->positive probability:0.8241469816272966, 314/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.00976849237718802, 0.07466022349743279, 0.44675324675324674, 0.2199134199134199, 0.15324675324675324, 0.07175324675324674, 0.024878246753246736, 0.06461038961038962]
-->fnr_diff [0.031242987589111558, 0.037325266457013014, 0.07324840764331209, 0.03786270346779901, 0.21213729653220098, 0.08713729653220098, 0.12342761911284614, 0.0440485593308358]
-->FPR:[0.45652173913043476, 0.37209302325581395, 0.0, 0.6666666666666666, 0.6, 0.375, 0.421875, 0.5113636363636364], mean FPR:0.42544000817706895, mean FPR diff:0.13319800236311546
-->FNR:[0.06910569105691057, 0.07518796992481203, 0.1111111111111111, 0.0, 0.25, 0.125, 0.16129032258064516, 0.08191126279863481], mean FNR:0.1092007946840142, mean FNR diff:0.08080376708316495
-->mean fnr diff metric 0.13319800236311546
-->epoch 11
-->start_index 0
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9610389610389611
-->z_score:1.4142128229141235, idi:13.999998092651367, p_hat:0.1428571194410324, n:98.0
Epoch [12/20], Loss: -0.2050, acc_loss, -0.2050, bias_loss:0.0000
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [12/20], Loss: -0.4310, acc_loss, -0.4310, bias_loss:0.0000
-->start_index 196
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9811320754716981
-->z_score:2.423827886581421, idi:16.998401641845703, p_hat:0.17345307767391205, n:98.0
Epoch [12/20], Loss: -0.3529, acc_loss, -0.3529, bias_loss:0.0000
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:2.4233951568603516, idi:16.997116088867188, p_hat:0.17343996465206146, n:98.0
Epoch [12/20], Loss: -0.3357, acc_loss, -0.3357, bias_loss:0.0000
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:-0.9428117275238037, idi:6.999992370605469, p_hat:0.07142849266529083, n:98.0
Epoch [12/20], Loss: -0.3509, acc_loss, -0.3509, bias_loss:0.0000
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [12/20], Loss: -0.3299, acc_loss, -0.3299, bias_loss:0.0000
-->start_index 588
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9673202614379085
-->z_score:1.375725507736206, idi:13.885696411132812, p_hat:0.14169077575206757, n:98.0
Epoch [12/20], Loss: -0.1024, acc_loss, -0.1024, bias_loss:0.0000
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9876543209876543
-->z_score:2.8121533393859863, idi:18.151668548583984, p_hat:0.1852211058139801, n:98.0
Epoch [12/20], Loss: -0.4825, acc_loss, -0.4825, bias_loss:0.0000
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.6060916781425476, idi:8.0, p_hat:0.08163265138864517, n:98.0
Epoch [12/20], Loss: -0.4391, acc_loss, -0.4391, bias_loss:0.0000
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:2.0109684467315674, idi:15.772271156311035, p_hat:0.16094154119491577, n:98.0
Epoch [12/20], Loss: -0.4201, acc_loss, -0.4201, bias_loss:0.0000
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.40318766236305237, idi:10.997406005859375, p_hat:0.11221843212842941, n:98.0
Epoch [12/20], Loss: -0.2752, acc_loss, -0.2752, bias_loss:0.0000
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [12/20], Loss: -0.5221, acc_loss, -0.5221, bias_loss:0.0000
-->start_index 1176
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [12/20], Loss: -0.4760, acc_loss, -0.4760, bias_loss:0.0000
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9729729729729729
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [12/20], Loss: -0.3942, acc_loss, -0.3942, bias_loss:0.0000
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [12/20], Loss: -0.4061, acc_loss, -0.4061, bias_loss:0.0000
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:1.750930666923523, idi:14.999999046325684, p_hat:0.15306121110916138, n:98.0
Epoch [12/20], Loss: -0.3771, acc_loss, -0.3771, bias_loss:0.0000
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.950943946838379, idi:15.59400749206543, p_hat:0.1591225266456604, n:98.0
Epoch [12/20], Loss: -0.3959, acc_loss, -0.3959, bias_loss:0.0000
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.06685333698987961, idi:9.998544692993164, p_hat:0.10202596336603165, n:98.0
Epoch [12/20], Loss: -0.3196, acc_loss, -0.3196, bias_loss:0.0000
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:0.8942576050758362, idi:12.455809593200684, p_hat:0.12710009515285492, n:98.0
Epoch [12/20], Loss: -0.4452, acc_loss, -0.4452, bias_loss:0.0000
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.9428090453147888, idi:7.0, p_hat:0.0714285746216774, n:98.0
Epoch [12/20], Loss: -0.5104, acc_loss, -0.5104, bias_loss:0.0000
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [12/20], Loss: -0.4879, acc_loss, -0.4879, bias_loss:0.0000
-->after epoch 11
-->overall baseline on training dataset
-->ACC 0.9878537106246663
-->F1 0.9931952441486578
-->FPR: 0.06288532675709001
-->FNR: 0.00598712767549768
-->overall baseline on testing dataset
-->ACC 0.913111180317658
-->F1 0.9511981808640897
-->FPR: 0.44675324675324674
-->FNR: 0.03786270346779901
training dataset
-->original metric score:
-->individual metric:0.13309894525364138, num_idi:265, num_all:1991
-->individual metric 0.13309894525364138
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.9881129271916791
-->F1 0.9931153184165232
-->FPR 0.043478260869565216
-->FNR 0.0068846815834767644
-->positive probability:0.8632986627043091, 581/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9742268041237113
-->F1 0.9847094801223242
-->FPR 0.08196721311475409
-->FNR 0.01529051987767584
-->positive probability:0.8427835051546392, 327/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.96
-->F1 0.9767441860465116
-->FPR 0.14285714285714285
-->FNR 0.023255813953488372
-->positive probability:0.86, 43/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9411764705882353
-->F1 0.9444444444444444
-->FPR 0.11764705882352941
-->FNR 0.0
-->positive probability:0.5588235294117647, 19/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9197860962566845
-->F1 0.9282296650717704
-->FPR 0.0963855421686747
-->FNR 0.0673076923076923
-->positive probability:0.5614973262032086, 105/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9621621621621622
-->F1 0.9717741935483871
-->FPR 0.049586776859504134
-->FNR 0.0321285140562249
-->positive probability:0.6675675675675675, 247/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9584269662921349
-->F1 0.9732078204199855
-->FPR 0.07653061224489796
-->FNR 0.03170028818443804
-->positive probability:0.7719101123595505, 687/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.01940706588752479, 0.019081886357664085, 0.01526627913804239, 0.07997181610005284, 0.0547617320664394, 0.0335002154115847, 0.013298549897585873, 0.013645285487807954]
-->fnr_diff [0.0008975539079790849, 0.00930339220217816, 0.09401287232450233, 0.01726868627799069, 0.00598712767549768, 0.061320564632194624, 0.026141386380727216, 0.02571316050894036]
-->FPR:[0.043478260869565216, 0.08196721311475409, 0.047619047619047616, 0.14285714285714285, 0.11764705882352941, 0.0963855421686747, 0.049586776859504134, 0.07653061224489796], mean FPR:0.08200895681963949, mean FPR diff:0.031116603793337756
-->FNR:[0.0068846815834767644, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.0321285140562249, 0.03170028818443804], mean FNR:0.03457093874537453, mean FNR diff:0.030080592988751268
-->mean fnr diff metric 0.031116603793337756
testing dataset
-->original metric score:
-->individual metric:0.1950354609929078, num_idi:165, num_all:846
-->individual metric 0.1950354609929078
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8698630136986302
-->F1 0.9233870967741935
-->FPR 0.45652173913043476
-->FNR 0.06910569105691057
-->positive probability:0.8561643835616438, 250/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9044117647058822
-->FPR 0.37209302325581395
-->FNR 0.07518796992481203
-->positive probability:0.7897727272727273, 139/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7058823529411765
-->FPR 0.6
-->FNR 0.25
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7466666666666667
-->FPR 0.375
-->FNR 0.125
-->positive probability:0.5972222222222222, 43/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.732484076433121
-->F1 0.787878787878788
-->FPR 0.421875
-->FNR 0.16129032258064516
-->positive probability:0.6687898089171974, 105/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8188976377952756
-->F1 0.8863261943986821
-->FPR 0.5113636363636364
-->FNR 0.08191126279863481
-->positive probability:0.8241469816272966, 314/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.00976849237718802, 0.07466022349743279, 0.44675324675324674, 0.2199134199134199, 0.15324675324675324, 0.07175324675324674, 0.024878246753246736, 0.06461038961038962]
-->fnr_diff [0.031242987589111558, 0.037325266457013014, 0.07324840764331209, 0.03786270346779901, 0.21213729653220098, 0.08713729653220098, 0.12342761911284614, 0.0440485593308358]
-->FPR:[0.45652173913043476, 0.37209302325581395, 0.0, 0.6666666666666666, 0.6, 0.375, 0.421875, 0.5113636363636364], mean FPR:0.42544000817706895, mean FPR diff:0.13319800236311546
-->FNR:[0.06910569105691057, 0.07518796992481203, 0.1111111111111111, 0.0, 0.25, 0.125, 0.16129032258064516, 0.08191126279863481], mean FNR:0.1092007946840142, mean FNR diff:0.08080376708316495
-->mean fnr diff metric 0.13319800236311546
-->epoch 12
-->start_index 0
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9610389610389611
-->z_score:1.4142060279846191, idi:13.999977111816406, p_hat:0.1428569108247757, n:98.0
Epoch [13/20], Loss: -0.2051, acc_loss, -0.2051, bias_loss:0.0000
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [13/20], Loss: -0.4318, acc_loss, -0.4318, bias_loss:0.0000
-->start_index 196
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9811320754716981
-->z_score:2.423734188079834, idi:16.998123168945312, p_hat:0.17345023155212402, n:98.0
Epoch [13/20], Loss: -0.3539, acc_loss, -0.3539, bias_loss:0.0000
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:2.347153663635254, idi:16.77069091796875, p_hat:0.1711294949054718, n:98.0
Epoch [13/20], Loss: -0.3392, acc_loss, -0.3392, bias_loss:0.0000
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:-0.9428173899650574, idi:6.999975204467773, p_hat:0.0714283213019371, n:98.0
Epoch [13/20], Loss: -0.3514, acc_loss, -0.3514, bias_loss:0.0000
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.3168491125106812, idi:13.71084213256836, p_hat:0.13990655541419983, n:98.0
Epoch [13/20], Loss: -0.3299, acc_loss, -0.3299, bias_loss:0.0000
-->start_index 588
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9673202614379085
-->z_score:1.334365963935852, idi:13.76286506652832, p_hat:0.14043739438056946, n:98.0
Epoch [13/20], Loss: -0.1019, acc_loss, -0.1019, bias_loss:0.0000
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9876543209876543
-->z_score:2.761056900024414, idi:17.999919891357422, p_hat:0.18367265164852142, n:98.0
Epoch [13/20], Loss: -0.4853, acc_loss, -0.4853, bias_loss:0.0000
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.6060916781425476, idi:8.0, p_hat:0.08163265138864517, n:98.0
Epoch [13/20], Loss: -0.4414, acc_loss, -0.4414, bias_loss:0.0000
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.915951132774353, idi:15.490083694458008, p_hat:0.15806208550930023, n:98.0
Epoch [13/20], Loss: -0.4235, acc_loss, -0.4235, bias_loss:0.0000
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.40133416652679443, idi:10.991901397705078, p_hat:0.1121622622013092, n:98.0
Epoch [13/20], Loss: -0.2797, acc_loss, -0.2797, bias_loss:0.0000
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [13/20], Loss: -0.5246, acc_loss, -0.5246, bias_loss:0.0000
-->start_index 1176
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [13/20], Loss: -0.4791, acc_loss, -0.4791, bias_loss:0.0000
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9729729729729729
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [13/20], Loss: -0.3967, acc_loss, -0.3967, bias_loss:0.0000
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [13/20], Loss: -0.4087, acc_loss, -0.4087, bias_loss:0.0000
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:1.750906229019165, idi:14.99992561340332, p_hat:0.15306046605110168, n:98.0
Epoch [13/20], Loss: -0.3777, acc_loss, -0.3777, bias_loss:0.0000
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.8903480768203735, idi:15.414047241210938, p_hat:0.15728619694709778, n:98.0
Epoch [13/20], Loss: -0.3976, acc_loss, -0.3976, bias_loss:0.0000
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.06695438921451569, idi:9.998844146728516, p_hat:0.10202902555465698, n:98.0
Epoch [13/20], Loss: -0.3249, acc_loss, -0.3249, bias_loss:0.0000
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:0.9381847381591797, idi:12.58626651763916, p_hat:0.1284312903881073, n:98.0
Epoch [13/20], Loss: -0.4470, acc_loss, -0.4470, bias_loss:0.0000
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.942809522151947, idi:6.999998569488525, p_hat:0.0714285597205162, n:98.0
Epoch [13/20], Loss: -0.5102, acc_loss, -0.5102, bias_loss:0.0000
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [13/20], Loss: -0.4871, acc_loss, -0.4871, bias_loss:0.0000
-->after epoch 12
-->overall baseline on training dataset
-->ACC 0.9875867592098239
-->F1 0.993045689075002
-->FPR: 0.06411837237977805
-->FNR: 0.006136805867385122
-->overall baseline on testing dataset
-->ACC 0.912488321395204
-->F1 0.9508483470351584
-->FPR: 0.44935064935064933
-->FNR: 0.03821656050955414
training dataset
-->original metric score:
-->individual metric:0.13259668508287292, num_idi:264, num_all:1991
-->individual metric 0.13259668508287292
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.986627043090639
-->F1 0.9922480620155039
-->FPR 0.043478260869565216
-->FNR 0.008605851979345954
-->positive probability:0.861812778603269, 580/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9742268041237113
-->F1 0.9847094801223242
-->FPR 0.08196721311475409
-->FNR 0.01529051987767584
-->positive probability:0.8427835051546392, 327/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.96
-->F1 0.9767441860465116
-->FPR 0.14285714285714285
-->FNR 0.023255813953488372
-->positive probability:0.86, 43/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9411764705882353
-->F1 0.9444444444444444
-->FPR 0.11764705882352941
-->FNR 0.0
-->positive probability:0.5588235294117647, 19/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9197860962566845
-->F1 0.9282296650717704
-->FPR 0.0963855421686747
-->FNR 0.0673076923076923
-->positive probability:0.5614973262032086, 105/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9621621621621622
-->F1 0.9717741935483871
-->FPR 0.049586776859504134
-->FNR 0.0321285140562249
-->positive probability:0.6675675675675675, 247/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9573033707865168
-->F1 0.972463768115942
-->FPR 0.07653061224489796
-->FNR 0.03314121037463977
-->positive probability:0.7707865168539326, 686/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.020640111510212833, 0.017848840734976043, 0.016499324760730433, 0.0787387704773648, 0.05352868644375136, 0.032267169788896655, 0.014531595520273916, 0.012412239865119912]
-->fnr_diff [0.002469046111960833, 0.00915371401029072, 0.09386319413261489, 0.01711900808610325, 0.006136805867385122, 0.06117088644030718, 0.025991708188839776, 0.027004404507254647]
-->FPR:[0.043478260869565216, 0.08196721311475409, 0.047619047619047616, 0.14285714285714285, 0.11764705882352941, 0.0963855421686747, 0.049586776859504134, 0.07653061224489796], mean FPR:0.08200895681963949, mean FPR diff:0.030808342387665746
-->FNR:[0.008605851979345954, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.0321285140562249, 0.03314121037463977], mean FNR:0.03496620031863339, mean FNR diff:0.030363595918094552
-->mean fnr diff metric 0.030808342387665746
testing dataset
-->original metric score:
-->individual metric:0.19148936170212766, num_idi:162, num_all:846
-->individual metric 0.19148936170212766
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8732876712328768
-->F1 0.9252525252525251
-->FPR 0.43478260869565216
-->FNR 0.06910569105691057
-->positive probability:0.8527397260273972, 249/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9044117647058822
-->FPR 0.37209302325581395
-->FNR 0.07518796992481203
-->positive probability:0.7897727272727273, 139/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7058823529411765
-->FPR 0.6
-->FNR 0.25
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7466666666666667
-->FPR 0.375
-->FNR 0.125
-->positive probability:0.5972222222222222, 43/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.732484076433121
-->F1 0.787878787878788
-->FPR 0.421875
-->FNR 0.16129032258064516
-->positive probability:0.6687898089171974, 105/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8188976377952756
-->F1 0.8859504132231405
-->FPR 0.5
-->FNR 0.08532423208191127
-->positive probability:0.8188976377952756, 312/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.014568040654997172, 0.07725762609483539, 0.44935064935064933, 0.2173160173160173, 0.15064935064935064, 0.07435064935064933, 0.027475649350649334, 0.050649350649350666]
-->fnr_diff [0.030889130547356432, 0.03697140941525789, 0.07289455060155697, 0.03821656050955414, 0.21178343949044587, 0.08678343949044587, 0.12307376207109103, 0.04710767157235713]
-->FPR:[0.43478260869565216, 0.37209302325581395, 0.0, 0.6666666666666666, 0.6, 0.375, 0.421875, 0.5], mean FPR:0.4213021623272666, mean FPR diff:0.13270216667706242
-->FNR:[0.06910569105691057, 0.07518796992481203, 0.1111111111111111, 0.0, 0.25, 0.125, 0.16129032258064516, 0.08532423208191127], mean FNR:0.10962741584442376, mean FNR diff:0.08096499546225816
-->mean fnr diff metric 0.13270216667706242
-->epoch 13
-->start_index 0
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9610389610389611
-->z_score:1.41408109664917, idi:13.999606132507324, p_hat:0.14285312592983246, n:98.0
Epoch [14/20], Loss: -0.2094, acc_loss, -0.2094, bias_loss:0.0000
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [14/20], Loss: -0.4317, acc_loss, -0.4317, bias_loss:0.0000
-->start_index 196
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9811320754716981
-->z_score:2.4241831302642822, idi:16.99945640563965, p_hat:0.173463836312294, n:98.0
Epoch [14/20], Loss: -0.3563, acc_loss, -0.3563, bias_loss:0.0000
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:2.0803122520446777, idi:15.978212356567383, p_hat:0.16304297745227814, n:98.0
Epoch [14/20], Loss: -0.3428, acc_loss, -0.3428, bias_loss:0.0000
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:-0.9428127408027649, idi:6.9999895095825195, p_hat:0.07142846286296844, n:98.0
Epoch [14/20], Loss: -0.3515, acc_loss, -0.3515, bias_loss:0.0000
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.4023463726043701, idi:13.96475601196289, p_hat:0.14249750971794128, n:98.0
Epoch [14/20], Loss: -0.3300, acc_loss, -0.3300, bias_loss:0.0000
-->start_index 588
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9673202614379085
-->z_score:1.3901891708374023, idi:13.928651809692383, p_hat:0.1421290934085846, n:98.0
Epoch [14/20], Loss: -0.1046, acc_loss, -0.1046, bias_loss:0.0000
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9876543209876543
-->z_score:2.913501739501953, idi:18.45265769958496, p_hat:0.18829242885112762, n:98.0
Epoch [14/20], Loss: -0.4858, acc_loss, -0.4858, bias_loss:0.0000
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.6060916781425476, idi:8.0, p_hat:0.08163265138864517, n:98.0
Epoch [14/20], Loss: -0.4424, acc_loss, -0.4424, bias_loss:0.0000
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:2.022922992706299, idi:15.807774543762207, p_hat:0.1613038182258606, n:98.0
Epoch [14/20], Loss: -0.4246, acc_loss, -0.4246, bias_loss:0.0000
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.40297892689704895, idi:10.996786117553711, p_hat:0.11221210658550262, n:98.0
Epoch [14/20], Loss: -0.2819, acc_loss, -0.2819, bias_loss:0.0000
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [14/20], Loss: -0.5253, acc_loss, -0.5253, bias_loss:0.0000
-->start_index 1176
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [14/20], Loss: -0.4809, acc_loss, -0.4809, bias_loss:0.0000
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9729729729729729
-->z_score:2.090468168258667, idi:16.008373260498047, p_hat:0.16335074603557587, n:98.0
Epoch [14/20], Loss: -0.3980, acc_loss, -0.3980, bias_loss:0.0000
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [14/20], Loss: -0.4102, acc_loss, -0.4102, bias_loss:0.0000
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:1.7498091459274292, idi:14.996667861938477, p_hat:0.1530272215604782, n:98.0
Epoch [14/20], Loss: -0.3777, acc_loss, -0.3777, bias_loss:0.0000
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.9856358766555786, idi:15.697037696838379, p_hat:0.16017384827136993, n:98.0
Epoch [14/20], Loss: -0.3986, acc_loss, -0.3986, bias_loss:0.0000
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.06722040474414825, idi:9.999634742736816, p_hat:0.10203708708286285, n:98.0
Epoch [14/20], Loss: -0.3238, acc_loss, -0.3238, bias_loss:0.0000
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:0.9428260326385498, idi:12.600050926208496, p_hat:0.12857194244861603, n:98.0
Epoch [14/20], Loss: -0.4489, acc_loss, -0.4489, bias_loss:0.0000
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.94281005859375, idi:6.999997138977051, p_hat:0.07142854481935501, n:98.0
Epoch [14/20], Loss: -0.5113, acc_loss, -0.5113, bias_loss:0.0000
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [14/20], Loss: -0.4881, acc_loss, -0.4881, bias_loss:0.0000
-->after epoch 13
-->overall baseline on training dataset
-->ACC 0.9875867592098239
-->F1 0.993045689075002
-->FPR: 0.06411837237977805
-->FNR: 0.006136805867385122
-->overall baseline on testing dataset
-->ACC 0.912176891933977
-->F1 0.950664800559832
-->FPR: 0.44935064935064933
-->FNR: 0.03857041755130927
training dataset
-->original metric score:
-->individual metric:0.13309894525364138, num_idi:265, num_all:1991
-->individual metric 0.13309894525364138
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.986627043090639
-->F1 0.9922480620155039
-->FPR 0.043478260869565216
-->FNR 0.008605851979345954
-->positive probability:0.861812778603269, 580/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9742268041237113
-->F1 0.9847094801223242
-->FPR 0.08196721311475409
-->FNR 0.01529051987767584
-->positive probability:0.8427835051546392, 327/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.96
-->F1 0.9767441860465116
-->FPR 0.14285714285714285
-->FNR 0.023255813953488372
-->positive probability:0.86, 43/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9411764705882353
-->F1 0.9444444444444444
-->FPR 0.11764705882352941
-->FNR 0.0
-->positive probability:0.5588235294117647, 19/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9197860962566845
-->F1 0.9282296650717704
-->FPR 0.0963855421686747
-->FNR 0.0673076923076923
-->positive probability:0.5614973262032086, 105/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9621621621621622
-->F1 0.9717741935483871
-->FPR 0.049586776859504134
-->FNR 0.0321285140562249
-->positive probability:0.6675675675675675, 247/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9573033707865168
-->F1 0.972463768115942
-->FPR 0.07653061224489796
-->FNR 0.03314121037463977
-->positive probability:0.7707865168539326, 686/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.020640111510212833, 0.017848840734976043, 0.016499324760730433, 0.0787387704773648, 0.05352868644375136, 0.032267169788896655, 0.014531595520273916, 0.012412239865119912]
-->fnr_diff [0.002469046111960833, 0.00915371401029072, 0.09386319413261489, 0.01711900808610325, 0.006136805867385122, 0.06117088644030718, 0.025991708188839776, 0.027004404507254647]
-->FPR:[0.043478260869565216, 0.08196721311475409, 0.047619047619047616, 0.14285714285714285, 0.11764705882352941, 0.0963855421686747, 0.049586776859504134, 0.07653061224489796], mean FPR:0.08200895681963949, mean FPR diff:0.030808342387665746
-->FNR:[0.008605851979345954, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.0321285140562249, 0.03314121037463977], mean FNR:0.03496620031863339, mean FNR diff:0.030363595918094552
-->mean fnr diff metric 0.030808342387665746
testing dataset
-->original metric score:
-->individual metric:0.19030732860520094, num_idi:161, num_all:846
-->individual metric 0.19030732860520094
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8732876712328768
-->F1 0.9252525252525251
-->FPR 0.43478260869565216
-->FNR 0.06910569105691057
-->positive probability:0.8527397260273972, 249/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9044117647058822
-->FPR 0.37209302325581395
-->FNR 0.07518796992481203
-->positive probability:0.7897727272727273, 139/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7058823529411765
-->FPR 0.6
-->FNR 0.25
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7466666666666667
-->FPR 0.375
-->FNR 0.125
-->positive probability:0.5972222222222222, 43/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.732484076433121
-->F1 0.787878787878788
-->FPR 0.421875
-->FNR 0.16129032258064516
-->positive probability:0.6687898089171974, 105/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8188976377952756
-->F1 0.8859504132231405
-->FPR 0.5
-->FNR 0.08532423208191127
-->positive probability:0.8188976377952756, 312/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.014568040654997172, 0.07725762609483539, 0.44935064935064933, 0.2173160173160173, 0.15064935064935064, 0.07435064935064933, 0.027475649350649334, 0.050649350649350666]
-->fnr_diff [0.0305352735056013, 0.036617552373502754, 0.07254069355980183, 0.03857041755130927, 0.21142958244869073, 0.08642958244869073, 0.12271990502933589, 0.046753814530602]
-->FPR:[0.43478260869565216, 0.37209302325581395, 0.0, 0.6666666666666666, 0.6, 0.375, 0.421875, 0.5], mean FPR:0.4213021623272666, mean FPR diff:0.13270216667706242
-->FNR:[0.06910569105691057, 0.07518796992481203, 0.1111111111111111, 0.0, 0.25, 0.125, 0.16129032258064516, 0.08532423208191127], mean FNR:0.10962741584442376, mean FNR diff:0.08069960268094181
-->mean fnr diff metric 0.13270216667706242
-->epoch 14
-->start_index 0
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9610389610389611
-->z_score:1.4137142896652222, idi:13.998517036437988, p_hat:0.14284200966358185, n:98.0
Epoch [15/20], Loss: -0.2091, acc_loss, -0.2091, bias_loss:0.0000
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [15/20], Loss: -0.4329, acc_loss, -0.4329, bias_loss:0.0000
-->start_index 196
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9811320754716981
-->z_score:2.4196159839630127, idi:16.98589324951172, p_hat:0.17332543432712555, n:98.0
Epoch [15/20], Loss: -0.3570, acc_loss, -0.3570, bias_loss:0.0000
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:2.048527240753174, idi:15.88381576538086, p_hat:0.16207975149154663, n:98.0
Epoch [15/20], Loss: -0.3458, acc_loss, -0.3458, bias_loss:0.0000
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:-0.9428154826164246, idi:6.99998140335083, p_hat:0.07142838090658188, n:98.0
Epoch [15/20], Loss: -0.3518, acc_loss, -0.3518, bias_loss:0.0000
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.4132623672485352, idi:13.997175216674805, p_hat:0.1428283154964447, n:98.0
Epoch [15/20], Loss: -0.3298, acc_loss, -0.3298, bias_loss:0.0000
-->start_index 588
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9673202614379085
-->z_score:1.3688960075378418, idi:13.865413665771484, p_hat:0.14148381352424622, n:98.0
Epoch [15/20], Loss: -0.1042, acc_loss, -0.1042, bias_loss:0.0000
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9876543209876543
-->z_score:2.821770191192627, idi:18.18022918701172, p_hat:0.18551254272460938, n:98.0
Epoch [15/20], Loss: -0.4879, acc_loss, -0.4879, bias_loss:0.0000
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.6060916781425476, idi:8.0, p_hat:0.08163265138864517, n:98.0
Epoch [15/20], Loss: -0.4445, acc_loss, -0.4445, bias_loss:0.0000
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.9329605102539062, idi:15.540599822998047, p_hat:0.1585775464773178, n:98.0
Epoch [15/20], Loss: -0.4273, acc_loss, -0.4273, bias_loss:0.0000
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.4274856746196747, idi:11.069567680358887, p_hat:0.1129547730088234, n:98.0
Epoch [15/20], Loss: -0.2857, acc_loss, -0.2857, bias_loss:0.0000
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [15/20], Loss: -0.5274, acc_loss, -0.5274, bias_loss:0.0000
-->start_index 1176
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [15/20], Loss: -0.4835, acc_loss, -0.4835, bias_loss:0.0000
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9729729729729729
-->z_score:2.138282299041748, idi:16.150373458862305, p_hat:0.1647997349500656, n:98.0
Epoch [15/20], Loss: -0.4001, acc_loss, -0.4001, bias_loss:0.0000
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [15/20], Loss: -0.4124, acc_loss, -0.4124, bias_loss:0.0000
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:1.7112528085708618, idi:14.882162094116211, p_hat:0.15185879170894623, n:98.0
Epoch [15/20], Loss: -0.3780, acc_loss, -0.3780, bias_loss:0.0000
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.9574518203735352, idi:15.613334655761719, p_hat:0.15931974351406097, n:98.0
Epoch [15/20], Loss: -0.4003, acc_loss, -0.4003, bias_loss:0.0000
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.06724326312541962, idi:9.999702453613281, p_hat:0.10203777998685837, n:98.0
Epoch [15/20], Loss: -0.3279, acc_loss, -0.3279, bias_loss:0.0000
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:0.8202482461929321, idi:12.236013412475586, p_hat:0.12485727667808533, n:98.0
Epoch [15/20], Loss: -0.4503, acc_loss, -0.4503, bias_loss:0.0000
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.9428130388259888, idi:6.999988555908203, p_hat:0.07142845541238785, n:98.0
Epoch [15/20], Loss: -0.5111, acc_loss, -0.5111, bias_loss:0.0000
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [15/20], Loss: -0.4874, acc_loss, -0.4874, bias_loss:0.0000
-->after epoch 14
-->overall baseline on training dataset
-->ACC 0.987720234917245
-->F1 0.9931199521387974
-->FPR: 0.06288532675709001
-->FNR: 0.006136805867385122
-->overall baseline on testing dataset
-->ACC 0.912176891933977
-->F1 0.950664800559832
-->FPR: 0.44935064935064933
-->FNR: 0.03857041755130927
training dataset
-->original metric score:
-->individual metric:0.13259668508287292, num_idi:264, num_all:1991
-->individual metric 0.13259668508287292
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.986627043090639
-->F1 0.9922480620155039
-->FPR 0.043478260869565216
-->FNR 0.008605851979345954
-->positive probability:0.861812778603269, 580/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9742268041237113
-->F1 0.9847094801223242
-->FPR 0.08196721311475409
-->FNR 0.01529051987767584
-->positive probability:0.8427835051546392, 327/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.96
-->F1 0.9767441860465116
-->FPR 0.14285714285714285
-->FNR 0.023255813953488372
-->positive probability:0.86, 43/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9411764705882353
-->F1 0.9444444444444444
-->FPR 0.11764705882352941
-->FNR 0.0
-->positive probability:0.5588235294117647, 19/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9197860962566845
-->F1 0.9282296650717704
-->FPR 0.0963855421686747
-->FNR 0.0673076923076923
-->positive probability:0.5614973262032086, 105/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9621621621621622
-->F1 0.9717741935483871
-->FPR 0.049586776859504134
-->FNR 0.0321285140562249
-->positive probability:0.6675675675675675, 247/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9573033707865168
-->F1 0.972463768115942
-->FPR 0.07653061224489796
-->FNR 0.03314121037463977
-->positive probability:0.7707865168539326, 686/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.01940706588752479, 0.019081886357664085, 0.01526627913804239, 0.07997181610005284, 0.0547617320664394, 0.0335002154115847, 0.013298549897585873, 0.013645285487807954]
-->fnr_diff [0.002469046111960833, 0.00915371401029072, 0.09386319413261489, 0.01711900808610325, 0.006136805867385122, 0.06117088644030718, 0.025991708188839776, 0.027004404507254647]
-->FPR:[0.043478260869565216, 0.08196721311475409, 0.047619047619047616, 0.14285714285714285, 0.11764705882352941, 0.0963855421686747, 0.049586776859504134, 0.07653061224489796], mean FPR:0.08200895681963949, mean FPR diff:0.031116603793337756
-->FNR:[0.008605851979345954, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.0321285140562249, 0.03314121037463977], mean FNR:0.03496620031863339, mean FNR diff:0.030363595918094552
-->mean fnr diff metric 0.031116603793337756
testing dataset
-->original metric score:
-->individual metric:0.19148936170212766, num_idi:162, num_all:846
-->individual metric 0.19148936170212766
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8732876712328768
-->F1 0.9252525252525251
-->FPR 0.43478260869565216
-->FNR 0.06910569105691057
-->positive probability:0.8527397260273972, 249/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9044117647058822
-->FPR 0.37209302325581395
-->FNR 0.07518796992481203
-->positive probability:0.7897727272727273, 139/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7058823529411765
-->FPR 0.6
-->FNR 0.25
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7466666666666667
-->FPR 0.375
-->FNR 0.125
-->positive probability:0.5972222222222222, 43/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.732484076433121
-->F1 0.787878787878788
-->FPR 0.421875
-->FNR 0.16129032258064516
-->positive probability:0.6687898089171974, 105/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8188976377952756
-->F1 0.8859504132231405
-->FPR 0.5
-->FNR 0.08532423208191127
-->positive probability:0.8188976377952756, 312/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.014568040654997172, 0.07725762609483539, 0.44935064935064933, 0.2173160173160173, 0.15064935064935064, 0.07435064935064933, 0.027475649350649334, 0.050649350649350666]
-->fnr_diff [0.0305352735056013, 0.036617552373502754, 0.07254069355980183, 0.03857041755130927, 0.21142958244869073, 0.08642958244869073, 0.12271990502933589, 0.046753814530602]
-->FPR:[0.43478260869565216, 0.37209302325581395, 0.0, 0.6666666666666666, 0.6, 0.375, 0.421875, 0.5], mean FPR:0.4213021623272666, mean FPR diff:0.13270216667706242
-->FNR:[0.06910569105691057, 0.07518796992481203, 0.1111111111111111, 0.0, 0.25, 0.125, 0.16129032258064516, 0.08532423208191127], mean FNR:0.10962741584442376, mean FNR diff:0.08069960268094181
-->mean fnr diff metric 0.13270216667706242
-->epoch 15
-->start_index 0
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9610389610389611
-->z_score:1.4096384048461914, idi:13.98641300201416, p_hat:0.14271849393844604, n:98.0
Epoch [16/20], Loss: -0.2127, acc_loss, -0.2127, bias_loss:0.0000
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [16/20], Loss: -0.4327, acc_loss, -0.4327, bias_loss:0.0000
-->start_index 196
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9811320754716981
-->z_score:2.0875699520111084, idi:15.999765396118164, p_hat:0.16326291859149933, n:98.0
Epoch [16/20], Loss: -0.3590, acc_loss, -0.3590, bias_loss:0.0000
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:1.9707452058792114, idi:15.652814865112305, p_hat:0.15972259640693665, n:98.0
Epoch [16/20], Loss: -0.3491, acc_loss, -0.3491, bias_loss:0.0000
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:-0.9428130388259888, idi:6.999988555908203, p_hat:0.07142845541238785, n:98.0
Epoch [16/20], Loss: -0.3521, acc_loss, -0.3521, bias_loss:0.0000
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.4140515327453613, idi:13.999519348144531, p_hat:0.14285223186016083, n:98.0
Epoch [16/20], Loss: -0.3300, acc_loss, -0.3300, bias_loss:0.0000
-->start_index 588
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9673202614379085
-->z_score:1.3930894136428833, idi:13.937263488769531, p_hat:0.1422169804573059, n:98.0
Epoch [16/20], Loss: -0.1070, acc_loss, -0.1070, bias_loss:0.0000
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9876543209876543
-->z_score:2.950590133666992, idi:18.56280517578125, p_hat:0.18941637873649597, n:98.0
Epoch [16/20], Loss: -0.4879, acc_loss, -0.4879, bias_loss:0.0000
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.6060916781425476, idi:8.0, p_hat:0.08163265138864517, n:98.0
Epoch [16/20], Loss: -0.4454, acc_loss, -0.4454, bias_loss:0.0000
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:2.0087320804595947, idi:15.765629768371582, p_hat:0.16087377071380615, n:98.0
Epoch [16/20], Loss: -0.4282, acc_loss, -0.4282, bias_loss:0.0000
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.4024355709552765, idi:10.995172500610352, p_hat:0.11219564080238342, n:98.0
Epoch [16/20], Loss: -0.2879, acc_loss, -0.2879, bias_loss:0.0000
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [16/20], Loss: -0.5277, acc_loss, -0.5277, bias_loss:0.0000
-->start_index 1176
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [16/20], Loss: -0.4849, acc_loss, -0.4849, bias_loss:0.0000
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9729729729729729
-->z_score:2.3090052604675293, idi:16.657394409179688, p_hat:0.16997341811656952, n:98.0
Epoch [16/20], Loss: -0.4009, acc_loss, -0.4009, bias_loss:0.0000
-->start_index 1372
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9659863945578231
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [16/20], Loss: -0.4134, acc_loss, -0.4134, bias_loss:0.0000
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:1.5704188346862793, idi:14.463905334472656, p_hat:0.14759087562561035, n:98.0
Epoch [16/20], Loss: -0.3779, acc_loss, -0.3779, bias_loss:0.0000
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:2.029853105545044, idi:15.82835578918457, p_hat:0.16151383519172668, n:98.0
Epoch [16/20], Loss: -0.4013, acc_loss, -0.4013, bias_loss:0.0000
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.06731456518173218, idi:9.999914169311523, p_hat:0.10203994065523148, n:98.0
Epoch [16/20], Loss: -0.3270, acc_loss, -0.3270, bias_loss:0.0000
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:0.8856185674667358, idi:12.430152893066406, p_hat:0.1268382966518402, n:98.0
Epoch [16/20], Loss: -0.4518, acc_loss, -0.4518, bias_loss:0.0000
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.9428130388259888, idi:6.999988555908203, p_hat:0.07142845541238785, n:98.0
Epoch [16/20], Loss: -0.5120, acc_loss, -0.5120, bias_loss:0.0000
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [16/20], Loss: -0.4886, acc_loss, -0.4886, bias_loss:0.0000
-->after epoch 15
-->overall baseline on training dataset
-->ACC 0.987720234917245
-->F1 0.9931199521387974
-->FPR: 0.06288532675709001
-->FNR: 0.006136805867385122
-->overall baseline on testing dataset
-->ACC 0.9118654624727499
-->F1 0.950498513206227
-->FPR: 0.45194805194805193
-->FNR: 0.03857041755130927
training dataset
-->original metric score:
-->individual metric:0.13259668508287292, num_idi:264, num_all:1991
-->individual metric 0.13259668508287292
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.986627043090639
-->F1 0.9922480620155039
-->FPR 0.043478260869565216
-->FNR 0.008605851979345954
-->positive probability:0.861812778603269, 580/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9742268041237113
-->F1 0.9847094801223242
-->FPR 0.08196721311475409
-->FNR 0.01529051987767584
-->positive probability:0.8427835051546392, 327/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.96
-->F1 0.9767441860465116
-->FPR 0.14285714285714285
-->FNR 0.023255813953488372
-->positive probability:0.86, 43/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9411764705882353
-->F1 0.9444444444444444
-->FPR 0.11764705882352941
-->FNR 0.0
-->positive probability:0.5588235294117647, 19/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9197860962566845
-->F1 0.9282296650717704
-->FPR 0.0963855421686747
-->FNR 0.0673076923076923
-->positive probability:0.5614973262032086, 105/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9621621621621622
-->F1 0.9717741935483871
-->FPR 0.049586776859504134
-->FNR 0.0321285140562249
-->positive probability:0.6675675675675675, 247/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9573033707865168
-->F1 0.972463768115942
-->FPR 0.07653061224489796
-->FNR 0.03314121037463977
-->positive probability:0.7707865168539326, 686/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.01940706588752479, 0.019081886357664085, 0.01526627913804239, 0.07997181610005284, 0.0547617320664394, 0.0335002154115847, 0.013298549897585873, 0.013645285487807954]
-->fnr_diff [0.002469046111960833, 0.00915371401029072, 0.09386319413261489, 0.01711900808610325, 0.006136805867385122, 0.06117088644030718, 0.025991708188839776, 0.027004404507254647]
-->FPR:[0.043478260869565216, 0.08196721311475409, 0.047619047619047616, 0.14285714285714285, 0.11764705882352941, 0.0963855421686747, 0.049586776859504134, 0.07653061224489796], mean FPR:0.08200895681963949, mean FPR diff:0.031116603793337756
-->FNR:[0.008605851979345954, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.0321285140562249, 0.03314121037463977], mean FNR:0.03496620031863339, mean FNR diff:0.030363595918094552
-->mean fnr diff metric 0.031116603793337756
testing dataset
-->original metric score:
-->individual metric:0.19030732860520094, num_idi:161, num_all:846
-->individual metric 0.19030732860520094
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8698630136986302
-->F1 0.923076923076923
-->FPR 0.43478260869565216
-->FNR 0.07317073170731707
-->positive probability:0.8493150684931506, 248/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9044117647058822
-->FPR 0.37209302325581395
-->FNR 0.07518796992481203
-->positive probability:0.7897727272727273, 139/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7058823529411765
-->FPR 0.6
-->FNR 0.25
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7466666666666667
-->FPR 0.375
-->FNR 0.125
-->positive probability:0.5972222222222222, 43/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.732484076433121
-->F1 0.787878787878788
-->FPR 0.421875
-->FNR 0.16129032258064516
-->positive probability:0.6687898089171974, 105/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8188976377952756
-->F1 0.8859504132231405
-->FPR 0.5
-->FNR 0.08532423208191127
-->positive probability:0.8188976377952756, 312/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.01716544325239977, 0.07985502869223798, 0.45194805194805193, 0.2147186147186147, 0.14805194805194805, 0.07694805194805193, 0.030073051948051932, 0.04805194805194807]
-->fnr_diff [0.0346003141560078, 0.036617552373502754, 0.07254069355980183, 0.03857041755130927, 0.21142958244869073, 0.08642958244869073, 0.12271990502933589, 0.046753814530602]
-->FPR:[0.43478260869565216, 0.37209302325581395, 0.0, 0.6666666666666666, 0.6, 0.375, 0.421875, 0.5], mean FPR:0.4213021623272666, mean FPR diff:0.13335151732641304
-->FNR:[0.07317073170731707, 0.07518796992481203, 0.1111111111111111, 0.0, 0.25, 0.125, 0.16129032258064516, 0.08532423208191127], mean FNR:0.11013554592572458, mean FNR diff:0.08120773276224263
-->mean fnr diff metric 0.13335151732641304
-->epoch 16
-->start_index 0
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9610389610389611
-->z_score:1.4063832759857178, idi:13.97674560546875, p_hat:0.14261984825134277, n:98.0
Epoch [17/20], Loss: -0.2124, acc_loss, -0.2124, bias_loss:0.0000
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [17/20], Loss: -0.4342, acc_loss, -0.4342, bias_loss:0.0000
-->start_index 196
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9811320754716981
-->z_score:2.0875866413116455, idi:15.999815940856934, p_hat:0.16326342523097992, n:98.0
Epoch [17/20], Loss: -0.3597, acc_loss, -0.3597, bias_loss:0.0000
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:1.8556581735610962, idi:15.311023712158203, p_hat:0.15623493492603302, n:98.0
Epoch [17/20], Loss: -0.3517, acc_loss, -0.3517, bias_loss:0.0000
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:-0.9428145289421082, idi:6.999984264373779, p_hat:0.07142841070890427, n:98.0
Epoch [17/20], Loss: -0.3522, acc_loss, -0.3522, bias_loss:0.0000
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.4141803979873657, idi:13.999900817871094, p_hat:0.14285613596439362, n:98.0
Epoch [17/20], Loss: -0.3297, acc_loss, -0.3297, bias_loss:0.0000
-->start_index 588
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9673202614379085
-->z_score:1.3815463781356812, idi:13.902983665466309, p_hat:0.14186717569828033, n:98.0
Epoch [17/20], Loss: -0.1068, acc_loss, -0.1068, bias_loss:0.0000
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9876543209876543
-->z_score:2.89420747756958, idi:18.395357131958008, p_hat:0.18770772218704224, n:98.0
Epoch [17/20], Loss: -0.4896, acc_loss, -0.4896, bias_loss:0.0000
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.6060916781425476, idi:8.0, p_hat:0.08163265138864517, n:98.0
Epoch [17/20], Loss: -0.4473, acc_loss, -0.4473, bias_loss:0.0000
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.9242302179336548, idi:15.514671325683594, p_hat:0.15831297636032104, n:98.0
Epoch [17/20], Loss: -0.4305, acc_loss, -0.4305, bias_loss:0.0000
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.47260773181915283, idi:11.203573226928711, p_hat:0.11432217806577682, n:98.0
Epoch [17/20], Loss: -0.2911, acc_loss, -0.2911, bias_loss:0.0000
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:1.0774959325790405, idi:12.999999046325684, p_hat:0.13265305757522583, n:98.0
Epoch [17/20], Loss: -0.5295, acc_loss, -0.5295, bias_loss:0.0000
-->start_index 1176
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [17/20], Loss: -0.4872, acc_loss, -0.4872, bias_loss:0.0000
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9729729729729729
-->z_score:2.3334343433380127, idi:16.72994613647461, p_hat:0.17071373760700226, n:98.0
Epoch [17/20], Loss: -0.4027, acc_loss, -0.4027, bias_loss:0.0000
-->start_index 1372
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9659863945578231
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [17/20], Loss: -0.4153, acc_loss, -0.4153, bias_loss:0.0000
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:1.7366917133331299, idi:14.957711219787598, p_hat:0.15262970328330994, n:98.0
Epoch [17/20], Loss: -0.3780, acc_loss, -0.3780, bias_loss:0.0000
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:2.019178628921509, idi:15.796653747558594, p_hat:0.16119034588336945, n:98.0
Epoch [17/20], Loss: -0.4029, acc_loss, -0.4029, bias_loss:0.0000
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.06731972843408585, idi:9.999929428100586, p_hat:0.10204009711742401, n:98.0
Epoch [17/20], Loss: -0.3302, acc_loss, -0.3302, bias_loss:0.0000
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:0.767642617225647, idi:12.079782485961914, p_hat:0.12326308339834213, n:98.0
Epoch [17/20], Loss: -0.4530, acc_loss, -0.4530, bias_loss:0.0000
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.9428203701972961, idi:6.999966621398926, p_hat:0.07142823189496994, n:98.0
Epoch [17/20], Loss: -0.5120, acc_loss, -0.5120, bias_loss:0.0000
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [17/20], Loss: -0.4881, acc_loss, -0.4881, bias_loss:0.0000
-->after epoch 16
-->overall baseline on training dataset
-->ACC 0.987720234917245
-->F1 0.9931199521387974
-->FPR: 0.06288532675709001
-->FNR: 0.006136805867385122
-->overall baseline on testing dataset
-->ACC 0.9118654624727499
-->F1 0.950498513206227
-->FPR: 0.45194805194805193
-->FNR: 0.03857041755130927
training dataset
-->original metric score:
-->individual metric:0.13259668508287292, num_idi:264, num_all:1991
-->individual metric 0.13259668508287292
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.986627043090639
-->F1 0.9922480620155039
-->FPR 0.043478260869565216
-->FNR 0.008605851979345954
-->positive probability:0.861812778603269, 580/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9742268041237113
-->F1 0.9847094801223242
-->FPR 0.08196721311475409
-->FNR 0.01529051987767584
-->positive probability:0.8427835051546392, 327/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.96
-->F1 0.9767441860465116
-->FPR 0.14285714285714285
-->FNR 0.023255813953488372
-->positive probability:0.86, 43/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9411764705882353
-->F1 0.9444444444444444
-->FPR 0.11764705882352941
-->FNR 0.0
-->positive probability:0.5588235294117647, 19/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9197860962566845
-->F1 0.9282296650717704
-->FPR 0.0963855421686747
-->FNR 0.0673076923076923
-->positive probability:0.5614973262032086, 105/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9621621621621622
-->F1 0.9717741935483871
-->FPR 0.049586776859504134
-->FNR 0.0321285140562249
-->positive probability:0.6675675675675675, 247/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9573033707865168
-->F1 0.972463768115942
-->FPR 0.07653061224489796
-->FNR 0.03314121037463977
-->positive probability:0.7707865168539326, 686/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.01940706588752479, 0.019081886357664085, 0.01526627913804239, 0.07997181610005284, 0.0547617320664394, 0.0335002154115847, 0.013298549897585873, 0.013645285487807954]
-->fnr_diff [0.002469046111960833, 0.00915371401029072, 0.09386319413261489, 0.01711900808610325, 0.006136805867385122, 0.06117088644030718, 0.025991708188839776, 0.027004404507254647]
-->FPR:[0.043478260869565216, 0.08196721311475409, 0.047619047619047616, 0.14285714285714285, 0.11764705882352941, 0.0963855421686747, 0.049586776859504134, 0.07653061224489796], mean FPR:0.08200895681963949, mean FPR diff:0.031116603793337756
-->FNR:[0.008605851979345954, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.0321285140562249, 0.03314121037463977], mean FNR:0.03496620031863339, mean FNR diff:0.030363595918094552
-->mean fnr diff metric 0.031116603793337756
testing dataset
-->original metric score:
-->individual metric:0.19030732860520094, num_idi:161, num_all:846
-->individual metric 0.19030732860520094
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8698630136986302
-->F1 0.923076923076923
-->FPR 0.43478260869565216
-->FNR 0.07317073170731707
-->positive probability:0.8493150684931506, 248/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9044117647058822
-->FPR 0.37209302325581395
-->FNR 0.07518796992481203
-->positive probability:0.7897727272727273, 139/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7058823529411765
-->FPR 0.6
-->FNR 0.25
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7466666666666667
-->FPR 0.375
-->FNR 0.125
-->positive probability:0.5972222222222222, 43/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.732484076433121
-->F1 0.787878787878788
-->FPR 0.421875
-->FNR 0.16129032258064516
-->positive probability:0.6687898089171974, 105/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8188976377952756
-->F1 0.8859504132231405
-->FPR 0.5
-->FNR 0.08532423208191127
-->positive probability:0.8188976377952756, 312/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.01716544325239977, 0.07985502869223798, 0.45194805194805193, 0.2147186147186147, 0.14805194805194805, 0.07694805194805193, 0.030073051948051932, 0.04805194805194807]
-->fnr_diff [0.0346003141560078, 0.036617552373502754, 0.07254069355980183, 0.03857041755130927, 0.21142958244869073, 0.08642958244869073, 0.12271990502933589, 0.046753814530602]
-->FPR:[0.43478260869565216, 0.37209302325581395, 0.0, 0.6666666666666666, 0.6, 0.375, 0.421875, 0.5], mean FPR:0.4213021623272666, mean FPR diff:0.13335151732641304
-->FNR:[0.07317073170731707, 0.07518796992481203, 0.1111111111111111, 0.0, 0.25, 0.125, 0.16129032258064516, 0.08532423208191127], mean FNR:0.11013554592572458, mean FNR diff:0.08120773276224263
-->mean fnr diff metric 0.13335151732641304
-->epoch 17
-->start_index 0
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9610389610389611
-->z_score:1.3708752393722534, idi:13.871292114257812, p_hat:0.14154379069805145, n:98.0
Epoch [18/20], Loss: -0.2154, acc_loss, -0.2154, bias_loss:0.0000
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [18/20], Loss: -0.4341, acc_loss, -0.4341, bias_loss:0.0000
-->start_index 196
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9811320754716981
-->z_score:2.087604284286499, idi:15.999868392944336, p_hat:0.1632639616727829, n:98.0
Epoch [18/20], Loss: -0.3614, acc_loss, -0.3614, bias_loss:0.0000
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:1.7496399879455566, idi:14.99616527557373, p_hat:0.15302209556102753, n:98.0
Epoch [18/20], Loss: -0.3548, acc_loss, -0.3548, bias_loss:0.0000
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:-0.942833662033081, idi:6.999927520751953, p_hat:0.0714278295636177, n:98.0
Epoch [18/20], Loss: -0.3524, acc_loss, -0.3524, bias_loss:0.0000
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.4142060279846191, idi:13.999977111816406, p_hat:0.1428569108247757, n:98.0
Epoch [18/20], Loss: -0.3299, acc_loss, -0.3299, bias_loss:0.0000
-->start_index 588
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9673202614379085
-->z_score:1.3927992582321167, idi:13.936402320861816, p_hat:0.14220818877220154, n:98.0
Epoch [18/20], Loss: -0.1097, acc_loss, -0.1097, bias_loss:0.0000
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9876543209876543
-->z_score:2.9643194675445557, idi:18.603578567504883, p_hat:0.1898324340581894, n:98.0
Epoch [18/20], Loss: -0.4893, acc_loss, -0.4893, bias_loss:0.0000
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.6060916781425476, idi:8.0, p_hat:0.08163265138864517, n:98.0
Epoch [18/20], Loss: -0.4481, acc_loss, -0.4481, bias_loss:0.0000
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.9794825315475464, idi:15.678762435913086, p_hat:0.15998737514019012, n:98.0
Epoch [18/20], Loss: -0.4312, acc_loss, -0.4312, bias_loss:0.0000
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.43619149923324585, idi:11.095422744750977, p_hat:0.11321859806776047, n:98.0
Epoch [18/20], Loss: -0.2934, acc_loss, -0.2934, bias_loss:0.0000
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:1.077491044998169, idi:12.999984741210938, p_hat:0.1326529085636139, n:98.0
Epoch [18/20], Loss: -0.5295, acc_loss, -0.5295, bias_loss:0.0000
-->start_index 1176
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [18/20], Loss: -0.4882, acc_loss, -0.4882, bias_loss:0.0000
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9729729729729729
-->z_score:2.3893890380859375, idi:16.896121978759766, p_hat:0.17240941524505615, n:98.0
Epoch [18/20], Loss: -0.4032, acc_loss, -0.4032, bias_loss:0.0000
-->start_index 1372
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9659863945578231
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [18/20], Loss: -0.4161, acc_loss, -0.4161, bias_loss:0.0000
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:1.7497284412384033, idi:14.996427536010742, p_hat:0.15302477777004242, n:98.0
Epoch [18/20], Loss: -0.3779, acc_loss, -0.3779, bias_loss:0.0000
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:2.0547471046447754, idi:15.902286529541016, p_hat:0.1622682362794876, n:98.0
Epoch [18/20], Loss: -0.4038, acc_loss, -0.4038, bias_loss:0.0000
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.06733570992946625, idi:9.999977111816406, p_hat:0.10204058140516281, n:98.0
Epoch [18/20], Loss: -0.3295, acc_loss, -0.3295, bias_loss:0.0000
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:0.8569709062576294, idi:12.345073699951172, p_hat:0.12597014009952545, n:98.0
Epoch [18/20], Loss: -0.4541, acc_loss, -0.4541, bias_loss:0.0000
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.9428178668022156, idi:6.999974250793457, p_hat:0.07142830640077591, n:98.0
Epoch [18/20], Loss: -0.5127, acc_loss, -0.5127, bias_loss:0.0000
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [18/20], Loss: -0.4891, acc_loss, -0.4891, bias_loss:0.0000
-->after epoch 17
-->overall baseline on training dataset
-->ACC 0.987720234917245
-->F1 0.9931199521387974
-->FPR: 0.06288532675709001
-->FNR: 0.006136805867385122
-->overall baseline on testing dataset
-->ACC 0.9118654624727499
-->F1 0.950498513206227
-->FPR: 0.45194805194805193
-->FNR: 0.03857041755130927
training dataset
-->original metric score:
-->individual metric:0.13309894525364138, num_idi:265, num_all:1991
-->individual metric 0.13309894525364138
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.986627043090639
-->F1 0.9922480620155039
-->FPR 0.043478260869565216
-->FNR 0.008605851979345954
-->positive probability:0.861812778603269, 580/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9742268041237113
-->F1 0.9847094801223242
-->FPR 0.08196721311475409
-->FNR 0.01529051987767584
-->positive probability:0.8427835051546392, 327/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.96
-->F1 0.9767441860465116
-->FPR 0.14285714285714285
-->FNR 0.023255813953488372
-->positive probability:0.86, 43/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9411764705882353
-->F1 0.9444444444444444
-->FPR 0.11764705882352941
-->FNR 0.0
-->positive probability:0.5588235294117647, 19/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9197860962566845
-->F1 0.9282296650717704
-->FPR 0.0963855421686747
-->FNR 0.0673076923076923
-->positive probability:0.5614973262032086, 105/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9621621621621622
-->F1 0.9717741935483871
-->FPR 0.049586776859504134
-->FNR 0.0321285140562249
-->positive probability:0.6675675675675675, 247/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9573033707865168
-->F1 0.972463768115942
-->FPR 0.07653061224489796
-->FNR 0.03314121037463977
-->positive probability:0.7707865168539326, 686/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.01940706588752479, 0.019081886357664085, 0.01526627913804239, 0.07997181610005284, 0.0547617320664394, 0.0335002154115847, 0.013298549897585873, 0.013645285487807954]
-->fnr_diff [0.002469046111960833, 0.00915371401029072, 0.09386319413261489, 0.01711900808610325, 0.006136805867385122, 0.06117088644030718, 0.025991708188839776, 0.027004404507254647]
-->FPR:[0.043478260869565216, 0.08196721311475409, 0.047619047619047616, 0.14285714285714285, 0.11764705882352941, 0.0963855421686747, 0.049586776859504134, 0.07653061224489796], mean FPR:0.08200895681963949, mean FPR diff:0.031116603793337756
-->FNR:[0.008605851979345954, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.0321285140562249, 0.03314121037463977], mean FNR:0.03496620031863339, mean FNR diff:0.030363595918094552
-->mean fnr diff metric 0.031116603793337756
testing dataset
-->original metric score:
-->individual metric:0.18912529550827423, num_idi:160, num_all:846
-->individual metric 0.18912529550827423
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8698630136986302
-->F1 0.923076923076923
-->FPR 0.43478260869565216
-->FNR 0.07317073170731707
-->positive probability:0.8493150684931506, 248/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9044117647058822
-->FPR 0.37209302325581395
-->FNR 0.07518796992481203
-->positive probability:0.7897727272727273, 139/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7058823529411765
-->FPR 0.6
-->FNR 0.25
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7466666666666667
-->FPR 0.375
-->FNR 0.125
-->positive probability:0.5972222222222222, 43/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.732484076433121
-->F1 0.787878787878788
-->FPR 0.421875
-->FNR 0.16129032258064516
-->positive probability:0.6687898089171974, 105/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8188976377952756
-->F1 0.8859504132231405
-->FPR 0.5
-->FNR 0.08532423208191127
-->positive probability:0.8188976377952756, 312/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.01716544325239977, 0.07985502869223798, 0.45194805194805193, 0.2147186147186147, 0.14805194805194805, 0.07694805194805193, 0.030073051948051932, 0.04805194805194807]
-->fnr_diff [0.0346003141560078, 0.036617552373502754, 0.07254069355980183, 0.03857041755130927, 0.21142958244869073, 0.08642958244869073, 0.12271990502933589, 0.046753814530602]
-->FPR:[0.43478260869565216, 0.37209302325581395, 0.0, 0.6666666666666666, 0.6, 0.375, 0.421875, 0.5], mean FPR:0.4213021623272666, mean FPR diff:0.13335151732641304
-->FNR:[0.07317073170731707, 0.07518796992481203, 0.1111111111111111, 0.0, 0.25, 0.125, 0.16129032258064516, 0.08532423208191127], mean FNR:0.11013554592572458, mean FNR diff:0.08120773276224263
-->mean fnr diff metric 0.13335151732641304
-->epoch 18
-->start_index 0
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9610389610389611
-->z_score:1.3657201528549194, idi:13.855981826782227, p_hat:0.14138756692409515, n:98.0
Epoch [19/20], Loss: -0.2152, acc_loss, -0.2152, bias_loss:0.0000
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [19/20], Loss: -0.4358, acc_loss, -0.4358, bias_loss:0.0000
-->start_index 196
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9811320754716981
-->z_score:2.0876171588897705, idi:15.999906539916992, p_hat:0.16326434910297394, n:98.0
Epoch [19/20], Loss: -0.3621, acc_loss, -0.3621, bias_loss:0.0000
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:1.749879002571106, idi:14.996875762939453, p_hat:0.15302933752536774, n:98.0
Epoch [19/20], Loss: -0.3571, acc_loss, -0.3571, bias_loss:0.0000
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:-0.9429265856742859, idi:6.999650955200195, p_hat:0.07142501324415207, n:98.0
Epoch [19/20], Loss: -0.3525, acc_loss, -0.3525, bias_loss:0.0000
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.4142109155654907, idi:13.999991416931152, p_hat:0.14285705983638763, n:98.0
Epoch [19/20], Loss: -0.3296, acc_loss, -0.3296, bias_loss:0.0000
-->start_index 588
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9673202614379085
-->z_score:1.3866297006607056, idi:13.918079376220703, p_hat:0.14202122390270233, n:98.0
Epoch [19/20], Loss: -0.1097, acc_loss, -0.1097, bias_loss:0.0000
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9876543209876543
-->z_score:2.934048891067505, idi:18.51367950439453, p_hat:0.18891510367393494, n:98.0
Epoch [19/20], Loss: -0.4908, acc_loss, -0.4908, bias_loss:0.0000
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.6060916781425476, idi:8.0, p_hat:0.08163265138864517, n:98.0
Epoch [19/20], Loss: -0.4498, acc_loss, -0.4498, bias_loss:0.0000
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.903344750404358, idi:15.452644348144531, p_hat:0.15768004953861237, n:98.0
Epoch [19/20], Loss: -0.4332, acc_loss, -0.4332, bias_loss:0.0000
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.47969532012939453, idi:11.22462272644043, p_hat:0.11453696340322495, n:98.0
Epoch [19/20], Loss: -0.2958, acc_loss, -0.2958, bias_loss:0.0000
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:1.0774836540222168, idi:12.999963760375977, p_hat:0.13265268504619598, n:98.0
Epoch [19/20], Loss: -0.5311, acc_loss, -0.5311, bias_loss:0.0000
-->start_index 1176
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [19/20], Loss: -0.4903, acc_loss, -0.4903, bias_loss:0.0000
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9729729729729729
-->z_score:2.3988165855407715, idi:16.924121856689453, p_hat:0.1726951152086258, n:98.0
Epoch [19/20], Loss: -0.4047, acc_loss, -0.4047, bias_loss:0.0000
-->start_index 1372
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9659863945578231
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [19/20], Loss: -0.4178, acc_loss, -0.4178, bias_loss:0.0000
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:1.7507822513580322, idi:14.999557495117188, p_hat:0.15305671095848083, n:98.0
Epoch [19/20], Loss: -0.3777, acc_loss, -0.3777, bias_loss:0.0000
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:2.052046537399292, idi:15.894267082214355, p_hat:0.162186399102211, n:98.0
Epoch [19/20], Loss: -0.4052, acc_loss, -0.4052, bias_loss:0.0000
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.06733742356300354, idi:9.999981880187988, p_hat:0.10204063355922699, n:98.0
Epoch [19/20], Loss: -0.3320, acc_loss, -0.3320, bias_loss:0.0000
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:0.8550282120704651, idi:12.339303970336914, p_hat:0.12591126561164856, n:98.0
Epoch [19/20], Loss: -0.4551, acc_loss, -0.4551, bias_loss:0.0000
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.9428272247314453, idi:6.999946594238281, p_hat:0.07142802327871323, n:98.0
Epoch [19/20], Loss: -0.5127, acc_loss, -0.5127, bias_loss:0.0000
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [19/20], Loss: -0.4888, acc_loss, -0.4888, bias_loss:0.0000
-->after epoch 18
-->overall baseline on training dataset
-->ACC 0.9875867592098239
-->F1 0.993045689075002
-->FPR: 0.06411837237977805
-->FNR: 0.006136805867385122
-->overall baseline on testing dataset
-->ACC 0.9115540330115229
-->F1 0.95033228401539
-->FPR: 0.45454545454545453
-->FNR: 0.03857041755130927
training dataset
-->original metric score:
-->individual metric:0.13209442491210446, num_idi:263, num_all:1991
-->individual metric 0.13209442491210446
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.986627043090639
-->F1 0.9922480620155039
-->FPR 0.043478260869565216
-->FNR 0.008605851979345954
-->positive probability:0.861812778603269, 580/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9742268041237113
-->F1 0.9847094801223242
-->FPR 0.08196721311475409
-->FNR 0.01529051987767584
-->positive probability:0.8427835051546392, 327/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.96
-->F1 0.9767441860465116
-->FPR 0.14285714285714285
-->FNR 0.023255813953488372
-->positive probability:0.86, 43/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9411764705882353
-->F1 0.9444444444444444
-->FPR 0.11764705882352941
-->FNR 0.0
-->positive probability:0.5588235294117647, 19/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9197860962566845
-->F1 0.9282296650717704
-->FPR 0.0963855421686747
-->FNR 0.0673076923076923
-->positive probability:0.5614973262032086, 105/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9621621621621622
-->F1 0.9717741935483871
-->FPR 0.049586776859504134
-->FNR 0.0321285140562249
-->positive probability:0.6675675675675675, 247/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9573033707865168
-->F1 0.972463768115942
-->FPR 0.07653061224489796
-->FNR 0.03314121037463977
-->positive probability:0.7707865168539326, 686/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.020640111510212833, 0.017848840734976043, 0.016499324760730433, 0.0787387704773648, 0.05352868644375136, 0.032267169788896655, 0.014531595520273916, 0.012412239865119912]
-->fnr_diff [0.002469046111960833, 0.00915371401029072, 0.09386319413261489, 0.01711900808610325, 0.006136805867385122, 0.06117088644030718, 0.025991708188839776, 0.027004404507254647]
-->FPR:[0.043478260869565216, 0.08196721311475409, 0.047619047619047616, 0.14285714285714285, 0.11764705882352941, 0.0963855421686747, 0.049586776859504134, 0.07653061224489796], mean FPR:0.08200895681963949, mean FPR diff:0.030808342387665746
-->FNR:[0.008605851979345954, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.0321285140562249, 0.03314121037463977], mean FNR:0.03496620031863339, mean FNR diff:0.030363595918094552
-->mean fnr diff metric 0.030808342387665746
testing dataset
-->original metric score:
-->individual metric:0.18912529550827423, num_idi:160, num_all:846
-->individual metric 0.18912529550827423
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8698630136986302
-->F1 0.923076923076923
-->FPR 0.43478260869565216
-->FNR 0.07317073170731707
-->positive probability:0.8493150684931506, 248/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9044117647058822
-->FPR 0.37209302325581395
-->FNR 0.07518796992481203
-->positive probability:0.7897727272727273, 139/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6923076923076923
-->F1 0.7777777777777777
-->FPR 0.6
-->FNR 0.125
-->positive probability:0.7692307692307693, 10/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7466666666666667
-->FPR 0.375
-->FNR 0.125
-->positive probability:0.5972222222222222, 43/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.732484076433121
-->F1 0.787878787878788
-->FPR 0.421875
-->FNR 0.16129032258064516
-->positive probability:0.6687898089171974, 105/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8188976377952756
-->F1 0.8859504132231405
-->FPR 0.5
-->FNR 0.08532423208191127
-->positive probability:0.8188976377952756, 312/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.01976284584980237, 0.08245243128964058, 0.45454545454545453, 0.2121212121212121, 0.14545454545454545, 0.07954545454545453, 0.03267045454545453, 0.04545454545454547]
-->fnr_diff [0.0346003141560078, 0.036617552373502754, 0.07254069355980183, 0.03857041755130927, 0.08642958244869073, 0.08642958244869073, 0.12271990502933589, 0.046753814530602]
-->FPR:[0.43478260869565216, 0.37209302325581395, 0.0, 0.6666666666666666, 0.6, 0.375, 0.421875, 0.5], mean FPR:0.4213021623272666, mean FPR diff:0.13400086797576372
-->FNR:[0.07317073170731707, 0.07518796992481203, 0.1111111111111111, 0.0, 0.125, 0.125, 0.16129032258064516, 0.08532423208191127], mean FNR:0.09451054592572458, mean FNR diff:0.06558273276224263
-->mean fnr diff metric 0.13400086797576372
-->epoch 19
-->start_index 0
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9610389610389611
-->z_score:1.2558566331863403, idi:13.529703140258789, p_hat:0.13805820047855377, n:98.0
Epoch [20/20], Loss: -0.2177, acc_loss, -0.2177, bias_loss:0.0000
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [20/20], Loss: -0.4360, acc_loss, -0.4360, bias_loss:0.0000
-->start_index 196
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9811320754716981
-->z_score:2.087620973587036, idi:15.999917984008789, p_hat:0.1632644683122635, n:98.0
Epoch [20/20], Loss: -0.3636, acc_loss, -0.3636, bias_loss:0.0000
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:1.7497000694274902, idi:14.996343612670898, p_hat:0.15302391350269318, n:98.0
Epoch [20/20], Loss: -0.3599, acc_loss, -0.3599, bias_loss:0.0000
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:-0.944491982460022, idi:6.995002269744873, p_hat:0.07137757539749146, n:98.0
Epoch [20/20], Loss: -0.3527, acc_loss, -0.3527, bias_loss:0.0000
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.4142128229141235, idi:13.999998092651367, p_hat:0.1428571194410324, n:98.0
Epoch [20/20], Loss: -0.3298, acc_loss, -0.3298, bias_loss:0.0000
-->start_index 588
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9673202614379085
-->z_score:1.39151930809021, idi:13.932601928710938, p_hat:0.14216940104961395, n:98.0
Epoch [20/20], Loss: -0.1128, acc_loss, -0.1128, bias_loss:0.0000
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9876543209876543
-->z_score:2.9700934886932373, idi:18.6207275390625, p_hat:0.19000741839408875, n:98.0
Epoch [20/20], Loss: -0.4903, acc_loss, -0.4903, bias_loss:0.0000
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.6060919165611267, idi:7.999999046325684, p_hat:0.08163264393806458, n:98.0
Epoch [20/20], Loss: -0.4504, acc_loss, -0.4504, bias_loss:0.0000
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.9405505657196045, idi:15.563140869140625, p_hat:0.15880756080150604, n:98.0
Epoch [20/20], Loss: -0.4338, acc_loss, -0.4338, bias_loss:0.0000
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.4656972289085388, idi:11.183050155639648, p_hat:0.11411275714635849, n:98.0
Epoch [20/20], Loss: -0.2983, acc_loss, -0.2983, bias_loss:0.0000
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:1.077308177947998, idi:12.999441146850586, p_hat:0.13264736533164978, n:98.0
Epoch [20/20], Loss: -0.5310, acc_loss, -0.5310, bias_loss:0.0000
-->start_index 1176
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [20/20], Loss: -0.4911, acc_loss, -0.4911, bias_loss:0.0000
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9729729729729729
-->z_score:2.4125959873199463, idi:16.965044021606445, p_hat:0.173112690448761, n:98.0
Epoch [20/20], Loss: -0.4051, acc_loss, -0.4051, bias_loss:0.0000
-->start_index 1372
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9659863945578231
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [20/20], Loss: -0.4183, acc_loss, -0.4183, bias_loss:0.0000
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:1.7509139776229858, idi:14.99994945526123, p_hat:0.1530607044696808, n:98.0
Epoch [20/20], Loss: -0.3775, acc_loss, -0.3775, bias_loss:0.0000
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:2.067045211791992, idi:15.938810348510742, p_hat:0.16264092922210693, n:98.0
Epoch [20/20], Loss: -0.4061, acc_loss, -0.4061, bias_loss:0.0000
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.06734111160039902, idi:9.999993324279785, p_hat:0.10204074531793594, n:98.0
Epoch [20/20], Loss: -0.3316, acc_loss, -0.3316, bias_loss:0.0000
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:0.910027801990509, idi:12.502644538879395, p_hat:0.127578005194664, n:98.0
Epoch [20/20], Loss: -0.4559, acc_loss, -0.4559, bias_loss:0.0000
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.9428225755691528, idi:6.999959945678711, p_hat:0.07142816483974457, n:98.0
Epoch [20/20], Loss: -0.5132, acc_loss, -0.5132, bias_loss:0.0000
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [20/20], Loss: -0.4896, acc_loss, -0.4896, bias_loss:0.0000
-->after epoch 19
-->overall baseline on training dataset
-->ACC 0.9875867592098239
-->F1 0.993045689075002
-->FPR: 0.06411837237977805
-->FNR: 0.006136805867385122
-->overall baseline on testing dataset
-->ACC 0.9115540330115229
-->F1 0.95033228401539
-->FPR: 0.45454545454545453
-->FNR: 0.03857041755130927
training dataset
-->original metric score:
-->individual metric:0.13209442491210446, num_idi:263, num_all:1991
-->individual metric 0.13209442491210446
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.986627043090639
-->F1 0.9922480620155039
-->FPR 0.043478260869565216
-->FNR 0.008605851979345954
-->positive probability:0.861812778603269, 580/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9742268041237113
-->F1 0.9847094801223242
-->FPR 0.08196721311475409
-->FNR 0.01529051987767584
-->positive probability:0.8427835051546392, 327/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.96
-->F1 0.9767441860465116
-->FPR 0.14285714285714285
-->FNR 0.023255813953488372
-->positive probability:0.86, 43/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9411764705882353
-->F1 0.9444444444444444
-->FPR 0.11764705882352941
-->FNR 0.0
-->positive probability:0.5588235294117647, 19/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9197860962566845
-->F1 0.9282296650717704
-->FPR 0.0963855421686747
-->FNR 0.0673076923076923
-->positive probability:0.5614973262032086, 105/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9621621621621622
-->F1 0.9717741935483871
-->FPR 0.049586776859504134
-->FNR 0.0321285140562249
-->positive probability:0.6675675675675675, 247/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9573033707865168
-->F1 0.972463768115942
-->FPR 0.07653061224489796
-->FNR 0.03314121037463977
-->positive probability:0.7707865168539326, 686/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.020640111510212833, 0.017848840734976043, 0.016499324760730433, 0.0787387704773648, 0.05352868644375136, 0.032267169788896655, 0.014531595520273916, 0.012412239865119912]
-->fnr_diff [0.002469046111960833, 0.00915371401029072, 0.09386319413261489, 0.01711900808610325, 0.006136805867385122, 0.06117088644030718, 0.025991708188839776, 0.027004404507254647]
-->FPR:[0.043478260869565216, 0.08196721311475409, 0.047619047619047616, 0.14285714285714285, 0.11764705882352941, 0.0963855421686747, 0.049586776859504134, 0.07653061224489796], mean FPR:0.08200895681963949, mean FPR diff:0.030808342387665746
-->FNR:[0.008605851979345954, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.0321285140562249, 0.03314121037463977], mean FNR:0.03496620031863339, mean FNR diff:0.030363595918094552
-->mean fnr diff metric 0.030808342387665746
testing dataset
-->original metric score:
-->individual metric:0.19030732860520094, num_idi:161, num_all:846
-->individual metric 0.19030732860520094
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8698630136986302
-->F1 0.923076923076923
-->FPR 0.43478260869565216
-->FNR 0.07317073170731707
-->positive probability:0.8493150684931506, 248/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9044117647058822
-->FPR 0.37209302325581395
-->FNR 0.07518796992481203
-->positive probability:0.7897727272727273, 139/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7368421052631579
-->FPR 0.8
-->FNR 0.125
-->positive probability:0.8461538461538461, 11/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7466666666666667
-->FPR 0.375
-->FNR 0.125
-->positive probability:0.5972222222222222, 43/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.732484076433121
-->F1 0.787878787878788
-->FPR 0.421875
-->FNR 0.16129032258064516
-->positive probability:0.6687898089171974, 105/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8188976377952756
-->F1 0.8859504132231405
-->FPR 0.5
-->FNR 0.08532423208191127
-->positive probability:0.8188976377952756, 312/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.01976284584980237, 0.08245243128964058, 0.45454545454545453, 0.2121212121212121, 0.3454545454545455, 0.07954545454545453, 0.03267045454545453, 0.04545454545454547]
-->fnr_diff [0.0346003141560078, 0.036617552373502754, 0.07254069355980183, 0.03857041755130927, 0.08642958244869073, 0.08642958244869073, 0.12271990502933589, 0.046753814530602]
-->FPR:[0.43478260869565216, 0.37209302325581395, 0.0, 0.6666666666666666, 0.8, 0.375, 0.421875, 0.5], mean FPR:0.44630216232726655, mean FPR diff:0.1590008679757637
-->FNR:[0.07317073170731707, 0.07518796992481203, 0.1111111111111111, 0.0, 0.125, 0.125, 0.16129032258064516, 0.08532423208191127], mean FNR:0.09451054592572458, mean FNR diff:0.06558273276224263
-->mean fnr diff metric 0.1590008679757637
    train_ind  train_acc  train_f1  ...   test_f1  test_fpr  test_fnr
0    0.130085   0.987053  0.992748  ...  0.952863  0.449351  0.034324
1    0.141135   0.986919  0.992666  ...  0.951262  0.428571  0.039986
2    0.136113   0.986919  0.992669  ...  0.951365  0.444156  0.037863
3    0.137619   0.986919  0.992670  ...  0.951531  0.441558  0.037863
4    0.138624   0.987186  0.992820  ...  0.951348  0.441558  0.038217
5    0.135610   0.987320  0.992895  ...  0.951548  0.444156  0.037509
6    0.135610   0.987320  0.992895  ...  0.951514  0.438961  0.038217
7    0.134103   0.987453  0.992970  ...  0.951698  0.438961  0.037863
8    0.134103   0.987587  0.993046  ...  0.951365  0.444156  0.037863
9    0.133601   0.987720  0.993121  ...  0.951198  0.446753  0.037863
10   0.132597   0.987854  0.993195  ...  0.951198  0.446753  0.037863
11   0.133099   0.987854  0.993195  ...  0.951198  0.446753  0.037863
12   0.132597   0.987587  0.993046  ...  0.950848  0.449351  0.038217
13   0.133099   0.987587  0.993046  ...  0.950665  0.449351  0.038570
14   0.132597   0.987720  0.993120  ...  0.950665  0.449351  0.038570
15   0.132597   0.987720  0.993120  ...  0.950499  0.451948  0.038570
16   0.132597   0.987720  0.993120  ...  0.950499  0.451948  0.038570
17   0.133099   0.987720  0.993120  ...  0.950499  0.451948  0.038570
18   0.132094   0.987587  0.993046  ...  0.950332  0.454545  0.038570
19   0.132094   0.987587  0.993046  ...  0.950332  0.454545  0.038570

[20 rows x 10 columns]
-->gamma 0.1
-->model.parameters() <generator object Module.parameters at 0x7fea428b35f0>
-->classifier <generator object Module.parameters at 0x7fea428b35f0>
-->orig_weight tensor([[-2.7050e-02,  4.2381e-03, -1.3482e-02,  ...,  1.2411e-02,
          3.7255e-02, -3.9176e-02],
        [-1.6160e-04, -5.5718e-04,  2.1560e-02,  ..., -1.0290e-02,
         -1.5954e-02,  4.3106e-02],
        [-4.8262e-02,  1.2085e-02,  2.5940e-02,  ...,  4.3119e-02,
          5.2135e-03,  1.1908e-03],
        ...,
        [-1.6197e-02, -3.1305e-02,  1.1135e-03,  ...,  2.0616e-02,
          3.7840e-02,  2.0713e-02],
        [ 3.6338e-02, -1.5780e-02, -8.8916e-03,  ...,  4.2007e-05,
         -5.7139e-03,  3.4055e-02],
        [ 2.0367e-02,  3.0029e-02,  1.2986e-03,  ...,  1.7680e-02,
          1.9854e-02,  1.3992e-03]], device='cuda:0', grad_fn=<CloneBackward0>)
-->orig_bias tensor([-0.0116, -0.0210,  0.0217,  0.0088, -0.0158,  0.0344,  0.0329,  0.0114,
        -0.0113,  0.0101, -0.0123,  0.0298,  0.0191, -0.0280,  0.0217, -0.0261,
        -0.0226, -0.0219, -0.0056, -0.0423, -0.0077, -0.0366, -0.0331,  0.0237,
         0.0078,  0.0029,  0.0201,  0.0046,  0.0325, -0.0150, -0.0311, -0.0404,
        -0.0085, -0.0056,  0.0049,  0.0359, -0.0206,  0.0004, -0.0202, -0.0041,
        -0.0358, -0.0391, -0.0222,  0.0181, -0.0347,  0.0096, -0.0068, -0.0300,
         0.0209, -0.0096, -0.0094, -0.0020,  0.0316,  0.0157, -0.0302, -0.0400,
        -0.0295, -0.0276, -0.0201, -0.0344, -0.0144], device='cuda:0',
       grad_fn=<CloneBackward0>)
-->MinValue:-3.2998316455372216, MaxValue:4.6572209567471345
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.9836552748885586
-->F1 0.9905254091300603
-->FPR 0.05434782608695652
-->FNR 0.010327022375215147
-->positive probability:0.861812778603269, 580/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9716494845360825
-->F1 0.9832572298325722
-->FPR 0.11475409836065574
-->FNR 0.012232415902140673
-->positive probability:0.8505154639175257, 330/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.98
-->F1 0.988235294117647
-->FPR 0.0
-->FNR 0.023255813953488372
-->positive probability:0.84, 42/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9117647058823529
-->F1 0.9189189189189189
-->FPR 0.17647058823529413
-->FNR 0.0
-->positive probability:0.5882352941176471, 20/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9037433155080213
-->F1 0.9134615384615384
-->FPR 0.10843373493975904
-->FNR 0.08653846153846154
-->positive probability:0.5561497326203209, 104/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9540540540540541
-->F1 0.9656565656565655
-->FPR 0.05785123966942149
-->FNR 0.040160642570281124
-->positive probability:0.6648648648648648, 246/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9550561797752809
-->F1 0.9710144927536232
-->FPR 0.08163265306122448
-->FNR 0.0345821325648415
-->positive probability:0.7707865168539326, 686/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.004838363913043479, 0.05556790836065574, 0.011567142380952383, 0.05918619, 0.11728439823529413, 0.04924754493975904, 0.0013349503305785104, 0.022446463061224484]
-->fnr_diff [0.003441825375215147, 0.005347218902140673, 0.09311480300000001, 0.016370616953488373, 0.006885197, 0.07965326453846154, 0.03327544557028112, 0.027696935564841502]
-->FPR: [0.05434782608695652, 0.11475409836065574, 0.047619047619047616, 0.0, 0.17647058823529413, 0.10843373493975904, 0.05785123966942149, 0.08163265306122448], mean FPR:0.08013864849654488, mean FPR diff:0.04018412015268847
-->FNR: [0.010327022375215147, 0.012232415902140673, 0.1, 0.023255813953488372, 0.0, 0.08653846153846154, 0.040160642570281124, 0.0345821325648415], mean FNR:0.03838706111305354, mean FNR diff:0.033223163363053546
-->base group metric 0.04018412015268847 0.08013864849654488
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8835616438356164
-->F1 0.9322709163346613
-->FPR 0.4782608695652174
-->FNR 0.04878048780487805
-->positive probability:0.8767123287671232, 256/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9057971014492754
-->FPR 0.4186046511627907
-->FNR 0.06015037593984962
-->positive probability:0.8125, 143/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7058823529411765
-->FPR 0.6
-->FNR 0.25
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7222222222222222
-->F1 0.7368421052631579
-->FPR 0.4
-->FNR 0.125
-->positive probability:0.6111111111111112, 44/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7770700636942676
-->F1 0.8275862068965516
-->FPR 0.40625
-->FNR 0.0967741935483871
-->positive probability:0.7006369426751592, 110/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8320209973753281
-->F1 0.8950819672131147
-->FPR 0.5
-->FNR 0.06825938566552901
-->positive probability:0.8320209973753281, 317/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.4190746795652174, 0.35941846116279075, 0.05918619, 0.6074804766666666, 0.54081381, 0.34081381, 0.34706381, 0.44081381]
-->fnr_diff [0.04189529080487805, 0.05326517893984962, 0.10422591411111111, 0.006885197, 0.243114803, 0.118114803, 0.0898889965483871, 0.06137418866552901]
-->FPR: [0.4782608695652174, 0.4186046511627907, 0.0, 0.6666666666666666, 0.6, 0.4, 0.40625, 0.5], mean FPR:0.43372277342433435, mean FPR diff:0.3893331309243343
-->FNR: [0.04878048780487805, 0.06015037593984962, 0.1111111111111111, 0.0, 0.25, 0.125, 0.0967741935483871, 0.06825938566552901], mean FNR:0.09500944425871936, mean FNR diff:0.08984554650871936
-->base group metric 0.3893331309243343 0.43372277342433435
-->epoch 0
-->start_index 0
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9610389610389611
-->z_score:1.2602529525756836, idi:13.542760848999023, p_hat:0.13819143176078796, n:98.0
Epoch [1/20], Loss: -0.1605, acc_loss, -0.2178, bias_loss:0.0573
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:0.3989923596382141, idi:10.984947204589844, p_hat:0.1120912954211235, n:98.0
Epoch [1/20], Loss: -0.2031, acc_loss, -0.2496, bias_loss:0.0465
-->start_index 196
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [1/20], Loss: -0.2714, acc_loss, -0.3179, bias_loss:0.0465
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:1.7499680519104004, idi:14.997138977050781, p_hat:0.15303203463554382, n:98.0
Epoch [1/20], Loss: -0.3099, acc_loss, -0.3734, bias_loss:0.0635
-->start_index 392
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9743589743589743
-->z_score:-1.2795270681381226, idi:5.999999046325684, p_hat:0.06122447922825813, n:98.0
Epoch [1/20], Loss: -0.3075, acc_loss, -0.3329, bias_loss:0.0254
-->start_index 490
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.958904109589041
-->z_score:1.4142138957977295, idi:14.0, p_hat:0.1428571492433548, n:98.0
Epoch [1/20], Loss: -0.2527, acc_loss, -0.3119, bias_loss:0.0592
-->start_index 588
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.961038961038961
-->z_score:1.4068278074264526, idi:13.97806453704834, p_hat:0.142633318901062, n:98.0
Epoch [1/20], Loss: 0.0417, acc_loss, -0.0175, bias_loss:0.0592
-->start_index 686
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9938650306748467
-->z_score:2.6549603939056396, idi:17.684829711914062, p_hat:0.1804574429988861, n:98.0
Epoch [1/20], Loss: -0.3946, acc_loss, -0.4695, bias_loss:0.0748
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.2693740427494049, idi:9.0, p_hat:0.09183673560619354, n:98.0
Epoch [1/20], Loss: -0.4251, acc_loss, -0.4631, bias_loss:0.0381
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.3712882995605469, idi:13.872517585754395, p_hat:0.14155630767345428, n:98.0
Epoch [1/20], Loss: -0.3424, acc_loss, -0.4011, bias_loss:0.0587
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [1/20], Loss: -0.1992, acc_loss, -0.2457, bias_loss:0.0465
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.7407753467559814, idi:11.999990463256836, p_hat:0.1224488839507103, n:98.0
Epoch [1/20], Loss: -0.4430, acc_loss, -0.4938, bias_loss:0.0508
-->start_index 1176
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9871794871794872
-->z_score:0.7396259903907776, idi:11.996577262878418, p_hat:0.12241405248641968, n:98.0
Epoch [1/20], Loss: -0.4180, acc_loss, -0.4688, bias_loss:0.0508
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.7504684925079346, idi:14.998625755310059, p_hat:0.15304720401763916, n:98.0
Epoch [1/20], Loss: -0.3041, acc_loss, -0.3676, bias_loss:0.0635
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.7231265902519226, idi:11.947576522827148, p_hat:0.12191404402256012, n:98.0
Epoch [1/20], Loss: -0.3556, acc_loss, -0.4061, bias_loss:0.0506
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [1/20], Loss: -0.3058, acc_loss, -0.3609, bias_loss:0.0550
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.4124706983566284, idi:13.994823455810547, p_hat:0.1428043246269226, n:98.0
Epoch [1/20], Loss: -0.3544, acc_loss, -0.4136, bias_loss:0.0592
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.06733964383602142, idi:9.999988555908203, p_hat:0.10204070061445236, n:98.0
Epoch [1/20], Loss: -0.2416, acc_loss, -0.2839, bias_loss:0.0423
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:-0.2693920135498047, idi:8.999946594238281, p_hat:0.09183619171380997, n:98.0
Epoch [1/20], Loss: -0.3923, acc_loss, -0.4303, bias_loss:0.0381
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-1.2893216609954834, idi:5.970910549163818, p_hat:0.06092765927314758, n:98.0
Epoch [1/20], Loss: -0.4970, acc_loss, -0.5223, bias_loss:0.0253
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [1/20], Loss: -0.4395, acc_loss, -0.4656, bias_loss:0.0262
-->after epoch 0
-->overall baseline on training dataset
-->ACC 0.98718633208756
-->F1 0.9928272564255828
-->FPR: 0.07274969173859433
-->FNR: 0.005538093099835354
-->overall baseline on testing dataset
-->ACC 0.912488321395204
-->F1 0.9510708688838586
-->FPR: 0.4831168831168831
-->FNR: 0.033616418966737435
training dataset
-->original metric score:
-->individual metric:0.12506278252134606, num_idi:249, num_all:1991
-->individual metric 0.12506278252134606
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.986627043090639
-->F1 0.9922613929492692
-->FPR 0.05434782608695652
-->FNR 0.0068846815834767644
-->positive probability:0.8647845468053492, 582/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9716494845360825
-->F1 0.983206106870229
-->FPR 0.09836065573770492
-->FNR 0.01529051987767584
-->positive probability:0.845360824742268, 328/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.94
-->F1 0.9655172413793104
-->FPR 0.2857142857142857
-->FNR 0.023255813953488372
-->positive probability:0.88, 44/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9117647058823529
-->F1 0.9189189189189189
-->FPR 0.17647058823529413
-->FNR 0.0
-->positive probability:0.5882352941176471, 20/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9090909090909091
-->F1 0.919431279620853
-->FPR 0.12048192771084337
-->FNR 0.0673076923076923
-->positive probability:0.5721925133689839, 107/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9594594594594594
-->F1 0.969939879759519
-->FPR 0.06611570247933884
-->FNR 0.028112449799196786
-->positive probability:0.6756756756756757, 250/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9606741573033708
-->F1 0.9747656813266042
-->FPR 0.08673469387755102
-->FNR 0.025936599423631124
-->positive probability:0.7786516853932585, 693/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.01840186565163781, 0.025610963999110586, 0.025130644119546713, 0.21296459397569137, 0.1037208964966998, 0.04773223597224904, 0.006633989259255485, 0.01398500213895669]
-->fnr_diff [0.00134658848364141, 0.009752426777840486, 0.09446190690016465, 0.017717720853653016, 0.005538093099835354, 0.06176959920785695, 0.022574356699361434, 0.02039850632379577]
-->FPR:[0.05434782608695652, 0.09836065573770492, 0.047619047619047616, 0.2857142857142857, 0.17647058823529413, 0.12048192771084337, 0.06611570247933884, 0.08673469387755102], mean FPR:0.11698059093262775, mean FPR diff:0.056772523951643436
-->FNR:[0.0068846815834767644, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.028112449799196786, 0.025936599423631124], mean FNR:0.03334846961814515, mean FNR diff:0.029194899793268635
-->mean fnr diff metric 0.056772523951643436
testing dataset
-->original metric score:
-->individual metric:0.18557919621749408, num_idi:157, num_all:846
-->individual metric 0.18557919621749408
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8732876712328768
-->F1 0.9258517034068134
-->FPR 0.4782608695652174
-->FNR 0.06097560975609756
-->positive probability:0.8664383561643836, 253/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8409090909090909
-->F1 0.8978102189781022
-->FPR 0.4186046511627907
-->FNR 0.07518796992481203
-->positive probability:0.8011363636363636, 141/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7058823529411765
-->FPR 0.6
-->FNR 0.25
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7222222222222222
-->F1 0.7368421052631579
-->FPR 0.4
-->FNR 0.125
-->positive probability:0.6111111111111112, 44/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7452229299363057
-->F1 0.801980198019802
-->FPR 0.4375
-->FNR 0.12903225806451613
-->positive probability:0.6942675159235668, 109/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.821522309711286
-->F1 0.8885245901639345
-->FPR 0.5227272727272727
-->FNR 0.07508532423208192
-->positive probability:0.8320209973753281, 317/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.0048560135516657055, 0.06451223195409239, 0.4831168831168831, 0.18354978354978352, 0.11688311688311687, 0.08311688311688309, 0.04561688311688311, 0.039610389610389596]
-->fnr_diff [0.027359190789360124, 0.04157155095807459, 0.07749469214437367, 0.033616418966737435, 0.21638358103326255, 0.09138358103326256, 0.09541583909777869, 0.04146890526534448]
-->FPR:[0.4782608695652174, 0.4186046511627907, 0.0, 0.6666666666666666, 0.6, 0.4, 0.4375, 0.5227272727272727], mean FPR:0.44046993251524347, mean FPR diff:0.12765777311246218
-->FNR:[0.06097560975609756, 0.07518796992481203, 0.1111111111111111, 0.0, 0.25, 0.125, 0.12903225806451613, 0.07508532423208192], mean FNR:0.10329903413607734, mean FNR diff:0.07808671991102425
-->mean fnr diff metric 0.12765777311246218
-->epoch 1
-->start_index 0
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9743589743589743
-->z_score:1.4142138957977295, idi:14.0, p_hat:0.1428571492433548, n:98.0
Epoch [2/20], Loss: -0.1315, acc_loss, -0.1908, bias_loss:0.0592
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:1.739621877670288, idi:14.966412544250488, p_hat:0.15271849930286407, n:98.0
Epoch [2/20], Loss: -0.3503, acc_loss, -0.4136, bias_loss:0.0633
-->start_index 196
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9811320754716981
-->z_score:2.086719274520874, idi:15.99724006652832, p_hat:0.16323713958263397, n:98.0
Epoch [2/20], Loss: -0.2703, acc_loss, -0.3380, bias_loss:0.0677
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:1.6877565383911133, idi:14.812379837036133, p_hat:0.15114673972129822, n:98.0
Epoch [2/20], Loss: -0.2801, acc_loss, -0.3428, bias_loss:0.0627
-->start_index 392
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9743589743589743
-->z_score:-0.9942749738693237, idi:6.84715461730957, p_hat:0.06986892223358154, n:98.0
Epoch [2/20], Loss: -0.3270, acc_loss, -0.3560, bias_loss:0.0290
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.4142138957977295, idi:14.0, p_hat:0.1428571492433548, n:98.0
Epoch [2/20], Loss: -0.2703, acc_loss, -0.3296, bias_loss:0.0592
-->start_index 588
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9673202614379085
-->z_score:1.4137516021728516, idi:13.998628616333008, p_hat:0.14284314215183258, n:98.0
Epoch [2/20], Loss: -0.0853, acc_loss, -0.1445, bias_loss:0.0592
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9876543209876543
-->z_score:3.097383737564087, idi:18.998760223388672, p_hat:0.19386489689350128, n:98.0
Epoch [2/20], Loss: -0.3701, acc_loss, -0.4505, bias_loss:0.0804
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.6060919165611267, idi:7.999999046325684, p_hat:0.08163264393806458, n:98.0
Epoch [2/20], Loss: -0.3852, acc_loss, -0.4190, bias_loss:0.0339
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:2.087646722793579, idi:15.999994277954102, p_hat:0.16326524317264557, n:98.0
Epoch [2/20], Loss: -0.3471, acc_loss, -0.4148, bias_loss:0.0677
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.9574820399284363, idi:12.643576622009277, p_hat:0.12901608645915985, n:98.0
Epoch [2/20], Loss: -0.2258, acc_loss, -0.2793, bias_loss:0.0535
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [2/20], Loss: -0.4508, acc_loss, -0.5058, bias_loss:0.0550
-->start_index 1176
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [2/20], Loss: -0.4342, acc_loss, -0.4808, bias_loss:0.0465
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9729729729729729
-->z_score:2.278317451477051, idi:16.56625747680664, p_hat:0.1690434366464615, n:98.0
Epoch [2/20], Loss: -0.3304, acc_loss, -0.4005, bias_loss:0.0701
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [2/20], Loss: -0.3752, acc_loss, -0.4218, bias_loss:0.0465
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:1.7489285469055176, idi:14.99405288696289, p_hat:0.15300053358078003, n:98.0
Epoch [2/20], Loss: -0.2805, acc_loss, -0.3440, bias_loss:0.0635
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.4142118692398071, idi:13.999995231628418, p_hat:0.14285708963871002, n:98.0
Epoch [2/20], Loss: -0.3260, acc_loss, -0.3852, bias_loss:0.0592
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.0673428326845169, idi:9.999998092651367, p_hat:0.10204079747200012, n:98.0
Epoch [2/20], Loss: -0.2542, acc_loss, -0.2966, bias_loss:0.0423
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:0.09928969293832779, idi:10.09487533569336, p_hat:0.103008933365345, n:98.0
Epoch [2/20], Loss: -0.4016, acc_loss, -0.4443, bias_loss:0.0427
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-1.3393090963363647, idi:5.822455406188965, p_hat:0.05941281095147133, n:98.0
Epoch [2/20], Loss: -0.4940, acc_loss, -0.5187, bias_loss:0.0246
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [2/20], Loss: -0.4345, acc_loss, -0.4607, bias_loss:0.0262
-->after epoch 1
-->overall baseline on training dataset
-->ACC 0.9873198077949813
-->F1 0.9929014421280729
-->FPR: 0.07151664611590629
-->FNR: 0.005538093099835354
-->overall baseline on testing dataset
-->ACC 0.912488321395204
-->F1 0.9510538233757185
-->FPR: 0.4805194805194805
-->FNR: 0.03397027600849257
training dataset
-->original metric score:
-->individual metric:0.1245605223505776, num_idi:248, num_all:1991
-->individual metric 0.1245605223505776
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.986627043090639
-->F1 0.9922613929492692
-->FPR 0.05434782608695652
-->FNR 0.0068846815834767644
-->positive probability:0.8647845468053492, 582/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9716494845360825
-->F1 0.983206106870229
-->FPR 0.09836065573770492
-->FNR 0.01529051987767584
-->positive probability:0.845360824742268, 328/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.94
-->F1 0.9655172413793104
-->FPR 0.2857142857142857
-->FNR 0.023255813953488372
-->positive probability:0.88, 44/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9117647058823529
-->F1 0.9189189189189189
-->FPR 0.17647058823529413
-->FNR 0.0
-->positive probability:0.5882352941176471, 20/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9090909090909091
-->F1 0.919431279620853
-->FPR 0.12048192771084337
-->FNR 0.0673076923076923
-->positive probability:0.5721925133689839, 107/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9594594594594594
-->F1 0.969939879759519
-->FPR 0.06611570247933884
-->FNR 0.028112449799196786
-->positive probability:0.6756756756756757, 250/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9595505617977528
-->F1 0.9740259740259741
-->FPR 0.08673469387755102
-->FNR 0.027377521613832854
-->positive probability:0.7775280898876404, 692/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.017168820028949767, 0.02684400962179863, 0.02389759849685867, 0.2141976395983794, 0.10495394211938784, 0.048965281594937085, 0.005400943636567443, 0.015218047761644732]
-->fnr_diff [0.00134658848364141, 0.009752426777840486, 0.09446190690016465, 0.017717720853653016, 0.005538093099835354, 0.06176959920785695, 0.022574356699361434, 0.0218394285139975]
-->FPR:[0.05434782608695652, 0.09836065573770492, 0.047619047619047616, 0.2857142857142857, 0.17647058823529413, 0.12048192771084337, 0.06611570247933884, 0.08673469387755102], mean FPR:0.11698059093262775, mean FPR diff:0.05708078535731544
-->FNR:[0.0068846815834767644, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.028112449799196786, 0.027377521613832854], mean FNR:0.033528584891920364, mean FNR diff:0.02937501506704385
-->mean fnr diff metric 0.05708078535731544
testing dataset
-->original metric score:
-->individual metric:0.18203309692671396, num_idi:154, num_all:846
-->individual metric 0.18203309692671396
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8732876712328768
-->F1 0.9255533199195171
-->FPR 0.45652173913043476
-->FNR 0.06504065040650407
-->positive probability:0.8595890410958904, 251/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8465909090909091
-->F1 0.9010989010989012
-->FPR 0.3953488372093023
-->FNR 0.07518796992481203
-->positive probability:0.7954545454545454, 140/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6923076923076923
-->F1 0.7777777777777777
-->FPR 0.6
-->FNR 0.125
-->positive probability:0.7692307692307693, 10/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7222222222222222
-->F1 0.7368421052631579
-->FPR 0.4
-->FNR 0.125
-->positive probability:0.6111111111111112, 44/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7388535031847133
-->F1 0.7980295566502462
-->FPR 0.453125
-->FNR 0.12903225806451613
-->positive probability:0.7006369426751592, 110/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8241469816272966
-->F1 0.8899835796387521
-->FPR 0.5113636363636364
-->FNR 0.07508532423208192
-->positive probability:0.8293963254593176, 316/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.023997741389045757, 0.0851706433101782, 0.4805194805194805, 0.18614718614718612, 0.11948051948051946, 0.08051948051948049, 0.027394480519480513, 0.03084415584415584]
-->fnr_diff [0.031070374398011504, 0.04121769391631946, 0.07714083510261854, 0.03397027600849257, 0.09102972399150744, 0.09102972399150744, 0.09506198205602356, 0.04111504822358935]
-->FPR:[0.45652173913043476, 0.3953488372093023, 0.0, 0.6666666666666666, 0.6, 0.4, 0.453125, 0.5113636363636364], mean FPR:0.435378234921255, mean FPR diff:0.12925921096619086
-->FNR:[0.06504065040650407, 0.07518796992481203, 0.1111111111111111, 0.0, 0.125, 0.125, 0.12903225806451613, 0.07508532423208192], mean FNR:0.08818216421737815, mean FNR diff:0.06270445721100873
-->mean fnr diff metric 0.12925921096619086
-->epoch 2
-->start_index 0
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [3/20], Loss: -0.1484, acc_loss, -0.2034, bias_loss:0.0550
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:1.7508933544158936, idi:14.999887466430664, p_hat:0.15306007862091064, n:98.0
Epoch [3/20], Loss: -0.3558, acc_loss, -0.4193, bias_loss:0.0635
-->start_index 196
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9811320754716981
-->z_score:1.904373288154602, idi:15.455699920654297, p_hat:0.1577112227678299, n:98.0
Epoch [3/20], Loss: -0.2841, acc_loss, -0.3495, bias_loss:0.0654
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:1.7332501411437988, idi:14.947490692138672, p_hat:0.1525254100561142, n:98.0
Epoch [3/20], Loss: -0.2918, acc_loss, -0.3550, bias_loss:0.0633
-->start_index 392
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9743589743589743
-->z_score:-1.6162441968917847, idi:5.0, p_hat:0.051020409911870956, n:98.0
Epoch [3/20], Loss: -0.3372, acc_loss, -0.3583, bias_loss:0.0212
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.414206862449646, idi:13.999979972839355, p_hat:0.14285694062709808, n:98.0
Epoch [3/20], Loss: -0.2774, acc_loss, -0.3367, bias_loss:0.0592
-->start_index 588
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9548387096774195
-->z_score:0.740764319896698, idi:11.999958038330078, p_hat:0.12244854867458344, n:98.0
Epoch [3/20], Loss: -0.0751, acc_loss, -0.1258, bias_loss:0.0508
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9876543209876543
-->z_score:1.401523232460022, idi:13.962310791015625, p_hat:0.14247256517410278, n:98.0
Epoch [3/20], Loss: -0.3962, acc_loss, -0.4553, bias_loss:0.0591
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.9428093433380127, idi:6.999999523162842, p_hat:0.0714285671710968, n:98.0
Epoch [3/20], Loss: -0.3939, acc_loss, -0.4235, bias_loss:0.0296
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [3/20], Loss: -0.3675, acc_loss, -0.4225, bias_loss:0.0550
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9575757575757574
-->z_score:0.4040606915950775, idi:10.999999046325684, p_hat:0.11224488914012909, n:98.0
Epoch [3/20], Loss: -0.2578, acc_loss, -0.3043, bias_loss:0.0465
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.9897713661193848, idi:12.739470481872559, p_hat:0.12999460101127625, n:98.0
Epoch [3/20], Loss: -0.4473, acc_loss, -0.5012, bias_loss:0.0539
-->start_index 1176
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9871794871794872
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [3/20], Loss: -0.4274, acc_loss, -0.4782, bias_loss:0.0508
-->start_index 1274
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9664429530201343
-->z_score:2.0876412391662598, idi:15.999977111816406, p_hat:0.16326507925987244, n:98.0
Epoch [3/20], Loss: -0.3261, acc_loss, -0.3938, bias_loss:0.0677
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [3/20], Loss: -0.3757, acc_loss, -0.4222, bias_loss:0.0465
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:1.7509139776229858, idi:14.999948501586914, p_hat:0.1530607044696808, n:98.0
Epoch [3/20], Loss: -0.2991, acc_loss, -0.3626, bias_loss:0.0635
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.414207935333252, idi:13.999983787536621, p_hat:0.14285697042942047, n:98.0
Epoch [3/20], Loss: -0.3336, acc_loss, -0.3928, bias_loss:0.0592
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.06701265275478363, idi:9.999017715454102, p_hat:0.10203079134225845, n:98.0
Epoch [3/20], Loss: -0.2507, acc_loss, -0.2930, bias_loss:0.0423
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:0.40401867032051086, idi:10.999874114990234, p_hat:0.11224361509084702, n:98.0
Epoch [3/20], Loss: -0.4162, acc_loss, -0.4628, bias_loss:0.0465
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-1.6162490844726562, idi:4.999985694885254, p_hat:0.05102026090025902, n:98.0
Epoch [3/20], Loss: -0.5005, acc_loss, -0.5217, bias_loss:0.0212
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [3/20], Loss: -0.4686, acc_loss, -0.4947, bias_loss:0.0262
-->after epoch 2
-->overall baseline on training dataset
-->ACC 0.9873198077949813
-->F1 0.9928971962616824
-->FPR: 0.06658446362515413
-->FNR: 0.006136805867385122
-->overall baseline on testing dataset
-->ACC 0.9118654624727499
-->F1 0.9505676855895197
-->FPR: 0.4623376623376623
-->FNR: 0.037154989384288746
training dataset
-->original metric score:
-->individual metric:0.12405826217980914, num_idi:247, num_all:1991
-->individual metric 0.12405826217980914
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.9881129271916791
-->F1 0.9931153184165232
-->FPR 0.043478260869565216
-->FNR 0.0068846815834767644
-->positive probability:0.8632986627043091, 581/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9742268041237113
-->F1 0.9847094801223242
-->FPR 0.08196721311475409
-->FNR 0.01529051987767584
-->positive probability:0.8427835051546392, 327/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.94
-->F1 0.9655172413793104
-->FPR 0.2857142857142857
-->FNR 0.023255813953488372
-->positive probability:0.88, 44/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9411764705882353
-->F1 0.9444444444444444
-->FPR 0.11764705882352941
-->FNR 0.0
-->positive probability:0.5588235294117647, 19/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9090909090909091
-->F1 0.919431279620853
-->FPR 0.12048192771084337
-->FNR 0.0673076923076923
-->positive probability:0.5721925133689839, 107/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9621621621621622
-->F1 0.9718875502008032
-->FPR 0.05785123966942149
-->FNR 0.028112449799196786
-->positive probability:0.672972972972973, 249/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9584269662921349
-->F1 0.9732465654374548
-->FPR 0.08163265306122448
-->FNR 0.03025936599423631
-->positive probability:0.7741573033707865, 689/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.023106202755588917, 0.015382749489599959, 0.018965416006106517, 0.21912982208913157, 0.05106259519837528, 0.05389746408568924, 0.008733223955732644, 0.01504818943607035]
-->fnr_diff [0.0007478757160916429, 0.00915371401029072, 0.09386319413261489, 0.01711900808610325, 0.006136805867385122, 0.06117088644030718, 0.021975643931811666, 0.02412256012685119]
-->FPR:[0.043478260869565216, 0.08196721311475409, 0.047619047619047616, 0.2857142857142857, 0.11764705882352941, 0.12048192771084337, 0.05785123966942149, 0.08163265306122448], mean FPR:0.10454896082283392, mean FPR diff:0.05066570787703681
-->FNR:[0.0068846815834767644, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.028112449799196786, 0.03025936599423631], mean FNR:0.033888815439470796, mean FNR diff:0.029286211038931958
-->mean fnr diff metric 0.05066570787703681
testing dataset
-->original metric score:
-->individual metric:0.1867612293144208, num_idi:158, num_all:846
-->individual metric 0.1867612293144208
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8732876712328768
-->F1 0.9252525252525251
-->FPR 0.43478260869565216
-->FNR 0.06910569105691057
-->positive probability:0.8527397260273972, 249/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9044117647058822
-->FPR 0.37209302325581395
-->FNR 0.07518796992481203
-->positive probability:0.7897727272727273, 139/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7368421052631579
-->FPR 0.8
-->FNR 0.125
-->positive probability:0.8461538461538461, 11/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7466666666666667
-->FPR 0.375
-->FNR 0.125
-->positive probability:0.5972222222222222, 43/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7261146496815286
-->F1 0.7839195979899497
-->FPR 0.4375
-->FNR 0.16129032258064516
-->positive probability:0.6751592356687898, 106/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8188976377952756
-->F1 0.8859504132231405
-->FPR 0.5
-->FNR 0.08532423208191127
-->positive probability:0.8188976377952756, 312/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.027555053642010163, 0.09024463908184838, 0.4623376623376623, 0.2043290043290043, 0.3376623376623377, 0.08733766233766233, 0.024837662337662325, 0.037662337662337675]
-->fnr_diff [0.031950701672621824, 0.03803298054052328, 0.07395612172682237, 0.037154989384288746, 0.08784501061571126, 0.08784501061571126, 0.12413533319635642, 0.04816924269762252]
-->FPR:[0.43478260869565216, 0.37209302325581395, 0.0, 0.6666666666666666, 0.8, 0.375, 0.4375, 0.5], mean FPR:0.44825528732726655, mean FPR diff:0.15899579492381566
-->FNR:[0.06910569105691057, 0.07518796992481203, 0.1111111111111111, 0.0, 0.125, 0.125, 0.16129032258064516, 0.08532423208191127], mean FNR:0.09400241584442376, mean FNR diff:0.0661361738062072
-->mean fnr diff metric 0.15899579492381566
-->epoch 3
-->start_index 0
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [4/20], Loss: -0.1372, acc_loss, -0.1922, bias_loss:0.0550
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:1.784621000289917, idi:15.100052833557129, p_hat:0.15408217906951904, n:98.0
Epoch [4/20], Loss: -0.3652, acc_loss, -0.4291, bias_loss:0.0639
-->start_index 196
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9811320754716981
-->z_score:2.0395522117614746, idi:15.857160568237305, p_hat:0.16180776059627533, n:98.0
Epoch [4/20], Loss: -0.2921, acc_loss, -0.3592, bias_loss:0.0671
-->start_index 294
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9813664596273292
-->z_score:1.4142128229141235, idi:13.99999713897705, p_hat:0.1428571194410324, n:98.0
Epoch [4/20], Loss: -0.3036, acc_loss, -0.3628, bias_loss:0.0592
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9681528662420382
-->z_score:-0.9430824518203735, idi:6.999188423156738, p_hat:0.07142028957605362, n:98.0
Epoch [4/20], Loss: -0.3071, acc_loss, -0.3367, bias_loss:0.0296
-->start_index 490
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.958904109589041
-->z_score:1.3901523351669312, idi:13.928542137145996, p_hat:0.14212797582149506, n:98.0
Epoch [4/20], Loss: -0.2386, acc_loss, -0.2976, bias_loss:0.0589
-->start_index 588
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9548387096774195
-->z_score:0.38808274269104004, idi:10.952547073364258, p_hat:0.1117606833577156, n:98.0
Epoch [4/20], Loss: -0.0971, acc_loss, -0.1434, bias_loss:0.0463
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9876543209876543
-->z_score:-0.6902263164520264, idi:7.7501325607299805, p_hat:0.07908298820257187, n:98.0
Epoch [4/20], Loss: -0.4094, acc_loss, -0.4422, bias_loss:0.0328
-->start_index 784
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:-0.6060916781425476, idi:8.0, p_hat:0.08163265138864517, n:98.0
Epoch [4/20], Loss: -0.3660, acc_loss, -0.3999, bias_loss:0.0339
-->start_index 882
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.974025974025974
-->z_score:1.4142138957977295, idi:14.0, p_hat:0.1428571492433548, n:98.0
Epoch [4/20], Loss: -0.3570, acc_loss, -0.4163, bias_loss:0.0592
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9575757575757574
-->z_score:0.067343570291996, idi:10.0, p_hat:0.10204081982374191, n:98.0
Epoch [4/20], Loss: -0.2682, acc_loss, -0.3106, bias_loss:0.0423
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.7404798865318298, idi:11.999113082885742, p_hat:0.1224399283528328, n:98.0
Epoch [4/20], Loss: -0.4605, acc_loss, -0.5113, bias_loss:0.0508
-->start_index 1176
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [4/20], Loss: -0.4484, acc_loss, -0.4949, bias_loss:0.0465
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9729729729729729
-->z_score:2.087648630142212, idi:16.0, p_hat:0.16326530277729034, n:98.0
Epoch [4/20], Loss: -0.3196, acc_loss, -0.3873, bias_loss:0.0677
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [4/20], Loss: -0.3929, acc_loss, -0.4395, bias_loss:0.0465
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:1.9112739562988281, idi:15.476194381713867, p_hat:0.15792034566402435, n:98.0
Epoch [4/20], Loss: -0.3161, acc_loss, -0.3816, bias_loss:0.0655
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.4133539199829102, idi:13.997446060180664, p_hat:0.14283108711242676, n:98.0
Epoch [4/20], Loss: -0.3200, acc_loss, -0.3793, bias_loss:0.0592
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.05492166802287102, idi:9.963109016418457, p_hat:0.10166437923908234, n:98.0
Epoch [4/20], Loss: -0.2122, acc_loss, -0.2544, bias_loss:0.0422
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:0.067343570291996, idi:10.0, p_hat:0.10204081982374191, n:98.0
Epoch [4/20], Loss: -0.4199, acc_loss, -0.4622, bias_loss:0.0423
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-1.6162567138671875, idi:4.99996280670166, p_hat:0.05102002993226051, n:98.0
Epoch [4/20], Loss: -0.4914, acc_loss, -0.5125, bias_loss:0.0212
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [4/20], Loss: -0.4383, acc_loss, -0.4645, bias_loss:0.0262
-->after epoch 3
-->overall baseline on training dataset
-->ACC 0.9863854778430325
-->F1 0.9923835125448028
-->FPR: 0.08138101109741061
-->FNR: 0.005388414907947912
-->overall baseline on testing dataset
-->ACC 0.912488321395204
-->F1 0.9511049243083347
-->FPR: 0.4883116883116883
-->FNR: 0.032908704883227176
training dataset
-->original metric score:
-->individual metric:0.11551983927674535, num_idi:230, num_all:1991
-->individual metric 0.11551983927674535
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.9851411589895989
-->F1 0.9914089347079037
-->FPR 0.06521739130434782
-->FNR 0.0068846815834767644
-->positive probability:0.8662704309063893, 583/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9716494845360825
-->F1 0.983206106870229
-->FPR 0.09836065573770492
-->FNR 0.01529051987767584
-->positive probability:0.845360824742268, 328/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.92
-->F1 0.9545454545454545
-->FPR 0.42857142857142855
-->FNR 0.023255813953488372
-->positive probability:0.9, 45/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9117647058823529
-->F1 0.9189189189189189
-->FPR 0.17647058823529413
-->FNR 0.0
-->positive probability:0.5882352941176471, 20/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9090909090909091
-->F1 0.92018779342723
-->FPR 0.13253012048192772
-->FNR 0.057692307692307696
-->positive probability:0.5828877005347594, 109/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9567567567567568
-->F1 0.9683794466403164
-->FPR 0.09917355371900827
-->FNR 0.01606425702811245
-->positive probability:0.6945945945945946, 257/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9550561797752809
-->F1 0.9712643678160918
-->FPR 0.11224489795918367
-->FNR 0.025936599423631124
-->positive probability:0.7842696629213484, 698/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.016163619793062786, 0.016979644640294306, 0.033761963478362994, 0.3471904174740179, 0.09508957713788352, 0.05114910938451711, 0.017792542621597657, 0.030863886861773063]
-->fnr_diff [0.001496266675528852, 0.009902104969727928, 0.09461158509205209, 0.01786739904554046, 0.005388414907947912, 0.05230389278435978, 0.010675842120164536, 0.020548184515683212]
-->FPR:[0.06521739130434782, 0.09836065573770492, 0.047619047619047616, 0.42857142857142855, 0.17647058823529413, 0.13253012048192772, 0.09917355371900827, 0.11224489795918367], mean FPR:0.14502346045349285, mean FPR diff:0.07612384517393866
-->FNR:[0.0068846815834767644, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.057692307692307696, 0.01606425702811245, 0.025936599423631124], mean FNR:0.030640522444836532, mean FNR diff:0.0265992112638756
-->mean fnr diff metric 0.07612384517393866
testing dataset
-->original metric score:
-->individual metric:0.17966903073286053, num_idi:152, num_all:846
-->individual metric 0.17966903073286053
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8732876712328768
-->F1 0.9258517034068134
-->FPR 0.4782608695652174
-->FNR 0.06097560975609756
-->positive probability:0.8664383561643836, 253/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8295454545454546
-->F1 0.8913043478260869
-->FPR 0.46511627906976744
-->FNR 0.07518796992481203
-->positive probability:0.8125, 143/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.5384615384615384
-->F1 0.7000000000000001
-->FPR 1.0
-->FNR 0.125
-->positive probability:0.9230769230769231, 12/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7222222222222222
-->F1 0.7368421052631579
-->FPR 0.4
-->FNR 0.125
-->positive probability:0.6111111111111112, 44/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7261146496815286
-->F1 0.7881773399014779
-->FPR 0.46875
-->FNR 0.13978494623655913
-->positive probability:0.7006369426751592, 110/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8162729658792651
-->F1 0.8852459016393444
-->FPR 0.5340909090909091
-->FNR 0.07849829351535836
-->positive probability:0.8320209973753281, 317/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.010050818746470902, 0.023195409241920872, 0.4883116883116883, 0.17835497835497832, 0.5116883116883117, 0.08831168831168829, 0.019561688311688308, 0.04577922077922075]
-->fnr_diff [0.028066904872870384, 0.04227926504158485, 0.07820240622788394, 0.032908704883227176, 0.09209129511677283, 0.09209129511677283, 0.10687624135333196, 0.04558958863213119]
-->FPR:[0.4782608695652174, 0.46511627906976744, 0.0, 0.6666666666666666, 1.0, 0.4, 0.46875, 0.5340909090909091], mean FPR:0.5016105905490701, mean FPR diff:0.17065672546824595
-->FNR:[0.06097560975609756, 0.07518796992481203, 0.1111111111111111, 0.0, 0.125, 0.125, 0.13978494623655913, 0.07849829351535836], mean FNR:0.08944474131799227, mean FNR diff:0.06476321265557189
-->mean fnr diff metric 0.17065672546824595
-->epoch 4
-->start_index 0
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:0.7407717108726501, idi:11.999979972839355, p_hat:0.12244877219200134, n:98.0
Epoch [5/20], Loss: -0.1634, acc_loss, -0.2142, bias_loss:0.0508
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:0.7015976309776306, idi:11.883638381958008, p_hat:0.12126161903142929, n:98.0
Epoch [5/20], Loss: -0.3313, acc_loss, -0.3816, bias_loss:0.0503
-->start_index 196
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:1.707816243171692, idi:14.871955871582031, p_hat:0.15175464749336243, n:98.0
Epoch [5/20], Loss: -0.2909, acc_loss, -0.3539, bias_loss:0.0629
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:1.7509297132492065, idi:14.999996185302734, p_hat:0.153061181306839, n:98.0
Epoch [5/20], Loss: -0.2961, acc_loss, -0.3596, bias_loss:0.0635
-->start_index 392
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9743589743589743
-->z_score:-1.2349213361740112, idi:6.132470607757568, p_hat:0.06257623434066772, n:98.0
Epoch [5/20], Loss: -0.3248, acc_loss, -0.3508, bias_loss:0.0260
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.75091552734375, idi:14.999953269958496, p_hat:0.15306074917316437, n:98.0
Epoch [5/20], Loss: -0.2671, acc_loss, -0.3305, bias_loss:0.0635
-->start_index 588
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.961038961038961
-->z_score:0.7425529360771179, idi:12.005270004272461, p_hat:0.12250275164842606, n:98.0
Epoch [5/20], Loss: -0.0777, acc_loss, -0.1285, bias_loss:0.0508
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9876543209876543
-->z_score:2.8698995113372803, idi:18.323165893554688, p_hat:0.18697108328342438, n:98.0
Epoch [5/20], Loss: -0.4029, acc_loss, -0.4805, bias_loss:0.0775
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.9428090453147888, idi:7.0, p_hat:0.0714285746216774, n:98.0
Epoch [5/20], Loss: -0.4122, acc_loss, -0.4418, bias_loss:0.0296
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.6478016376495361, idi:14.693721771240234, p_hat:0.14993593096733093, n:98.0
Epoch [5/20], Loss: -0.3766, acc_loss, -0.4388, bias_loss:0.0622
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9575757575757574
-->z_score:0.4040587544441223, idi:10.999993324279785, p_hat:0.11224482953548431, n:98.0
Epoch [5/20], Loss: -0.2725, acc_loss, -0.3190, bias_loss:0.0465
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.4040606915950775, idi:10.999999046325684, p_hat:0.11224488914012909, n:98.0
Epoch [5/20], Loss: -0.4639, acc_loss, -0.5105, bias_loss:0.0465
-->start_index 1176
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9871794871794872
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [5/20], Loss: -0.4350, acc_loss, -0.4858, bias_loss:0.0508
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.7508889436721802, idi:14.999874114990234, p_hat:0.1530599445104599, n:98.0
Epoch [5/20], Loss: -0.3319, acc_loss, -0.3953, bias_loss:0.0635
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [5/20], Loss: -0.3846, acc_loss, -0.4312, bias_loss:0.0465
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [5/20], Loss: -0.3430, acc_loss, -0.3980, bias_loss:0.0550
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.4125912189483643, idi:13.995182037353516, p_hat:0.1428079754114151, n:98.0
Epoch [5/20], Loss: -0.3489, acc_loss, -0.4081, bias_loss:0.0592
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.06645357608795166, idi:9.997357368469238, p_hat:0.10201384872198105, n:98.0
Epoch [5/20], Loss: -0.2275, acc_loss, -0.2698, bias_loss:0.0423
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:-0.2889818549156189, idi:8.941767692565918, p_hat:0.09124252945184708, n:98.0
Epoch [5/20], Loss: -0.4120, acc_loss, -0.4498, bias_loss:0.0378
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-1.6162441968917847, idi:5.0, p_hat:0.051020409911870956, n:98.0
Epoch [5/20], Loss: -0.4944, acc_loss, -0.5155, bias_loss:0.0212
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [5/20], Loss: -0.4084, acc_loss, -0.4345, bias_loss:0.0262
-->after epoch 4
-->overall baseline on training dataset
-->ACC 0.9870528563801388
-->F1 0.9927617341989403
-->FPR: 0.08384710234278668
-->FNR: 0.004340667564735818
-->overall baseline on testing dataset
-->ACC 0.9146683276237932
-->F1 0.9525129982668977
-->FPR: 0.509090909090909
-->FNR: 0.027600849256900213
training dataset
-->original metric score:
-->individual metric:0.1125062782521346, num_idi:224, num_all:1991
-->individual metric 0.1125062782521346
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.9821693907875185
-->F1 0.9897084048027444
-->FPR 0.08695652173913043
-->FNR 0.0068846815834767644
-->positive probability:0.8692421991084696, 585/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9716494845360825
-->F1 0.9832572298325722
-->FPR 0.11475409836065574
-->FNR 0.012232415902140673
-->positive probability:0.8505154639175257, 330/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.92
-->F1 0.9545454545454545
-->FPR 0.42857142857142855
-->FNR 0.023255813953488372
-->positive probability:0.9, 45/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9117647058823529
-->F1 0.9189189189189189
-->FPR 0.17647058823529413
-->FNR 0.0
-->positive probability:0.5882352941176471, 20/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.893048128342246
-->F1 0.9065420560747663
-->FPR 0.1566265060240964
-->FNR 0.0673076923076923
-->positive probability:0.5882352941176471, 110/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9540540540540541
-->F1 0.9662027833001988
-->FPR 0.09090909090909091
-->FNR 0.024096385542168676
-->positive probability:0.6864864864864865, 254/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9584269662921349
-->F1 0.9733621310295176
-->FPR 0.09693877551020408
-->FNR 0.025936599423631124
-->positive probability:0.7808988764044944, 695/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.0031094193963437516, 0.03090699601786906, 0.036228054723739064, 0.34472432622864185, 0.09262348589250745, 0.07277940368130971, 0.007061988566304231, 0.013091673167417398]
-->fnr_diff [0.002544014018740946, 0.007891748337404855, 0.09565933243526419, 0.01891514638875255, 0.004340667564735818, 0.06296702474295648, 0.019755717977432856, 0.021595931858895308]
-->FPR:[0.08695652173913043, 0.11475409836065574, 0.047619047619047616, 0.42857142857142855, 0.17647058823529413, 0.1566265060240964, 0.09090909090909091, 0.09693877551020408], mean FPR:0.14985575712111848, mean FPR diff:0.07506566845926657
-->FNR:[0.0068846815834767644, 0.012232415902140673, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.024096385542168676, 0.025936599423631124], mean FNR:0.03246419858907474, mean FNR diff:0.02920869791552288
-->mean fnr diff metric 0.07506566845926657
testing dataset
-->original metric score:
-->individual metric:0.17375886524822695, num_idi:147, num_all:846
-->individual metric 0.17375886524822695
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.886986301369863
-->F1 0.9349112426035503
-->FPR 0.5217391304347826
-->FNR 0.036585365853658534
-->positive probability:0.8938356164383562, 261/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8409090909090909
-->F1 0.8992805755395683
-->FPR 0.46511627906976744
-->FNR 0.06015037593984962
-->positive probability:0.8238636363636364, 145/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7368421052631579
-->FPR 0.8
-->FNR 0.125
-->positive probability:0.8461538461538461, 11/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.6944444444444444
-->F1 0.717948717948718
-->FPR 0.45
-->FNR 0.125
-->positive probability:0.6388888888888888, 46/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7579617834394905
-->F1 0.8155339805825244
-->FPR 0.453125
-->FNR 0.0967741935483871
-->positive probability:0.7197452229299363, 113/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8293963254593176
-->F1 0.8939641109298533
-->FPR 0.5227272727272727
-->FNR 0.06484641638225255
-->positive probability:0.8398950131233596, 320/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.012648221343873556, 0.0439746300211416, 0.509090909090909, 0.1575757575757576, 0.290909090909091, 0.05909090909090903, 0.05596590909090904, 0.013636363636363669]
-->fnr_diff [0.008984516596758321, 0.03254952668294941, 0.0835102618542109, 0.027600849256900213, 0.0973991507430998, 0.0973991507430998, 0.06917334429148689, 0.03724556712535234]
-->FPR:[0.5217391304347826, 0.46511627906976744, 0.0, 0.6666666666666666, 0.8, 0.45, 0.453125, 0.5227272727272727], mean FPR:0.48492179361231114, mean FPR diff:0.14286147384486933
-->FNR:[0.036585365853658534, 0.06015037593984962, 0.1111111111111111, 0.0, 0.125, 0.125, 0.0967741935483871, 0.06484641638225255], mean FNR:0.07743343285440736, mean FNR diff:0.056732795911732206
-->mean fnr diff metric 0.14286147384486933
-->epoch 5
-->start_index 0
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9743589743589743
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [6/20], Loss: -0.1853, acc_loss, -0.2361, bias_loss:0.0508
-->start_index 98
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9855072463768115
-->z_score:1.0722960233688354, idi:12.984556198120117, p_hat:0.1324954777956009, n:98.0
Epoch [6/20], Loss: -0.3679, acc_loss, -0.4229, bias_loss:0.0549
-->start_index 196
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9570552147239264
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [6/20], Loss: -0.2698, acc_loss, -0.3163, bias_loss:0.0465
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:1.7509312629699707, idi:15.0, p_hat:0.15306122601032257, n:98.0
Epoch [6/20], Loss: -0.3034, acc_loss, -0.3669, bias_loss:0.0635
-->start_index 392
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9559748427672956
-->z_score:-0.6249948740005493, idi:7.943860054016113, p_hat:0.08105979859828949, n:98.0
Epoch [6/20], Loss: -0.3149, acc_loss, -0.3486, bias_loss:0.0336
-->start_index 490
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.958904109589041
-->z_score:1.0772438049316406, idi:12.999250411987305, p_hat:0.1326454132795334, n:98.0
Epoch [6/20], Loss: -0.2682, acc_loss, -0.3232, bias_loss:0.0550
-->start_index 588
-->batch_size 98
-->ACC 0.9183673469387755
-->F1 0.9487179487179488
-->z_score:1.0726590156555176, idi:12.985633850097656, p_hat:0.13250647485256195, n:98.0
Epoch [6/20], Loss: -0.0642, acc_loss, -0.1191, bias_loss:0.0550
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9878048780487805
-->z_score:1.5409549474716187, idi:14.376401901245117, p_hat:0.1466979831457138, n:98.0
Epoch [6/20], Loss: -0.4064, acc_loss, -0.4672, bias_loss:0.0608
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.9840232729911804, idi:6.87760066986084, p_hat:0.07017959654331207, n:98.0
Epoch [6/20], Loss: -0.4076, acc_loss, -0.4367, bias_loss:0.0291
-->start_index 882
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9870129870129869
-->z_score:0.29592040181159973, idi:10.678838729858398, p_hat:0.10896774381399155, n:98.0
Epoch [6/20], Loss: -0.3774, acc_loss, -0.4226, bias_loss:0.0452
-->start_index 980
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.963855421686747
-->z_score:1.077165126800537, idi:12.999016761779785, p_hat:0.13264302909374237, n:98.0
Epoch [6/20], Loss: -0.2781, acc_loss, -0.3331, bias_loss:0.0550
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.06731529533863068, idi:9.999916076660156, p_hat:0.10203996300697327, n:98.0
Epoch [6/20], Loss: -0.4460, acc_loss, -0.4883, bias_loss:0.0423
-->start_index 1176
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9871794871794872
-->z_score:0.7397496700286865, idi:11.996944427490234, p_hat:0.12241780012845993, n:98.0
Epoch [6/20], Loss: -0.4159, acc_loss, -0.4667, bias_loss:0.0508
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.4141970872879028, idi:13.999951362609863, p_hat:0.1428566426038742, n:98.0
Epoch [6/20], Loss: -0.3240, acc_loss, -0.3832, bias_loss:0.0592
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.40384191274642944, idi:10.999349594116211, p_hat:0.11223825812339783, n:98.0
Epoch [6/20], Loss: -0.3733, acc_loss, -0.4198, bias_loss:0.0465
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:1.0758743286132812, idi:12.995183944702148, p_hat:0.13260391354560852, n:98.0
Epoch [6/20], Loss: -0.3287, acc_loss, -0.3836, bias_loss:0.0550
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.413128137588501, idi:13.99677562713623, p_hat:0.14282424747943878, n:98.0
Epoch [6/20], Loss: -0.3540, acc_loss, -0.4133, bias_loss:0.0592
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:-0.2693740427494049, idi:9.0, p_hat:0.09183673560619354, n:98.0
Epoch [6/20], Loss: -0.2580, acc_loss, -0.2960, bias_loss:0.0381
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:-0.5036720037460327, idi:8.304170608520508, p_hat:0.08473643660545349, n:98.0
Epoch [6/20], Loss: -0.4208, acc_loss, -0.4559, bias_loss:0.0351
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.9428178668022156, idi:6.999973773956299, p_hat:0.07142830640077591, n:98.0
Epoch [6/20], Loss: -0.4959, acc_loss, -0.5255, bias_loss:0.0296
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [6/20], Loss: -0.4540, acc_loss, -0.4802, bias_loss:0.0262
-->after epoch 5
-->overall baseline on training dataset
-->ACC 0.9874532835024026
-->F1 0.9929735386455374
-->FPR: 0.06781750924784218
-->FNR: 0.0058374494836102376
-->overall baseline on testing dataset
-->ACC 0.912488321395204
-->F1 0.9509170305676857
-->FPR: 0.4597402597402597
-->FNR: 0.03680113234253362
training dataset
-->original metric score:
-->individual metric:0.12908086388749374, num_idi:257, num_all:1991
-->individual metric 0.12908086388749374
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.9881129271916791
-->F1 0.9931153184165232
-->FPR 0.043478260869565216
-->FNR 0.0068846815834767644
-->positive probability:0.8632986627043091, 581/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9716494845360825
-->F1 0.983206106870229
-->FPR 0.09836065573770492
-->FNR 0.01529051987767584
-->positive probability:0.845360824742268, 328/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.96
-->F1 0.9767441860465116
-->FPR 0.14285714285714285
-->FNR 0.023255813953488372
-->positive probability:0.86, 43/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9117647058823529
-->F1 0.9189189189189189
-->FPR 0.17647058823529413
-->FNR 0.0
-->positive probability:0.5882352941176471, 20/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9144385026737968
-->F1 0.9238095238095239
-->FPR 0.10843373493975904
-->FNR 0.0673076923076923
-->positive probability:0.5668449197860963, 106/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9594594594594594
-->F1 0.9698189134808854
-->FPR 0.05785123966942149
-->FNR 0.0321285140562249
-->positive probability:0.6702702702702703, 248/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9617977528089887
-->F1 0.9754335260115607
-->FPR 0.07653061224489796
-->FNR 0.027377521613832854
-->positive probability:0.7752808988764045, 690/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.02433924837827696, 0.03054314648986274, 0.02019846162879456, 0.07503963360930067, 0.10865307898745195, 0.04061622569191686, 0.009966269578420686, 0.008713102997055786]
-->fnr_diff [0.0010472320998665269, 0.009453070394065604, 0.09416255051638976, 0.017418364469878135, 0.0058374494836102376, 0.06147024282408207, 0.02629106457261466, 0.021540072130222618]
-->FPR:[0.043478260869565216, 0.09836065573770492, 0.047619047619047616, 0.14285714285714285, 0.17647058823529413, 0.10843373493975904, 0.05785123966942149, 0.07653061224489796], mean FPR:0.09395016027160415, mean FPR diff:0.03975864592013503
-->FNR:[0.0068846815834767644, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.0321285140562249, 0.027377521613832854], mean FNR:0.03403059292404888, mean FNR diff:0.0296525058113412
-->mean fnr diff metric 0.03975864592013503
testing dataset
-->original metric score:
-->individual metric:0.19030732860520094, num_idi:161, num_all:846
-->individual metric 0.19030732860520094
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8698630136986302
-->F1 0.9233870967741935
-->FPR 0.45652173913043476
-->FNR 0.06910569105691057
-->positive probability:0.8561643835616438, 250/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9044117647058822
-->FPR 0.37209302325581395
-->FNR 0.07518796992481203
-->positive probability:0.7897727272727273, 139/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7368421052631579
-->FPR 0.8
-->FNR 0.125
-->positive probability:0.8461538461538461, 11/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7222222222222222
-->F1 0.7368421052631579
-->FPR 0.4
-->FNR 0.125
-->positive probability:0.6111111111111112, 44/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7452229299363057
-->F1 0.7999999999999999
-->FPR 0.421875
-->FNR 0.13978494623655913
-->positive probability:0.6815286624203821, 107/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8188976377952756
-->F1 0.8863261943986821
-->FPR 0.5113636363636364
-->FNR 0.08191126279863481
-->positive probability:0.8241469816272966, 314/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.003218520609824971, 0.08764723648444578, 0.4597402597402597, 0.2069264069264069, 0.3402597402597403, 0.059740259740259705, 0.03786525974025973, 0.05162337662337663]
-->fnr_diff [0.03230455871437695, 0.038386837582278406, 0.07430997876857748, 0.03680113234253362, 0.08819886765746637, 0.08819886765746637, 0.1029838138940255, 0.04511013045610119]
-->FPR:[0.45652173913043476, 0.37209302325581395, 0.0, 0.6666666666666666, 0.8, 0.4, 0.421875, 0.5113636363636364], mean FPR:0.45356500817706896, mean FPR diff:0.1558776325155717
-->FNR:[0.06910569105691057, 0.07518796992481203, 0.1111111111111111, 0.0, 0.125, 0.125, 0.13978494623655913, 0.08191126279863481], mean FNR:0.09088762264100345, mean FNR diff:0.06328677338410324
-->mean fnr diff metric 0.1558776325155717
-->epoch 6
-->start_index 0
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.967741935483871
-->z_score:1.414211392402649, idi:13.999993324279785, p_hat:0.14285707473754883, n:98.0
Epoch [7/20], Loss: -0.1512, acc_loss, -0.2104, bias_loss:0.0592
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:2.0876481533050537, idi:15.999998092651367, p_hat:0.16326528787612915, n:98.0
Epoch [7/20], Loss: -0.3802, acc_loss, -0.4479, bias_loss:0.0677
-->start_index 196
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9811320754716981
-->z_score:1.9868091344833374, idi:15.700521469116211, p_hat:0.16020940244197845, n:98.0
Epoch [7/20], Loss: -0.2601, acc_loss, -0.3266, bias_loss:0.0664
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:1.4142138957977295, idi:14.0, p_hat:0.1428571492433548, n:98.0
Epoch [7/20], Loss: -0.2952, acc_loss, -0.3545, bias_loss:0.0592
-->start_index 392
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9743589743589743
-->z_score:-1.305356502532959, idi:5.9232892990112305, p_hat:0.06044172868132591, n:98.0
Epoch [7/20], Loss: -0.3140, acc_loss, -0.3391, bias_loss:0.0251
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.4141675233840942, idi:13.999863624572754, p_hat:0.14285574853420258, n:98.0
Epoch [7/20], Loss: -0.2512, acc_loss, -0.3104, bias_loss:0.0592
-->start_index 588
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9673202614379085
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [7/20], Loss: -0.0648, acc_loss, -0.1156, bias_loss:0.0508
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9876543209876543
-->z_score:2.1591057777404785, idi:16.212217330932617, p_hat:0.16543078422546387, n:98.0
Epoch [7/20], Loss: -0.4248, acc_loss, -0.4934, bias_loss:0.0686
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.9428090453147888, idi:7.0, p_hat:0.0714285746216774, n:98.0
Epoch [7/20], Loss: -0.4160, acc_loss, -0.4456, bias_loss:0.0296
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.0605642795562744, idi:12.949714660644531, p_hat:0.13213995099067688, n:98.0
Epoch [7/20], Loss: -0.3838, acc_loss, -0.4386, bias_loss:0.0548
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9575757575757574
-->z_score:0.7403886914253235, idi:11.998842239379883, p_hat:0.12243716418743134, n:98.0
Epoch [7/20], Loss: -0.2922, acc_loss, -0.3430, bias_loss:0.0508
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.39792558550834656, idi:10.981779098510742, p_hat:0.11205896735191345, n:98.0
Epoch [7/20], Loss: -0.4534, acc_loss, -0.4999, bias_loss:0.0465
-->start_index 1176
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9871794871794872
-->z_score:0.7407525181770325, idi:11.999922752380371, p_hat:0.12244819104671478, n:98.0
Epoch [7/20], Loss: -0.4186, acc_loss, -0.4694, bias_loss:0.0508
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.71951162815094, idi:14.906688690185547, p_hat:0.1521090716123581, n:98.0
Epoch [7/20], Loss: -0.3235, acc_loss, -0.3866, bias_loss:0.0631
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.40342074632644653, idi:10.998098373413086, p_hat:0.1122254952788353, n:98.0
Epoch [7/20], Loss: -0.3662, acc_loss, -0.4128, bias_loss:0.0465
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [7/20], Loss: -0.3280, acc_loss, -0.3787, bias_loss:0.0508
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.2918927669525146, idi:13.636726379394531, p_hat:0.13915026187896729, n:98.0
Epoch [7/20], Loss: -0.3523, acc_loss, -0.4100, bias_loss:0.0577
-->start_index 1666
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9664429530201343
-->z_score:0.06723711639642715, idi:9.99968433380127, p_hat:0.10203759372234344, n:98.0
Epoch [7/20], Loss: -0.2858, acc_loss, -0.3281, bias_loss:0.0423
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:-0.607420027256012, idi:7.9960551261901855, p_hat:0.08159239590167999, n:98.0
Epoch [7/20], Loss: -0.4175, acc_loss, -0.4514, bias_loss:0.0338
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-1.6162441968917847, idi:5.0, p_hat:0.051020409911870956, n:98.0
Epoch [7/20], Loss: -0.4912, acc_loss, -0.5124, bias_loss:0.0212
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [7/20], Loss: -0.4246, acc_loss, -0.4508, bias_loss:0.0262
-->after epoch 6
-->overall baseline on training dataset
-->ACC 0.98718633208756
-->F1 0.9928326116171421
-->FPR: 0.07891491985203453
-->FNR: 0.004789702140398144
-->overall baseline on testing dataset
-->ACC 0.9149797570850202
-->F1 0.9525794684731631
-->FPR: 0.4909090909090909
-->FNR: 0.029723991507430998
training dataset
-->original metric score:
-->individual metric:0.11200401808136615, num_idi:223, num_all:1991
-->individual metric 0.11200401808136615
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.9836552748885586
-->F1 0.9905579399141631
-->FPR 0.07608695652173914
-->FNR 0.0068846815834767644
-->positive probability:0.8677563150074294, 584/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9716494845360825
-->F1 0.9832572298325722
-->FPR 0.11475409836065574
-->FNR 0.012232415902140673
-->positive probability:0.8505154639175257, 330/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.94
-->F1 0.9655172413793104
-->FPR 0.2857142857142857
-->FNR 0.023255813953488372
-->positive probability:0.88, 44/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9117647058823529
-->F1 0.9189189189189189
-->FPR 0.17647058823529413
-->FNR 0.0
-->positive probability:0.5882352941176471, 20/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9090909090909091
-->F1 0.919431279620853
-->FPR 0.12048192771084337
-->FNR 0.0673076923076923
-->positive probability:0.5721925133689839, 107/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9567567567567568
-->F1 0.9681274900398407
-->FPR 0.08264462809917356
-->FNR 0.024096385542168676
-->positive probability:0.6837837837837838, 253/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9595505617977528
-->F1 0.9740634005763689
-->FPR 0.09183673469387756
-->FNR 0.025936599423631124
-->positive probability:0.7797752808988764, 694/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.002827963330295391, 0.035839178508621214, 0.03129587223298691, 0.20679936586225117, 0.0975556683832596, 0.041567007858808847, 0.0037297082471390297, 0.01292181484184303]
-->fnr_diff [0.00209497944307862, 0.0074427137617425285, 0.09521029785960186, 0.018466111813090227, 0.004789702140398144, 0.06251799016729416, 0.01930668340177053, 0.02114689728323298]
-->FPR:[0.07608695652173914, 0.11475409836065574, 0.047619047619047616, 0.2857142857142857, 0.17647058823529413, 0.12048192771084337, 0.08264462809917356, 0.09183673469387756], mean FPR:0.12445103336936458, mean FPR diff:0.05406707240815065
-->FNR:[0.0068846815834767644, 0.012232415902140673, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.024096385542168676, 0.025936599423631124], mean FNR:0.03246419858907474, mean FNR diff:0.028871921983776132
-->mean fnr diff metric 0.05406707240815065
testing dataset
-->original metric score:
-->individual metric:0.1702127659574468, num_idi:144, num_all:846
-->individual metric 0.1702127659574468
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8835616438356164
-->F1 0.9328063241106719
-->FPR 0.5217391304347826
-->FNR 0.04065040650406504
-->positive probability:0.8904109589041096, 260/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8465909090909091
-->F1 0.9025270758122743
-->FPR 0.4418604651162791
-->FNR 0.06015037593984962
-->positive probability:0.8181818181818182, 144/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7368421052631579
-->FPR 0.8
-->FNR 0.125
-->positive probability:0.8461538461538461, 11/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7083333333333334
-->F1 0.7272727272727274
-->FPR 0.425
-->FNR 0.125
-->positive probability:0.625, 45/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7515923566878981
-->F1 0.8097560975609757
-->FPR 0.453125
-->FNR 0.10752688172043011
-->positive probability:0.7133757961783439, 112/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8241469816272966
-->F1 0.8903436988543372
-->FPR 0.5227272727272727
-->FNR 0.07167235494880546
-->positive probability:0.8346456692913385, 318/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.030830039525691688, 0.04904862579281183, 0.4909090909090909, 0.17575757575757572, 0.30909090909090914, 0.06590909090909092, 0.037784090909090906, 0.0318181818181818]
-->fnr_diff [0.010926414996634042, 0.030426384432418623, 0.08138711960368011, 0.029723991507430998, 0.09527600849256901, 0.09527600849256901, 0.0778028902129991, 0.04194836344137446]
-->FPR:[0.5217391304347826, 0.4418604651162791, 0.0, 0.6666666666666666, 0.8, 0.425, 0.453125, 0.5227272727272727], mean FPR:0.47888981686812515, mean FPR diff:0.14889345058905537
-->FNR:[0.04065040650406504, 0.06015037593984962, 0.1111111111111111, 0.0, 0.125, 0.125, 0.10752688172043011, 0.07167235494880546], mean FNR:0.08013889127803267, mean FNR diff:0.05784589764745942
-->mean fnr diff metric 0.14889345058905537
-->epoch 7
-->start_index 0
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9743589743589743
-->z_score:1.3951727151870728, idi:13.943450927734375, p_hat:0.14228011667728424, n:98.0
Epoch [8/20], Loss: -0.1912, acc_loss, -0.2502, bias_loss:0.0590
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:0.7367811799049377, idi:11.988128662109375, p_hat:0.12232784181833267, n:98.0
Epoch [8/20], Loss: -0.3913, acc_loss, -0.4420, bias_loss:0.0507
-->start_index 196
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9689440993788819
-->z_score:0.6871786713600159, idi:11.840816497802734, p_hat:0.1208246573805809, n:98.0
Epoch [8/20], Loss: -0.2776, acc_loss, -0.3277, bias_loss:0.0501
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:1.7509312629699707, idi:15.0, p_hat:0.15306122601032257, n:98.0
Epoch [8/20], Loss: -0.3116, acc_loss, -0.3750, bias_loss:0.0635
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9681528662420382
-->z_score:-1.61691153049469, idi:4.998018264770508, p_hat:0.05100018531084061, n:98.0
Epoch [8/20], Loss: -0.3193, acc_loss, -0.3404, bias_loss:0.0212
-->start_index 490
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.958904109589041
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [8/20], Loss: -0.2578, acc_loss, -0.3128, bias_loss:0.0550
-->start_index 588
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9548387096774195
-->z_score:1.3184983730316162, idi:13.715740203857422, p_hat:0.139956533908844, n:98.0
Epoch [8/20], Loss: -0.0457, acc_loss, -0.1037, bias_loss:0.0580
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9878048780487805
-->z_score:1.3331912755966187, idi:13.75937557220459, p_hat:0.14040179550647736, n:98.0
Epoch [8/20], Loss: -0.4259, acc_loss, -0.4841, bias_loss:0.0582
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-1.279526710510254, idi:6.0, p_hat:0.06122449040412903, n:98.0
Epoch [8/20], Loss: -0.4323, acc_loss, -0.4577, bias_loss:0.0254
-->start_index 882
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9870129870129869
-->z_score:0.06144842505455017, idi:9.982492446899414, p_hat:0.10186216980218887, n:98.0
Epoch [8/20], Loss: -0.3978, acc_loss, -0.4401, bias_loss:0.0422
-->start_index 980
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.963855421686747
-->z_score:0.7407557368278503, idi:11.999932289123535, p_hat:0.12244828790426254, n:98.0
Epoch [8/20], Loss: -0.2891, acc_loss, -0.3399, bias_loss:0.0508
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.18127377331256866, idi:10.338356018066406, p_hat:0.10549342632293701, n:98.0
Epoch [8/20], Loss: -0.4584, acc_loss, -0.5022, bias_loss:0.0437
-->start_index 1176
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9871794871794872
-->z_score:0.7403380274772644, idi:11.99869155883789, p_hat:0.12243562936782837, n:98.0
Epoch [8/20], Loss: -0.4307, acc_loss, -0.4815, bias_loss:0.0508
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.6012487411499023, idi:14.555465698242188, p_hat:0.1485251635313034, n:98.0
Epoch [8/20], Loss: -0.3297, acc_loss, -0.3913, bias_loss:0.0616
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.40405577421188354, idi:10.999984741210938, p_hat:0.11224474012851715, n:98.0
Epoch [8/20], Loss: -0.3793, acc_loss, -0.4258, bias_loss:0.0465
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [8/20], Loss: -0.3397, acc_loss, -0.3905, bias_loss:0.0508
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.412911295890808, idi:13.996131896972656, p_hat:0.1428176760673523, n:98.0
Epoch [8/20], Loss: -0.3510, acc_loss, -0.4102, bias_loss:0.0592
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:-0.08240843564271927, idi:9.555259704589844, p_hat:0.09750264883041382, n:98.0
Epoch [8/20], Loss: -0.2706, acc_loss, -0.3110, bias_loss:0.0404
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:-0.4723860025405884, idi:8.397085189819336, p_hat:0.08568454533815384, n:98.0
Epoch [8/20], Loss: -0.4201, acc_loss, -0.4557, bias_loss:0.0355
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.9443631172180176, idi:6.995384693145752, p_hat:0.07138147950172424, n:98.0
Epoch [8/20], Loss: -0.4888, acc_loss, -0.5184, bias_loss:0.0296
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [8/20], Loss: -0.4460, acc_loss, -0.4722, bias_loss:0.0262
-->after epoch 7
-->overall baseline on training dataset
-->ACC 0.9870528563801388
-->F1 0.992754164487936
-->FPR: 0.0752157829839704
-->FNR: 0.005388414907947912
-->overall baseline on testing dataset
-->ACC 0.912176891933977
-->F1 0.9508368200836821
-->FPR: 0.4753246753246753
-->FNR: 0.03503184713375796
training dataset
-->original metric score:
-->individual metric:0.12104470115519839, num_idi:241, num_all:1991
-->individual metric 0.12104470115519839
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.986627043090639
-->F1 0.9922613929492692
-->FPR 0.05434782608695652
-->FNR 0.0068846815834767644
-->positive probability:0.8647845468053492, 582/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9716494845360825
-->F1 0.983206106870229
-->FPR 0.09836065573770492
-->FNR 0.01529051987767584
-->positive probability:0.845360824742268, 328/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.94
-->F1 0.9655172413793104
-->FPR 0.2857142857142857
-->FNR 0.023255813953488372
-->positive probability:0.88, 44/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9117647058823529
-->F1 0.9189189189189189
-->FPR 0.17647058823529413
-->FNR 0.0
-->positive probability:0.5882352941176471, 20/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9090909090909091
-->F1 0.919431279620853
-->FPR 0.12048192771084337
-->FNR 0.0673076923076923
-->positive probability:0.5721925133689839, 107/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9594594594594594
-->F1 0.970059880239521
-->FPR 0.0743801652892562
-->FNR 0.024096385542168676
-->positive probability:0.6810810810810811, 252/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9617977528089887
-->F1 0.9754689754689755
-->FPR 0.08163265306122448
-->FNR 0.025936599423631124
-->positive probability:0.7775280898876404, 692/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.02086795689701388, 0.023144872753734516, 0.027596735364922784, 0.21049850273031528, 0.10125480525132373, 0.04526614472687297, 0.0008356176947141997, 0.006416870077254083]
-->fnr_diff [0.001496266675528852, 0.009902104969727928, 0.09461158509205209, 0.01786739904554046, 0.005388414907947912, 0.06191927739974439, 0.018707970634220764, 0.020548184515683212]
-->FPR:[0.05434782608695652, 0.09836065573770492, 0.047619047619047616, 0.2857142857142857, 0.17647058823529413, 0.12048192771084337, 0.0743801652892562, 0.08163265306122448], mean FPR:0.1173758936818266, mean FPR diff:0.05448518818701893
-->FNR:[0.0068846815834767644, 0.01529051987767584, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.024096385542168676, 0.025936599423631124], mean FNR:0.03284646158601664, mean FNR diff:0.028805150405055702
-->mean fnr diff metric 0.05448518818701893
testing dataset
-->original metric score:
-->individual metric:0.18439716312056736, num_idi:156, num_all:846
-->individual metric 0.18439716312056736
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8767123287671232
-->F1 0.9277108433734941
-->FPR 0.45652173913043476
-->FNR 0.06097560975609756
-->positive probability:0.863013698630137, 252/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8522727272727273
-->F1 0.9044117647058822
-->FPR 0.37209302325581395
-->FNR 0.07518796992481203
-->positive probability:0.7897727272727273, 139/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7368421052631579
-->FPR 0.8
-->FNR 0.125
-->positive probability:0.8461538461538461, 11/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7222222222222222
-->F1 0.7368421052631579
-->FPR 0.4
-->FNR 0.125
-->positive probability:0.6111111111111112, 44/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7452229299363057
-->F1 0.801980198019802
-->FPR 0.4375
-->FNR 0.12903225806451613
-->positive probability:0.6942675159235668, 109/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.821522309711286
-->F1 0.8881578947368421
-->FPR 0.5113636363636364
-->FNR 0.07849829351535836
-->positive probability:0.8267716535433071, 315/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.01880293619424056, 0.10323165206886137, 0.4753246753246753, 0.1913419913419913, 0.32467532467532473, 0.0753246753246753, 0.037824675324675316, 0.03603896103896104]
-->fnr_diff [0.0259437626223396, 0.040156122791054065, 0.07607926397735315, 0.03503184713375796, 0.08996815286624205, 0.08996815286624205, 0.09400041093075817, 0.0434664463816004]
-->FPR:[0.45652173913043476, 0.37209302325581395, 0.0, 0.6666666666666666, 0.8, 0.4, 0.4375, 0.5113636363636364], mean FPR:0.45551813317706896, mean FPR diff:0.1578206114116756
-->FNR:[0.06097560975609756, 0.07518796992481203, 0.1111111111111111, 0.0, 0.125, 0.125, 0.12903225806451613, 0.07849829351535836], mean FNR:0.08810065529648689, mean FNR diff:0.06182676994616843
-->mean fnr diff metric 0.1578206114116756
-->epoch 8
-->start_index 0
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9743589743589743
-->z_score:1.4611163139343262, idi:14.139293670654297, p_hat:0.14427851140499115, n:98.0
Epoch [9/20], Loss: -0.1794, acc_loss, -0.2392, bias_loss:0.0598
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:1.0760287046432495, idi:12.995641708374023, p_hat:0.1326085925102234, n:98.0
Epoch [9/20], Loss: -0.3886, acc_loss, -0.4436, bias_loss:0.0550
-->start_index 196
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9689440993788819
-->z_score:1.0179234743118286, idi:12.823078155517578, p_hat:0.1308477371931076, n:98.0
Epoch [9/20], Loss: -0.2864, acc_loss, -0.3406, bias_loss:0.0543
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:1.7509312629699707, idi:15.0, p_hat:0.15306122601032257, n:98.0
Epoch [9/20], Loss: -0.3178, acc_loss, -0.3813, bias_loss:0.0635
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9681528662420382
-->z_score:-1.6651510000228882, idi:4.854754447937012, p_hat:0.04953831061720848, n:98.0
Epoch [9/20], Loss: -0.3252, acc_loss, -0.3457, bias_loss:0.0205
-->start_index 490
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.958904109589041
-->z_score:1.353531002998352, idi:13.819781303405762, p_hat:0.14101818203926086, n:98.0
Epoch [9/20], Loss: -0.2603, acc_loss, -0.3188, bias_loss:0.0585
-->start_index 588
-->batch_size 98
-->ACC 0.9183673469387755
-->F1 0.9487179487179488
-->z_score:1.20229971408844, idi:13.370647430419922, p_hat:0.13643518090248108, n:98.0
Epoch [9/20], Loss: -0.0690, acc_loss, -0.1256, bias_loss:0.0566
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9878048780487805
-->z_score:-0.2693750262260437, idi:8.99999713897705, p_hat:0.09183670580387115, n:98.0
Epoch [9/20], Loss: -0.4373, acc_loss, -0.4754, bias_loss:0.0381
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-1.2795370817184448, idi:5.999969482421875, p_hat:0.06122417747974396, n:98.0
Epoch [9/20], Loss: -0.4117, acc_loss, -0.4371, bias_loss:0.0254
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9806451612903226
-->z_score:0.07410168647766113, idi:10.020071029663086, p_hat:0.10224562138319016, n:98.0
Epoch [9/20], Loss: -0.3925, acc_loss, -0.4349, bias_loss:0.0424
-->start_index 980
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.963855421686747
-->z_score:0.4422975778579712, idi:11.113556861877441, p_hat:0.11340364068746567, n:98.0
Epoch [9/20], Loss: -0.3214, acc_loss, -0.3684, bias_loss:0.0470
-->start_index 1078
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9871794871794872
-->z_score:0.37045973539352417, idi:10.900209426879883, p_hat:0.1112266257405281, n:98.0
Epoch [9/20], Loss: -0.4460, acc_loss, -0.4922, bias_loss:0.0461
-->start_index 1176
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9871794871794872
-->z_score:0.7404956221580505, idi:11.999159812927246, p_hat:0.122440405189991, n:98.0
Epoch [9/20], Loss: -0.4137, acc_loss, -0.4645, bias_loss:0.0508
-->start_index 1274
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9548387096774195
-->z_score:0.7407755851745605, idi:11.999991416931152, p_hat:0.1224488914012909, n:98.0
Epoch [9/20], Loss: -0.3180, acc_loss, -0.3687, bias_loss:0.0508
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.050866756588220596, idi:9.951066970825195, p_hat:0.10154149681329727, n:98.0
Epoch [9/20], Loss: -0.3688, acc_loss, -0.4109, bias_loss:0.0421
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9795918367346939
-->z_score:0.4040243327617645, idi:10.99989128112793, p_hat:0.11224378645420074, n:98.0
Epoch [9/20], Loss: -0.3244, acc_loss, -0.3709, bias_loss:0.0465
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9736842105263157
-->z_score:-0.9428090453147888, idi:7.0, p_hat:0.0714285746216774, n:98.0
Epoch [9/20], Loss: -0.3978, acc_loss, -0.4274, bias_loss:0.0296
-->start_index 1666
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9664429530201343
-->z_score:-0.2723764479160309, idi:8.991083145141602, p_hat:0.09174574911594391, n:98.0
Epoch [9/20], Loss: -0.2671, acc_loss, -0.3052, bias_loss:0.0380
-->start_index 1764
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:-0.2693740427494049, idi:9.0, p_hat:0.09183673560619354, n:98.0
Epoch [9/20], Loss: -0.4002, acc_loss, -0.4383, bias_loss:0.0381
-->start_index 1862
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9940828402366864
-->z_score:-0.9428178668022156, idi:6.999973773956299, p_hat:0.07142830640077591, n:98.0
Epoch [9/20], Loss: -0.4816, acc_loss, -0.5112, bias_loss:0.0296
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [9/20], Loss: -0.4002, acc_loss, -0.4264, bias_loss:0.0262
-->after epoch 8
-->overall baseline on training dataset
-->ACC 0.9867859049652963
-->F1 0.9926146960089519
-->FPR: 0.08754623921085081
-->FNR: 0.004190989372848376
-->overall baseline on testing dataset
-->ACC 0.9140454687013392
-->F1 0.952232606438214
-->FPR: 0.522077922077922
-->FNR: 0.02653927813163482
training dataset
-->original metric score:
-->individual metric:0.10999497739829231, num_idi:219, num_all:1991
-->individual metric 0.10999497739829231
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.9806835066864784
-->F1 0.9888793840889648
-->FPR 0.10869565217391304
-->FNR 0.0051635111876075735
-->positive probability:0.8736998514115899, 588/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9716494845360825
-->F1 0.9832572298325722
-->FPR 0.11475409836065574
-->FNR 0.012232415902140673
-->positive probability:0.8505154639175257, 330/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.92
-->F1 0.9545454545454545
-->FPR 0.42857142857142855
-->FNR 0.023255813953488372
-->positive probability:0.9, 45/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.8823529411764706
-->F1 0.8947368421052632
-->FPR 0.23529411764705882
-->FNR 0.0
-->positive probability:0.6176470588235294, 21/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.8823529411764706
-->F1 0.8981481481481481
-->FPR 0.18072289156626506
-->FNR 0.0673076923076923
-->positive probability:0.5989304812834224, 112/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9540540540540541
-->F1 0.9662027833001988
-->FPR 0.09090909090909091
-->FNR 0.024096385542168676
-->positive probability:0.6864864864864865, 254/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9573033707865168
-->F1 0.9727011494252873
-->FPR 0.10714285714285714
-->FNR 0.024495677233429394
-->positive probability:0.7842696629213484, 698/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.021149412963062234, 0.027207859149804933, 0.03992719159180319, 0.34102518936057774, 0.147747878436208, 0.09317665235541425, 0.0033628516982401047, 0.01959661793200633]
-->fnr_diff [0.0009725218147591972, 0.008041426529292297, 0.09580901062715164, 0.019064824580639995, 0.004190989372848376, 0.06311670293484392, 0.0199053961693203, 0.020304687860581018]
-->FPR:[0.10869565217391304, 0.11475409836065574, 0.047619047619047616, 0.42857142857142855, 0.23529411764705882, 0.18072289156626506, 0.09090909090909091, 0.10714285714285714], mean FPR:0.16421364799878962, mean FPR diff:0.0866492066858896
-->FNR:[0.0051635111876075735, 0.012232415902140673, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.024096385542168676, 0.024495677233429394], mean FNR:0.032068937015815875, mean FNR diff:0.02892569498617959
-->mean fnr diff metric 0.0866492066858896
testing dataset
-->original metric score:
-->individual metric:0.1607565011820331, num_idi:136, num_all:846
-->individual metric 0.1607565011820331
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.886986301369863
-->F1 0.9349112426035503
-->FPR 0.5217391304347826
-->FNR 0.036585365853658534
-->positive probability:0.8938356164383562, 261/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8465909090909091
-->F1 0.9032258064516129
-->FPR 0.46511627906976744
-->FNR 0.05263157894736842
-->positive probability:0.8295454545454546, 146/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7368421052631579
-->FPR 0.8
-->FNR 0.125
-->positive probability:0.8461538461538461, 11/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.6805555555555556
-->F1 0.7088607594936708
-->FPR 0.475
-->FNR 0.125
-->positive probability:0.6527777777777778, 47/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7579617834394905
-->F1 0.8155339805825244
-->FPR 0.453125
-->FNR 0.0967741935483871
-->positive probability:0.7197452229299363, 113/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8267716535433071
-->F1 0.8925081433224755
-->FPR 0.5340909090909091
-->FNR 0.06484641638225255
-->positive probability:0.84251968503937, 321/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.00033879164313943555, 0.056961643008154594, 0.522077922077922, 0.1445887445887446, 0.277922077922078, 0.04707792207792205, 0.06895292207792203, 0.01201298701298703]
-->fnr_diff [0.010046087722023714, 0.026092300815733598, 0.08457183297947629, 0.02653927813163482, 0.09846072186836519, 0.09846072186836519, 0.07023491541675228, 0.03830713825061773]
-->FPR:[0.5217391304347826, 0.46511627906976744, 0.0, 0.6666666666666666, 0.8, 0.475, 0.453125, 0.5340909090909091], mean FPR:0.4894672481577657, mean FPR diff:0.14124162630110873
-->FNR:[0.036585365853658534, 0.05263157894736842, 0.1111111111111111, 0.0, 0.125, 0.125, 0.0967741935483871, 0.06484641638225255], mean FNR:0.07649358323034722, mean FNR diff:0.0565891246316211
-->mean fnr diff metric 0.14124162630110873
-->epoch 9
-->start_index 0
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9743589743589743
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [10/20], Loss: -0.2021, acc_loss, -0.2529, bias_loss:0.0508
-->start_index 98
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9855072463768115
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [10/20], Loss: -0.3926, acc_loss, -0.4476, bias_loss:0.0550
-->start_index 196
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9629629629629629
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [10/20], Loss: -0.2590, acc_loss, -0.3055, bias_loss:0.0465
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:1.7509312629699707, idi:15.0, p_hat:0.15306122601032257, n:98.0
Epoch [10/20], Loss: -0.3119, acc_loss, -0.3754, bias_loss:0.0635
-->start_index 392
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9620253164556962
-->z_score:-0.9456180334091187, idi:6.9916582107543945, p_hat:0.07134345173835754, n:98.0
Epoch [10/20], Loss: -0.3028, acc_loss, -0.3324, bias_loss:0.0296
-->start_index 490
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.958904109589041
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [10/20], Loss: -0.2401, acc_loss, -0.2951, bias_loss:0.0550
-->start_index 588
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9548387096774195
-->z_score:1.4142138957977295, idi:14.0, p_hat:0.1428571492433548, n:98.0
Epoch [10/20], Loss: -0.0383, acc_loss, -0.0975, bias_loss:0.0592
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9878048780487805
-->z_score:2.201700448989868, idi:16.338716506958008, p_hat:0.16672159731388092, n:98.0
Epoch [10/20], Loss: -0.4273, acc_loss, -0.4964, bias_loss:0.0691
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.6061182022094727, idi:7.999920845031738, p_hat:0.0816318467259407, n:98.0
Epoch [10/20], Loss: -0.4417, acc_loss, -0.4755, bias_loss:0.0339
-->start_index 882
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9870129870129869
-->z_score:0.7281678318977356, idi:11.96254825592041, p_hat:0.12206681817770004, n:98.0
Epoch [10/20], Loss: -0.4092, acc_loss, -0.4598, bias_loss:0.0506
-->start_index 980
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.9634146341463415
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [10/20], Loss: -0.2649, acc_loss, -0.3157, bias_loss:0.0508
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.4005756974220276, idi:10.989648818969727, p_hat:0.1121392771601677, n:98.0
Epoch [10/20], Loss: -0.4684, acc_loss, -0.5149, bias_loss:0.0465
-->start_index 1176
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:1.0477925539016724, idi:12.911785125732422, p_hat:0.13175290822982788, n:98.0
Epoch [10/20], Loss: -0.4373, acc_loss, -0.4919, bias_loss:0.0546
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.4141980409622192, idi:13.999954223632812, p_hat:0.1428566724061966, n:98.0
Epoch [10/20], Loss: -0.3330, acc_loss, -0.3923, bias_loss:0.0592
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.067343570291996, idi:10.0, p_hat:0.10204081982374191, n:98.0
Epoch [10/20], Loss: -0.3836, acc_loss, -0.4259, bias_loss:0.0423
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:1.0774949789047241, idi:12.99999713897705, p_hat:0.13265302777290344, n:98.0
Epoch [10/20], Loss: -0.3243, acc_loss, -0.3793, bias_loss:0.0550
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:0.7407753467559814, idi:11.999990463256836, p_hat:0.1224488839507103, n:98.0
Epoch [10/20], Loss: -0.3626, acc_loss, -0.4134, bias_loss:0.0508
-->start_index 1666
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9664429530201343
-->z_score:-0.09548039734363556, idi:9.516437530517578, p_hat:0.09710650891065598, n:98.0
Epoch [10/20], Loss: -0.2925, acc_loss, -0.3327, bias_loss:0.0403
-->start_index 1764
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9798657718120806
-->z_score:-0.32934489846229553, idi:8.821895599365234, p_hat:0.0900193452835083, n:98.0
Epoch [10/20], Loss: -0.4114, acc_loss, -0.4487, bias_loss:0.0373
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-0.7458021640777588, idi:7.585081100463867, p_hat:0.07739878445863724, n:98.0
Epoch [10/20], Loss: -0.4810, acc_loss, -0.5131, bias_loss:0.0321
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [10/20], Loss: -0.4414, acc_loss, -0.4676, bias_loss:0.0262
-->after epoch 9
-->overall baseline on training dataset
-->ACC 0.9870528563801388
-->F1 0.992754164487936
-->FPR: 0.0752157829839704
-->FNR: 0.005388414907947912
-->overall baseline on testing dataset
-->ACC 0.912176891933977
-->F1 0.9508196721311475
-->FPR: 0.4727272727272727
-->FNR: 0.035385704175513094
training dataset
-->original metric score:
-->individual metric:0.12355600200904068, num_idi:246, num_all:1991
-->individual metric 0.12355600200904068
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.986627043090639
-->F1 0.9922613929492692
-->FPR 0.05434782608695652
-->FNR 0.0068846815834767644
-->positive probability:0.8647845468053492, 582/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9742268041237113
-->F1 0.9847560975609757
-->FPR 0.09836065573770492
-->FNR 0.012232415902140673
-->positive probability:0.8479381443298969, 329/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.94
-->F1 0.9655172413793104
-->FPR 0.2857142857142857
-->FNR 0.023255813953488372
-->positive probability:0.88, 44/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9117647058823529
-->F1 0.9189189189189189
-->FPR 0.17647058823529413
-->FNR 0.0
-->positive probability:0.5882352941176471, 20/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9090909090909091
-->F1 0.919431279620853
-->FPR 0.12048192771084337
-->FNR 0.0673076923076923
-->positive probability:0.5721925133689839, 107/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9594594594594594
-->F1 0.969939879759519
-->FPR 0.06611570247933884
-->FNR 0.028112449799196786
-->positive probability:0.6756756756756757, 250/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9617977528089887
-->F1 0.9754689754689755
-->FPR 0.08163265306122448
-->FNR 0.025936599423631124
-->positive probability:0.7775280898876404, 692/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.02086795689701388, 0.023144872753734516, 0.027596735364922784, 0.21049850273031528, 0.10125480525132373, 0.04526614472687297, 0.009100080504631555, 0.006416870077254083]
-->fnr_diff [0.001496266675528852, 0.0068440009941927605, 0.09461158509205209, 0.01786739904554046, 0.005388414907947912, 0.06191927739974439, 0.022724034891248874, 0.020548184515683212]
-->FPR:[0.05434782608695652, 0.09836065573770492, 0.047619047619047616, 0.2857142857142857, 0.17647058823529413, 0.12048192771084337, 0.06611570247933884, 0.08163265306122448], mean FPR:0.11634283583058694, mean FPR diff:0.0555182460382586
-->FNR:[0.0068846815834767644, 0.012232415902140673, 0.1, 0.023255813953488372, 0.0, 0.0673076923076923, 0.028112449799196786, 0.025936599423631124], mean FNR:0.03296620662120325, mean FNR diff:0.02892489544024232
-->mean fnr diff metric 0.0555182460382586
testing dataset
-->original metric score:
-->individual metric:0.18439716312056736, num_idi:156, num_all:846
-->individual metric 0.18439716312056736
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8732876712328768
-->F1 0.9258517034068134
-->FPR 0.4782608695652174
-->FNR 0.06097560975609756
-->positive probability:0.8664383561643836, 253/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8465909090909091
-->F1 0.9010989010989012
-->FPR 0.3953488372093023
-->FNR 0.07518796992481203
-->positive probability:0.7954545454545454, 140/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7368421052631579
-->FPR 0.8
-->FNR 0.125
-->positive probability:0.8461538461538461, 11/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7222222222222222
-->F1 0.7368421052631579
-->FPR 0.4
-->FNR 0.125
-->positive probability:0.6111111111111112, 44/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7452229299363057
-->F1 0.801980198019802
-->FPR 0.4375
-->FNR 0.12903225806451613
-->positive probability:0.6942675159235668, 109/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.821522309711286
-->F1 0.8881578947368421
-->FPR 0.5113636363636364
-->FNR 0.07849829351535836
-->positive probability:0.8267716535433071, 315/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.005533596837944688, 0.07737843551797041, 0.4727272727272727, 0.1939393939393939, 0.3272727272727273, 0.0727272727272727, 0.03522727272727272, 0.038636363636363635]
-->fnr_diff [0.025589905580584466, 0.03980226574929893, 0.07572540693559801, 0.035385704175513094, 0.0896142958244869, 0.0896142958244869, 0.09364655388900303, 0.04311258933984527]
-->FPR:[0.4782608695652174, 0.3953488372093023, 0.0, 0.6666666666666666, 0.8, 0.4, 0.4375, 0.5113636363636364], mean FPR:0.46114250122560285, mean FPR diff:0.15293029192327726
-->FNR:[0.06097560975609756, 0.07518796992481203, 0.1111111111111111, 0.0, 0.125, 0.125, 0.12903225806451613, 0.07849829351535836], mean FNR:0.08810065529648689, mean FNR diff:0.06156137716485208
-->mean fnr diff metric 0.15293029192327726
-->epoch 10
-->start_index 0
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9743589743589743
-->z_score:1.7507556676864624, idi:14.999479293823242, p_hat:0.15305590629577637, n:98.0
Epoch [11/20], Loss: -0.1914, acc_loss, -0.2548, bias_loss:0.0635
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:1.9932795763015747, idi:15.719738006591797, p_hat:0.1604054868221283, n:98.0
Epoch [11/20], Loss: -0.3815, acc_loss, -0.4480, bias_loss:0.0665
-->start_index 196
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:1.4142138957977295, idi:14.0, p_hat:0.1428571492433548, n:98.0
Epoch [11/20], Loss: -0.2878, acc_loss, -0.3470, bias_loss:0.0592
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:1.7508612871170044, idi:14.99979305267334, p_hat:0.15305911004543304, n:98.0
Epoch [11/20], Loss: -0.3121, acc_loss, -0.3756, bias_loss:0.0635
-->start_index 392
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9743589743589743
-->z_score:-1.6162441968917847, idi:5.0, p_hat:0.051020409911870956, n:98.0
Epoch [11/20], Loss: -0.3255, acc_loss, -0.3467, bias_loss:0.0212
-->start_index 490
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9655172413793104
-->z_score:1.152296781539917, idi:13.222146987915039, p_hat:0.13491986691951752, n:98.0
Epoch [11/20], Loss: -0.2610, acc_loss, -0.3169, bias_loss:0.0560
-->start_index 588
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.961038961038961
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [11/20], Loss: -0.1011, acc_loss, -0.1519, bias_loss:0.0508
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9878048780487805
-->z_score:2.424365520477295, idi:16.999998092651367, p_hat:0.17346936464309692, n:98.0
Epoch [11/20], Loss: -0.4274, acc_loss, -0.4993, bias_loss:0.0719
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-0.6193448305130005, idi:7.960639953613281, p_hat:0.0812310203909874, n:98.0
Epoch [11/20], Loss: -0.4262, acc_loss, -0.4599, bias_loss:0.0337
-->start_index 882
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9803921568627451
-->z_score:1.0827680826187134, idi:13.015657424926758, p_hat:0.13281282782554626, n:98.0
Epoch [11/20], Loss: -0.4062, acc_loss, -0.4613, bias_loss:0.0551
-->start_index 980
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9575757575757574
-->z_score:0.40400588512420654, idi:10.999835968017578, p_hat:0.11224322766065598, n:98.0
Epoch [11/20], Loss: -0.2903, acc_loss, -0.3369, bias_loss:0.0465
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.25957077741622925, idi:10.57088565826416, p_hat:0.10786618292331696, n:98.0
Epoch [11/20], Loss: -0.4806, acc_loss, -0.5253, bias_loss:0.0447
-->start_index 1176
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [11/20], Loss: -0.4518, acc_loss, -0.4983, bias_loss:0.0465
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.4142138957977295, idi:14.0, p_hat:0.1428571492433548, n:98.0
Epoch [11/20], Loss: -0.3443, acc_loss, -0.4035, bias_loss:0.0592
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.4036361277103424, idi:10.998738288879395, p_hat:0.1122320219874382, n:98.0
Epoch [11/20], Loss: -0.3850, acc_loss, -0.4315, bias_loss:0.0465
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [11/20], Loss: -0.3295, acc_loss, -0.3803, bias_loss:0.0508
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:0.4040599465370178, idi:10.99999713897705, p_hat:0.1122448667883873, n:98.0
Epoch [11/20], Loss: -0.3664, acc_loss, -0.4129, bias_loss:0.0465
-->start_index 1666
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9664429530201343
-->z_score:-0.009446303360164165, idi:9.77194595336914, p_hat:0.09971373528242111, n:98.0
Epoch [11/20], Loss: -0.2877, acc_loss, -0.3290, bias_loss:0.0414
-->start_index 1764
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9866666666666668
-->z_score:-0.3227020800113678, idi:8.84162425994873, p_hat:0.09022065252065659, n:98.0
Epoch [11/20], Loss: -0.4160, acc_loss, -0.4535, bias_loss:0.0374
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-1.3411569595336914, idi:5.816967487335205, p_hat:0.05935681238770485, n:98.0
Epoch [11/20], Loss: -0.4812, acc_loss, -0.5058, bias_loss:0.0246
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [11/20], Loss: -0.4242, acc_loss, -0.4504, bias_loss:0.0262
-->after epoch 10
-->overall baseline on training dataset
-->ACC 0.98718633208756
-->F1 0.9928336816960286
-->FPR: 0.08014796547472257
-->FNR: 0.004640023948510702
-->overall baseline on testing dataset
-->ACC 0.9146683276237932
-->F1 0.9524140326502258
-->FPR: 0.4935064935064935
-->FNR: 0.029723991507430998
training dataset
-->original metric score:
-->individual metric:0.11351079859367152, num_idi:226, num_all:1991
-->individual metric 0.11351079859367152
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.9836552748885586
-->F1 0.9905579399141631
-->FPR 0.07608695652173914
-->FNR 0.0068846815834767644
-->positive probability:0.8677563150074294, 584/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9716494845360825
-->F1 0.9832572298325722
-->FPR 0.11475409836065574
-->FNR 0.012232415902140673
-->positive probability:0.8505154639175257, 330/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.92
-->F1 0.9545454545454545
-->FPR 0.42857142857142855
-->FNR 0.023255813953488372
-->positive probability:0.9, 45/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9117647058823529
-->F1 0.9189189189189189
-->FPR 0.17647058823529413
-->FNR 0.0
-->positive probability:0.5882352941176471, 20/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9144385026737968
-->F1 0.9245283018867925
-->FPR 0.12048192771084337
-->FNR 0.057692307692307696
-->positive probability:0.5775401069518716, 108/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9540540540540541
-->F1 0.9662027833001988
-->FPR 0.09090909090909091
-->FNR 0.024096385542168676
-->positive probability:0.6864864864864865, 254/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9606741573033708
-->F1 0.9748020158387328
-->FPR 0.09183673469387756
-->FNR 0.024495677233429394
-->positive probability:0.7808988764044944, 695/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.004061008952983433, 0.03460613288593317, 0.03252891785567495, 0.34842346309670597, 0.09632262276057156, 0.040333962236120804, 0.010761125434368343, 0.011688769219154987]
-->fnr_diff [0.002244657634966062, 0.0075923919536299705, 0.0953599760514893, 0.01861579000497767, 0.004640023948510702, 0.053052283743796995, 0.019456361593657975, 0.019855653284918694]
-->FPR:[0.07608695652173914, 0.11475409836065574, 0.047619047619047616, 0.42857142857142855, 0.17647058823529413, 0.12048192771084337, 0.09090909090909091, 0.09183673469387756], mean FPR:0.14334123407774713, mean FPR diff:0.07234075030518916
-->FNR:[0.0068846815834767644, 0.012232415902140673, 0.1, 0.023255813953488372, 0.0, 0.057692307692307696, 0.024096385542168676, 0.024495677233429394], mean FNR:0.031082160238376448, mean FNR diff:0.027602142276993424
-->mean fnr diff metric 0.07234075030518916
testing dataset
-->original metric score:
-->individual metric:0.1702127659574468, num_idi:144, num_all:846
-->individual metric 0.1702127659574468
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8801369863013698
-->F1 0.9306930693069307
-->FPR 0.5217391304347826
-->FNR 0.044715447154471545
-->positive probability:0.886986301369863, 259/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8465909090909091
-->F1 0.9025270758122743
-->FPR 0.4418604651162791
-->FNR 0.06015037593984962
-->positive probability:0.8181818181818182, 144/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7368421052631579
-->FPR 0.8
-->FNR 0.125
-->positive probability:0.8461538461538461, 11/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7083333333333334
-->F1 0.7272727272727274
-->FPR 0.425
-->FNR 0.125
-->positive probability:0.625, 45/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7579617834394905
-->F1 0.8137254901960784
-->FPR 0.4375
-->FNR 0.10752688172043011
-->positive probability:0.7070063694267515, 111/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8241469816272966
-->F1 0.8903436988543372
-->FPR 0.5227272727272727
-->FNR 0.07167235494880546
-->positive probability:0.8346456692913385, 318/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.02823263692828909, 0.05164602839021443, 0.4935064935064935, 0.17316017316017313, 0.30649350649350654, 0.06850649350649352, 0.056006493506493504, 0.029220779220779203]
-->fnr_diff [0.014991455647040547, 0.030426384432418623, 0.08138711960368011, 0.029723991507430998, 0.09527600849256901, 0.09527600849256901, 0.0778028902129991, 0.04194836344137446]
-->FPR:[0.5217391304347826, 0.4418604651162791, 0.0, 0.6666666666666666, 0.8, 0.425, 0.4375, 0.5227272727272727], mean FPR:0.47693669186812515, mean FPR diff:0.15084657558905537
-->FNR:[0.044715447154471545, 0.06015037593984962, 0.1111111111111111, 0.0, 0.125, 0.125, 0.10752688172043011, 0.07167235494880546], mean FNR:0.08064702135933348, mean FNR diff:0.058354027728760235
-->mean fnr diff metric 0.15084657558905537
-->epoch 11
-->start_index 0
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9743589743589743
-->z_score:1.4023674726486206, idi:13.964818954467773, p_hat:0.14249815046787262, n:98.0
Epoch [12/20], Loss: -0.2137, acc_loss, -0.2728, bias_loss:0.0591
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [12/20], Loss: -0.4058, acc_loss, -0.4524, bias_loss:0.0465
-->start_index 196
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9689440993788819
-->z_score:0.6603913307189941, idi:11.761261940002441, p_hat:0.12001287937164307, n:98.0
Epoch [12/20], Loss: -0.2932, acc_loss, -0.3430, bias_loss:0.0498
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:1.7509312629699707, idi:15.0, p_hat:0.15306122601032257, n:98.0
Epoch [12/20], Loss: -0.3314, acc_loss, -0.3948, bias_loss:0.0635
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9681528662420382
-->z_score:-1.952961802482605, idi:4.0, p_hat:0.040816325694322586, n:98.0
Epoch [12/20], Loss: -0.3264, acc_loss, -0.3434, bias_loss:0.0169
-->start_index 490
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.958904109589041
-->z_score:1.0774959325790405, idi:13.0, p_hat:0.13265305757522583, n:98.0
Epoch [12/20], Loss: -0.2631, acc_loss, -0.3181, bias_loss:0.0550
-->start_index 588
-->batch_size 98
-->ACC 0.9285714285714286
-->F1 0.9548387096774195
-->z_score:1.3829994201660156, idi:13.907299041748047, p_hat:0.14191120862960815, n:98.0
Epoch [12/20], Loss: -0.0833, acc_loss, -0.1421, bias_loss:0.0589
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9878048780487805
-->z_score:1.9196890592575073, idi:15.50118637084961, p_hat:0.15817536413669586, n:98.0
Epoch [12/20], Loss: -0.4227, acc_loss, -0.4883, bias_loss:0.0656
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-1.137168288230896, idi:6.422782897949219, p_hat:0.06553860008716583, n:98.0
Epoch [12/20], Loss: -0.4412, acc_loss, -0.4683, bias_loss:0.0272
-->start_index 882
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9870129870129869
-->z_score:0.40226104855537415, idi:10.994654655456543, p_hat:0.1121903508901596, n:98.0
Epoch [12/20], Loss: -0.4112, acc_loss, -0.4578, bias_loss:0.0465
-->start_index 980
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.963855421686747
-->z_score:0.7406013011932373, idi:11.999473571777344, p_hat:0.12244360893964767, n:98.0
Epoch [12/20], Loss: -0.2997, acc_loss, -0.3504, bias_loss:0.0508
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.061625685542821884, idi:9.98301887512207, p_hat:0.10186754167079926, n:98.0
Epoch [12/20], Loss: -0.4769, acc_loss, -0.5192, bias_loss:0.0422
-->start_index 1176
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9871794871794872
-->z_score:1.2235151529312134, idi:13.43365478515625, p_hat:0.13707810640335083, n:98.0
Epoch [12/20], Loss: -0.4421, acc_loss, -0.4990, bias_loss:0.0568
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.4132343530654907, idi:13.997091293334961, p_hat:0.14282746613025665, n:98.0
Epoch [12/20], Loss: -0.3431, acc_loss, -0.4024, bias_loss:0.0592
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.37597331404685974, idi:10.916584014892578, p_hat:0.11139371246099472, n:98.0
Epoch [12/20], Loss: -0.3925, acc_loss, -0.4387, bias_loss:0.0462
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [12/20], Loss: -0.3287, acc_loss, -0.3795, bias_loss:0.0508
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:0.664560079574585, idi:11.773642539978027, p_hat:0.1201392114162445, n:98.0
Epoch [12/20], Loss: -0.3759, acc_loss, -0.4257, bias_loss:0.0498
-->start_index 1666
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9664429530201343
-->z_score:-0.40926477313041687, idi:8.584546089172363, p_hat:0.08759740740060806, n:98.0
Epoch [12/20], Loss: -0.2824, acc_loss, -0.3188, bias_loss:0.0363
-->start_index 1764
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9866666666666668
-->z_score:-0.9524732232093811, idi:6.971299171447754, p_hat:0.07113570719957352, n:98.0
Epoch [12/20], Loss: -0.4311, acc_loss, -0.4606, bias_loss:0.0295
-->start_index 1862
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9880952380952381
-->z_score:-1.6162441968917847, idi:5.0, p_hat:0.051020409911870956, n:98.0
Epoch [12/20], Loss: -0.4883, acc_loss, -0.5095, bias_loss:0.0212
-->start_index 1960
-->batch_size 98
-->ACC 0.9666666666666667
-->F1 0.9811320754716981
-->z_score:-1.2171612977981567, idi:1.0, p_hat:0.03333333507180214, n:30.0
Epoch [12/20], Loss: -0.4310, acc_loss, -0.4572, bias_loss:0.0262
-->after epoch 11
-->overall baseline on training dataset
-->ACC 0.9869193806727176
-->F1 0.9926854754440961
-->FPR: 0.08261405672009864
-->FNR: 0.004640023948510702
-->overall baseline on testing dataset
-->ACC 0.9149797570850202
-->F1 0.9526123936816524
-->FPR: 0.4961038961038961
-->FNR: 0.029016277423920735
training dataset
-->original metric score:
-->individual metric:0.10999497739829231, num_idi:219, num_all:1991
-->individual metric 0.10999497739829231
-->all_length: 1991
-->identity male
-->length 673
-->ACC 0.9836552748885586
-->F1 0.9905579399141631
-->FPR 0.07608695652173914
-->FNR 0.0068846815834767644
-->positive probability:0.8677563150074294, 584/673
-->group-truth label positive probability:0.8632986627043091, 581/673
-->identity female
-->length 388
-->ACC 0.9716494845360825
-->F1 0.9832572298325722
-->FPR 0.11475409836065574
-->FNR 0.012232415902140673
-->positive probability:0.8505154639175257, 330/388
-->group-truth label positive probability:0.8427835051546392, 327/388
-->identity homosexual
-->length 41
-->ACC 0.926829268292683
-->F1 0.9230769230769231
-->FPR 0.047619047619047616
-->FNR 0.1
-->positive probability:0.4634146341463415, 19/41
-->group-truth label positive probability:0.4878048780487805, 20/41
-->identity christian
-->length 50
-->ACC 0.92
-->F1 0.9545454545454545
-->FPR 0.42857142857142855
-->FNR 0.023255813953488372
-->positive probability:0.9, 45/50
-->group-truth label positive probability:0.86, 43/50
-->identity muslim
-->length 34
-->ACC 0.9117647058823529
-->F1 0.9189189189189189
-->FPR 0.17647058823529413
-->FNR 0.0
-->positive probability:0.5882352941176471, 20/34
-->group-truth label positive probability:0.5, 17/34
-->identity jewish
-->length 187
-->ACC 0.9090909090909091
-->F1 0.92018779342723
-->FPR 0.13253012048192772
-->FNR 0.057692307692307696
-->positive probability:0.5828877005347594, 109/187
-->group-truth label positive probability:0.5561497326203209, 104/187
-->identity black
-->length 370
-->ACC 0.9567567567567568
-->F1 0.9682539682539684
-->FPR 0.09090909090909091
-->FNR 0.020080321285140562
-->positive probability:0.6891891891891891, 255/370
-->group-truth label positive probability:0.672972972972973, 249/370
-->identity white
-->length 890
-->ACC 0.9595505617977528
-->F1 0.9741007194244605
-->FPR 0.09693877551020408
-->FNR 0.024495677233429394
-->positive probability:0.7820224719101123, 696/890
-->group-truth label positive probability:0.7797752808988764, 694/890
-->fpr_diff [0.006527100198359503, 0.0321400416405571, 0.03499500910105102, 0.3459573718513299, 0.09385653151519549, 0.04991606376182908, 0.008295034188992273, 0.01432471879010544]
-->fnr_diff [0.002244657634966062, 0.0075923919536299705, 0.0953599760514893, 0.01861579000497767, 0.004640023948510702, 0.053052283743796995, 0.01544029733662986, 0.019855653284918694]
-->FPR:[0.07608695652173914, 0.11475409836065574, 0.047619047619047616, 0.42857142857142855, 0.17647058823529413, 0.13253012048192772, 0.09090909090909091, 0.09693877551020408], mean FPR:0.14548501327617347, mean FPR diff:0.07325148388092748
-->FNR:[0.0068846815834767644, 0.012232415902140673, 0.1, 0.023255813953488372, 0.0, 0.057692307692307696, 0.020080321285140562, 0.024495677233429394], mean FNR:0.030580152206247935, mean FNR diff:0.027100134244864908
-->mean fnr diff metric 0.07325148388092748
testing dataset
-->original metric score:
-->individual metric:0.1690307328605201, num_idi:143, num_all:846
-->individual metric 0.1690307328605201
-->all_length: 846
-->identity male
-->length 292
-->ACC 0.8801369863013698
-->F1 0.9306930693069307
-->FPR 0.5217391304347826
-->FNR 0.044715447154471545
-->positive probability:0.886986301369863, 259/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 176
-->ACC 0.8409090909090909
-->F1 0.8992805755395683
-->FPR 0.46511627906976744
-->FNR 0.06015037593984962
-->positive probability:0.8238636363636364, 145/176
-->group-truth label positive probability:0.7556818181818182, 133/176
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6153846153846154
-->F1 0.7368421052631579
-->FPR 0.8
-->FNR 0.125
-->positive probability:0.8461538461538461, 11/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.6944444444444444
-->F1 0.717948717948718
-->FPR 0.45
-->FNR 0.125
-->positive probability:0.6388888888888888, 46/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7515923566878981
-->F1 0.8097560975609757
-->FPR 0.453125
-->FNR 0.10752688172043011
-->positive probability:0.7133757961783439, 112/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8241469816272966
-->F1 0.8903436988543372
-->FPR 0.5227272727272727
-->FNR 0.07167235494880546
-->positive probability:0.8346456692913385, 318/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.02563523433088649, 0.030987617034128667, 0.4961038961038961, 0.17056277056277053, 0.30389610389610394, 0.04610389610389609, 0.0429788961038961, 0.026623376623376604]
-->fnr_diff [0.01569916973055081, 0.031134098515928885, 0.08209483368719037, 0.029016277423920735, 0.09598372257607926, 0.09598372257607926, 0.07851060429650937, 0.04265607752488472]
-->FPR:[0.5217391304347826, 0.46511627906976744, 0.0, 0.6666666666666666, 0.8, 0.45, 0.453125, 0.5227272727272727], mean FPR:0.48492179361231114, mean FPR diff:0.14286147384486933
-->FNR:[0.044715447154471545, 0.06015037593984962, 0.1111111111111111, 0.0, 0.125, 0.125, 0.10752688172043011, 0.07167235494880546], mean FNR:0.08064702135933348, mean FNR diff:0.058884813291392925
-->mean fnr diff metric 0.14286147384486933
-->epoch 12
-->start_index 0
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9743589743589743
-->z_score:0.7407765984535217, idi:11.999994277954102, p_hat:0.12244892120361328, n:98.0
Epoch [13/20], Loss: -0.2122, acc_loss, -0.2630, bias_loss:0.0508
-->start_index 98
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9927007299270074
-->z_score:0.06733693927526474, idi:9.999980926513672, p_hat:0.1020406186580658, n:98.0
Epoch [13/20], Loss: -0.4006, acc_loss, -0.4429, bias_loss:0.0423
-->start_index 196
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9689440993788819
-->z_score:0.404060959815979, idi:11.0, p_hat:0.11224489659070969, n:98.0
Epoch [13/20], Loss: -0.3045, acc_loss, -0.3511, bias_loss:0.0465
-->start_index 294
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.975
-->z_score:1.7489502429962158, idi:14.994115829467773, p_hat:0.15300118923187256, n:98.0
Epoch [13/20], Loss: -0.3366, acc_loss, -0.4001, bias_loss:0.0635
-->start_index 392
-->batch_size 98
-->ACC 0.9489795918367347
-->F1 0.9681528662420382
-->z_score:-1.952961802482605, idi:4.0, p_hat:0.040816325694322586, n:98.0
Epoch [13/20], Loss: -0.3305, acc_loss, -0.3475, bias_loss:0.0169
-->start_index 490
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.958904109589041
-->z_score:1.077485203742981, idi:12.999967575073242, p_hat:0.13265272974967957, n:98.0
Epoch [13/20], Loss: -0.2645, acc_loss, -0.3195, bias_loss:0.0550
-->start_index 588
-->batch_size 98
-->ACC 0.9183673469387755
-->F1 0.9487179487179488
-->z_score:1.3729413747787476, idi:13.87742805480957, p_hat:0.141606405377388, n:98.0
Epoch [13/20], Loss: -0.0930, acc_loss, -0.1517, bias_loss:0.0587
-->start_index 686
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9878048780487805
-->z_score:1.235361933708191, idi:13.46883773803711, p_hat:0.1374371200799942, n:98.0
Epoch [13/20], Loss: -0.4275, acc_loss, -0.4845, bias_loss:0.0570
-->start_index 784
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9861111111111112
-->z_score:-1.2795270681381226, idi:5.999999046325684, p_hat:0.06122447922825813, n:98.0
Epoch [13/20], Loss: -0.4339, acc_loss, -0.4593, bias_loss:0.0254
-->start_index 882
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9870129870129869
-->z_score:0.06275318562984467, idi:9.986367225646973, p_hat:0.10190171003341675, n:98.0
Epoch [13/20], Loss: -0.4168, acc_loss, -0.4590, bias_loss:0.0423
-->start_index 980
-->batch_size 98
-->ACC 0.9387755102040817
-->F1 0.963855421686747
-->z_score:0.740744411945343, idi:11.999898910522461, p_hat:0.12244794517755508, n:98.0
Epoch [13/20], Loss: -0.3168, acc_loss, -0.3676, bias_loss:0.0508
-->start_index 1078
-->batch_size 98
-->ACC 0.9897959183673469
-->F1 0.9935483870967742
-->z_score:0.06731382757425308, idi:9.99991226196289, p_hat:0.10203991830348969, n:98.0
Epoch [13/20], Loss: -0.4785, acc_loss, -0.5208, bias_loss:0.0423
-->start_index 1176
-->batch_size 98
-->ACC 0.9795918367346939
-->F1 0.9871794871794872
-->z_score:0.4040606915950775, idi:10.999999046325684, p_hat:0.11224488914012909, n:98.0
Epoch [13/20], Loss: -0.4538, acc_loss, -0.5004, bias_loss:0.0465
-->start_index 1274
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9736842105263157
-->z_score:2.0876386165618896, idi:15.999970436096191, p_hat:0.16326500475406647, n:98.0
Epoch [13/20], Loss: -0.3341, acc_loss, -0.4018, bias_loss:0.0677
-->start_index 1372
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:0.40400072932243347, idi:10.999820709228516, p_hat:0.11224307119846344, n:98.0
Epoch [13/20], Loss: -0.3936, acc_loss, -0.4401, bias_loss:0.0465
-->start_index 1470
-->batch_size 98
-->ACC 0.9693877551020408
-->F1 0.9793103448275863
-->z_score:0.7407785654067993, idi:12.0, p_hat:0.12244898080825806, n:98.0
Epoch [13/20], Loss: -0.3196, acc_loss, -0.3703, bias_loss:0.0508
-->start_index 1568
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.9733333333333334
-->z_score:1.0317553281784058, idi:12.864156723022461, p_hat:0.13126690685749054, n:98.0
Epoch [13/20], Loss: -0.3695, acc_loss, -0.4239, bias_loss:0.0544
-->start_index 1666
-->batch_size 98
-->ACC 0.9591836734693877
-->F1 0.972972972972973
-->z_score:-0.039994727820158005, idi:9.681221961975098, p_hat:0.09878797829151154, n:98.0
Epoch [13/20], Loss: -0.2805, acc_loss, -0.3214, bias_loss:0.0410
-->sta