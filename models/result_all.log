nohup: ignoring input
2023-07-19 18:48:26.266634: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-07-19 18:48:26.437468: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-07-19 18:48:26.974911: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-07-19 18:48:26.974983: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-07-19 18:48:26.974991: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
-->device cuda:0
-->device cuda:0
-->arguments:
ModelArguments(model_name_or_path='./output/hate_speech_twitter/', config_name=None, tokenizer_name=None, cache_dir=None, use_fast_tokenizer=True, model_revision='main', use_auth_token=False, ignore_mismatched_sizes=False)
DataTrainingArguments(task_name=None, dataset_name=None, dataset_config_name=None, max_seq_length=128, overwrite_cache=False, pad_to_max_length=True, max_train_samples=None, max_eval_samples=None, max_predict_samples=None, train_file='dataset/hate_speech_twitter/train.csv', validation_file='dataset/hate_speech_twitter/test.csv', test_file='dataset/hate_speech_twitter/test.csv')
TrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
bf16=False,
bf16_full_eval=False,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=False,
do_predict=False,
do_train=False,
eval_accumulation_steps=None,
eval_delay=0,
eval_steps=None,
evaluation_strategy=no,
fp16=true,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=./output/test/runs/Jul19_18-48-27_SJgroup,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=500,
logging_strategy=steps,
lr_scheduler_type=linear,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=3,
optim=adamw_hf,
output_dir=./output/test/,
overwrite_output_dir=true,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=['tensorboard'],
resume_from_checkpoint=None,
run_name=./output/test/,
save_on_each_node=False,
save_steps=500,
save_strategy=steps,
save_total_limit=None,
seed=42,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_ipex=False,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
-->device cuda:0
-->is_available True
Tesla T4
-->current_device:  0
-->n_gpu 1
07/19/2023 18:48:27 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 1distributed training: False, 16-bits training: true
07/19/2023 18:48:27 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
bf16=False,
bf16_full_eval=False,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=False,
do_predict=False,
do_train=False,
eval_accumulation_steps=None,
eval_delay=0,
eval_steps=None,
evaluation_strategy=no,
fp16=true,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=./output/test/runs/Jul19_18-48-27_SJgroup,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=500,
logging_strategy=steps,
lr_scheduler_type=linear,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=3,
optim=adamw_hf,
output_dir=./output/test/,
overwrite_output_dir=true,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=['tensorboard'],
resume_from_checkpoint=None,
run_name=./output/test/,
save_on_each_node=False,
save_steps=3000,
save_strategy=steps,
save_total_limit=None,
seed=42,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_ipex=False,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
07/19/2023 18:48:27 - INFO - __main__ - load a local file for train: dataset/hate_speech_twitter/train.csv
07/19/2023 18:48:27 - INFO - __main__ - load a local file for validation: dataset/hate_speech_twitter/test.csv
07/19/2023 18:48:27 - INFO - __main__ - load a local file for test: dataset/hate_speech_twitter/test.csv
07/19/2023 18:48:28 - INFO - datasets.builder - Using custom data configuration default-1d8986503c24eaac
07/19/2023 18:48:28 - INFO - datasets.info - Loading Dataset Infos from /home/mengdi/.local/lib/python3.8/site-packages/datasets/packaged_modules/csv
07/19/2023 18:48:28 - INFO - datasets.builder - Overwrite dataset info from restored data version if exists.
07/19/2023 18:48:28 - INFO - datasets.info - Loading Dataset info from /home/mengdi/.cache/huggingface/datasets/csv/default-1d8986503c24eaac/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1
07/19/2023 18:48:28 - WARNING - datasets.builder - Found cached dataset csv (/home/mengdi/.cache/huggingface/datasets/csv/default-1d8986503c24eaac/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1)
07/19/2023 18:48:28 - INFO - datasets.info - Loading Dataset info from /home/mengdi/.cache/huggingface/datasets/csv/default-1d8986503c24eaac/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1

  0%|          | 0/3 [00:00<?, ?it/s]
100%|██████████| 3/3 [00:00<00:00, 1093.50it/s]
[INFO|configuration_utils.py:679] 2023-07-19 18:48:28,875 >> loading configuration file ./output/hate_speech_twitter/config.json
[INFO|configuration_utils.py:730] 2023-07-19 18:48:28,876 >> Model config BertConfig {
  "_name_or_path": "./output/hate_speech_twitter/",
  "adapters": {
    "adapters": {},
    "config_map": {},
    "fusion_config_map": {},
    "fusions": {}
  },
  "architectures": [
    "BertForSequenceClassification"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "id2label": {
    "0": 0,
    "1": 1
  },
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "0": 0,
    "1": 1
  },
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "output_attentions": true,
  "output_hidden_states": true,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "problem_type": "single_label_classification",
  "torch_dtype": "float32",
  "transformers_version": "4.21.3",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 28996
}

[INFO|tokenization_utils_base.py:1723] 2023-07-19 18:48:28,876 >> Didn't find file ./output/hate_speech_twitter/added_tokens.json. We won't load it.
[INFO|tokenization_utils_base.py:1801] 2023-07-19 18:48:28,876 >> loading file ./output/hate_speech_twitter/vocab.txt
[INFO|tokenization_utils_base.py:1801] 2023-07-19 18:48:28,877 >> loading file ./output/hate_speech_twitter/tokenizer.json
[INFO|tokenization_utils_base.py:1801] 2023-07-19 18:48:28,877 >> loading file None
[INFO|tokenization_utils_base.py:1801] 2023-07-19 18:48:28,877 >> loading file ./output/hate_speech_twitter/special_tokens_map.json
[INFO|tokenization_utils_base.py:1801] 2023-07-19 18:48:28,877 >> loading file ./output/hate_speech_twitter/tokenizer_config.json
[INFO|modeling_utils.py:2039] 2023-07-19 18:48:28,906 >> loading weights file ./output/hate_speech_twitter/pytorch_model.bin
[INFO|modeling_utils.py:2435] 2023-07-19 18:48:29,706 >> All model checkpoint weights were used when initializing BertForSequenceClassification.

[INFO|modeling_utils.py:2443] 2023-07-19 18:48:29,706 >> All the weights of BertForSequenceClassification were initialized from the model checkpoint at ./output/hate_speech_twitter/.
If your task is similar to the task the model of the checkpoint was trained on, you can already use BertForSequenceClassification for predictions without further training.
-->label_list [0, 1]
-->raw_datasets DatasetDict({
    train: Dataset({
        features: ['Unnamed: 0', 'text', 'label'],
        num_rows: 9225
    })
    validation: Dataset({
        features: ['Unnamed: 0', 'text', 'label'],
        num_rows: 3955
    })
    test: Dataset({
        features: ['Unnamed: 0', 'text', 'label'],
        num_rows: 3955
    })
})
07/19/2023 18:48:31 - WARNING - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x7f169c1f0e50> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
07/19/2023 18:48:31 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/mengdi/.cache/huggingface/datasets/csv/default-1d8986503c24eaac/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-1c80317fa3b1799d.arrow
07/19/2023 18:48:31 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x7f169c1f0e50> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
07/19/2023 18:48:31 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/mengdi/.cache/huggingface/datasets/csv/default-1d8986503c24eaac/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-bdd640fb06671ad1.arrow
07/19/2023 18:48:31 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x7f169c1f0e50> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
07/19/2023 18:48:31 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/mengdi/.cache/huggingface/datasets/csv/default-1d8986503c24eaac/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-3eb13b9046685257.arrow
[INFO|trainer.py:555] 2023-07-19 18:48:33,203 >> Using cuda_amp half precision backend
[INFO|modeling_utils.py:2039] 2023-07-19 18:48:33,204 >> loading weights file ./output/hate_speech_twitter/pytorch_model.bin
[INFO|modeling_utils.py:2435] 2023-07-19 18:48:33,980 >> All model checkpoint weights were used when initializing BertForSequenceClassification.

[INFO|modeling_utils.py:2443] 2023-07-19 18:48:33,980 >> All the weights of BertForSequenceClassification were initialized from the model checkpoint at ./output/hate_speech_twitter/.
If your task is similar to the task the model of the checkpoint was trained on, you can already use BertForSequenceClassification for predictions without further training.
-->Do Custom Model
-->gamma 1
-->model.parameters() <generator object Module.parameters at 0x7f167fa6aba0>
-->classifier <generator object Module.parameters at 0x7f167fa6aba0>
-->orig_weight tensor([[-0.0153,  0.0072, -0.0222,  ...,  0.0030,  0.0304, -0.0347],
        [-0.0036, -0.0129,  0.0329,  ...,  0.0022, -0.0106,  0.0357],
        [-0.0289,  0.0154, -0.0010,  ...,  0.0194,  0.0028, -0.0017],
        ...,
        [-0.0043, -0.0288, -0.0088,  ...,  0.0138,  0.0355,  0.0232],
        [ 0.0323, -0.0258,  0.0002,  ...,  0.0115,  0.0021,  0.0288],
        [ 0.0199,  0.0185,  0.0066,  ...,  0.0277,  0.0317, -0.0036]],
       device='cuda:0', grad_fn=<CloneBackward0>)
-->orig_bias tensor([-0.0154, -0.0195,  0.0195,  0.0179, -0.0157,  0.0325,  0.0289,  0.0058,
        -0.0116,  0.0227, -0.0167,  0.0213,  0.0117, -0.0140,  0.0187, -0.0304,
        -0.0207, -0.0191, -0.0019, -0.0283, -0.0069, -0.0283, -0.0303,  0.0349,
         0.0093,  0.0073,  0.0194,  0.0046,  0.0351, -0.0079, -0.0181, -0.0305,
        -0.0143, -0.0116,  0.0188,  0.0337, -0.0105, -0.0104, -0.0264,  0.0049,
        -0.0270, -0.0288, -0.0317,  0.0162, -0.0334,  0.0064, -0.0188, -0.0266,
         0.0158, -0.0136, -0.0107, -0.0051,  0.0295,  0.0126, -0.0286, -0.0360,
        -0.0248, -0.0211, -0.0207, -0.0330, -0.0103], device='cuda:0',
       grad_fn=<CloneBackward0>)
-->MinValue:-3.2998316455372216, MaxValue:3.9719170089423623
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9135338345864662
-->F1 0.9291217257318952
-->FPR 0.046511627906976744
-->FNR 0.10930576070901034
-->positive probability:0.5836466165413534, 621/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9080987937966686
-->F1 0.93993993993994
-->FPR 0.07584269662921349
-->FNR 0.096028880866426
-->positive probability:0.7346352670878805, 1279/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9605263157894737
-->F1 0.9798657718120806
-->FPR None
-->FNR 0.039473684210526314
-->positive probability:0.9605263157894737, 73/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9660194174757282
-->F1 0.9826732673267327
-->FPR 0.6666666666666666
-->FNR 0.029339853300733496
-->positive probability:0.9684466019417476, 399/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.03167168790697675, 0.06100275662921349, 0.01483994, 0.6518267266666666, 0.007382282222222224, 0.01483994]
-->fnr_diff [0.09333415070901034, 0.080057270866426, 0.10167544882352941, 0.023502074210526313, 0.013368243300733496, 0.017361723333333332, 0.11916352513513515, 0.10902839]
-->FPR: [0.046511627906976744, 0.07584269662921349, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13520720223751317, mean FPR diff:0.1302605555708465
-->FNR: [0.10930576070901034, 0.096028880866426, 0.11764705882352941, 0.039473684210526314, 0.029339853300733496, 0.03333333333333333, 0.13513513513513514, 0.125], mean FNR:0.08565796329733676, mean FNR diff:0.06968635329733676
-->base group metric 0.1302605555708465 0.13520720223751317
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8698481561822126
-->F1 0.8951048951048952
-->FPR 0.09937888198757763
-->FNR 0.14666666666666667
-->positive probability:0.5900216919739696, 272/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8645251396648045
-->F1 0.9117379435850772
-->FPR 0.17482517482517482
-->FNR 0.1256544502617801
-->positive probability:0.7346368715083799, 526/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9807692307692307
-->F1 0.9902912621359222
-->FPR 1.0
-->FNR 0.012903225806451613
-->positive probability:0.9871794871794872, 154/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9230769230769231
-->F1 0.9600000000000001
-->FPR None
-->FNR 0.07692307692307693
-->positive probability:0.9230769230769231, 36/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.75
-->FPR 0.04
-->FNR 0.35714285714285715
-->positive probability:0.2564102564102564, 10/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.08453894198757764, 0.15998523482517482, 0.01483994, 0.48516006, 0.98516006, 0.02516006, 0.12801720285714285]
-->fnr_diff [0.13069505666666667, 0.1096828402617801, 0.10902839, 0.01597161, 0.0030683841935483878, 0.06095146692307693, 0.3411712471428571, 0.10902839]
-->FPR: [0.09937888198757763, 0.17482517482517482, 0.0, 0.5, 1.0, 0.04, 0.14285714285714285], mean FPR:0.2795801713814136, mean FPR diff:0.26898021423855645
-->FNR: [0.14666666666666667, 0.1256544502617801, 0.125, 0.0, 0.012903225806451613, 0.07692307692307693, 0.35714285714285715, 0.125], mean FNR:0.12116128460010406, mean FNR diff:0.10994967314849116
-->base group metric 0.26898021423855645 0.2795801713814136
-->epoch 0
-->start_index 0
-->batch_size 98
-->FUR:0.002341856947168708, FU:0.1288021355867386, P:55
-->FUR:0.002055945573374629, FU:0.10485322028398514, P:51
-->FUR:0.00324994046241045, FU:0.0129997618496418, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.002661013277247548, FU:0.013305066153407097, P:5
-->FUR:0.0024018127005547285, FU:0.01681268960237503, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.7032, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.9999942183494568, FU:57.999664306640625, P:58
-->FUR:0.9999940991401672, FU:47.999717712402344, P:48
-->FUR:1.0, FU:3.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:0.9999986886978149, FU:0.9999986886978149, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:10.0, P:10
-->FUR:1.0, FU:3.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.6999, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:1.0, FU:54.0, P:54
-->FUR:1.0, FU:54.0, P:54
-->FUR:1.0, FU:4.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:5.0, P:5
-->FUR:1.0, FU:5.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.6837, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:1.0, FU:64.0, P:64
-->FUR:1.0, FU:47.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:7.0, P:7
-->FUR:1.0, FU:3.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.6492, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:1.0, FU:50.0, P:50
-->FUR:1.0, FU:57.0, P:57
-->FUR:1.0, FU:2.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:7.0, P:7
-->FUR:1.0, FU:7.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.6083, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:1.0, FU:50.0, P:50
-->FUR:1.0, FU:50.0, P:50
-->FUR:1.0, FU:2.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:4.0, P:4
-->FUR:1.0, FU:5.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.5191, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.09048449248075485, FU:5.067131519317627, P:56
-->FUR:0.28671303391456604, FU:14.048938751220703, P:49
-->FUR:5.836204763909336e-07, FU:5.836204763909336e-07, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:2.21846174243423e-12, FU:1.5529232413880045e-11, P:7
-->FUR:0.24999991059303284, FU:0.9999996423721313, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.4406, bias_loss:nan
-->after epoch 0
-->overall baseline on training dataset
-->ACC 0.9839566395663957
-->F1 0.9836065573770492
-->FPR: 0.01695993216027136
-->FNR: 0.015084294587400177
-->overall baseline on testing dataset
-->ACC 0.9185840707964602
-->F1 0.9158829676071055
-->FPR: 0.08023483365949119
-->FNR: 0.08267922553636839
training dataset
-->original metric score:
-->individual metric:0.12383580545015523, num_idi:359, num_all:2899
-->individual metric 0.12383580545015523
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9238721804511278
-->F1 0.9382151029748284
-->FPR 0.04909560723514212
-->FNR 0.0915805022156573
-->positive probability:0.5958646616541353, 634/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9149913842619184
-->F1 0.944776119402985
-->FPR 0.08146067415730338
-->FNR 0.08592057761732852
-->positive probability:0.7438253877082137, 1295/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9736842105263158
-->F1 0.9866666666666666
-->FPR None
-->FNR 0.02631578947368421
-->positive probability:0.9736842105263158, 74/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9830097087378641
-->F1 0.9914110429447852
-->FPR 0.6666666666666666
-->FNR 0.012224938875305624
-->positive probability:0.9854368932038835, 406/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.032135675074870765, 0.06450074199703201, 0.01695993216027136, 0.6497067345063953, 0.005262290061950864, 0.01695993216027136]
-->fnr_diff [0.07649620762825712, 0.07083628302992834, 0.10256276423612923, 0.011231494886284032, 0.0028593557120945527, 0.018249038745933158, 0.09302381352070793, 0.10991570541259982]
-->FPR:[0.04909560723514212, 0.08146067415730338, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13657419504688906, mean FPR diff:0.1309208843267986
-->FNR:[0.0915805022156573, 0.08592057761732852, 0.11764705882352941, 0.02631578947368421, 0.012224938875305624, 0.03333333333333333, 0.10810810810810811, 0.125], mean FNR:0.07501628855586831, mean FNR diff:0.06064683289649177
-->mean fnr diff metric 0.1309208843267986
testing dataset
-->original metric score:
-->individual metric:0.15049342105263158, num_idi:183, num_all:1216
-->individual metric 0.15049342105263158
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8676789587852495
-->F1 0.8939130434782608
-->FPR 0.11180124223602485
-->FNR 0.14333333333333334
-->positive probability:0.596529284164859, 275/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8659217877094972
-->F1 0.9133574007220217
-->FPR 0.20279720279720279
-->FNR 0.1169284467713787
-->positive probability:0.7472067039106145, 535/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.75
-->FPR 0.04
-->FNR 0.35714285714285715
-->positive probability:0.2564102564102564, 10/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.03156640857653366, 0.1225623691377116, 0.08023483365949119, 0.4197651663405088, 0.9197651663405089, 0.04023483365949119, 0.06262230919765166]
-->fnr_diff [0.06065410779696495, 0.03424922123501031, 0.04232077446363161, 0.08267922553636839, 0.08267922553636839, 0.03139717425431711, 0.2744636316064888, 0.04232077446363161]
-->FPR:[0.11180124223602485, 0.20279720279720279, 0.0, 0.5, 1.0, 0.04, 0.14285714285714285], mean FPR:0.28535079827005294, mean FPR diff:0.2395358695588424
-->FNR:[0.14333333333333334, 0.1169284467713787, 0.125, 0.0, 0.0, 0.05128205128205128, 0.35714285714285715, 0.125], mean FNR:0.11483583606620255, mean FNR diff:0.08134551686159765
-->mean fnr diff metric 0.2395358695588424
-->epoch 1
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.03921568766236305, FU:2.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.3080, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.2349, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1980, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.06382978707551956, FU:3.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1883, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.035087719559669495, FU:2.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.2048, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.04000487178564072, FU:2.000243663787842, P:50
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.2668, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.1428571492433548, FU:7.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.2314, bias_loss:nan
-->after epoch 1
-->overall baseline on training dataset
-->ACC 0.9835230352303523
-->F1 0.9831073571904868
-->FPR: 0.014203943184227264
-->FNR: 0.01885536823425022
-->overall baseline on testing dataset
-->ACC 0.9193426042983565
-->F1 0.9156753899021941
-->FPR: 0.0684931506849315
-->FNR: 0.09366823652537938
training dataset
-->original metric score:
-->individual metric:0.12763021731631596, num_idi:370, num_all:2899
-->individual metric 0.12763021731631596
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9163533834586466
-->F1 0.9312741312741312
-->FPR 0.03875968992248062
-->FNR 0.10930576070901034
-->positive probability:0.5808270676691729, 618/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9080987937966686
-->F1 0.9398496240601503
-->FPR 0.0702247191011236
-->FNR 0.09747292418772563
-->positive probability:0.7323377369327972, 1275/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9605263157894737
-->F1 0.9798657718120806
-->FPR None
-->FNR 0.039473684210526314
-->positive probability:0.9605263157894737, 73/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9684466019417476
-->F1 0.9839307787391842
-->FPR 0.6666666666666666
-->FNR 0.02689486552567237
-->positive probability:0.970873786407767, 400/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.024555746738253358, 0.05602077591689634, 0.014203943184227264, 0.6524627234824394, 0.00801827903799496, 0.014203943184227264]
-->fnr_diff [0.09045039247476011, 0.07861755595347542, 0.0987916905892792, 0.020618315976276093, 0.00803949729142215, 0.022811298432416444, 0.0892527398738579, 0.10614463176574979]
-->FPR:[0.03875968992248062, 0.0702247191011236, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13297888298541552, mean FPR diff:0.12824423525733977
-->FNR:[0.10930576070901034, 0.09747292418772563, 0.11764705882352941, 0.039473684210526314, 0.02689486552567237, 0.041666666666666664, 0.10810810810810811, 0.125], mean FNR:0.08319613352890486, mean FNR diff:0.06434076529465463
-->mean fnr diff metric 0.12824423525733977
testing dataset
-->original metric score:
-->individual metric:0.15296052631578946, num_idi:186, num_all:1216
-->individual metric 0.15296052631578946
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8611713665943601
-->F1 0.8869257950530035
-->FPR 0.09316770186335403
-->FNR 0.16333333333333333
-->positive probability:0.5770065075921909, 266/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8589385474860335
-->F1 0.9077625570776257
-->FPR 0.17482517482517482
-->FNR 0.13263525305410123
-->positive probability:0.729050279329609, 522/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9871794871794872
-->F1 0.9935483870967742
-->FPR 1.0
-->FNR 0.0064516129032258064
-->positive probability:0.9935897435897436, 155/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9230769230769231
-->F1 0.9600000000000001
-->FPR None
-->FNR 0.07692307692307693
-->positive probability:0.9230769230769231, 36/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.75
-->FPR 0.04
-->FNR 0.35714285714285715
-->positive probability:0.2564102564102564, 10/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.02467455117842253, 0.10633202414024331, 0.0684931506849315, 0.4315068493150685, 0.9315068493150684, 0.028493150684931502, 0.0029354207436399216]
-->fnr_diff [0.06966509680795395, 0.03896701652872185, 0.03133176347462062, 0.09366823652537938, 0.08721662362215357, 0.016745159602302453, 0.2634746206174778, 0.03133176347462062]
-->FPR:[0.09316770186335403, 0.17482517482517482, 0.0, 0.5, 1.0, 0.04, 0.07142857142857142], mean FPR:0.2684887783024429, mean FPR diff:0.22770599943747222
-->FNR:[0.16333333333333333, 0.13263525305410123, 0.125, 0.0, 0.0064516129032258064, 0.07692307692307693, 0.35714285714285715, 0.125], mean FNR:0.1233107666695743, mean FNR diff:0.07905003508165379
-->mean fnr diff metric 0.22770599943747222
-->epoch 2
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1549, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.2606, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.2260, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.031259797513484955, FU:2.000627040863037, P:64
-->FUR:0.06384313106536865, FU:3.000627040863037, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.2039, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.035087719559669495, FU:2.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1908, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.06692127138376236, FU:3.3460636138916016, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.2172, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.1428571492433548, FU:7.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.2290, bias_loss:nan
-->after epoch 2
-->overall baseline on training dataset
-->ACC 0.9839566395663957
-->F1 0.9835482436638505
-->FPR: 0.013567945728217087
-->FNR: 0.018633540372670808
-->overall baseline on testing dataset
-->ACC 0.9193426042983565
-->F1 0.9156307855064798
-->FPR: 0.06800391389432485
-->FNR: 0.09419152276295134
training dataset
-->original metric score:
-->individual metric:0.12349085891686788, num_idi:358, num_all:2899
-->individual metric 0.12349085891686788
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.918233082706767
-->F1 0.9330254041570439
-->FPR 0.041343669250646
-->FNR 0.10487444608567208
-->positive probability:0.5845864661654135, 622/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9109707064905227
-->F1 0.9417512213453588
-->FPR 0.06460674157303371
-->FNR 0.09530685920577617
-->positive probability:0.7329121194715681, 1276/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9605263157894737
-->F1 0.9798657718120806
-->FPR None
-->FNR 0.039473684210526314
-->positive probability:0.9605263157894737, 73/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9830097087378641
-->F1 0.9914110429447852
-->FPR 0.6666666666666666
-->FNR 0.012224938875305624
-->positive probability:0.9854368932038835, 406/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.027775723522428908, 0.051038795844816624, 0.013567945728217087, 0.6530987209384496, 0.008654276494005136, 0.013567945728217087]
-->fnr_diff [0.08624090571300128, 0.07667331883310535, 0.0990135184508586, 0.020840143837855506, 0.006408601497365184, 0.014699792960662525, 0.0894745677354373, 0.10636645962732919]
-->FPR:[0.041343669250646, 0.06460674157303371, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13247321661876144, mean FPR diff:0.1279505680426891
-->FNR:[0.10487444608567208, 0.09530685920577617, 0.11764705882352941, 0.039473684210526314, 0.012224938875305624, 0.03333333333333333, 0.10810810810810811, 0.125], mean FNR:0.07949605358028138, mean FNR diff:0.062464663581951865
-->mean fnr diff metric 0.1279505680426891
testing dataset
-->original metric score:
-->individual metric:0.1455592105263158, num_idi:177, num_all:1216
-->individual metric 0.1455592105263158
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8655097613882863
-->F1 0.8912280701754387
-->FPR 0.09937888198757763
-->FNR 0.15333333333333332
-->positive probability:0.5856832971800434, 270/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8575418994413407
-->F1 0.906764168190128
-->FPR 0.17482517482517482
-->FNR 0.1343804537521815
-->positive probability:0.7276536312849162, 521/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.75
-->FPR 0.04
-->FNR 0.35714285714285715
-->positive probability:0.2564102564102564, 10/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.031374968093252784, 0.10682126093084997, 0.06800391389432485, 0.43199608610567514, 0.9319960861056752, 0.02800391389432485, 0.003424657534246575]
-->fnr_diff [0.05914181057038198, 0.040188930989230154, 0.03080847723704866, 0.09419152276295134, 0.09419152276295134, 0.04290947148090006, 0.2629513343799058, 0.03080847723704866]
-->FPR:[0.09937888198757763, 0.17482517482517482, 0.0, 0.5, 1.0, 0.04, 0.07142857142857142], mean FPR:0.26937608974876054, mean FPR diff:0.2288029837940499
-->FNR:[0.15333333333333332, 0.1343804537521815, 0.125, 0.0, 0.0, 0.05128205128205128, 0.35714285714285715, 0.125], mean FNR:0.1182673369388029, mean FNR diff:0.08189894342755225
-->mean fnr diff metric 0.2288029837940499
-->epoch 3
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1436, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.2384, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.2001, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1884, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1754, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.2019, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.08163265138864517, FU:4.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1903, bias_loss:nan
-->after epoch 3
-->overall baseline on training dataset
-->ACC 0.9811382113821138
-->F1 0.980515117581187
-->FPR: 0.009327962688149248
-->FNR: 0.02883762200532387
-->overall baseline on testing dataset
-->ACC 0.9160556257901391
-->F1 0.9117959617428267
-->FPR: 0.06702544031311154
-->FNR: 0.10204081632653061
training dataset
-->original metric score:
-->individual metric:0.12211107278371852, num_idi:354, num_all:2899
-->individual metric 0.12211107278371852
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9210526315789473
-->F1 0.9349845201238389
-->FPR 0.028423772609819122
-->FNR 0.10782865583456426
-->positive probability:0.5780075187969925, 615/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9092475588742103
-->F1 0.9401968205904617
-->FPR 0.042134831460674156
-->FNR 0.10324909747292418
-->positive probability:0.7219988512349225, 1257/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.019095809921669874, 0.03280686877252491, 0.009327962688149248, 0.6573387039785173, 0.012894259534072975, 0.009327962688149248]
-->fnr_diff [0.07899103382924039, 0.07441147546760031, 0.14763296622997027, 0.015679727268481766, 0.026392634230262745, 0.004495711328009463, 0.07927048610278424, 0.09616237799467613]
-->FPR:[0.028423772609819122, 0.042134831460674156, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12657458215989703, mean FPR diff:0.12346526126384727
-->FNR:[0.10782865583456426, 0.10324909747292418, 0.17647058823529413, 0.013157894736842105, 0.0024449877750611247, 0.03333333333333333, 0.10810810810810811, 0.125], mean FNR:0.08369908318701591, mean FNR diff:0.06537955155637817
-->mean fnr diff metric 0.12346526126384727
testing dataset
-->original metric score:
-->individual metric:0.1356907894736842, num_idi:165, num_all:1216
-->individual metric 0.1356907894736842
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8741865509761388
-->F1 0.897887323943662
-->FPR 0.08074534161490683
-->FNR 0.15
-->positive probability:0.5813449023861171, 268/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8603351955307262
-->F1 0.9080882352941175
-->FPR 0.14685314685314685
-->FNR 0.13787085514834205
-->positive probability:0.7192737430167597, 515/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8
-->FPR 0.04
-->FNR 0.2857142857142857
-->positive probability:0.28205128205128205, 11/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9545454545454546
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3181818181818182, 7/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.01371990130179529, 0.0798277065400353, 0.06702544031311154, 0.43297455968688847, 0.9329745596868885, 0.02702544031311154, 0.06702544031311154]
-->fnr_diff [0.04795918367346938, 0.03583003882181143, 0.022959183673469385, 0.10204081632653061, 0.10204081632653061, 0.050758765044479334, 0.18367346938775508, 0.022959183673469385]
-->FPR:[0.08074534161490683, 0.14685314685314685, 0.0, 0.5, 1.0, 0.04, 0.0], mean FPR:0.25251406978115054, mean FPR diff:0.23151043545070604
-->FNR:[0.15, 0.13787085514834205, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.10935839901808488, mean FNR diff:0.0710276821159394
-->mean fnr diff metric 0.23151043545070604
-->epoch 4
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1374, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.0625, FU:3.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.2067, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1912, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.031251661479473114, FU:2.0001063346862793, P:64
-->FUR:0.0212788637727499, FU:1.0001065731048584, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1908, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1758, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1895, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.08163265138864517, FU:4.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1764, bias_loss:nan
-->after epoch 4
-->overall baseline on training dataset
-->ACC 0.9787533875338753
-->F1 0.9780170480035889
-->FPR: 0.010175959296162815
-->FNR: 0.032830523513753325
-->overall baseline on testing dataset
-->ACC 0.913527180783818
-->F1 0.9091874668082847
-->FPR: 0.06996086105675146
-->FNR: 0.10413396127681843
training dataset
-->original metric score:
-->individual metric:0.12211107278371852, num_idi:354, num_all:2899
-->individual metric 0.12211107278371852
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9191729323308271
-->F1 0.9336419753086419
-->FPR 0.03617571059431524
-->FNR 0.10635155096011817
-->positive probability:0.581766917293233, 619/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9046524985640436
-->F1 0.9371688115064345
-->FPR 0.05337078651685393
-->FNR 0.10613718411552346
-->positive probability:0.7219988512349225, 1257/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.025999751298152428, 0.043194827220691116, 0.010175959296162815, 0.6564907073705039, 0.012046262926059408, 0.010175959296162815]
-->fnr_diff [0.07352102744636485, 0.07330666060177013, 0.1436400647215408, 0.01967262877691122, 0.0303855357386922, 0.0005028098195800079, 0.0752775845943548, 0.09216947648624668]
-->FPR:[0.03617571059431524, 0.05337078651685393, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12973923100000967, mean FPR diff:0.1263472445679554
-->FNR:[0.10635155096011817, 0.10613718411552346, 0.17647058823529413, 0.013157894736842105, 0.0024449877750611247, 0.03333333333333333, 0.10810810810810811, 0.125], mean FNR:0.08387545590803505, mean FNR diff:0.06355947352318259
-->mean fnr diff metric 0.1263472445679554
testing dataset
-->original metric score:
-->individual metric:0.12911184210526316, num_idi:157, num_all:1216
-->individual metric 0.12911184210526316
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8806941431670282
-->F1 0.9036777583187391
-->FPR 0.08074534161490683
-->FNR 0.14
-->positive probability:0.5878524945770065, 271/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8645251396648045
-->F1 0.9112534309240622
-->FPR 0.15384615384615385
-->FNR 0.13089005235602094
-->positive probability:0.7262569832402235, 520/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.010784480558155368, 0.08388529278940239, 0.0967058056099152, 0.4300391389432485, 0.9300391389432485, 0.010039138943248538, 0.0014677103718199608]
-->fnr_diff [0.03586603872318159, 0.026756091079202515, 0.020866038723181574, 0.10413396127681843, 0.10413396127681843, 0.052851909994767146, 0.18158032443746727, 0.020866038723181574]
-->FPR:[0.08074534161490683, 0.15384615384615385, 0.16666666666666666, 0.5, 1.0, 0.08, 0.07142857142857142], mean FPR:0.29324096193661414, mean FPR diff:0.22328010087986264
-->FNR:[0.14, 0.13089005235602094, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.10723579866904473, mean FNR diff:0.06838179552932731
-->mean fnr diff metric 0.22328010087986264
-->epoch 5
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1390, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.06250064820051193, FU:3.000030994415283, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1900, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1835, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.046875, FU:3.0, P:64
-->FUR:0.08510638028383255, FU:4.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1750, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:1.3588557649460374e-30, FU:6.794278805922277e-29, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1618, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1678, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.08163265138864517, FU:4.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1618, bias_loss:nan
-->after epoch 5
-->overall baseline on training dataset
-->ACC 0.981029810298103
-->F1 0.9805360916472027
-->FPR: 0.0158999364002544
-->FNR: 0.022182786157941437
-->overall baseline on testing dataset
-->ACC 0.915802781289507
-->F1 0.9125295508274233
-->FPR: 0.07778864970645792
-->FNR: 0.09105180533751962
training dataset
-->original metric score:
-->individual metric:0.12004139358399447, num_idi:348, num_all:2899
-->individual metric 0.12004139358399447
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9285714285714286
-->F1 0.9419847328244275
-->FPR 0.041343669250646
-->FNR 0.08862629246676514
-->positive probability:0.5949248120300752, 633/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9167145318782309
-->F1 0.9457538346427236
-->FPR 0.06741573033707865
-->FNR 0.08736462093862817
-->positive probability:0.7398047099368179, 1288/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.9
-->F1 0.9206349206349206
-->FPR 0.0
-->FNR 0.14705882352941177
-->positive probability:0.58, 29/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.025443732850391598, 0.05151579393682425, 0.0158999364002544, 0.6507667302664122, 0.006322285821967824, 0.0158999364002544]
-->fnr_diff [0.0664435063088237, 0.06518183478068673, 0.12487603737147034, 0.009024891421099333, 0.01973779838288031, 0.002817213842058564, 0.08592532195016668, 0.10281721384205857]
-->FPR:[0.041343669250646, 0.06741573033707865, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13294138141276893, mean FPR diff:0.1276414026126841
-->FNR:[0.08862629246676514, 0.08736462093862817, 0.14705882352941177, 0.013157894736842105, 0.0024449877750611247, 0.025, 0.10810810810810811, 0.125], mean FNR:0.07459509094435204, mean FNR diff:0.05960297723740553
-->mean fnr diff metric 0.1276414026126841
testing dataset
-->original metric score:
-->individual metric:0.13322368421052633, num_idi:162, num_all:1216
-->individual metric 0.13322368421052633
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8785249457700651
-->F1 0.9031141868512111
-->FPR 0.10559006211180125
-->FNR 0.13
-->positive probability:0.6030368763557483, 278/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8701117318435754
-->F1 0.9158371040723982
-->FPR 0.18181818181818182
-->FNR 0.1169284467713787
-->positive probability:0.7430167597765364, 532/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.7272727272727273
-->F1 0.7000000000000001
-->FPR 0.35714285714285715
-->FNR 0.125
-->positive probability:0.5454545454545454, 12/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.027801412405343326, 0.1040295321117239, 0.08887801696020874, 0.42221135029354206, 0.9222113502935421, 0.0022113502935420803, 0.2793542074363992]
-->fnr_diff [0.03894819466248038, 0.02587664143385908, 0.03394819466248038, 0.09105180533751962, 0.09105180533751962, 0.03976975405546834, 0.1946624803767661, 0.03394819466248038]
-->FPR:[0.10559006211180125, 0.18181818181818182, 0.16666666666666666, 0.5, 1.0, 0.08, 0.35714285714285715], mean FPR:0.34160253824850095, mean FPR diff:0.2638138885420431
-->FNR:[0.13, 0.1169284467713787, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.10424059797096447, mean FNR diff:0.06865713381607173
-->mean fnr diff metric 0.2638138885420431
-->epoch 6
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1299, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1738, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:5.995913984471257e-38, FU:2.9979569922356285e-37, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1703, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.0625, FU:4.0, P:64
-->FUR:0.10638298094272614, FU:5.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1581, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:4.1933549255190883e-07, FU:2.096677417284809e-05, P:50
-->FUR:0.017544228583574295, FU:1.000020980834961, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1494, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.04021860286593437, FU:2.010930061340332, P:50
-->FUR:0.060218602418899536, FU:3.010930061340332, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1598, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.12244898080825806, FU:6.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1500, bias_loss:nan
-->after epoch 6
-->overall baseline on training dataset
-->ACC 0.9827642276422764
-->F1 0.9823509823509823
-->FPR: 0.016111935552257792
-->FNR: 0.01841171251109139
-->overall baseline on testing dataset
-->ACC 0.9160556257901391
-->F1 0.913134484563056
-->FPR: 0.0812133072407045
-->FNR: 0.08686551543694401
training dataset
-->original metric score:
-->individual metric:0.12004139358399447, num_idi:348, num_all:2899
-->individual metric 0.12004139358399447
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9295112781954887
-->F1 0.9430523917995445
-->FPR 0.04909560723514212
-->FNR 0.0827178729689808
-->positive probability:0.6015037593984962, 640/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.919586444572085
-->F1 0.9478390461997019
-->FPR 0.07584269662921349
-->FNR 0.0815884476534296
-->positive probability:0.746122917863297, 1299/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.032983671682884325, 0.0597307610769557, 0.016111935552257792, 0.6505547311144089, 0.006110286669964431, 0.016111935552257792]
-->fnr_diff [0.06430616045788941, 0.06317673514233821, 0.09923534631243802, 0.01841171251109139, 0.015966724736030266, 0.00658828748890861, 0.08969639559701673, 0.10658828748890861]
-->FPR:[0.04909560723514212, 0.07584269662921349, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13563786545887407, mean FPR diff:0.13026722027478813
-->FNR:[0.0827178729689808, 0.0815884476534296, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.10810810810810811, 0.125], mean FNR:0.06781330941613863, mean FNR diff:0.05799620621682766
-->mean fnr diff metric 0.13026722027478813
testing dataset
-->original metric score:
-->individual metric:0.13651315789473684, num_idi:166, num_all:1216
-->individual metric 0.13651315789473684
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8763557483731019
-->F1 0.9015544041450777
-->FPR 0.11180124223602485
-->FNR 0.13
-->positive probability:0.6052060737527115, 279/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8687150837988827
-->F1 0.9151624548736462
-->FPR 0.1958041958041958
-->FNR 0.11518324607329843
-->positive probability:0.7472067039106145, 535/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.7272727272727273
-->F1 0.7000000000000001
-->FPR 0.35714285714285715
-->FNR 0.125
-->positive probability:0.5454545454545454, 12/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.03058793499532035, 0.11459088856349131, 0.08545335942596216, 0.4187866927592955, 0.9187866927592955, 0.0012133072407044948, 0.2759295499021527]
-->fnr_diff [0.04313448456305599, 0.028317730636354413, 0.03813448456305599, 0.08686551543694401, 0.08686551543694401, 0.03558346415489273, 0.19884877027734169, 0.03813448456305599]
-->FPR:[0.11180124223602485, 0.1958041958041958, 0.16666666666666666, 0.5, 1.0, 0.08, 0.35714285714285715], mean FPR:0.34448785169282065, mean FPR diff:0.263621203663746
-->FNR:[0.13, 0.11518324607329843, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.10402244788370443, mean FNR diff:0.0694855562039556
-->mean fnr diff metric 0.263621203663746
-->epoch 7
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1189, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1683, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1638, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.0625, FU:4.0, P:64
-->FUR:0.10638292133808136, FU:4.999997138977051, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1517, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:5.547584009946149e-07, FU:2.773792039079126e-05, P:50
-->FUR:0.017544347792863846, FU:1.0000277757644653, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1451, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1578, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.1428571492433548, FU:7.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1476, bias_loss:nan
-->after epoch 7
-->overall baseline on training dataset
-->ACC 0.9822222222222222
-->F1 0.9818423383525243
-->FPR: 0.01907992368030528
-->FNR: 0.016415261756876662
-->overall baseline on testing dataset
-->ACC 0.9155499367888749
-->F1 0.9129755080771235
-->FPR: 0.08561643835616438
-->FNR: 0.08320251177394035
training dataset
-->original metric score:
-->individual metric:0.12004139358399447, num_idi:348, num_all:2899
-->individual metric 0.12004139358399447
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9332706766917294
-->F1 0.9463340891912321
-->FPR 0.05167958656330749
-->FNR 0.07533234859675036
-->positive probability:0.6071428571428571, 646/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9241815048822516
-->F1 0.951111111111111
-->FPR 0.08707865168539326
-->FNR 0.07292418772563176
-->positive probability:0.7553130384836301, 1315/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.032599662883002214, 0.06799872800508798, 0.01907992368030528, 0.6475867429863613, 0.0031422985419169436, 0.01907992368030528]
-->fnr_diff [0.058917086839873706, 0.056508925968755105, 0.10123179706665275, 0.016415261756876662, 0.013970273981815537, 0.008584738243123339, 0.09169284635123146, 0.10858473824312334]
-->FPR:[0.05167958656330749, 0.08707865168539326, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13794118785626494, mean FPR diff:0.13158121329616318
-->FNR:[0.07533234859675036, 0.07292418772563176, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.10810810810810811, 0.125], mean FNR:0.0658070863786351, mean FNR diff:0.05698820855643149
-->mean fnr diff metric 0.13158121329616318
testing dataset
-->original metric score:
-->individual metric:0.13404605263157895, num_idi:163, num_all:1216
-->individual metric 0.13404605263157895
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8850325379609545
-->F1 0.9097103918228279
-->FPR 0.12422360248447205
-->FNR 0.11
-->positive probability:0.6225596529284165, 287/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8784916201117319
-->F1 0.9219730941704035
-->FPR 0.1958041958041958
-->FNR 0.10296684118673648
-->positive probability:0.7569832402234636, 542/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.7272727272727273
-->F1 0.7000000000000001
-->FPR 0.35714285714285715
-->FNR 0.125
-->positive probability:0.5454545454545454, 12/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.03860716412830767, 0.11018775744803143, 0.08105022831050228, 0.4143835616438356, 0.9143835616438356, 0.005616438356164377, 0.27152641878669276]
-->fnr_diff [0.02679748822605965, 0.019764329412796128, 0.04179748822605965, 0.08320251177394035, 0.08320251177394035, 0.03192046049188907, 0.20251177394034536, 0.04179748822605965]
-->FPR:[0.12422360248447205, 0.1958041958041958, 0.16666666666666666, 0.5, 1.0, 0.08, 0.35714285714285715], mean FPR:0.346262474585456, mean FPR diff:0.2622507329024814
-->FNR:[0.11, 0.10296684118673648, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.09999539727288417, mean FNR diff:0.06637425650888627
-->mean fnr diff metric 0.2622507329024814
-->epoch 8
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1134, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.12137068063020706, FU:5.8257927894592285, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1646, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.09259262681007385, FU:5.000001907348633, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:1.2784002496099726e-26, FU:6.392001248049863e-26, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1597, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.0625, FU:4.0, P:64
-->FUR:0.10638298094272614, FU:5.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1466, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.00023768391110934317, FU:0.011884195730090141, P:50
-->FUR:0.017752354964613914, FU:1.0118842124938965, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1407, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.040189843624830246, FU:2.0094921588897705, P:50
-->FUR:0.06018984317779541, FU:3.0094921588897705, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1531, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.08163265138864517, FU:4.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1454, bias_loss:nan
-->after epoch 8
-->overall baseline on training dataset
-->ACC 0.9815718157181572
-->F1 0.9811278863232682
-->FPR: 0.017171931312274753
-->FNR: 0.01974267968056788
-->overall baseline on testing dataset
-->ACC 0.913527180783818
-->F1 0.9104712041884817
-->FPR: 0.08317025440313111
-->FNR: 0.09000523286237572
training dataset
-->original metric score:
-->individual metric:0.11797171438427044, num_idi:342, num_all:2899
-->individual metric 0.11797171438427044
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9332706766917294
-->F1 0.9460076045627376
-->FPR 0.041343669250646
-->FNR 0.08124076809453472
-->positive probability:0.599624060150376, 638/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9213095921883975
-->F1 0.9489377562430116
-->FPR 0.0702247191011236
-->FNR 0.08086642599277978
-->positive probability:0.7455485353245261, 1298/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.024171737938371244, 0.05305278778884885, 0.017171931312274753, 0.6494947353543918, 0.0050502909099474705, 0.017171931312274753]
-->fnr_diff [0.06149808841396684, 0.0611237463122119, 0.09790437914296153, 0.01974267968056788, 0.017297691905506753, 0.0052573203194321225, 0.08836542842754024, 0.10525732031943212]
-->FPR:[0.041343669250646, 0.0702247191011236, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13340954620677642, mean FPR diff:0.12768556910268483
-->FNR:[0.08124076809453472, 0.08086642599277978, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.10810810810810811, 0.125], mean FNR:0.06753841859925164, mean FNR diff:0.05705583181520242
-->mean fnr diff metric 0.12768556910268483
testing dataset
-->original metric score:
-->individual metric:0.13486842105263158, num_idi:164, num_all:1216
-->individual metric 0.13486842105263158
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8806941431670282
-->F1 0.9053356282271945
-->FPR 0.11180124223602485
-->FNR 0.12333333333333334
-->positive probability:0.6095444685466378, 281/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8715083798882681
-->F1 0.9169675090252707
-->FPR 0.1888111888111888
-->FNR 0.11343804537521815
-->positive probability:0.7472067039106145, 535/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.7272727272727273
-->F1 0.7000000000000001
-->FPR 0.35714285714285715
-->FNR 0.125
-->positive probability:0.5454545454545454, 12/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.028630987832893737, 0.10564093440805769, 0.08349641226353555, 0.4168297455968689, 0.9168297455968689, 0.003170254403131109, 0.273972602739726]
-->fnr_diff [0.03332810047095762, 0.023432812512842432, 0.03499476713762428, 0.09000523286237572, 0.09000523286237572, 0.03872318158032444, 0.19570905285190998, 0.03499476713762428]
-->FPR:[0.11180124223602485, 0.1888111888111888, 0.16666666666666666, 0.5, 1.0, 0.08, 0.35714285714285715], mean FPR:0.3434888506938196, mean FPR diff:0.26122438326301173
-->FNR:[0.12333333333333334, 0.11343804537521815, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.10297096446311105, mean FNR diff:0.06764914342700432
-->mean fnr diff metric 0.26122438326301173
-->epoch 9
-->start_index 0
-->batch_size 98
-->FUR:0.023297635838389397, FU:1.281369924545288, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1147, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1698, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.09259328246116638, FU:5.00003719329834, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1708, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.046875, FU:3.0, P:64
-->FUR:0.08510638028383255, FU:4.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1605, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1543, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.0399981252849102, FU:1.9999061822891235, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1695, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.08163265138864517, FU:4.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1568, bias_loss:nan
-->after epoch 9
-->overall baseline on training dataset
-->ACC 0.9781029810298103
-->F1 0.9774301675977654
-->FPR: 0.014415942336230655
-->FNR: 0.029724933451641525
-->overall baseline on testing dataset
-->ACC 0.9117572692793932
-->F1 0.9077939233817702
-->FPR: 0.07632093933463796
-->FNR: 0.10099424385138671
training dataset
-->original metric score:
-->individual metric:0.11969644705070714, num_idi:347, num_all:2899
-->individual metric 0.11969644705070714
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9238721804511278
-->F1 0.9376443418013857
-->FPR 0.03359173126614987
-->FNR 0.10044313146233383
-->positive probability:0.5845864661654135, 622/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9058012636415853
-->F1 0.9380196523053665
-->FPR 0.056179775280898875
-->FNR 0.10397111913357401
-->positive probability:0.7242963813900057, 1261/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.019175788929919217, 0.04176383294466822, 0.014415942336230655, 0.652250724330436, 0.007806279885991568, 0.014415942336230655]
-->fnr_diff [0.0707181980106923, 0.07424618568193249, 0.1467456547836526, 0.01656703871479942, 0.0272799456765804, 0.003608399881691808, 0.07838317465646659, 0.09527506654835848]
-->FPR:[0.03359173126614987, 0.056179775280898875, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12977673257265626, mean FPR diff:0.1249714184605794
-->FNR:[0.10044313146233383, 0.10397111913357401, 0.17647058823529413, 0.013157894736842105, 0.0024449877750611247, 0.03333333333333333, 0.10810810810810811, 0.125], mean FNR:0.08286614534806833, mean FNR diff:0.06410295799427176
-->mean fnr diff metric 0.1249714184605794
testing dataset
-->original metric score:
-->individual metric:0.1299342105263158, num_idi:158, num_all:1216
-->individual metric 0.1299342105263158
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8850325379609545
-->F1 0.9078260869565218
-->FPR 0.08695652173913043
-->FNR 0.13
-->positive probability:0.596529284164859, 275/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.86731843575419
-->F1 0.9132420091324202
-->FPR 0.15384615384615385
-->FNR 0.1273996509598604
-->positive probability:0.729050279329609, 522/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.010635582404492472, 0.0775252145115159, 0.0903457273320287, 0.42367906066536204, 0.923679060665362, 0.003679060665362041, 0.06653620352250489]
-->fnr_diff [0.029005756148613296, 0.02640540710847368, 0.02400575614861329, 0.10099424385138671, 0.10099424385138671, 0.04971219256933543, 0.18472004186289898, 0.02400575614861329]
-->FPR:[0.08695652173913043, 0.15384615384615385, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.30433235501558487, mean FPR diff:0.22801141568094682
-->FNR:[0.13, 0.1273996509598604, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.10554949849452466, mean FNR diff:0.06748042471116517
-->mean fnr diff metric 0.22801141568094682
-->epoch 10
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1269, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1835, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1856, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1708, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1575, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.05999979004263878, FU:2.9999895095825195, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1648, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.06122449040412903, FU:3.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1607, bias_loss:nan
-->after epoch 10
-->overall baseline on training dataset
-->ACC 0.9764769647696477
-->F1 0.9757297841404764
-->FPR: 0.01505193979224083
-->FNR: 0.0323868677905945
-->overall baseline on testing dataset
-->ACC 0.9112515802781289
-->F1 0.907118285260651
-->FPR: 0.07534246575342465
-->FNR: 0.10308738880167452
training dataset
-->original metric score:
-->individual metric:0.11900655398413246, num_idi:345, num_all:2899
-->individual metric 0.11900655398413246
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9229323308270677
-->F1 0.9368258859784283
-->FPR 0.03359173126614987
-->FNR 0.1019202363367799
-->positive probability:0.5836466165413534, 621/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9058012636415853
-->F1 0.9379727685325264
-->FPR 0.05337078651685393
-->FNR 0.10469314079422383
-->positive probability:0.723147616312464, 1259/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.018539791473909044, 0.0383188467246131, 0.01505193979224083, 0.6516147268744258, 0.0071702824299813925, 0.01505193979224083]
-->fnr_diff [0.06953336854618541, 0.07230627300362932, 0.14408372044469964, 0.019228973053752395, 0.029941880015533374, 0.009279798876072165, 0.07572124031751362, 0.09261313220940551]
-->FPR:[0.03359173126614987, 0.05337078651685393, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12930856777864877, mean FPR diff:0.1242912545145685
-->FNR:[0.1019202363367799, 0.10469314079422383, 0.17647058823529413, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.10810810810810811, 0.125], mean FNR:0.08418270283162199, mean FNR diff:0.06408854830834892
-->mean fnr diff metric 0.1242912545145685
testing dataset
-->original metric score:
-->individual metric:0.13075657894736842, num_idi:159, num_all:1216
-->individual metric 0.13075657894736842
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8850325379609545
-->F1 0.9075043630017452
-->FPR 0.08074534161490683
-->FNR 0.13333333333333333
-->positive probability:0.5921908893709328, 273/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8645251396648045
-->F1 0.9112534309240622
-->FPR 0.15384615384615385
-->FNR 0.13089005235602094
-->positive probability:0.7262569832402235, 520/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.005402875861482179, 0.0785036880927292, 0.091324200913242, 0.4246575342465754, 0.9246575342465754, 0.004657534246575348, 0.0675146771037182]
-->fnr_diff [0.03024594453165881, 0.02780266355434642, 0.02191261119832548, 0.10308738880167452, 0.10308738880167452, 0.05180533751962324, 0.1826268969126112, 0.02191261119832548]
-->FPR:[0.08074534161490683, 0.15384615384615385, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.3034450435692672, mean FPR diff:0.22810257781584253
-->FNR:[0.13333333333333333, 0.13089005235602094, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.1064024653357114, mean FNR diff:0.06781010531477996
-->mean fnr diff metric 0.22810257781584253
-->epoch 11
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1284, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1845, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1833, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.04255000129342079, FU:1.9998500347137451, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1658, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1533, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1587, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.06122449040412903, FU:3.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1556, bias_loss:nan
-->after epoch 11
-->overall baseline on training dataset
-->ACC 0.9782113821138212
-->F1 0.9775594507089428
-->FPR: 0.01505193979224083
-->FNR: 0.02883762200532387
-->overall baseline on testing dataset
-->ACC 0.9120101137800253
-->F1 0.9080338266384779
-->FPR: 0.07583170254403131
-->FNR: 0.10099424385138671
training dataset
-->original metric score:
-->individual metric:0.11969644705070714, num_idi:347, num_all:2899
-->individual metric 0.11969644705070714
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9276315789473685
-->F1 0.9409056024558711
-->FPR 0.03359173126614987
-->FNR 0.09453471196454949
-->positive probability:0.5883458646616542, 626/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9115450890292935
-->F1 0.9420180722891566
-->FPR 0.056179775280898875
-->FNR 0.09675090252707581
-->positive probability:0.730040206777714, 1271/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.018539791473909044, 0.041127835488658046, 0.01505193979224083, 0.6516147268744258, 0.0071702824299813925, 0.01505193979224083]
-->fnr_diff [0.06569708995922562, 0.06791328052175194, 0.14763296622997027, 0.015679727268481766, 0.026392634230262745, 0.004495711328009463, 0.07927048610278424, 0.09616237799467613]
-->FPR:[0.03359173126614987, 0.056179775280898875, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12977673257265626, mean FPR diff:0.124759419308576
-->FNR:[0.09453471196454949, 0.09675090252707581, 0.17647058823529413, 0.013157894736842105, 0.0024449877750611247, 0.03333333333333333, 0.10810810810810811, 0.125], mean FNR:0.08122506583503301, mean FNR diff:0.06290553420439526
-->mean fnr diff metric 0.124759419308576
testing dataset
-->original metric score:
-->individual metric:0.12828947368421054, num_idi:156, num_all:1216
-->individual metric 0.12828947368421054
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8828633405639913
-->F1 0.9059233449477352
-->FPR 0.08695652173913043
-->FNR 0.13333333333333333
-->positive probability:0.5943600867678959, 274/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8645251396648045
-->F1 0.9112534309240622
-->FPR 0.15384615384615385
-->FNR 0.13089005235602094
-->positive probability:0.7262569832402235, 520/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.011124819195099125, 0.07801445130212255, 0.09083496412263535, 0.4241682974559687, 0.9241682974559687, 0.004168297455968695, 0.06702544031311154]
-->fnr_diff [0.03233908948194662, 0.029895808504634233, 0.02400575614861329, 0.10099424385138671, 0.10099424385138671, 0.04971219256933543, 0.18472004186289898, 0.02400575614861329]
-->FPR:[0.08695652173913043, 0.15384615384615385, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.30433235501558487, mean FPR diff:0.22850065247155354
-->FNR:[0.13333333333333333, 0.13089005235602094, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.1064024653357114, mean FNR diff:0.06833339155235191
-->mean fnr diff metric 0.22850065247155354
-->epoch 12
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1206, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1789, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.09259295463562012, FU:5.000019550323486, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1745, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1554, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1462, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1558, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.06122449040412903, FU:3.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1484, bias_loss:nan
-->after epoch 12
-->overall baseline on training dataset
-->ACC 0.9795121951219512
-->F1 0.9789321145914613
-->FPR: 0.015263938944244222
-->FNR: 0.025953859804791483
-->overall baseline on testing dataset
-->ACC 0.9132743362831859
-->F1 0.9094747954605436
-->FPR: 0.07583170254403131
-->FNR: 0.09837781266352695
training dataset
-->original metric score:
-->individual metric:0.12038634011728182, num_idi:349, num_all:2899
-->individual metric 0.12038634011728182
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9285714285714286
-->F1 0.9416282642089094
-->FPR 0.031007751937984496
-->FNR 0.09453471196454949
-->positive probability:0.5874060150375939, 625/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9167145318782309
-->F1 0.9455501314307173
-->FPR 0.05337078651685393
-->FNR 0.09097472924187726
-->positive probability:0.7340608845491097, 1278/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.015743812993740273, 0.03810684757260971, 0.015263938944244222, 0.6514027277224224, 0.006958283277978001, 0.015263938944244222]
-->fnr_diff [0.06858085215975801, 0.06502086943708578, 0.15051672843050265, 0.012795965067949378, 0.023508872029730357, 0.00737947352854185, 0.08215424830331663, 0.09904614019520852]
-->FPR:[0.031007751937984496, 0.05337078651685393, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1288779045572879, mean FPR diff:0.12378992490920647
-->FNR:[0.09453471196454949, 0.09097472924187726, 0.17647058823529413, 0.013157894736842105, 0.0024449877750611247, 0.03333333333333333, 0.10810810810810811, 0.125], mean FNR:0.0805030441743832, mean FNR diff:0.06362539364401165
-->mean fnr diff metric 0.12378992490920647
testing dataset
-->original metric score:
-->individual metric:0.12911184210526316, num_idi:157, num_all:1216
-->individual metric 0.12911184210526316
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8828633405639913
-->F1 0.9059233449477352
-->FPR 0.08695652173913043
-->FNR 0.13333333333333333
-->positive probability:0.5943600867678959, 274/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8701117318435754
-->F1 0.9152233363719234
-->FPR 0.15384615384615385
-->FNR 0.12390924956369982
-->positive probability:0.7318435754189944, 524/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.011124819195099125, 0.07801445130212255, 0.09083496412263535, 0.4241682974559687, 0.9241682974559687, 0.004168297455968695, 0.06702544031311154]
-->fnr_diff [0.03495552066980638, 0.02553143690017287, 0.02662218733647305, 0.09837781266352695, 0.09837781266352695, 0.04709576138147567, 0.18733647305075873, 0.02662218733647305]
-->FPR:[0.08695652173913043, 0.15384615384615385, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.30433235501558487, mean FPR diff:0.22850065247155354
-->FNR:[0.13333333333333333, 0.12390924956369982, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.10552986498667127, mean FNR diff:0.0681148990002767
-->mean fnr diff metric 0.22850065247155354
-->epoch 13
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1135, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1744, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.01854376681149006, FU:1.0013633966445923, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1691, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1483, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1414, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1512, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.07970701158046722, FU:3.9056434631347656, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1444, bias_loss:nan
-->after epoch 13
-->overall baseline on training dataset
-->ACC 0.9800542005420054
-->F1 0.9795145847250055
-->FPR: 0.0158999364002544
-->FNR: 0.024179236912156166
-->overall baseline on testing dataset
-->ACC 0.913527180783818
-->F1 0.9098576700052715
-->FPR: 0.07681017612524461
-->FNR: 0.0968079539508111
training dataset
-->original metric score:
-->individual metric:0.11900655398413246, num_idi:345, num_all:2899
-->individual metric 0.11900655398413246
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9285714285714286
-->F1 0.941717791411043
-->FPR 0.03359173126614987
-->FNR 0.0930576070901034
-->positive probability:0.5892857142857143, 627/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9172889144170018
-->F1 0.9459459459459459
-->FPR 0.05337078651685393
-->FNR 0.09025270758122744
-->positive probability:0.7346352670878805, 1279/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.017691794865895474, 0.037470850116599536, 0.0158999364002544, 0.6507667302664122, 0.006322285821967824, 0.0158999364002544]
-->fnr_diff [0.06887837017794723, 0.06607347066907128, 0.15229135132313795, 0.011021342175314062, 0.02173424913709504, 0.009154096421177167, 0.08392887119595195, 0.10082076308784384]
-->FPR:[0.03359173126614987, 0.05337078651685393, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12930856777864877, mean FPR diff:0.12400858897856398
-->FNR:[0.0930576070901034, 0.09025270758122744, 0.17647058823529413, 0.013157894736842105, 0.0024449877750611247, 0.03333333333333333, 0.10810810810810811, 0.125], mean FNR:0.08022815335749621, mean FNR diff:0.06423781427344231
-->mean fnr diff metric 0.12400858897856398
testing dataset
-->original metric score:
-->individual metric:0.12911184210526316, num_idi:157, num_all:1216
-->individual metric 0.12911184210526316
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8828633405639913
-->F1 0.90625
-->FPR 0.09316770186335403
-->FNR 0.13
-->positive probability:0.5986984815618221, 276/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8687150837988827
-->F1 0.9143897996357012
-->FPR 0.16083916083916083
-->FNR 0.12390924956369982
-->positive probability:0.7332402234636871, 525/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.01635752573810942, 0.08402898471391622, 0.08985649054142204, 0.4231898238747554, 0.9231898238747553, 0.0031898238747553875, 0.06604696673189824]
-->fnr_diff [0.033192046049188906, 0.027101295612888723, 0.0281920460491889, 0.0968079539508111, 0.0968079539508111, 0.04552590266875982, 0.1889063317634746, 0.0281920460491889]
-->FPR:[0.09316770186335403, 0.16083916083916083, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.3062186674609035, mean FPR diff:0.22940849133565885
-->FNR:[0.13, 0.12390924956369982, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.1051131983200046, mean FNR diff:0.068090697011789
-->mean fnr diff metric 0.22940849133565885
-->epoch 14
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1095, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1715, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1672, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.04255295172333717, FU:1.9999886751174927, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1447, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1396, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1469, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.06122449040412903, FU:3.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1428, bias_loss:nan
-->after epoch 14
-->overall baseline on training dataset
-->ACC 0.9797289972899729
-->F1 0.9791829010352889
-->FPR: 0.016323934704261182
-->FNR: 0.024401064773735583
-->overall baseline on testing dataset
-->ACC 0.9130214917825538
-->F1 0.9093305218766473
-->FPR: 0.07729941291585127
-->FNR: 0.09733124018838304
training dataset
-->original metric score:
-->individual metric:0.11797171438427044, num_idi:342, num_all:2899
-->individual metric 0.11797171438427044
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9295112781954887
-->F1 0.942528735632184
-->FPR 0.03359173126614987
-->FNR 0.0915805022156573
-->positive probability:0.5902255639097744, 628/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9161401493394601
-->F1 0.9451540195341849
-->FPR 0.05337078651685393
-->FNR 0.09169675090252707
-->positive probability:0.7334865020103389, 1277/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.01726779656188869, 0.03704685181259275, 0.016323934704261182, 0.6503427319624054, 0.005898287517961041, 0.016323934704261182]
-->fnr_diff [0.06717943744192173, 0.0672956861287915, 0.15206952346155855, 0.011243170036893478, 0.021956076998674457, 0.00893226855959775, 0.11073407036139957, 0.10059893522626442]
-->FPR:[0.03359173126614987, 0.05337078651685393, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12930856777864877, mean FPR diff:0.12386725621056172
-->FNR:[0.0915805022156573, 0.09169675090252707, 0.17647058823529413, 0.013157894736842105, 0.0024449877750611247, 0.03333333333333333, 0.13513513513513514, 0.125], mean FNR:0.08360239904173128, mean FNR diff:0.06750114602688768
-->mean fnr diff metric 0.12386725621056172
testing dataset
-->original metric score:
-->individual metric:0.12582236842105263, num_idi:153, num_all:1216
-->individual metric 0.12582236842105263
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8850325379609545
-->F1 0.9078260869565218
-->FPR 0.08695652173913043
-->FNR 0.13
-->positive probability:0.596529284164859, 275/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8701117318435754
-->F1 0.9152233363719234
-->FPR 0.15384615384615385
-->FNR 0.12390924956369982
-->positive probability:0.7318435754189944, 524/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.009657108823279165, 0.07654674093030259, 0.08936725375081539, 0.4227005870841487, 0.9227005870841487, 0.002700587084148734, 0.06555772994129158]
-->fnr_diff [0.03266875981161696, 0.026578009375316777, 0.027668759811616955, 0.09733124018838304, 0.09733124018838304, 0.046049188906331764, 0.18838304552590265, 0.027668759811616955]
-->FPR:[0.08695652173913043, 0.15384615384615385, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.30433235501558487, mean FPR diff:0.22703294209973354
-->FNR:[0.13, 0.12390924956369982, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.1051131983200046, mean FNR diff:0.06795987545239601
-->mean fnr diff metric 0.22703294209973354
-->epoch 15
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1083, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1704, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1667, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.021276595070958138, FU:1.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1423, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:1.3144713490081692e-38, FU:6.5723566049109995e-37, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1380, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1434, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.06122449040412903, FU:3.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1409, bias_loss:nan
-->after epoch 15
-->overall baseline on training dataset
-->ACC 0.9796205962059621
-->F1 0.9790832220738762
-->FPR: 0.01695993216027136
-->FNR: 0.023957409050576754
-->overall baseline on testing dataset
-->ACC 0.9127686472819216
-->F1 0.9091387937845667
-->FPR: 0.07827788649706457
-->FNR: 0.0968079539508111
training dataset
-->original metric score:
-->individual metric:0.11797171438427044, num_idi:342, num_all:2899
-->individual metric 0.11797171438427044
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9304511278195489
-->F1 0.9433384379785604
-->FPR 0.03359173126614987
-->FNR 0.09010339734121123
-->positive probability:0.5911654135338346, 629/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9167145318782309
-->F1 0.9455501314307173
-->FPR 0.05337078651685393
-->FNR 0.09097472924187726
-->positive probability:0.7340608845491097, 1278/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.016631799105878513, 0.036410854356582575, 0.01695993216027136, 0.6497067345063953, 0.005262290061950864, 0.01695993216027136]
-->fnr_diff [0.06614598829063448, 0.06701732019130051, 0.15251317918471738, 0.010799514313734649, 0.021512421275515628, 0.00937592428275658, 0.11117772608455839, 0.10104259094942325]
-->FPR:[0.03359173126614987, 0.05337078651685393, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12930856777864877, mean FPR diff:0.12365525705855833
-->FNR:[0.09010339734121123, 0.09097472924187726, 0.17647058823529413, 0.013157894736842105, 0.0024449877750611247, 0.03333333333333333, 0.13513513513513514, 0.125], mean FNR:0.08332750822484429, mean FNR diff:0.06744808307158011
-->mean fnr diff metric 0.12365525705855833
testing dataset
-->original metric score:
-->individual metric:0.12746710526315788, num_idi:155, num_all:1216
-->individual metric 0.12746710526315788
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8872017353579176
-->F1 0.9097222222222222
-->FPR 0.08695652173913043
-->FNR 0.12666666666666668
-->positive probability:0.5986984815618221, 276/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8715083798882681
-->F1 0.9163636363636364
-->FPR 0.16083916083916083
-->FNR 0.12041884816753927
-->positive probability:0.7360335195530726, 527/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9743589743589743
-->F1 0.9870129870129869
-->FPR None
-->FNR 0.02564102564102564
-->positive probability:0.9743589743589743, 38/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.008678635242065857, 0.08256127434209626, 0.08838878016960208, 0.4217221135029354, 0.9217221135029354, 0.0017221135029354268, 0.1360078277886497]
-->fnr_diff [0.02985871271585558, 0.02361089421672817, 0.0281920460491889, 0.0968079539508111, 0.0968079539508111, 0.07116692830978547, 0.1889063317634746, 0.0281920460491889]
-->FPR:[0.08695652173913043, 0.16083916083916083, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3155354376472389, mean FPR diff:0.2372575511501743
-->FNR:[0.12666666666666668, 0.12041884816753927, 0.125, 0.0, 0.0, 0.02564102564102564, 0.2857142857142857, 0.125], mean FNR:0.10105510327368966, mean FNR diff:0.07044285837573047
-->mean fnr diff metric 0.2372575511501743
-->epoch 16
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1058, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1690, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:1.360735385739461e-34, FU:6.803676813902935e-34, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1655, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.021276595070958138, FU:1.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1395, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:2.1517034145756867e-25, FU:1.0758516579840368e-23, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1360, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1409, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.06122449040412903, FU:3.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1393, bias_loss:nan
-->after epoch 16
-->overall baseline on training dataset
-->ACC 0.9796205962059621
-->F1 0.9790925266903915
-->FPR: 0.017383930464278143
-->FNR: 0.023513753327417924
-->overall baseline on testing dataset
-->ACC 0.9132743362831859
-->F1 0.9098080462792533
-->FPR: 0.07925636007827788
-->FNR: 0.09471480900052329
training dataset
-->original metric score:
-->individual metric:0.11969644705070714, num_idi:347, num_all:2899
-->individual metric 0.11969644705070714
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9323308270676691
-->F1 0.9449541284403671
-->FPR 0.03359173126614987
-->FNR 0.08714918759231906
-->positive probability:0.5930451127819549, 631/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9184376794945434
-->F1 0.9467366841710427
-->FPR 0.05337078651685393
-->FNR 0.0888086642599278
-->positive probability:0.7357840321654222, 1281/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.01620780080187173, 0.03598685605257579, 0.017383930464278143, 0.6492827362023885, 0.0048382917579440805, 0.017383930464278143]
-->fnr_diff [0.06363543426490113, 0.06529491093250987, 0.1529568349078762, 0.01035585859057582, 0.0210687655523568, 0.009819580005915408, 0.11162138180771722, 0.10148624667258208]
-->FPR:[0.03359173126614987, 0.05337078651685393, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12930856777864877, mean FPR diff:0.12351392429055606
-->FNR:[0.08714918759231906, 0.0888086642599278, 0.17647058823529413, 0.013157894736842105, 0.0024449877750611247, 0.03333333333333333, 0.13513513513513514, 0.125], mean FNR:0.08268747388348908, mean FNR diff:0.06702987659180432
-->mean fnr diff metric 0.12351392429055606
testing dataset
-->original metric score:
-->individual metric:0.12746710526315788, num_idi:155, num_all:1216
-->individual metric 0.12746710526315788
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8850325379609545
-->F1 0.9081455805892548
-->FPR 0.09316770186335403
-->FNR 0.12666666666666668
-->positive probability:0.6008676789587852, 277/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8701117318435754
-->F1 0.9155313351498638
-->FPR 0.16783216783216784
-->FNR 0.12041884816753927
-->positive probability:0.7374301675977654, 528/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9743589743589743
-->F1 0.9870129870129869
-->FPR None
-->FNR 0.02564102564102564
-->positive probability:0.9743589743589743, 38/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.01391134178507615, 0.08857580775388996, 0.08741030658838878, 0.42074363992172215, 0.9207436399217221, 0.0007436399217221196, 0.1350293542074364]
-->fnr_diff [0.03195185766614339, 0.025704039167015982, 0.030285190999476713, 0.09471480900052329, 0.09471480900052329, 0.06907378335949765, 0.1909994767137624, 0.030285190999476713]
-->FPR:[0.09316770186335403, 0.16783216783216784, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3174217500925575, mean FPR diff:0.23816539001427967
-->FNR:[0.12666666666666668, 0.12041884816753927, 0.125, 0.0, 0.0, 0.02564102564102564, 0.2857142857142857, 0.125], mean FNR:0.10105510327368966, mean FNR diff:0.07096614461330242
-->mean fnr diff metric 0.23816539001427967
-->epoch 17
-->start_index 0
-->batch_size 98
-->FUR:0.01834781840443611, FU:1.0091300010681152, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1035, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:2.7768296328429513e-31, FU:8.330488663429984e-31, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1680, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:9.136587582048742e-28, FU:4.568293887320868e-27, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1645, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.021276595070958138, FU:1.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1371, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:1.5748391250398615e-16, FU:7.874195307561952e-15, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.631424598997758e-30, FU:1.1419972381063402e-29, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1342, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.020000671967864037, FU:1.0000336170196533, P:50
-->FUR:0.060000672936439514, FU:3.0000336170196533, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1392, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.06122449040412903, FU:3.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1381, bias_loss:nan
-->after epoch 17
-->overall baseline on training dataset
-->ACC 0.9796205962059621
-->F1 0.979101823032459
-->FPR: 0.017807928768284926
-->FNR: 0.023070097604259095
-->overall baseline on testing dataset
-->ACC 0.913527180783818
-->F1 0.9102833158447009
-->FPR: 0.0812133072407045
-->FNR: 0.09209837781266353
training dataset
-->original metric score:
-->individual metric:0.11866160745084511, num_idi:344, num_all:2899
-->individual metric 0.11866160745084511
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9332706766917294
-->F1 0.945925361766946
-->FPR 0.03875968992248062
-->FNR 0.0827178729689808
-->positive probability:0.5977443609022557, 636/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.919586444572085
-->F1 0.9476047904191618
-->FPR 0.05898876404494382
-->FNR 0.08592057761732852
-->positive probability:0.7392303273980471, 1287/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.020951761154195694, 0.04118083527665889, 0.017807928768284926, 0.6488587378983817, 0.004414293453937297, 0.017807928768284926]
-->fnr_diff [0.0596477753647217, 0.06285048001306942, 0.15340049063103503, 0.00991220286741699, 0.02062510982919797, 0.010263235729074238, 0.11206503753087604, 0.1019299023957409]
-->FPR:[0.03875968992248062, 0.05898876404494382, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13110622380938555, mean FPR diff:0.12517024755329056
-->FNR:[0.0827178729689808, 0.08592057761732852, 0.17647058823529413, 0.013157894736842105, 0.0024449877750611247, 0.03333333333333333, 0.13513513513513514, 0.125], mean FNR:0.08177254872524689, mean FNR diff:0.06633677929514153
-->mean fnr diff metric 0.12517024755329056
testing dataset
-->original metric score:
-->individual metric:0.12746710526315788, num_idi:155, num_all:1216
-->individual metric 0.12746710526315788
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8828633405639913
-->F1 0.9065743944636678
-->FPR 0.09937888198757763
-->FNR 0.12666666666666668
-->positive probability:0.6030368763557483, 278/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8701117318435754
-->F1 0.9156844968268358
-->FPR 0.17482517482517482
-->FNR 0.11867364746945899
-->positive probability:0.7402234636871509, 530/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.018165574746873137, 0.09361186758447032, 0.08545335942596216, 0.4187866927592955, 0.9187866927592955, 0.0012133072407044948, 0.13307240704500978]
-->fnr_diff [0.03456828885400315, 0.026575269656795464, 0.03290162218733647, 0.09209837781266353, 0.09209837781266353, 0.09209837781266353, 0.19361590790162217, 0.03290162218733647]
-->FPR:[0.09937888198757763, 0.17482517482517482, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3193080625378762, mean FPR diff:0.23844141450880155
-->FNR:[0.12666666666666668, 0.11867364746945899, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09763182498130142, mean FNR diff:0.07460723052813553
-->mean fnr diff metric 0.23844141450880155
-->epoch 18
-->start_index 0
-->batch_size 98
-->FUR:0.0363636240363121, FU:1.9999994039535522, P:55
-->FUR:0.01960785686969757, FU:1.0000007152557373, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1013, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:2.0924716462804786e-18, FU:6.277414938841436e-18, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1673, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:1.0375881377433118e-20, FU:5.187940769495916e-20, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1639, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.046806447207927704, FU:2.995612621307373, P:64
-->FUR:0.042459841817617416, FU:1.995612621307373, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1350, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:9.64969331107568e-07, FU:4.8248464736388996e-05, P:50
-->FUR:0.017544707283377647, FU:1.000048279762268, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.7564960608392849e-16, FU:1.22954720288283e-15, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1323, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:1.9999998807907104, P:50
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1368, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.061225324869155884, FU:3.0000410079956055, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:2.9110968365432693e-34, FU:1.1644387346173077e-33, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1378, bias_loss:nan
-->after epoch 18
-->overall baseline on training dataset
-->ACC 0.9792953929539295
-->F1 0.9787895613548029
-->FPR: 0.01907992368030528
-->FNR: 0.022404614019520853
-->overall baseline on testing dataset
-->ACC 0.9140328697850821
-->F1 0.9111807732497387
-->FPR: 0.08463796477495107
-->FNR: 0.08738880167451596
training dataset
-->original metric score:
-->individual metric:0.12452569851672991, num_idi:361, num_all:2899
-->individual metric 0.12452569851672991
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9407894736842105
-->F1 0.9523809523809524
-->FPR 0.041343669250646
-->FNR 0.06942392909896603
-->positive probability:0.6071428571428571, 646/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9241815048822516
-->F1 0.9508196721311475
-->FPR 0.06460674157303371
-->FNR 0.07870036101083032
-->positive probability:0.746122917863297, 1299/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.9
-->F1 0.9206349206349206
-->FPR 0.0
-->FNR 0.14705882352941177
-->positive probability:0.58, 29/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9512195121951219
-->F1 0.9444444444444445
-->FPR 0.022222222222222223
-->FNR 0.08108108108108109
-->positive probability:0.4268292682926829, 35/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.022263745570340717, 0.04552681789272843, 0.01907992368030528, 0.6475867429863613, 0.0031422985419169436, 0.01907992368030528]
-->fnr_diff [0.04701931507944517, 0.056295746991309466, 0.12465420950989092, 0.009246719282678749, 0.019959626244459728, 0.002595385980479148, 0.05867646706156023, 0.10259538598047915]
-->FPR:[0.041343669250646, 0.06460674157303371, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13247321661876144, mean FPR diff:0.12611324205865967
-->FNR:[0.06942392909896603, 0.07870036101083032, 0.14705882352941177, 0.013157894736842105, 0.0024449877750611247, 0.025, 0.08108108108108109, 0.125], mean FNR:0.06773338465402405, mean FNR diff:0.05263035701628782
-->mean fnr diff metric 0.12611324205865967
testing dataset
-->original metric score:
-->individual metric:0.1356907894736842, num_idi:165, num_all:1216
-->individual metric 0.1356907894736842
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8828633405639913
-->F1 0.907849829351536
-->FPR 0.12422360248447205
-->FNR 0.11333333333333333
-->positive probability:0.6203904555314533, 286/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8715083798882681
-->F1 0.9172661870503598
-->FPR 0.20279720279720279
-->FNR 0.1099476439790576
-->positive probability:0.7527932960893855, 539/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9375
-->FPR 0.16666666666666666
-->FNR 0.0625
-->positive probability:0.7272727272727273, 16/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.03958563770952098, 0.11815923802225171, 0.08202870189171559, 0.41536203522504894, 0.9153620352250489, 0.00463796477495107, 0.1296477495107632]
-->fnr_diff [0.02594453165881737, 0.022558842304541638, 0.02488880167451596, 0.08738880167451596, 0.08738880167451596, 0.08738880167451596, 0.19832548403976974, 0.03761119832548404]
-->FPR:[0.12422360248447205, 0.20279720279720279, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3268533123191508, mean FPR diff:0.2435404803370429
-->FNR:[0.11333333333333333, 0.1099476439790576, 0.0625, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.08706190787833458, mean FNR diff:0.07143690787833458
-->mean fnr diff metric 0.2435404803370429
-->epoch 19
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.03573344647884369, FU:1.8224058151245117, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1000, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:9.919552531065e-22, FU:2.9758656583453043e-21, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1673, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:3.08298225821306e-32, FU:1.5414910997191713e-31, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1648, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.021276595070958138, FU:1.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1358, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:4.688477405987722e-37, FU:2.344238649184e-35, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1349, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1451, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.06122449040412903, FU:3.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1356, bias_loss:nan
-->after epoch 19
-->overall baseline on training dataset
-->ACC 0.9797289972899729
-->F1 0.9792106725958867
-->FPR: 0.017595929616281536
-->FNR: 0.023070097604259095
-->overall baseline on testing dataset
-->ACC 0.9140328697850821
-->F1 0.9107142857142858
-->FPR: 0.07974559686888454
-->FNR: 0.09262166405023547
training dataset
-->original metric score:
-->individual metric:0.11866160745084511, num_idi:344, num_all:2899
-->individual metric 0.11866160745084511
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9332706766917294
-->F1 0.9457601222307105
-->FPR 0.03359173126614987
-->FNR 0.08567208271787297
-->positive probability:0.5939849624060151, 632/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.919586444572085
-->F1 0.947565543071161
-->FPR 0.056179775280898875
-->FNR 0.08664259927797834
-->positive probability:0.7380815623205055, 1285/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.015995801649868337, 0.03858384566461734, 0.017595929616281536, 0.6490707370503851, 0.004626292605940687, 0.017595929616281536]
-->fnr_diff [0.06260198511361387, 0.06357250167371924, 0.15340049063103503, 0.00991220286741699, 0.02062510982919797, 0.010263235729074238, 0.11206503753087604, 0.1019299023957409]
-->FPR:[0.03359173126614987, 0.056179775280898875, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12977673257265626, mean FPR diff:0.12391142270056242
-->FNR:[0.08567208271787297, 0.08664259927797834, 0.17647058823529413, 0.013157894736842105, 0.0024449877750611247, 0.03333333333333333, 0.13513513513513514, 0.125], mean FNR:0.08223207765143964, mean FNR diff:0.06679630822133428
-->mean fnr diff metric 0.12391142270056242
testing dataset
-->original metric score:
-->individual metric:0.12828947368421054, num_idi:156, num_all:1216
-->individual metric 0.12828947368421054
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8828633405639913
-->F1 0.9065743944636678
-->FPR 0.09937888198757763
-->FNR 0.12666666666666668
-->positive probability:0.6030368763557483, 278/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8701117318435754
-->F1 0.9156844968268358
-->FPR 0.17482517482517482
-->FNR 0.11867364746945899
-->positive probability:0.7402234636871509, 530/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.019633285118693097, 0.09507957795629028, 0.08692106979778212, 0.42025440313111545, 0.9202544031311155, 0.000254403131115466, 0.13454011741682975]
-->fnr_diff [0.0340450026164312, 0.026051983419223518, 0.032378335949764525, 0.09262166405023547, 0.09262166405023547, 0.09262166405023547, 0.19309262166405022, 0.032378335949764525]
-->FPR:[0.09937888198757763, 0.17482517482517482, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3193080625378762, mean FPR diff:0.23956246566899167
-->FNR:[0.12666666666666668, 0.11867364746945899, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09763182498130142, mean FNR diff:0.07447640896874255
-->mean fnr diff metric 0.23956246566899167
    train_ind  train_acc  ...  test_fnr_mean  test_fnr_diff
0    0.123836   0.983957  ...       0.114836       0.081346
1    0.127630   0.983523  ...       0.123311       0.079050
2    0.123491   0.983957  ...       0.118267       0.081899
3    0.122111   0.981138  ...       0.109358       0.071028
4    0.122111   0.978753  ...       0.107236       0.068382
5    0.120041   0.981030  ...       0.104241       0.068657
6    0.120041   0.982764  ...       0.104022       0.069486
7    0.120041   0.982222  ...       0.099995       0.066374
8    0.117972   0.981572  ...       0.102971       0.067649
9    0.119696   0.978103  ...       0.105549       0.067480
10   0.119007   0.976477  ...       0.106402       0.067810
11   0.119696   0.978211  ...       0.106402       0.068333
12   0.120386   0.979512  ...       0.105530       0.068115
13   0.119007   0.980054  ...       0.105113       0.068091
14   0.117972   0.979729  ...       0.105113       0.067960
15   0.117972   0.979621  ...       0.101055       0.070443
16   0.119696   0.979621  ...       0.101055       0.070966
17   0.118662   0.979621  ...       0.097632       0.074607
18   0.124526   0.979295  ...       0.087062       0.071437
19   0.118662   0.979729  ...       0.097632       0.074476

[20 rows x 22 columns]
-->gamma 1.1
-->model.parameters() <generator object Module.parameters at 0x7f167fa6a900>
-->classifier <generator object Module.parameters at 0x7f167fa6a900>
-->orig_weight tensor([[-0.0124,  0.0027, -0.0253,  ..., -0.0036,  0.0339, -0.0388],
        [-0.0029, -0.0085,  0.0260,  ..., -0.0029, -0.0171,  0.0363],
        [-0.0187, -0.0039, -0.0110,  ...,  0.0020,  0.0170, -0.0216],
        ...,
        [-0.0105, -0.0182, -0.0075,  ...,  0.0177,  0.0142,  0.0328],
        [ 0.0441, -0.0416, -0.0086,  ...,  0.0005,  0.0160,  0.0165],
        [ 0.0139,  0.0281,  0.0062,  ...,  0.0306,  0.0094,  0.0063]],
       device='cuda:0', grad_fn=<CloneBackward0>)
-->orig_bias tensor([-0.0226, -0.0174,  0.0243,  0.0272, -0.0247,  0.0404,  0.0256,  0.0116,
        -0.0080,  0.0246, -0.0157,  0.0212,  0.0173, -0.0139,  0.0246, -0.0271,
        -0.0060, -0.0139,  0.0035, -0.0219, -0.0082, -0.0294, -0.0374,  0.0385,
         0.0069, -0.0041,  0.0147,  0.0112,  0.0349, -0.0078, -0.0131, -0.0334,
        -0.0100, -0.0055,  0.0191,  0.0411, -0.0033, -0.0040, -0.0214,  0.0080,
        -0.0211, -0.0306, -0.0226,  0.0227, -0.0432,  0.0166, -0.0109, -0.0236,
         0.0155, -0.0085, -0.0291, -0.0043,  0.0297,  0.0209, -0.0269, -0.0308,
        -0.0244, -0.0257, -0.0194, -0.0279, -0.0067], device='cuda:0',
       grad_fn=<CloneBackward0>)
-->MinValue:-3.2998316455372216, MaxValue:3.9719170089423623
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9125939849624061
-->F1 0.928296067848882
-->FPR 0.046511627906976744
-->FNR 0.11078286558345643
-->positive probability:0.5827067669172933, 620/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9063756461803562
-->F1 0.9387908374014269
-->FPR 0.07865168539325842
-->FNR 0.09747292418772563
-->positive probability:0.7340608845491097, 1278/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9605263157894737
-->F1 0.9798657718120806
-->FPR None
-->FNR 0.039473684210526314
-->positive probability:0.9605263157894737, 73/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9660194174757282
-->F1 0.9826732673267327
-->FPR 0.6666666666666666
-->FNR 0.029339853300733496
-->positive probability:0.9684466019417476, 399/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.03167168790697675, 0.06381174539325843, 0.01483994, 0.6518267266666666, 0.007382282222222224, 0.01483994]
-->fnr_diff [0.09481125558345643, 0.08150131418772563, 0.10167544882352941, 0.023502074210526313, 0.013368243300733496, 0.017361723333333332, 0.11916352513513515, 0.10902839]
-->FPR: [0.046511627906976744, 0.07865168539325842, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13567536703152067, mean FPR diff:0.130728720364854
-->FNR: [0.11078286558345643, 0.09747292418772563, 0.11764705882352941, 0.039473684210526314, 0.029339853300733496, 0.03333333333333333, 0.13513513513513514, 0.125], mean FNR:0.08602310682180497, mean FNR diff:0.07005149682180498
-->base group metric 0.130728720364854 0.13567536703152067
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8698481561822126
-->F1 0.8947368421052632
-->FPR 0.09316770186335403
-->FNR 0.15
-->positive probability:0.5856832971800434, 270/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8645251396648045
-->F1 0.9115770282588879
-->FPR 0.16783216783216784
-->FNR 0.1273996509598604
-->positive probability:0.7318435754189944, 524/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9743589743589743
-->F1 0.987012987012987
-->FPR 1.0
-->FNR 0.01935483870967742
-->positive probability:0.9807692307692307, 153/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9230769230769231
-->F1 0.9600000000000001
-->FPR None
-->FNR 0.07692307692307693
-->positive probability:0.9230769230769231, 36/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.75
-->FPR 0.04
-->FNR 0.35714285714285715
-->positive probability:0.2564102564102564, 10/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.07832776186335404, 0.15299222783216784, 0.01483994, 0.48516006, 0.98516006, 0.02516006, 0.12801720285714285]
-->fnr_diff [0.13402839, 0.11142804095986039, 0.10902839, 0.01597161, 0.0033832287096774195, 0.06095146692307693, 0.3411712471428571, 0.10902839]
-->FPR: [0.09316770186335403, 0.16783216783216784, 0.0, 0.5, 1.0, 0.04, 0.14285714285714285], mean FPR:0.27769385893609494, mean FPR diff:0.2670939017932378
-->FNR: [0.15, 0.1273996509598604, 0.125, 0.0, 0.01935483870967742, 0.07692307692307693, 0.35714285714285715, 0.125], mean FNR:0.12260255296693398, mean FNR diff:0.11062384546693399
-->base group metric 0.2670939017932378 0.27769385893609494
-->epoch 0
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1002, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.2068965584039688, FU:12.0, P:58
-->FUR:0.2667519152164459, FU:12.804092407226562, P:48
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:3.8530614283185263e-28, FU:1.1559184044214336e-27, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.2177, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:2.5813264312822992e-24, FU:1.0325305725129197e-23, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1776, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.021411385387182236, FU:1.0063351392745972, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1464, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1693, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.2171, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.06122449040412903, FU:3.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1621, bias_loss:nan
-->after epoch 0
-->overall baseline on training dataset
-->ACC 0.9828726287262872
-->F1 0.9823700066949342
-->FPR: 0.011023955904176383
-->FNR: 0.023513753327417924
-->overall baseline on testing dataset
-->ACC 0.9193426042983565
-->F1 0.9153621650305122
-->FPR: 0.06506849315068493
-->FNR: 0.09733124018838304
training dataset
-->original metric score:
-->individual metric:0.12004139358399447, num_idi:348, num_all:2899
-->individual metric 0.12004139358399447
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9210526315789473
-->F1 0.9348837209302326
-->FPR 0.025839793281653745
-->FNR 0.10930576070901034
-->positive probability:0.5761278195488722, 613/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9092475588742103
-->F1 0.9401515151515151
-->FPR 0.03932584269662921
-->FNR 0.10397111913357401
-->positive probability:0.7208500861573808, 1255/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9736842105263158
-->F1 0.9866666666666666
-->FPR None
-->FNR 0.02631578947368421
-->positive probability:0.9736842105263158, 74/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.014815837377477362, 0.02830188679245283, 0.011023955904176383, 0.6556427107624903, 0.01119826631804584, 0.011023955904176383]
-->fnr_diff [0.08579200738159241, 0.08045736580615609, 0.1529568349078762, 0.0028020361462662846, 0.0210687655523568, 0.009819580005915408, 0.11162138180771722, 0.10148624667258208]
-->FPR:[0.025839793281653745, 0.03932584269662921, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12567575414452864, mean FPR diff:0.12200110217646985
-->FNR:[0.10930576070901034, 0.10397111913357401, 0.17647058823529413, 0.02631578947368421, 0.0024449877750611247, 0.03333333333333333, 0.13513513513513514, 0.125], mean FNR:0.08899708922438654, mean FNR diff:0.07075052728505782
-->mean fnr diff metric 0.12200110217646985
testing dataset
-->original metric score:
-->individual metric:0.13733552631578946, num_idi:167, num_all:1216
-->individual metric 0.13733552631578946
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8698481561822126
-->F1 0.8943661971830985
-->FPR 0.08695652173913043
-->FNR 0.15333333333333332
-->positive probability:0.5813449023861171, 268/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8561452513966481
-->F1 0.9052437902483901
-->FPR 0.15384615384615385
-->FNR 0.14136125654450263
-->positive probability:0.7178770949720671, 514/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8
-->FPR 0.04
-->FNR 0.2857142857142857
-->positive probability:0.28205128205128205, 11/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9545454545454546
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3181818181818182, 7/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.021888028588445504, 0.08877766069546893, 0.06506849315068493, 0.4349315068493151, 0.934931506849315, 0.025068493150684927, 0.06506849315068493]
-->fnr_diff [0.05600209314495028, 0.04403001635611958, 0.027668759811616955, 0.09733124018838304, 0.09733124018838304, 0.046049188906331764, 0.18838304552590265, 0.027668759811616955]
-->FPR:[0.08695652173913043, 0.15384615384615385, 0.0, 0.5, 1.0, 0.04, 0.0], mean FPR:0.2544003822264692, mean FPR diff:0.23367631177637133
-->FNR:[0.15333333333333332, 0.14136125654450263, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.1102113658592716, mean FNR diff:0.07305804299166303
-->mean fnr diff metric 0.23367631177637133
-->epoch 1
-->start_index 0
-->batch_size 98
-->FUR:4.440545367143389e-25, FU:2.4422999519288638e-23, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1474, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:1.432527013678353e-10, FU:4.297580902257181e-10, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1782, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:1.0661345930469143e-20, FU:4.264538372187657e-20, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:1.7530543125703577e-26, FU:8.765271408777393e-26, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1718, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.07812526077032089, FU:5.000016689300537, P:64
-->FUR:0.0851067453622818, FU:4.000017166137695, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1484, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.07017543911933899, FU:4.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1616, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.10000000149011612, FU:5.0, P:50
-->FUR:1.8950176709319597e-21, FU:3.790035341863919e-21, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1573, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0714285746216774, FU:4.0, P:56
-->FUR:0.2857144773006439, FU:14.000009536743164, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.25, FU:1.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1639, bias_loss:nan
-->after epoch 1
-->overall baseline on training dataset
-->ACC 0.9818970189701897
-->F1 0.9815774958632102
-->FPR: 0.022895908416366333
-->FNR: 0.013087843833185448
-->overall baseline on testing dataset
-->ACC 0.9183312262958281
-->F1 0.9165158955802534
-->FPR: 0.09050880626223091
-->FNR: 0.07221350078492936
training dataset
-->original metric score:
-->individual metric:0.13694377371507416, num_idi:397, num_all:2899
-->individual metric 0.13694377371507416
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9304511278195489
-->F1 0.9441087613293051
-->FPR 0.056847545219638244
-->FNR 0.07680945347119646
-->positive probability:0.6080827067669173, 647/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9241815048822516
-->F1 0.9513274336283185
-->FPR 0.10393258426966293
-->FNR 0.06859205776173286
-->positive probability:0.76220562894888, 1327/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9393939393939394
-->FPR 0.0625
-->FNR 0.08823529411764706
-->positive probability:0.64, 32/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9166666666666667
-->FPR 0.044444444444444446
-->FNR 0.10810810810810811
-->positive probability:0.4268292682926829, 35/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9310344827586207
-->F1 0.9130434782608695
-->FPR 0.029411764705882353
-->FNR 0.125
-->positive probability:0.3793103448275862, 22/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.033951636803271915, 0.08103667585329659, 0.03960409158363366, 0.6437707582503003, 0.021548536028078113, 0.006515856289516019]
-->fnr_diff [0.063721609638011, 0.05550421392854741, 0.07514745028446161, 0.013087843833185448, 0.010642856058124324, 0.011912156166814554, 0.09502026427492266, 0.11191215616681455]
-->FPR:[0.056847545219638244, 0.10393258426966293, 0.0625, 0.6666666666666666, 0.044444444444444446, 0.029411764705882353], mean FPR:0.16063383421771577, mean FPR diff:0.13773792580134944
-->FNR:[0.07680945347119646, 0.06859205776173286, 0.08823529411764706, 0.0, 0.0024449877750611247, 0.025, 0.10810810810810811, 0.125], mean FNR:0.0617737376542182, mean FNR diff:0.0546185687938602
-->mean fnr diff metric 0.13773792580134944
testing dataset
-->original metric score:
-->individual metric:0.16036184210526316, num_idi:195, num_all:1216
-->individual metric 0.16036184210526316
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8828633405639913
-->F1 0.9093959731543624
-->FPR 0.15527950310559005
-->FNR 0.09666666666666666
-->positive probability:0.6420824295010846, 296/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8756983240223464
-->F1 0.9214474845542806
-->FPR 0.26573426573426573
-->FNR 0.08900523560209424
-->positive probability:0.7821229050279329, 560/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 1.0
-->F1 1.0
-->FPR 0.0
-->FNR 0.0
-->positive probability:0.7272727272727273, 16/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.8
-->FPR 0.2857142857142857
-->FNR 0.0
-->positive probability:0.5454545454545454, 12/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.06477069684335914, 0.17522545947203483, 0.09050880626223091, 0.4094911937377691, 0.9094911937377691, 0.010508806262230913, 0.1952054794520548]
-->fnr_diff [0.024453165881737307, 0.01679173481716488, 0.07221350078492936, 0.07221350078492936, 0.07221350078492936, 0.020931449502878077, 0.14207221350078492, 0.07221350078492936]
-->FPR:[0.15527950310559005, 0.26573426573426573, 0.0, 0.5, 1.0, 0.08, 0.2857142857142857], mean FPR:0.32667543636487734, mean FPR diff:0.26502880510963556
-->FNR:[0.09666666666666666, 0.08900523560209424, 0.0, 0.0, 0.0, 0.05128205128205128, 0.21428571428571427, 0.0], mean FNR:0.05640495847956581, mean FNR diff:0.061637820855285325
-->mean fnr diff metric 0.26502880510963556
-->epoch 2
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.05882348120212555, FU:2.999997615814209, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1134, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.069536954164505, FU:4.033143520355225, P:58
-->FUR:0.11464902013540268, FU:5.503152847290039, P:48
-->FUR:1.6113263257011567e-07, FU:4.833979119212017e-07, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1709, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1720, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.021276595070958138, FU:1.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1499, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1555, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1851, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.1428571492433548, FU:7.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1535, bias_loss:nan
-->after epoch 2
-->overall baseline on training dataset
-->ACC 0.9841734417344173
-->F1 0.9837705646954202
-->FPR: 0.013355946576213695
-->FNR: 0.01841171251109139
-->overall baseline on testing dataset
-->ACC 0.9188369152970923
-->F1 0.9153704191932507
-->FPR: 0.07142857142857142
-->FNR: 0.09157509157509157
training dataset
-->original metric score:
-->individual metric:0.11900655398413246, num_idi:345, num_all:2899
-->individual metric 0.11900655398413246
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9276315789473685
-->F1 0.9409056024558711
-->FPR 0.03359173126614987
-->FNR 0.09453471196454949
-->positive probability:0.5883458646616542, 626/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9178632969557725
-->F1 0.9464218808542525
-->FPR 0.05898876404494382
-->FNR 0.08808664259927798
-->positive probability:0.7375071797817346, 1284/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.020235784689936177, 0.04563281746873012, 0.013355946576213695, 0.6533107200904529, 0.008866275646008528, 0.013355946576213695]
-->fnr_diff [0.0761229994534581, 0.06967493008818659, 0.09923534631243802, 0.01841171251109139, 0.015966724736030266, 0.00658828748890861, 0.08969639559701673, 0.10658828748890861]
-->FPR:[0.03359173126614987, 0.05898876404494382, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13024489736666375, mean FPR diff:0.12579291517459248
-->FNR:[0.09453471196454949, 0.08808664259927798, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.10810810810810811, 0.125], mean FNR:0.07010268865881576, mean FNR diff:0.06028558545950479
-->mean fnr diff metric 0.12579291517459248
testing dataset
-->original metric score:
-->individual metric:0.13733552631578946, num_idi:167, num_all:1216
-->individual metric 0.13733552631578946
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8720173535791758
-->F1 0.8966725043782837
-->FPR 0.09316770186335403
-->FNR 0.14666666666666667
-->positive probability:0.5878524945770065, 271/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8659217877094972
-->F1 0.9124087591240875
-->FPR 0.16083916083916083
-->FNR 0.1273996509598604
-->positive probability:0.7304469273743017, 523/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8
-->FPR 0.04
-->FNR 0.2857142857142857
-->positive probability:0.28205128205128205, 11/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9545454545454546
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3181818181818182, 7/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.021739130434782608, 0.08941058941058941, 0.07142857142857142, 0.4285714285714286, 0.9285714285714286, 0.031428571428571424, 0.07142857142857142]
-->fnr_diff [0.0550915750915751, 0.03582455938476882, 0.03342490842490843, 0.09157509157509157, 0.09157509157509157, 0.04029304029304029, 0.19413919413919412, 0.03342490842490843]
-->FPR:[0.09316770186335403, 0.16083916083916083, 0.0, 0.5, 1.0, 0.04, 0.0], mean FPR:0.25628669467178783, mean FPR diff:0.23465404161056336
-->FNR:[0.14666666666666667, 0.1273996509598604, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.107632831827858, mean FNR diff:0.07191854611357229
-->mean fnr diff metric 0.23465404161056336
-->epoch 3
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1176, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1704, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1636, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.06382978707551956, FU:3.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1448, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1382, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.05981920287013054, FU:2.990960121154785, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1530, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.1428571492433548, FU:7.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1535, bias_loss:nan
-->after epoch 3
-->overall baseline on training dataset
-->ACC 0.9829810298102981
-->F1 0.982580716742483
-->FPR: 0.016323934704261182
-->FNR: 0.01774622892635315
-->overall baseline on testing dataset
-->ACC 0.9168141592920354
-->F1 0.9136256235232344
-->FPR: 0.07729941291585127
-->FNR: 0.08948194662480377
training dataset
-->original metric score:
-->individual metric:0.11624698171783374, num_idi:337, num_all:2899
-->individual metric 0.11624698171783374
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9295112781954887
-->F1 0.94279176201373
-->FPR 0.041343669250646
-->FNR 0.08714918759231906
-->positive probability:0.5958646616541353, 634/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9218839747271683
-->F1 0.9492915734526473
-->FPR 0.06741573033707865
-->FNR 0.08086642599277978
-->positive probability:0.7449741527857553, 1297/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.025019734546384814, 0.05109179563281747, 0.016323934704261182, 0.6503427319624054, 0.005898287517961041, 0.016323934704261182]
-->fnr_diff [0.06940295866596591, 0.06312019706642663, 0.09990082989717626, 0.01774622892635315, 0.015301241151292024, 0.007253771073646852, 0.09036187918175496, 0.10725377107364685]
-->FPR:[0.041343669250646, 0.06741573033707865, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13294138141276893, mean FPR diff:0.12750006984468185
-->FNR:[0.08714918759231906, 0.08086642599277978, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.10810810810810811, 0.125], mean FNR:0.06827697103647468, mean FNR diff:0.058792609629532824
-->mean fnr diff metric 0.12750006984468185
testing dataset
-->original metric score:
-->individual metric:0.13075657894736842, num_idi:159, num_all:1216
-->individual metric 0.13075657894736842
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8763557483731019
-->F1 0.9008695652173911
-->FPR 0.09937888198757763
-->FNR 0.13666666666666666
-->positive probability:0.596529284164859, 275/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8701117318435754
-->F1 0.9156844968268358
-->FPR 0.17482517482517482
-->FNR 0.11867364746945899
-->positive probability:0.7402234636871509, 530/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.022079469071726365, 0.09752576190932355, 0.08936725375081539, 0.4227005870841487, 0.9227005870841487, 0.002700587084148734, 0.005870841487279843]
-->fnr_diff [0.04718472004186289, 0.029191700844655222, 0.03551805337519623, 0.08948194662480377, 0.08948194662480377, 0.03819989534275249, 0.19623233908948193, 0.03551805337519623]
-->FPR:[0.09937888198757763, 0.17482517482517482, 0.16666666666666666, 0.5, 1.0, 0.08, 0.07142857142857142], mean FPR:0.2988998992725701, mean FPR diff:0.22327786963879875
-->FNR:[0.13666666666666666, 0.11867364746945899, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.10529208139155782, mean FNR diff:0.07010108191484407
-->mean fnr diff metric 0.22327786963879875
-->epoch 4
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1242, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.10416623204946518, FU:4.999979019165039, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1685, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1634, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.06382978707551956, FU:3.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1463, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1350, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1487, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.1428571492433548, FU:7.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1460, bias_loss:nan
-->after epoch 4
-->overall baseline on training dataset
-->ACC 0.9827642276422764
-->F1 0.98237445959428
-->FPR: 0.017383930464278143
-->FNR: 0.017080745341614908
-->overall baseline on testing dataset
-->ACC 0.915802781289507
-->F1 0.9129866736347008
-->FPR: 0.08268101761252446
-->FNR: 0.08581894296180011
training dataset
-->original metric score:
-->individual metric:0.1176267678509831, num_idi:341, num_all:2899
-->individual metric 0.1176267678509831
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9351503759398496
-->F1 0.9476876421531463
-->FPR 0.04392764857881137
-->FNR 0.07680945347119646
-->positive probability:0.6033834586466166, 642/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9247558874210224
-->F1 0.9513553657630895
-->FPR 0.07584269662921349
-->FNR 0.07509025270758123
-->positive probability:0.7512923607122344, 1308/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.026543718114533224, 0.058458766164935345, 0.017383930464278143, 0.6492827362023885, 0.0048382917579440805, 0.017383930464278143]
-->fnr_diff [0.059728708129581545, 0.058009507365966315, 0.1005663134819145, 0.017080745341614908, 0.014635757566553782, 0.007919254658385094, 0.0910273627664932, 0.10791925465838509]
-->FPR:[0.04392764857881137, 0.07584269662921349, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1347765390161523, mean FPR diff:0.12898189552805958
-->FNR:[0.07680945347119646, 0.07509025270758123, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.10810810810810811, 0.125], mean FNR:0.06626248261068454, mean FNR diff:0.0571108629961118
-->mean fnr diff metric 0.12898189552805958
testing dataset
-->original metric score:
-->individual metric:0.13157894736842105, num_idi:160, num_all:1216
-->individual metric 0.13157894736842105
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8785249457700651
-->F1 0.9031141868512111
-->FPR 0.10559006211180125
-->FNR 0.13
-->positive probability:0.6030368763557483, 278/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8743016759776536
-->F1 0.918918918918919
-->FPR 0.1888111888111888
-->FNR 0.1099476439790576
-->positive probability:0.75, 537/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.7727272727272727
-->F1 0.7368421052631579
-->FPR 0.2857142857142857
-->FNR 0.125
-->positive probability:0.5, 11/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.02290904449927679, 0.10613017119866434, 0.0839856490541422, 0.41731898238747556, 0.9173189823874756, 0.0026810176125244556, 0.20303326810176126]
-->fnr_diff [0.0441810570381999, 0.02412870101725749, 0.03918105703819989, 0.08581894296180011, 0.08581894296180011, 0.03453689167974883, 0.1998953427524856, 0.03918105703819989]
-->FPR:[0.10559006211180125, 0.1888111888111888, 0.16666666666666666, 0.5, 1.0, 0.08, 0.2857142857142857], mean FPR:0.3323974576148489, mean FPR diff:0.2504824450344743
-->FNR:[0.13, 0.1099476439790576, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.10336799762192432, mean FNR diff:0.06909274906096148
-->mean fnr diff metric 0.2504824450344743
-->epoch 5
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1056, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1675, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1591, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.06183610484004021, FU:3.9575107097625732, P:64
-->FUR:0.12675555050373077, FU:5.957510948181152, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1412, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1330, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1557, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.1428571492433548, FU:7.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1401, bias_loss:nan
-->after epoch 5
-->overall baseline on training dataset
-->ACC 0.9833062330623307
-->F1 0.9829040852575488
-->FPR: 0.015475938096247616
-->FNR: 0.017968056787932566
-->overall baseline on testing dataset
-->ACC 0.9178255372945638
-->F1 0.9146309429997374
-->FPR: 0.07583170254403131
-->FNR: 0.08895866038723181
training dataset
-->original metric score:
-->individual metric:0.1176267678509831, num_idi:341, num_all:2899
-->individual metric 0.1176267678509831
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9304511278195489
-->F1 0.9435114503816793
-->FPR 0.03875968992248062
-->FNR 0.08714918759231906
-->positive probability:0.5949248120300752, 633/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9230327398047099
-->F1 0.9500745156482862
-->FPR 0.06741573033707865
-->FNR 0.07942238267148015
-->positive probability:0.746122917863297, 1299/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.023283751826233004, 0.051939792240831034, 0.015475938096247616, 0.651190728570419, 0.0067462841259746074, 0.015475938096247616]
-->fnr_diff [0.0691811308043865, 0.061454325883547586, 0.09967900203559685, 0.017968056787932566, 0.01552306901287144, 0.007031943212067435, 0.11716707834720258, 0.10703194321206744]
-->FPR:[0.03875968992248062, 0.06741573033707865, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13251071819140803, mean FPR diff:0.12735207215932548
-->FNR:[0.08714918759231906, 0.07942238267148015, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.13513513513513514, 0.125], mean FNR:0.07147484399969062, mean FNR diff:0.06187956866195905
-->mean fnr diff metric 0.12735207215932548
testing dataset
-->original metric score:
-->individual metric:0.1299342105263158, num_idi:158, num_all:1216
-->individual metric 0.1299342105263158
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8806941431670282
-->F1 0.9046793760831889
-->FPR 0.09937888198757763
-->FNR 0.13
-->positive probability:0.6008676789587852, 277/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8743016759776536
-->F1 0.9184782608695652
-->FPR 0.16783216783216784
-->FNR 0.11518324607329843
-->positive probability:0.7416201117318436, 531/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.023547179443546326, 0.09200046528813653, 0.09083496412263535, 0.4241682974559687, 0.9241682974559687, 0.004168297455968695, 0.004403131115459882]
-->fnr_diff [0.04104133961276819, 0.026224585686066615, 0.03604133961276819, 0.08895866038723181, 0.08895866038723181, 0.03767660910518053, 0.19675562532705387, 0.03604133961276819]
-->FPR:[0.09937888198757763, 0.16783216783216784, 0.16666666666666666, 0.5, 1.0, 0.08, 0.07142857142857142], mean FPR:0.29790089827356914, mean FPR diff:0.22332723319109776
-->FNR:[0.13, 0.11518324607329843, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.10402244788370443, mean FNR diff:0.06896226996638365
-->mean fnr diff metric 0.22332723319109776
-->epoch 6
-->start_index 0
-->batch_size 98
-->FUR:0.03636357933282852, FU:1.9999969005584717, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1054, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1651, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1642, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.021276595070958138, FU:1.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1426, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1352, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1496, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.12244898080825806, FU:6.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1381, bias_loss:nan
-->after epoch 6
-->overall baseline on training dataset
-->ACC 0.9831978319783198
-->F1 0.9827873403664631
-->FPR: 0.015263938944244222
-->FNR: 0.01841171251109139
-->overall baseline on testing dataset
-->ACC 0.915802781289507
-->F1 0.912621359223301
-->FPR: 0.07876712328767123
-->FNR: 0.09000523286237572
training dataset
-->original metric score:
-->individual metric:0.11866160745084511, num_idi:344, num_all:2899
-->individual metric 0.11866160745084511
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.931390977443609
-->F1 0.9441469013006885
-->FPR 0.03359173126614987
-->FNR 0.08862629246676514
-->positive probability:0.5921052631578947, 630/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9241815048822516
-->F1 0.9507829977628635
-->FPR 0.06179775280898876
-->FNR 0.07942238267148015
-->positive probability:0.7449741527857553, 1297/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.9
-->F1 0.9206349206349206
-->FPR 0.0
-->FNR 0.14705882352941177
-->positive probability:0.58, 29/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.01832779232190565, 0.04653381386474454, 0.015263938944244222, 0.6514027277224224, 0.006958283277978001, 0.015263938944244222]
-->fnr_diff [0.07021457995567375, 0.06101067016038876, 0.12864711101832038, 0.01841171251109139, 0.015966724736030266, 0.014921620822241941, 0.11672342262404375, 0.10658828748890861]
-->FPR:[0.03359173126614987, 0.06179775280898876, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13071306216067127, mean FPR diff:0.12562508251258983
-->FNR:[0.08862629246676514, 0.07942238267148015, 0.14705882352941177, 0.0, 0.0024449877750611247, 0.03333333333333333, 0.13513513513513514, 0.125], mean FNR:0.07637761936389834, mean FNR diff:0.06656051616458736
-->mean fnr diff metric 0.12562508251258983
testing dataset
-->original metric score:
-->individual metric:0.1299342105263158, num_idi:158, num_all:1216
-->individual metric 0.1299342105263158
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8785249457700651
-->F1 0.9027777777777778
-->FPR 0.09937888198757763
-->FNR 0.13333333333333333
-->positive probability:0.5986984815618221, 276/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8743016759776536
-->F1 0.9183303085299456
-->FPR 0.16083916083916083
-->FNR 0.1169284467713787
-->positive probability:0.7388268156424581, 529/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.020611758699906405, 0.0820720375514896, 0.08789954337899543, 0.4212328767123288, 0.9212328767123288, 0.0012328767123287732, 0.007338551859099804]
-->fnr_diff [0.043328100470957615, 0.026923213909002985, 0.03499476713762428, 0.09000523286237572, 0.09000523286237572, 0.03872318158032444, 0.19570905285190998, 0.03499476713762428]
-->FPR:[0.09937888198757763, 0.16083916083916083, 0.16666666666666666, 0.5, 1.0, 0.08, 0.07142857142857142], mean FPR:0.2969018972745681, mean FPR diff:0.22023150308949682
-->FNR:[0.13333333333333333, 0.1169284467713787, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.10465726463763111, mean FNR diff:0.06933544360152438
-->mean fnr diff metric 0.22023150308949682
-->epoch 7
-->start_index 0
-->batch_size 98
-->FUR:8.285710130089053e-35, FU:4.557140703562505e-33, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1068, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1605, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1646, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1396, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1326, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1417, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.12256113439798355, FU:6.005495548248291, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1398, bias_loss:nan
-->after epoch 7
-->overall baseline on training dataset
-->ACC 0.9822222222222222
-->F1 0.9818141494788201
-->FPR: 0.017595929616281536
-->FNR: 0.017968056787932566
-->overall baseline on testing dataset
-->ACC 0.9160556257901391
-->F1 0.9130434782608694
-->FPR: 0.08023483365949119
-->FNR: 0.08791208791208792
training dataset
-->original metric score:
-->individual metric:0.1176267678509831, num_idi:341, num_all:2899
-->individual metric 0.1176267678509831
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.931390977443609
-->F1 0.9441469013006885
-->FPR 0.03359173126614987
-->FNR 0.08862629246676514
-->positive probability:0.5921052631578947, 630/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9247558874210224
-->F1 0.9512104283054004
-->FPR 0.06460674157303371
-->FNR 0.0779783393501805
-->positive probability:0.7466973004020678, 1300/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.9
-->F1 0.9206349206349206
-->FPR 0.0
-->FNR 0.14705882352941177
-->positive probability:0.58, 29/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.015995801649868337, 0.04701081195675218, 0.017595929616281536, 0.6490707370503851, 0.004626292605940687, 0.017595929616281536]
-->fnr_diff [0.07065823567883257, 0.06001028256224794, 0.1290907667414792, 0.017968056787932566, 0.01552306901287144, 0.015365276545400767, 0.11716707834720258, 0.10703194321206744]
-->FPR:[0.03359173126614987, 0.06460674157303371, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13118122695467874, mean FPR diff:0.1253159170825849
-->FNR:[0.08862629246676514, 0.0779783393501805, 0.14705882352941177, 0.0, 0.0024449877750611247, 0.03333333333333333, 0.13513513513513514, 0.125], mean FNR:0.07619711394873588, mean FNR diff:0.06660183861100431
-->mean fnr diff metric 0.1253159170825849
testing dataset
-->original metric score:
-->individual metric:0.1299342105263158, num_idi:158, num_all:1216
-->individual metric 0.1299342105263158
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8785249457700651
-->F1 0.9027777777777778
-->FPR 0.09937888198757763
-->FNR 0.13333333333333333
-->positive probability:0.5986984815618221, 276/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8770949720670391
-->F1 0.9202898550724637
-->FPR 0.16083916083916083
-->FNR 0.11343804537521815
-->positive probability:0.7416201117318436, 531/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.019144048328086444, 0.08060432717966964, 0.08643183300717547, 0.4197651663405088, 0.9197651663405089, 0.00023483365949118762, 0.008806262230919765]
-->fnr_diff [0.04542124542124541, 0.02552595746313023, 0.03708791208791208, 0.08791208791208792, 0.08791208791208792, 0.08791208791208792, 0.19780219780219777, 0.03708791208791208]
-->FPR:[0.09937888198757763, 0.16083916083916083, 0.16666666666666666, 0.5, 1.0, 0.08, 0.07142857142857142], mean FPR:0.2969018972745681, mean FPR diff:0.21925023386948003
-->FNR:[0.13333333333333333, 0.11343804537521815, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09781070805285465, mean FNR diff:0.07583268607483266
-->mean fnr diff metric 0.21925023386948003
-->epoch 8
-->start_index 0
-->batch_size 98
-->FUR:2.317358873698013e-26, FU:1.2745473789931633e-24, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1041, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1590, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.11111105233430862, FU:5.999996662139893, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1633, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1360, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1295, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1400, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.12244898080825806, FU:6.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1344, bias_loss:nan
-->after epoch 8
-->overall baseline on training dataset
-->ACC 0.9818970189701897
-->F1 0.9814835347599511
-->FPR: 0.01801992792028832
-->FNR: 0.01818988464951198
-->overall baseline on testing dataset
-->ACC 0.9150442477876106
-->F1 0.9121338912133892
-->FPR: 0.08268101761252446
-->FNR: 0.08738880167451596
training dataset
-->original metric score:
-->individual metric:0.11659192825112108, num_idi:338, num_all:2899
-->individual metric 0.11659192825112108
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9342105263157895
-->F1 0.9465648854961832
-->FPR 0.03359173126614987
-->FNR 0.08419497784342689
-->positive probability:0.5949248120300752, 633/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.925904652498564
-->F1 0.9520267757530682
-->FPR 0.06741573033707865
-->FNR 0.07581227436823104
-->positive probability:0.7489948305571511, 1304/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.9
-->F1 0.9206349206349206
-->FPR 0.0
-->FNR 0.14705882352941177
-->positive probability:0.58, 29/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.015571803345861553, 0.04939580241679033, 0.01801992792028832, 0.6486467387463783, 0.004202294301933904, 0.01801992792028832]
-->fnr_diff [0.06600509319391491, 0.057622389718719066, 0.12886893887989978, 0.01818988464951198, 0.015744896874450853, 0.015143448683821354, 0.11694525048562317, 0.10681011535048802]
-->FPR:[0.03359173126614987, 0.06741573033707865, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13164939174868623, mean FPR diff:0.1256427491085901
-->FNR:[0.08419497784342689, 0.07581227436823104, 0.14705882352941177, 0.0, 0.0024449877750611247, 0.03333333333333333, 0.13513513513513514, 0.125], mean FNR:0.07537244149807491, mean FNR diff:0.06566625222955363
-->mean fnr diff metric 0.1256427491085901
testing dataset
-->original metric score:
-->individual metric:0.12911184210526316, num_idi:157, num_all:1216
-->individual metric 0.12911184210526316
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8785249457700651
-->F1 0.9031141868512111
-->FPR 0.10559006211180125
-->FNR 0.13
-->positive probability:0.6030368763557483, 278/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8770949720670391
-->F1 0.9204339963833634
-->FPR 0.16783216783216784
-->FNR 0.11169284467713787
-->positive probability:0.744413407821229, 533/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.02290904449927679, 0.08515115021964338, 0.0839856490541422, 0.41731898238747556, 0.9173189823874756, 0.0026810176125244556, 0.06017612524461839]
-->fnr_diff [0.042611198325484045, 0.024304043002621914, 0.03761119832548404, 0.08738880167451596, 0.08738880167451596, 0.08738880167451596, 0.19832548403976974, 0.03761119832548404]
-->FPR:[0.10559006211180125, 0.16783216783216784, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.3089922913525398, mean FPR diff:0.22707727877216524
-->FNR:[0.13, 0.11169284467713787, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09717589129892795, mean FNR diff:0.07532869088029895
-->mean fnr diff metric 0.22707727877216524
-->epoch 9
-->start_index 0
-->batch_size 98
-->FUR:1.5762479925520813e-28, FU:8.669364103481193e-27, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.0986, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1571, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1610, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.046810686588287354, FU:2.9958839416503906, P:64
-->FUR:0.06374221295118332, FU:2.9958839416503906, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1334, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1280, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.039955154061317444, FU:1.9977576732635498, P:50
-->FUR:0.07996124029159546, FU:3.9980618953704834, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1391, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.12244898080825806, FU:6.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1322, bias_loss:nan
-->after epoch 9
-->overall baseline on training dataset
-->ACC 0.9824390243902439
-->F1 0.9820319432120674
-->FPR: 0.017171931312274753
-->FNR: 0.017968056787932566
-->overall baseline on testing dataset
-->ACC 0.9152970922882427
-->F1 0.9124640710739483
-->FPR: 0.08317025440313111
-->FNR: 0.08634222919937205
training dataset
-->original metric score:
-->individual metric:0.11590203518454639, num_idi:336, num_all:2899
-->individual metric 0.11590203518454639
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9360902255639098
-->F1 0.9482496194824962
-->FPR 0.03617571059431524
-->FNR 0.07976366322008863
-->positive probability:0.5986842105263158, 637/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9270534175761057
-->F1 0.9528406981062013
-->FPR 0.0702247191011236
-->FNR 0.0736462093862816
-->positive probability:0.7512923607122344, 1308/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.9
-->F1 0.9206349206349206
-->FPR 0.0
-->FNR 0.14705882352941177
-->positive probability:0.58, 29/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.01900377928204049, 0.05305278778884885, 0.017171931312274753, 0.6494947353543918, 0.0050502909099474705, 0.017171931312274753]
-->fnr_diff [0.061795606432156064, 0.05567815259834903, 0.1290907667414792, 0.017968056787932566, 0.01552306901287144, 0.015365276545400767, 0.11716707834720258, 0.10703194321206744]
-->FPR:[0.03617571059431524, 0.0702247191011236, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13254821976405462, mean FPR diff:0.12682424265996303
-->FNR:[0.07976366322008863, 0.0736462093862816, 0.14705882352941177, 0.0, 0.0024449877750611247, 0.03333333333333333, 0.13513513513513514, 0.125], mean FNR:0.07454776904741395, mean FNR diff:0.06495249370968238
-->mean fnr diff metric 0.12682424265996303
testing dataset
-->original metric score:
-->individual metric:0.1299342105263158, num_idi:158, num_all:1216
-->individual metric 0.1299342105263158
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8806941431670282
-->F1 0.9050086355785838
-->FPR 0.10559006211180125
-->FNR 0.12666666666666668
-->positive probability:0.6052060737527115, 279/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8784916201117319
-->F1 0.9214092140921409
-->FPR 0.16783216783216784
-->FNR 0.1099476439790576
-->positive probability:0.7458100558659218, 534/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.022419807708670136, 0.08466191342903673, 0.08349641226353555, 0.4168297455968689, 0.9168297455968689, 0.003170254403131109, 0.05968688845401174]
-->fnr_diff [0.040324437467294624, 0.023605414779685543, 0.03865777080062795, 0.08634222919937205, 0.08634222919937205, 0.08634222919937205, 0.19937205651491363, 0.03865777080062795]
-->FPR:[0.10559006211180125, 0.16783216783216784, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.3089922913525398, mean FPR diff:0.22672782392173188
-->FNR:[0.12666666666666668, 0.1099476439790576, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09654107454500124, mean FNR diff:0.07495551724515823
-->mean fnr diff metric 0.22672782392173188
-->epoch 10
-->start_index 0
-->batch_size 98
-->FUR:5.6850762319982096e-08, FU:3.126791852992028e-06, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.0962, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1553, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1582, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1314, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:1.947485755716432e-33, FU:9.737428447974373e-32, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.3911567157694862e-32, FU:9.738096716512816e-32, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1255, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999350219964981, FU:1.9996750354766846, P:50
-->FUR:0.07999393343925476, FU:3.9996964931488037, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1348, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.14285707473754883, FU:6.999996662139893, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1329, bias_loss:nan
-->after epoch 10
-->overall baseline on training dataset
-->ACC 0.9820054200542006
-->F1 0.9816005320328087
-->FPR: 0.01823192707229171
-->FNR: 0.01774622892635315
-->overall baseline on testing dataset
-->ACC 0.9150442477876106
-->F1 0.9122715404699738
-->FPR: 0.08414872798434442
-->FNR: 0.08581894296180011
training dataset
-->original metric score:
-->individual metric:0.11555708865125905, num_idi:335, num_all:2899
-->individual metric 0.11555708865125905
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9351503759398496
-->F1 0.9475285171102661
-->FPR 0.03875968992248062
-->FNR 0.07976366322008863
-->positive probability:0.599624060150376, 638/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9282021826536473
-->F1 0.9536865505742868
-->FPR 0.07584269662921349
-->FNR 0.07075812274368232
-->positive probability:0.7547386559448592, 1314/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.9
-->F1 0.9206349206349206
-->FPR 0.0
-->FNR 0.14705882352941177
-->positive probability:0.58, 29/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9655172413793104
-->F1 0.9565217391304348
-->FPR 0.0
-->FNR 0.08333333333333333
-->positive probability:0.3793103448275862, 22/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.02052776285018891, 0.05761076955692178, 0.01823192707229171, 0.6484347395943749, 0.003990295149930514, 0.01823192707229171]
-->fnr_diff [0.06201743429373548, 0.05301189381732917, 0.1293125946030586, 0.01774622892635315, 0.015301241151292024, 0.015587104406980183, 0.09036187918175496, 0.06558710440698018]
-->FPR:[0.03875968992248062, 0.07584269662921349, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1339152125734305, mean FPR diff:0.12783790354933325
-->FNR:[0.07976366322008863, 0.07075812274368232, 0.14705882352941177, 0.0, 0.0024449877750611247, 0.03333333333333333, 0.10810810810810811, 0.08333333333333333], mean FNR:0.06560004650537732, mean FNR diff:0.05611568509843547
-->mean fnr diff metric 0.12783790354933325
testing dataset
-->original metric score:
-->individual metric:0.1299342105263158, num_idi:158, num_all:1216
-->individual metric 0.1299342105263158
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8806941431670282
-->F1 0.9050086355785838
-->FPR 0.10559006211180125
-->FNR 0.12666666666666668
-->positive probability:0.6052060737527115, 279/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8770949720670391
-->F1 0.92057761732852
-->FPR 0.17482517482517482
-->FNR 0.1099476439790576
-->positive probability:0.7472067039106145, 535/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.02144133412745683, 0.0906764468408304, 0.08251793868232224, 0.4158512720156556, 0.9158512720156555, 0.004148727984344416, 0.05870841487279843]
-->fnr_diff [0.04084772370486657, 0.02412870101725749, 0.03918105703819989, 0.08581894296180011, 0.08581894296180011, 0.08581894296180011, 0.1998953427524856, 0.03918105703819989]
-->FPR:[0.10559006211180125, 0.17482517482517482, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.3099912923515408, mean FPR diff:0.2270279152198662
-->FNR:[0.12666666666666668, 0.1099476439790576, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09654107454500124, mean FNR diff:0.07508633880455122
-->mean fnr diff metric 0.2270279152198662
-->epoch 11
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.0953, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620699495077133, FU:5.000005722045898, P:58
-->FUR:0.10416678339242935, FU:5.000005722045898, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1535, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:1.038521837019275e-29, FU:5.192609260328014e-29, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1563, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.06382978707551956, FU:3.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1292, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:1.6133783198313267e-09, FU:8.06689186561016e-08, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.1525230547704268e-08, FU:8.067661383392988e-08, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1227, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.09999999403953552, FU:4.999999523162842, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1296, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.1428571492433548, FU:7.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1340, bias_loss:nan
-->after epoch 11
-->overall baseline on training dataset
-->ACC 0.9812466124661247
-->F1 0.9808480017712831
-->FPR: 0.02013991944032224
-->FNR: 0.01730257320319432
-->overall baseline on testing dataset
-->ACC 0.9127686472819216
-->F1 0.9102263856362218
-->FPR: 0.08953033268101761
-->FNR: 0.0847723704866562
training dataset
-->original metric score:
-->individual metric:0.11797171438427044, num_idi:342, num_all:2899
-->individual metric 0.11797171438427044
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9370300751879699
-->F1 0.9494339622641509
-->FPR 0.04909560723514212
-->FNR 0.07090103397341212
-->positive probability:0.6090225563909775, 648/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9339460080413555
-->F1 0.9576427255985267
-->FPR 0.08426966292134831
-->FNR 0.061371841155234655
-->positive probability:0.7639287765651924, 1330/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9315068493150684
-->FPR 0.044444444444444446
-->FNR 0.08108108108108109
-->positive probability:0.43902439024390244, 36/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9655172413793104
-->F1 0.9565217391304348
-->FPR 0.0
-->FNR 0.08333333333333333
-->positive probability:0.3793103448275862, 22/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.02895568779481988, 0.06412974348102607, 0.02013991944032224, 0.6465267472263444, 0.024304525004122206, 0.02013991944032224]
-->fnr_diff [0.05359846077021779, 0.04406926795204033, 0.10034448562033509, 0.01730257320319432, 0.014857585428133195, 0.007697426796805681, 0.06377850787788676, 0.066030760130139]
-->FPR:[0.04909560723514212, 0.08426966292134831, 0.0, 0.6666666666666666, 0.044444444444444446, 0.0], mean FPR:0.14074606354460026, mean FPR diff:0.13403275706449283
-->FNR:[0.07090103397341212, 0.061371841155234655, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.08108108108108109, 0.08333333333333333], mean FNR:0.055222417017706464, mean FNR diff:0.045959883472344025
-->mean fnr diff metric 0.13403275706449283
testing dataset
-->original metric score:
-->individual metric:0.13075657894736842, num_idi:159, num_all:1216
-->individual metric 0.13075657894736842
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8850325379609545
-->F1 0.9087779690189328
-->FPR 0.10559006211180125
-->FNR 0.12
-->positive probability:0.6095444685466378, 281/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8770949720670391
-->F1 0.9207207207207208
-->FPR 0.18181818181818182
-->FNR 0.1082024432809773
-->positive probability:0.75, 537/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.01605972943078364, 0.09228784913716422, 0.07713633398564905, 0.4104696673189824, 0.9104696673189824, 0.009530332681017606, 0.05332681017612524]
-->fnr_diff [0.035227629513343794, 0.023430072794321105, 0.0402276295133438, 0.0847723704866562, 0.0847723704866562, 0.0847723704866562, 0.2009419152276295, 0.0402276295133438]
-->FPR:[0.10559006211180125, 0.18181818181818182, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.3109902933505418, mean FPR diff:0.22418291286410066
-->FNR:[0.12, 0.1082024432809773, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09548959112440787, mean FNR diff:0.07429649850274382
-->mean fnr diff metric 0.22418291286410066
-->epoch 12
-->start_index 0
-->batch_size 98
-->FUR:0.0362376905977726, FU:1.9930729866027832, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.0938, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.1034482792019844, FU:6.0, P:58
-->FUR:0.125, FU:6.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1526, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:3.313286936229755e-19, FU:1.6566435198136657e-18, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1547, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.04687467962503433, FU:2.9999794960021973, P:64
-->FUR:0.08510594815015793, FU:3.9999794960021973, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1274, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.019667459651827812, FU:0.9833729863166809, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.14048203825950623, FU:0.9833742380142212, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1209, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.10000000149011612, FU:5.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1321, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.1428571492433548, FU:7.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1309, bias_loss:nan
-->after epoch 12
-->overall baseline on training dataset
-->ACC 0.9824390243902439
-->F1 0.982039911308204
-->FPR: 0.017595929616281536
-->FNR: 0.017524401064773737
-->overall baseline on testing dataset
-->ACC 0.9142857142857143
-->F1 0.9114651344998694
-->FPR: 0.08463796477495107
-->FNR: 0.08686551543694401
training dataset
-->original metric score:
-->individual metric:0.11624698171783374, num_idi:337, num_all:2899
-->individual metric 0.11624698171783374
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9389097744360902
-->F1 0.9507202426080364
-->FPR 0.03875968992248062
-->FNR 0.07385524372230429
-->positive probability:0.6033834586466166, 642/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9287765651924181
-->F1 0.9540740740740741
-->FPR 0.07584269662921349
-->FNR 0.07003610108303249
-->positive probability:0.7553130384836301, 1315/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.021163760306199084, 0.05824676701293195, 0.017595929616281536, 0.6490707370503851, 0.004626292605940687, 0.017595929616281536]
-->fnr_diff [0.05633084265753055, 0.05251170001825875, 0.10012265775875567, 0.017524401064773737, 0.015079413289712611, 0.0074755989352262645, 0.1176107340703614, 0.10747559893522626]
-->FPR:[0.03875968992248062, 0.07584269662921349, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1339152125734305, mean FPR diff:0.12804990270133665
-->FNR:[0.07385524372230429, 0.07003610108303249, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.13513513513513514, 0.125], mean FNR:0.0686398158173828, mean FNR diff:0.059266368341230655
-->mean fnr diff metric 0.12804990270133665
testing dataset
-->original metric score:
-->individual metric:0.12911184210526316, num_idi:157, num_all:1216
-->individual metric 0.12911184210526316
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8828633405639913
-->F1 0.906896551724138
-->FPR 0.10559006211180125
-->FNR 0.12333333333333334
-->positive probability:0.6073752711496746, 280/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8784916201117319
-->F1 0.9216921692169218
-->FPR 0.18181818181818182
-->FNR 0.10645724258289703
-->positive probability:0.7513966480446927, 538/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.020952097336850176, 0.09718021704323075, 0.08202870189171559, 0.41536203522504894, 0.9153620352250489, 0.00463796477495107, 0.05821917808219178]
-->fnr_diff [0.036467817896389323, 0.019591727145953017, 0.03813448456305599, 0.08686551543694401, 0.08686551543694401, 0.08686551543694401, 0.19884877027734169, 0.03813448456305599]
-->FPR:[0.10559006211180125, 0.18181818181818182, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.3109902933505418, mean FPR diff:0.22767746136843386
-->FNR:[0.12333333333333334, 0.10645724258289703, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.0956881077038145, mean FNR diff:0.0739717288445785
-->mean fnr diff metric 0.22767746136843386
-->epoch 13
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.0935, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1569, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.09259260445833206, FU:5.000000476837158, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1581, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1352, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1313, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.06951400637626648, FU:3.4757003784179688, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1466, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.1428571492433548, FU:7.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1322, bias_loss:nan
-->after epoch 13
-->overall baseline on training dataset
-->ACC 0.9833062330623307
-->F1 0.9829078801331854
-->FPR: 0.015687937248251006
-->FNR: 0.01774622892635315
-->overall baseline on testing dataset
-->ACC 0.9163084702907712
-->F1 0.9131005513258073
-->FPR: 0.07778864970645792
-->FNR: 0.09000523286237572
training dataset
-->original metric score:
-->individual metric:0.11866160745084511, num_idi:344, num_all:2899
-->individual metric 0.11866160745084511
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9342105263157895
-->F1 0.9466463414634148
-->FPR 0.03617571059431524
-->FNR 0.0827178729689808
-->positive probability:0.5968045112781954, 635/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9247558874210224
-->F1 0.951246743580201
-->FPR 0.06741573033707865
-->FNR 0.07725631768953069
-->positive probability:0.7478460654796094, 1302/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.020487773346064237, 0.05172779308882765, 0.015687937248251006, 0.6509787294184156, 0.0065342849739712175, 0.015687937248251006]
-->fnr_diff [0.06497164404262765, 0.05951008876317754, 0.09990082989717626, 0.01774622892635315, 0.015301241151292024, 0.007253771073646852, 0.11738890620878199, 0.10725377107364685]
-->FPR:[0.03617571059431524, 0.06741573033707865, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13208005497004713, mean FPR diff:0.12685074255396347
-->FNR:[0.0827178729689808, 0.07725631768953069, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.13513513513513514, 0.125], mean FNR:0.07065017154902964, mean FNR diff:0.06116581014208779
-->mean fnr diff metric 0.12685074255396347
testing dataset
-->original metric score:
-->individual metric:0.1299342105263158, num_idi:158, num_all:1216
-->individual metric 0.1299342105263158
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8785249457700651
-->F1 0.9027777777777778
-->FPR 0.09937888198757763
-->FNR 0.13333333333333333
-->positive probability:0.5986984815618221, 276/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8743016759776536
-->F1 0.918625678119349
-->FPR 0.17482517482517482
-->FNR 0.11343804537521815
-->positive probability:0.744413407821229, 533/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9743589743589743
-->F1 0.9870129870129869
-->FPR None
-->FNR 0.02564102564102564
-->positive probability:0.9743589743589743, 38/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.02159023228111971, 0.0970365251187169, 0.08887801696020874, 0.42221135029354206, 0.9222113502935421, 0.0022113502935420803, 0.006360078277886497]
-->fnr_diff [0.043328100470957615, 0.023432812512842432, 0.03499476713762428, 0.09000523286237572, 0.09000523286237572, 0.06436420722135008, 0.19570905285190998, 0.03499476713762428]
-->FPR:[0.09937888198757763, 0.17482517482517482, 0.16666666666666666, 0.5, 1.0, 0.08, 0.07142857142857142], mean FPR:0.2988998992725701, mean FPR diff:0.22292841478836545
-->FNR:[0.13333333333333333, 0.11343804537521815, 0.125, 0.0, 0.0, 0.02564102564102564, 0.2857142857142857, 0.125], mean FNR:0.10101583625798286, mean FNR diff:0.07210427163213251
-->mean fnr diff metric 0.22292841478836545
-->epoch 14
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1003, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.0835755243897438, FU:4.011625289916992, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1588, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1590, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1392, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1339, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1524, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.1428571492433548, FU:7.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1361, bias_loss:nan
-->after epoch 14
-->overall baseline on training dataset
-->ACC 0.983739837398374
-->F1 0.9833296288064015
-->FPR: 0.01399194403222387
-->FNR: 0.018633540372670808
-->overall baseline on testing dataset
-->ACC 0.9170670037926675
-->F1 0.9136387572406531
-->FPR: 0.07436399217221135
-->FNR: 0.09209837781266353
training dataset
-->original metric score:
-->individual metric:0.11693687478440842, num_idi:339, num_all:2899
-->individual metric 0.11693687478440842
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9285714285714286
-->F1 0.941717791411043
-->FPR 0.03359173126614987
-->FNR 0.0930576070901034
-->positive probability:0.5892857142857143, 627/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.919586444572085
-->F1 0.9476439790575916
-->FPR 0.06179775280898876
-->FNR 0.0851985559566787
-->positive probability:0.7403790924755888, 1289/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.019599787233926004, 0.047805808776764894, 0.01399194403222387, 0.6526747226344427, 0.008230278189998353, 0.01399194403222387]
-->fnr_diff [0.0744240667174326, 0.0665650155840079, 0.0990135184508586, 0.018633540372670808, 0.016188552597609682, 0.0063664596273291935, 0.11650159476246433, 0.10636645962732919]
-->FPR:[0.03359173126614987, 0.06179775280898876, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13071306216067127, mean FPR diff:0.12604908081659663
-->FNR:[0.0930576070901034, 0.0851985559566787, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.13513513513513514, 0.125], mean FNR:0.07293541809756346, mean FNR diff:0.0630074009674628
-->mean fnr diff metric 0.12604908081659663
testing dataset
-->original metric score:
-->individual metric:0.1299342105263158, num_idi:158, num_all:1216
-->individual metric 0.1299342105263158
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8741865509761388
-->F1 0.8989547038327527
-->FPR 0.09937888198757763
-->FNR 0.14
-->positive probability:0.5943600867678959, 274/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8687150837988827
-->F1 0.9147005444646098
-->FPR 0.17482517482517482
-->FNR 0.12041884816753927
-->positive probability:0.7388268156424581, 529/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.025014889815366287, 0.10046118265296347, 0.09230267449445531, 0.42563600782778865, 0.9256360078277887, 0.0056360078277886555, 0.0029354207436399216]
-->fnr_diff [0.047901622187336484, 0.02832047035487574, 0.03290162218733647, 0.09209837781266353, 0.09209837781266353, 0.04081632653061225, 0.19361590790162217, 0.03290162218733647]
-->FPR:[0.09937888198757763, 0.17482517482517482, 0.16666666666666666, 0.5, 1.0, 0.08, 0.07142857142857142], mean FPR:0.2988998992725701, mean FPR diff:0.2253745987413987
-->FNR:[0.14, 0.12041884816753927, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.10592689814548453, mean FNR diff:0.07008179087180583
-->mean fnr diff metric 0.2253745987413987
-->epoch 15
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1059, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.06896551698446274, FU:4.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1565, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.055560152977705, FU:3.0002481937408447, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1576, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1377, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1323, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1469, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.1427014172077179, FU:6.992369174957275, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1402, bias_loss:nan
-->after epoch 15
-->overall baseline on training dataset
-->ACC 0.983739837398374
-->F1 0.9833296288064015
-->FPR: 0.01399194403222387
-->FNR: 0.018633540372670808
-->overall baseline on testing dataset
-->ACC 0.9178255372945638
-->F1 0.9144061100869108
-->FPR: 0.07338551859099804
-->FNR: 0.09157509157509157
training dataset
-->original metric score:
-->individual metric:0.11866160745084511, num_idi:344, num_all:2899
-->individual metric 0.11866160745084511
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9285714285714286
-->F1 0.941717791411043
-->FPR 0.03359173126614987
-->FNR 0.0930576070901034
-->positive probability:0.5892857142857143, 627/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.919586444572085
-->F1 0.947565543071161
-->FPR 0.056179775280898875
-->FNR 0.08664259927797834
-->positive probability:0.7380815623205055, 1285/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.019599787233926004, 0.042187831248675006, 0.01399194403222387, 0.6526747226344427, 0.008230278189998353, 0.01399194403222387]
-->fnr_diff [0.0744240667174326, 0.06800905890530753, 0.0990135184508586, 0.018633540372670808, 0.016188552597609682, 0.0063664596273291935, 0.11650159476246433, 0.10636645962732919]
-->FPR:[0.03359173126614987, 0.056179775280898875, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12977673257265626, mean FPR diff:0.12511275122858165
-->FNR:[0.0930576070901034, 0.08664259927797834, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.13513513513513514, 0.125], mean FNR:0.07311592351272592, mean FNR diff:0.06318790638262525
-->mean fnr diff metric 0.12511275122858165
testing dataset
-->original metric score:
-->individual metric:0.13075657894736842, num_idi:159, num_all:1216
-->individual metric 0.13075657894736842
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8741865509761388
-->F1 0.8986013986013986
-->FPR 0.09316770186335403
-->FNR 0.14333333333333334
-->positive probability:0.5900216919739696, 272/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.86731843575419
-->F1 0.9137148047229792
-->FPR 0.17482517482517482
-->FNR 0.12216404886561955
-->positive probability:0.7374301675977654, 528/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8
-->FPR 0.04
-->FNR 0.2857142857142857
-->positive probability:0.28205128205128205, 11/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9545454545454546
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3181818181818182, 7/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.019782183272355994, 0.10143965623417678, 0.07338551859099804, 0.42661448140900193, 0.9266144814090019, 0.03338551859099804, 0.07338551859099804]
-->fnr_diff [0.05175824175824177, 0.030588957290527977, 0.03342490842490843, 0.09157509157509157, 0.09157509157509157, 0.04029304029304029, 0.19413919413919412, 0.03342490842490843]
-->FPR:[0.09316770186335403, 0.17482517482517482, 0.0, 0.5, 1.0, 0.04, 0.0], mean FPR:0.25828469666978987, mean FPR diff:0.2363724797282187
-->FNR:[0.14333333333333334, 0.12216404886561955, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.10656171489941124, mean FNR diff:0.07084742918512552
-->mean fnr diff metric 0.2363724797282187
-->epoch 16
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1088, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.06896551698446274, FU:4.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1568, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1591, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1385, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1336, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1457, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.12244898080825806, FU:6.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1417, bias_loss:nan
-->after epoch 16
-->overall baseline on training dataset
-->ACC 0.9836314363143631
-->F1 0.9832166277648103
-->FPR: 0.01399194403222387
-->FNR: 0.01885536823425022
-->overall baseline on testing dataset
-->ACC 0.9178255372945638
-->F1 0.9144061100869108
-->FPR: 0.07338551859099804
-->FNR: 0.09157509157509157
training dataset
-->original metric score:
-->individual metric:0.11900655398413246, num_idi:345, num_all:2899
-->individual metric 0.11900655398413246
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9285714285714286
-->F1 0.941717791411043
-->FPR 0.03359173126614987
-->FNR 0.0930576070901034
-->positive probability:0.5892857142857143, 627/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.919586444572085
-->F1 0.947565543071161
-->FPR 0.056179775280898875
-->FNR 0.08664259927797834
-->positive probability:0.7380815623205055, 1285/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.019599787233926004, 0.042187831248675006, 0.01399194403222387, 0.6526747226344427, 0.008230278189998353, 0.01399194403222387]
-->fnr_diff [0.07420223885585317, 0.06778723104372811, 0.0987916905892792, 0.01885536823425022, 0.016410380459189095, 0.006144631765749781, 0.11627976690088493, 0.10614463176574979]
-->FPR:[0.03359173126614987, 0.056179775280898875, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12977673257265626, mean FPR diff:0.12511275122858165
-->FNR:[0.0930576070901034, 0.08664259927797834, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.13513513513513514, 0.125], mean FNR:0.07311592351272592, mean FNR diff:0.06307699245183554
-->mean fnr diff metric 0.12511275122858165
testing dataset
-->original metric score:
-->individual metric:0.13075657894736842, num_idi:159, num_all:1216
-->individual metric 0.13075657894736842
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8741865509761388
-->F1 0.8986013986013986
-->FPR 0.09316770186335403
-->FNR 0.14333333333333334
-->positive probability:0.5900216919739696, 272/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.86731843575419
-->F1 0.9137148047229792
-->FPR 0.17482517482517482
-->FNR 0.12216404886561955
-->positive probability:0.7374301675977654, 528/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8
-->FPR 0.04
-->FNR 0.2857142857142857
-->positive probability:0.28205128205128205, 11/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9545454545454546
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3181818181818182, 7/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.019782183272355994, 0.10143965623417678, 0.07338551859099804, 0.42661448140900193, 0.9266144814090019, 0.03338551859099804, 0.07338551859099804]
-->fnr_diff [0.05175824175824177, 0.030588957290527977, 0.03342490842490843, 0.09157509157509157, 0.09157509157509157, 0.04029304029304029, 0.19413919413919412, 0.03342490842490843]
-->FPR:[0.09316770186335403, 0.17482517482517482, 0.0, 0.5, 1.0, 0.04, 0.0], mean FPR:0.25828469666978987, mean FPR diff:0.2363724797282187
-->FNR:[0.14333333333333334, 0.12216404886561955, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.10656171489941124, mean FNR diff:0.07084742918512552
-->mean fnr diff metric 0.2363724797282187
-->epoch 17
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1091, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.06896551698446274, FU:4.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1566, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1586, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1375, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1323, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1454, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.12244898080825806, FU:6.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1397, bias_loss:nan
-->after epoch 17
-->overall baseline on training dataset
-->ACC 0.9836314363143631
-->F1 0.9832166277648103
-->FPR: 0.01399194403222387
-->FNR: 0.01885536823425022
-->overall baseline on testing dataset
-->ACC 0.9175726927939317
-->F1 0.9141653501843076
-->FPR: 0.07387475538160469
-->FNR: 0.09157509157509157
training dataset
-->original metric score:
-->individual metric:0.11900655398413246, num_idi:345, num_all:2899
-->individual metric 0.11900655398413246
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9285714285714286
-->F1 0.941717791411043
-->FPR 0.03359173126614987
-->FNR 0.0930576070901034
-->positive probability:0.5892857142857143, 627/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.919586444572085
-->F1 0.947565543071161
-->FPR 0.056179775280898875
-->FNR 0.08664259927797834
-->positive probability:0.7380815623205055, 1285/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.019599787233926004, 0.042187831248675006, 0.01399194403222387, 0.6526747226344427, 0.008230278189998353, 0.01399194403222387]
-->fnr_diff [0.07420223885585317, 0.06778723104372811, 0.0987916905892792, 0.01885536823425022, 0.016410380459189095, 0.006144631765749781, 0.11627976690088493, 0.10614463176574979]
-->FPR:[0.03359173126614987, 0.056179775280898875, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12977673257265626, mean FPR diff:0.12511275122858165
-->FNR:[0.0930576070901034, 0.08664259927797834, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.13513513513513514, 0.125], mean FNR:0.07311592351272592, mean FNR diff:0.06307699245183554
-->mean fnr diff metric 0.12511275122858165
testing dataset
-->original metric score:
-->individual metric:0.13075657894736842, num_idi:159, num_all:1216
-->individual metric 0.13075657894736842
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8741865509761388
-->F1 0.8986013986013986
-->FPR 0.09316770186335403
-->FNR 0.14333333333333334
-->positive probability:0.5900216919739696, 272/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.86731843575419
-->F1 0.9137148047229792
-->FPR 0.17482517482517482
-->FNR 0.12216404886561955
-->positive probability:0.7374301675977654, 528/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8
-->FPR 0.04
-->FNR 0.2857142857142857
-->positive probability:0.28205128205128205, 11/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9545454545454546
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3181818181818182, 7/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.01929294648174934, 0.10095041944357012, 0.07387475538160469, 0.4261252446183953, 0.9261252446183953, 0.03387475538160469, 0.07387475538160469]
-->fnr_diff [0.05175824175824177, 0.030588957290527977, 0.03342490842490843, 0.09157509157509157, 0.09157509157509157, 0.04029304029304029, 0.19413919413919412, 0.03342490842490843]
-->FPR:[0.09316770186335403, 0.17482517482517482, 0.0, 0.5, 1.0, 0.04, 0.0], mean FPR:0.25828469666978987, mean FPR diff:0.23630258875813204
-->FNR:[0.14333333333333334, 0.12216404886561955, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.10656171489941124, mean FNR diff:0.07084742918512552
-->mean fnr diff metric 0.23630258875813204
-->epoch 18
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1070, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.06896551698446274, FU:4.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1554, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1567, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1362, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1308, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1452, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.12244899570941925, FU:6.000000953674316, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1380, bias_loss:nan
-->after epoch 18
-->overall baseline on training dataset
-->ACC 0.9838482384823848
-->F1 0.9834426047338592
-->FPR: 0.01399194403222387
-->FNR: 0.01841171251109139
-->overall baseline on testing dataset
-->ACC 0.9175726927939317
-->F1 0.9141653501843076
-->FPR: 0.07387475538160469
-->FNR: 0.09157509157509157
training dataset
-->original metric score:
-->individual metric:0.11969644705070714, num_idi:347, num_all:2899
-->individual metric 0.11969644705070714
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9295112781954887
-->F1 0.942528735632184
-->FPR 0.03359173126614987
-->FNR 0.0915805022156573
-->positive probability:0.5902255639097744, 628/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9201608271108558
-->F1 0.9479595657057281
-->FPR 0.056179775280898875
-->FNR 0.08592057761732852
-->positive probability:0.7386559448592763, 1286/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.019599787233926004, 0.042187831248675006, 0.01399194403222387, 0.6526747226344427, 0.008230278189998353, 0.01399194403222387]
-->fnr_diff [0.07316878970456592, 0.06750886510623713, 0.09923534631243802, 0.01841171251109139, 0.015966724736030266, 0.00658828748890861, 0.11672342262404375, 0.10658828748890861]
-->FPR:[0.03359173126614987, 0.056179775280898875, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12977673257265626, mean FPR diff:0.12511275122858165
-->FNR:[0.0915805022156573, 0.08592057761732852, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.13513513513513514, 0.125], mean FNR:0.07284103269583894, mean FNR diff:0.06302392949652796
-->mean fnr diff metric 0.12511275122858165
testing dataset
-->original metric score:
-->individual metric:0.13075657894736842, num_idi:159, num_all:1216
-->individual metric 0.13075657894736842
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8741865509761388
-->F1 0.8986013986013986
-->FPR 0.09316770186335403
-->FNR 0.14333333333333334
-->positive probability:0.5900216919739696, 272/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8687150837988827
-->F1 0.9147005444646098
-->FPR 0.17482517482517482
-->FNR 0.12041884816753927
-->positive probability:0.7388268156424581, 529/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8
-->FPR 0.04
-->FNR 0.2857142857142857
-->positive probability:0.28205128205128205, 11/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9545454545454546
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3181818181818182, 7/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.01929294648174934, 0.10095041944357012, 0.07387475538160469, 0.4261252446183953, 0.9261252446183953, 0.03387475538160469, 0.07387475538160469]
-->fnr_diff [0.05175824175824177, 0.0288437565924477, 0.03342490842490843, 0.09157509157509157, 0.09157509157509157, 0.04029304029304029, 0.19413919413919412, 0.03342490842490843]
-->FPR:[0.09316770186335403, 0.17482517482517482, 0.0, 0.5, 1.0, 0.04, 0.0], mean FPR:0.25828469666978987, mean FPR diff:0.23630258875813204
-->FNR:[0.14333333333333334, 0.12041884816753927, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.1063435648121512, mean FNR diff:0.07062927909786548
-->mean fnr diff metric 0.23630258875813204
-->epoch 19
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1055, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.06896551698446274, FU:4.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1546, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1552, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1352, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1297, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1441, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.13847339153289795, FU:6.785196304321289, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1370, bias_loss:nan
-->after epoch 19
-->overall baseline on training dataset
-->ACC 0.9836314363143631
-->F1 0.9832166277648103
-->FPR: 0.01399194403222387
-->FNR: 0.01885536823425022
-->overall baseline on testing dataset
-->ACC 0.9175726927939317
-->F1 0.9141653501843076
-->FPR: 0.07387475538160469
-->FNR: 0.09157509157509157
training dataset
-->original metric score:
-->individual metric:0.1193515005174198, num_idi:346, num_all:2899
-->individual metric 0.1193515005174198
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9285714285714286
-->F1 0.941717791411043
-->FPR 0.03359173126614987
-->FNR 0.0930576070901034
-->positive probability:0.5892857142857143, 627/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.919586444572085
-->F1 0.947565543071161
-->FPR 0.056179775280898875
-->FNR 0.08664259927797834
-->positive probability:0.7380815623205055, 1285/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.019599787233926004, 0.042187831248675006, 0.01399194403222387, 0.6526747226344427, 0.008230278189998353, 0.01399194403222387]
-->fnr_diff [0.07420223885585317, 0.06778723104372811, 0.0987916905892792, 0.01885536823425022, 0.016410380459189095, 0.006144631765749781, 0.11627976690088493, 0.10614463176574979]
-->FPR:[0.03359173126614987, 0.056179775280898875, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12977673257265626, mean FPR diff:0.12511275122858165
-->FNR:[0.0930576070901034, 0.08664259927797834, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.13513513513513514, 0.125], mean FNR:0.07311592351272592, mean FNR diff:0.06307699245183554
-->mean fnr diff metric 0.12511275122858165
testing dataset
-->original metric score:
-->individual metric:0.1299342105263158, num_idi:158, num_all:1216
-->individual metric 0.1299342105263158
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8763557483731019
-->F1 0.9005235602094239
-->FPR 0.09316770186335403
-->FNR 0.14
-->positive probability:0.5921908893709328, 273/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8701117318435754
-->F1 0.9156844968268358
-->FPR 0.17482517482517482
-->FNR 0.11867364746945899
-->positive probability:0.7402234636871509, 530/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8
-->FPR 0.04
-->FNR 0.2857142857142857
-->positive probability:0.28205128205128205, 11/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9545454545454546
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3181818181818182, 7/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.01929294648174934, 0.10095041944357012, 0.07387475538160469, 0.4261252446183953, 0.9261252446183953, 0.03387475538160469, 0.07387475538160469]
-->fnr_diff [0.048424908424908444, 0.027098555894367424, 0.03342490842490843, 0.09157509157509157, 0.09157509157509157, 0.04029304029304029, 0.19413919413919412, 0.03342490842490843]
-->FPR:[0.09316770186335403, 0.17482517482517482, 0.0, 0.5, 1.0, 0.04, 0.0], mean FPR:0.25828469666978987, mean FPR diff:0.23630258875813204
-->FNR:[0.14, 0.11867364746945899, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.1057087480582245, mean FNR diff:0.06999446234393877
-->mean fnr diff metric 0.23630258875813204
    train_ind  train_acc  ...  test_fnr_mean  test_fnr_diff
0    0.120041   0.982873  ...       0.110211       0.073058
1    0.136944   0.981897  ...       0.056405       0.061638
2    0.119007   0.984173  ...       0.107633       0.071919
3    0.116247   0.982981  ...       0.105292       0.070101
4    0.117627   0.982764  ...       0.103368       0.069093
5    0.117627   0.983306  ...       0.104022       0.068962
6    0.118662   0.983198  ...       0.104657       0.069335
7    0.117627   0.982222  ...       0.097811       0.075833
8    0.116592   0.981897  ...       0.097176       0.075329
9    0.115902   0.982439  ...       0.096541       0.074956
10   0.115557   0.982005  ...       0.096541       0.075086
11   0.117972   0.981247  ...       0.095490       0.074296
12   0.116247   0.982439  ...       0.095688       0.073972
13   0.118662   0.983306  ...       0.101016       0.072104
14   0.116937   0.983740  ...       0.105927       0.070082
15   0.118662   0.983740  ...       0.106562       0.070847
16   0.119007   0.983631  ...       0.106562       0.070847
17   0.119007   0.983631  ...       0.106562       0.070847
18   0.119696   0.983848  ...       0.106344       0.070629
19   0.119352   0.983631  ...       0.105709       0.069994

[20 rows x 22 columns]
-->gamma 1.2
-->model.parameters() <generator object Module.parameters at 0x7f167ec3c9e0>
-->classifier <generator object Module.parameters at 0x7f167ec3c9e0>
-->orig_weight tensor([[-0.0090, -0.0011, -0.0357,  ..., -0.0010,  0.0418, -0.0463],
        [-0.0121, -0.0054,  0.0281,  ..., -0.0015, -0.0002,  0.0379],
        [-0.0156, -0.0118, -0.0050,  ...,  0.0106,  0.0162, -0.0060],
        ...,
        [-0.0161, -0.0136,  0.0002,  ...,  0.0229,  0.0217,  0.0377],
        [ 0.0485, -0.0465, -0.0149,  ...,  0.0021,  0.0055,  0.0226],
        [ 0.0069,  0.0322,  0.0122,  ...,  0.0356,  0.0201,  0.0108]],
       device='cuda:0', grad_fn=<CloneBackward0>)
-->orig_bias tensor([-0.0205, -0.0159,  0.0253,  0.0271, -0.0295,  0.0415,  0.0258,  0.0123,
         0.0085,  0.0267, -0.0234,  0.0228,  0.0097, -0.0123,  0.0295, -0.0271,
         0.0096, -0.0141,  0.0126, -0.0209, -0.0157, -0.0311, -0.0357,  0.0288,
         0.0127, -0.0026,  0.0106,  0.0128,  0.0384, -0.0049, -0.0124, -0.0378,
        -0.0063,  0.0020,  0.0196,  0.0433, -0.0009, -0.0017, -0.0197,  0.0142,
        -0.0260, -0.0367, -0.0178,  0.0179, -0.0473,  0.0179, -0.0042, -0.0219,
         0.0215, -0.0062, -0.0273, -0.0036,  0.0306,  0.0248, -0.0236, -0.0286,
        -0.0257, -0.0259, -0.0173, -0.0258, -0.0036], device='cuda:0',
       grad_fn=<CloneBackward0>)
-->MinValue:-3.2998316455372216, MaxValue:3.9719170089423623
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9135338345864662
-->F1 0.9290123456790124
-->FPR 0.04392764857881137
-->FNR 0.11078286558345643
-->positive probability:0.581766917293233, 619/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9069500287191269
-->F1 0.9391435011269722
-->FPR 0.07584269662921349
-->FNR 0.09747292418772563
-->positive probability:0.7334865020103389, 1277/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9605263157894737
-->F1 0.9798657718120806
-->FPR None
-->FNR 0.039473684210526314
-->positive probability:0.9605263157894737, 73/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9660194174757282
-->F1 0.9826732673267327
-->FPR 0.6666666666666666
-->FNR 0.029339853300733496
-->positive probability:0.9684466019417476, 399/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.029087708578811367, 0.06100275662921349, 0.01483994, 0.6518267266666666, 0.007382282222222224, 0.01483994]
-->fnr_diff [0.09481125558345643, 0.08150131418772563, 0.10167544882352941, 0.023502074210526313, 0.013368243300733496, 0.017361723333333332, 0.11916352513513515, 0.10902839]
-->FPR: [0.04392764857881137, 0.07584269662921349, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1347765390161523, mean FPR diff:0.12982989234948564
-->FNR: [0.11078286558345643, 0.09747292418772563, 0.11764705882352941, 0.039473684210526314, 0.029339853300733496, 0.03333333333333333, 0.13513513513513514, 0.125], mean FNR:0.08602310682180497, mean FNR diff:0.07005149682180498
-->base group metric 0.12982989234948564 0.1347765390161523
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8676789587852495
-->F1 0.893169877408056
-->FPR 0.09937888198757763
-->FNR 0.15
-->positive probability:0.5878524945770065, 271/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.861731843575419
-->F1 0.9097538742023701
-->FPR 0.17482517482517482
-->FNR 0.12914485165794065
-->positive probability:0.7318435754189944, 524/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9743589743589743
-->F1 0.987012987012987
-->FPR 1.0
-->FNR 0.01935483870967742
-->positive probability:0.9807692307692307, 153/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9230769230769231
-->F1 0.9600000000000001
-->FPR None
-->FNR 0.07692307692307693
-->positive probability:0.9230769230769231, 36/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.75
-->FPR 0.04
-->FNR 0.35714285714285715
-->positive probability:0.2564102564102564, 10/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.08453894198757764, 0.15998523482517482, 0.01483994, 0.48516006, 0.98516006, 0.02516006, 0.12801720285714285]
-->fnr_diff [0.13402839, 0.11317324165794065, 0.10902839, 0.01597161, 0.0033832287096774195, 0.06095146692307693, 0.3411712471428571, 0.10902839]
-->FPR: [0.09937888198757763, 0.17482517482517482, 0.0, 0.5, 1.0, 0.04, 0.14285714285714285], mean FPR:0.2795801713814136, mean FPR diff:0.26898021423855645
-->FNR: [0.15, 0.12914485165794065, 0.125, 0.0, 0.01935483870967742, 0.07692307692307693, 0.35714285714285715, 0.125], mean FNR:0.12282070305419401, mean FNR diff:0.11084199555419402
-->base group metric 0.26898021423855645 0.2795801713814136
-->epoch 0
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1046, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.125, FU:6.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1714, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.037101056426763535, FU:2.0034570693969727, P:54
-->FUR:0.1469806730747223, FU:7.936956405639648, P:54
-->FUR:1.2898877124628582e-16, FU:5.159550849851433e-16, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.20000000298023224, FU:1.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1640, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.04257485270500183, FU:2.0010180473327637, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1314, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1602, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1883, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.1428571492433548, FU:7.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1380, bias_loss:nan
-->after epoch 0
-->overall baseline on training dataset
-->ACC 0.9833062330623307
-->F1 0.9829078801331854
-->FPR: 0.015687937248251006
-->FNR: 0.01774622892635315
-->overall baseline on testing dataset
-->ACC 0.9168141592920354
-->F1 0.913670952505904
-->FPR: 0.07778864970645792
-->FNR: 0.08895866038723181
training dataset
-->original metric score:
-->individual metric:0.11728182131769575, num_idi:340, num_all:2899
-->individual metric 0.11728182131769575
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.931390977443609
-->F1 0.9442322383498853
-->FPR 0.03617571059431524
-->FNR 0.08714918759231906
-->positive probability:0.5939849624060151, 632/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9224583572659392
-->F1 0.949683190458442
-->FPR 0.06741573033707865
-->FNR 0.08014440433212996
-->positive probability:0.7455485353245261, 1298/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.020487773346064237, 0.05172779308882765, 0.015687937248251006, 0.6509787294184156, 0.0065342849739712175, 0.015687937248251006]
-->fnr_diff [0.06940295866596591, 0.062398175405776815, 0.09990082989717626, 0.01774622892635315, 0.015301241151292024, 0.007253771073646852, 0.11738890620878199, 0.10725377107364685]
-->FPR:[0.03617571059431524, 0.06741573033707865, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13208005497004713, mean FPR diff:0.12685074255396347
-->FNR:[0.08714918759231906, 0.08014440433212996, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.13513513513513514, 0.125], mean FNR:0.07156509670727185, mean FNR diff:0.06208073530032998
-->mean fnr diff metric 0.12685074255396347
testing dataset
-->original metric score:
-->individual metric:0.12746710526315788, num_idi:155, num_all:1216
-->individual metric 0.12746710526315788
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8806941431670282
-->F1 0.9046793760831889
-->FPR 0.09937888198757763
-->FNR 0.13
-->positive probability:0.6008676789587852, 277/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8743016759776536
-->F1 0.918625678119349
-->FPR 0.17482517482517482
-->FNR 0.11343804537521815
-->positive probability:0.744413407821229, 533/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.02159023228111971, 0.0970365251187169, 0.08887801696020874, 0.42221135029354206, 0.9222113502935421, 0.0022113502935420803, 0.006360078277886497]
-->fnr_diff [0.04104133961276819, 0.02447938498798634, 0.03604133961276819, 0.08895866038723181, 0.08895866038723181, 0.03767660910518053, 0.19675562532705387, 0.03604133961276819]
-->FPR:[0.09937888198757763, 0.17482517482517482, 0.16666666666666666, 0.5, 1.0, 0.08, 0.07142857142857142], mean FPR:0.2988998992725701, mean FPR diff:0.22292841478836545
-->FNR:[0.13, 0.11343804537521815, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.1038042977964444, mean FNR diff:0.06874411987912361
-->mean fnr diff metric 0.22292841478836545
-->epoch 1
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1056, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.06896553188562393, FU:4.000000953674316, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1515, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1545, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.08510638028383255, FU:4.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1434, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.035087719559669495, FU:2.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1360, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1428, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.16326530277729034, FU:8.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1407, bias_loss:nan
-->after epoch 1
-->overall baseline on training dataset
-->ACC 0.9825474254742548
-->F1 0.9821882951653944
-->FPR: 0.019503921984312063
-->FNR: 0.015306122448979591
-->overall baseline on testing dataset
-->ACC 0.9122629582806574
-->F1 0.9100337049520353
-->FPR: 0.09344422700587084
-->FNR: 0.08163265306122448
training dataset
-->original metric score:
-->individual metric:0.11486719558468438, num_idi:333, num_all:2899
-->individual metric 0.11486719558468438
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9426691729323309
-->F1 0.9540316503391107
-->FPR 0.04392764857881137
-->FNR 0.06499261447562776
-->positive probability:0.6109022556390977, 650/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9304997128087306
-->F1 0.9553670232386573
-->FPR 0.08707865168539326
-->FNR 0.06498194945848375
-->positive probability:0.7616312464101092, 1326/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.024423726594499304, 0.0675747297010812, 0.019503921984312063, 0.6471627446823546, 0.00271830023791016, 0.019503921984312063]
-->fnr_diff [0.04968649202664817, 0.04967582700950415, 0.10234093637454982, 0.015306122448979591, 0.012861134673918466, 0.00969387755102041, 0.09280198565912852, 0.1096938775510204]
-->FPR:[0.04392764857881137, 0.08707865168539326, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13664919819218227, mean FPR diff:0.13014789086407824
-->FNR:[0.06499261447562776, 0.06498194945848375, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.10810810810810811, 0.125], mean FNR:0.06352183983010126, mean FNR diff:0.05525753166184619
-->mean fnr diff metric 0.13014789086407824
testing dataset
-->original metric score:
-->individual metric:0.12911184210526316, num_idi:157, num_all:1216
-->individual metric 0.12911184210526316
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8828633405639913
-->F1 0.9075342465753424
-->FPR 0.11801242236024845
-->FNR 0.11666666666666667
-->positive probability:0.6160520607375272, 284/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8854748603351955
-->F1 0.9267857142857142
-->FPR 0.1958041958041958
-->FNR 0.09424083769633508
-->positive probability:0.7639664804469274, 547/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.02456819535437761, 0.10235996879832497, 0.07322243966079582, 0.40655577299412915, 0.9065557729941291, 0.013444227005870835, 0.12084148727984344]
-->fnr_diff [0.035034013605442185, 0.012608184635110598, 0.04336734693877552, 0.08163265306122448, 0.08163265306122448, 0.08163265306122448, 0.20408163265306123, 0.04336734693877552]
-->FPR:[0.11801242236024845, 0.1958041958041958, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.32496699987383215, mean FPR diff:0.2353639805839244
-->FNR:[0.11666666666666667, 0.09424083769633508, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09332772375966093, mean FNR diff:0.0729195604943548
-->mean fnr diff metric 0.2353639805839244
-->epoch 2
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.0923, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.125, FU:6.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1555, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1457, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.046875, FU:3.0, P:64
-->FUR:0.10638298094272614, FU:5.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1271, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.019962672144174576, FU:0.9981335997581482, P:50
-->FUR:0.035087719559669495, FU:2.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1278, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.11999999731779099, FU:6.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1320, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0714285746216774, FU:4.0, P:56
-->FUR:0.18367347121238708, FU:9.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1278, bias_loss:nan
-->after epoch 2
-->overall baseline on training dataset
-->ACC 0.9786449864498645
-->F1 0.9782967940949653
-->FPR: 0.027347890608437567
-->FNR: 0.015084294587400177
-->overall baseline on testing dataset
-->ACC 0.9061946902654867
-->F1 0.9045536403395935
-->FPR: 0.10665362035225048
-->FNR: 0.08006279434850863
training dataset
-->original metric score:
-->individual metric:0.11969644705070714, num_idi:347, num_all:2899
-->individual metric 0.11969644705070714
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9417293233082706
-->F1 0.9537313432835821
-->FPR 0.06201550387596899
-->FNR 0.056129985228951254
-->positive probability:0.6231203007518797, 663/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9368179207352096
-->F1 0.9597659107534747
-->FPR 0.10393258426966293
-->FNR 0.05270758122743682
-->positive probability:0.774842044801838, 1349/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9902912621359223
-->F1 0.9951219512195123
-->FPR 1.0
-->FNR 0.0024449877750611247
-->positive probability:0.9975728155339806, 411/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9634146341463414
-->F1 0.9589041095890412
-->FPR 0.022222222222222223
-->FNR 0.05405405405405406
-->positive probability:0.43902439024390244, 36/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9655172413793104
-->F1 0.9565217391304348
-->FPR 0.0
-->FNR 0.08333333333333333
-->positive probability:0.3793103448275862, 22/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.03466761326753143, 0.07658469366122536, 0.027347890608437567, 0.9726521093915624, 0.005125668386215344, 0.027347890608437567]
-->fnr_diff [0.04104569064155108, 0.03762328664003665, 0.10256276423612923, 0.015084294587400177, 0.012639306812339053, 0.009915705412599824, 0.03896975946665388, 0.06824903874593315]
-->FPR:[0.06201550387596899, 0.10393258426966293, 0.0, 1.0, 0.022222222222222223, 0.0], mean FPR:0.19802838506130901, mean FPR diff:0.19062097765390162
-->FNR:[0.056129985228951254, 0.05270758122743682, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.05405405405405406, 0.08333333333333333], mean FNR:0.04891462505529574, mean FNR diff:0.04076123081783038
-->mean fnr diff metric 0.19062097765390162
testing dataset
-->original metric score:
-->individual metric:0.125, num_idi:152, num_all:1216
-->individual metric 0.125
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8915401301518439
-->F1 0.9155405405405406
-->FPR 0.13043478260869565
-->FNR 0.09666666666666666
-->positive probability:0.6334056399132321, 292/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8896648044692738
-->F1 0.9297777777777778
-->FPR 0.20279720279720279
-->FNR 0.08726003490401396
-->positive probability:0.770949720670391, 552/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.7727272727272727
-->F1 0.7368421052631579
-->FPR 0.2857142857142857
-->FNR 0.125
-->positive probability:0.5, 11/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.023781162256445165, 0.0961435824449523, 0.060013046314416174, 0.39334637964774954, 0.8933463796477495, 0.02665362035225048, 0.17906066536203522]
-->fnr_diff [0.016603872318158033, 0.00719724055550533, 0.04493720565149137, 0.08006279434850863, 0.08006279434850863, 0.08006279434850863, 0.13422291993720564, 0.04493720565149137]
-->FPR:[0.13043478260869565, 0.20279720279720279, 0.16666666666666666, 0.5, 1.0, 0.08, 0.2857142857142857], mean FPR:0.33794470539812155, mean FPR diff:0.2389064051465141
-->FNR:[0.09666666666666666, 0.08726003490401396, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.08102655198204936, mean FNR diff:0.06101085339492221
-->mean fnr diff metric 0.2389064051465141
-->epoch 3
-->start_index 0
-->batch_size 98
-->FUR:0.072727270424366, FU:4.0, P:55
-->FUR:0.039217691868543625, FU:2.0001022815704346, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.693030091121095e-11, FU:8.46515080255017e-11, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.0927, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.1034482792019844, FU:6.0, P:58
-->FUR:0.1458333283662796, FU:7.0, P:48
-->FUR:3.215327764351095e-28, FU:9.645983533794527e-28, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1487, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.20000000298023224, FU:1.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1418, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.046878524124622345, FU:3.00022554397583, P:64
-->FUR:0.10638777911663055, FU:5.00022554397583, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.9996216297149658, FU:0.9996216297149658, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1212, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.017285697162151337, FU:0.864284873008728, P:50
-->FUR:0.035087719559669495, FU:2.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.2615764832338305e-15, FU:8.831035064999458e-15, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1229, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.0609009750187397, FU:3.045048713684082, P:50
-->FUR:0.08098739385604858, FU:4.049369812011719, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1486, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.16326530277729034, FU:8.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1418, bias_loss:nan
-->after epoch 3
-->overall baseline on training dataset
-->ACC 0.9840650406504065
-->F1 0.9837046890588627
-->FPR: 0.016111935552257792
-->FNR: 0.01574977817213842
-->overall baseline on testing dataset
-->ACC 0.9160556257901391
-->F1 0.913134484563056
-->FPR: 0.0812133072407045
-->FNR: 0.08686551543694401
training dataset
-->original metric score:
-->individual metric:0.11659192825112108, num_idi:338, num_all:2899
-->individual metric 0.11659192825112108
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9379699248120301
-->F1 0.9498480243161093
-->FPR 0.03617571059431524
-->FNR 0.07680945347119646
-->positive probability:0.6005639097744361, 639/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9236071223434807
-->F1 0.950539233915954
-->FPR 0.07303370786516854
-->FNR 0.07725631768953069
-->positive probability:0.7489948305571511, 1304/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.02006377504205745, 0.05692177231291075, 0.016111935552257792, 0.6505547311144089, 0.006110286669964431, 0.016111935552257792]
-->fnr_diff [0.061059675299058036, 0.06150653951739227, 0.10189728065139099, 0.01574977817213842, 0.013304790397077295, 0.00925022182786158, 0.0923583299359697, 0.10925022182786158]
-->FPR:[0.03617571059431524, 0.07303370786516854, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1330163845580621, mean FPR diff:0.12764573937397616
-->FNR:[0.07680945347119646, 0.07725631768953069, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.10810810810810811, 0.125], mean FNR:0.06653324073342823, mean FNR diff:0.058047104703593734
-->mean fnr diff metric 0.12764573937397616
testing dataset
-->original metric score:
-->individual metric:0.13404605263157895, num_idi:163, num_all:1216
-->individual metric 0.13404605263157895
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8741865509761388
-->F1 0.8993055555555555
-->FPR 0.10559006211180125
-->FNR 0.13666666666666666
-->positive probability:0.5986984815618221, 276/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8756983240223464
-->F1 0.9197475202885483
-->FPR 0.18181818181818182
-->FNR 0.1099476439790576
-->positive probability:0.7486033519553073, 536/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8
-->FPR 0.04
-->FNR 0.2857142857142857
-->positive probability:0.28205128205128205, 11/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.02437675487109675, 0.10060487457747733, 0.0812133072407045, 0.4187866927592955, 0.9187866927592955, 0.041213307240704496, 0.009784735812133072]
-->fnr_diff [0.049801151229722646, 0.023082128542113584, 0.03813448456305599, 0.08686551543694401, 0.08686551543694401, 0.03558346415489273, 0.19884877027734169, 0.03813448456305599]
-->FPR:[0.10559006211180125, 0.18181818181818182, 0.0, 0.5, 1.0, 0.04, 0.07142857142857142], mean FPR:0.2712624021940792, mean FPR diff:0.2278237664658153
-->FNR:[0.13666666666666666, 0.1099476439790576, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.10420133095525766, mean FNR diff:0.06966443927550883
-->mean fnr diff metric 0.2278237664658153
-->epoch 4
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1361, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1883, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1843, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.06382978707551956, FU:3.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1751, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.035087719559669495, FU:2.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1712, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1937, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.16326530277729034, FU:8.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1441, bias_loss:nan
-->after epoch 4
-->overall baseline on training dataset
-->ACC 0.9841734417344173
-->F1 0.9838029731528734
-->FPR: 0.015263938944244222
-->FNR: 0.016415261756876662
-->overall baseline on testing dataset
-->ACC 0.9168141592920354
-->F1 0.9137614678899082
-->FPR: 0.07876712328767123
-->FNR: 0.08791208791208792
training dataset
-->original metric score:
-->individual metric:0.11659192825112108, num_idi:338, num_all:2899
-->individual metric 0.11659192825112108
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9342105263157895
-->F1 0.9466463414634148
-->FPR 0.03617571059431524
-->FNR 0.0827178729689808
-->positive probability:0.5968045112781954, 635/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9207352096496266
-->F1 0.9485842026825633
-->FPR 0.07303370786516854
-->FNR 0.08086642599277978
-->positive probability:0.746122917863297, 1299/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.02091177165007102, 0.057769768920924315, 0.015263938944244222, 0.6514027277224224, 0.006958283277978001, 0.015263938944244222]
-->fnr_diff [0.06630261121210414, 0.06445116423590312, 0.10123179706665275, 0.016415261756876662, 0.013970273981815537, 0.008584738243123339, 0.09169284635123146, 0.10858473824312334]
-->FPR:[0.03617571059431524, 0.07303370786516854, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1330163845580621, mean FPR diff:0.1279284049099807
-->FNR:[0.0827178729689808, 0.08086642599277978, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.10810810810810811, 0.125], mean FNR:0.0677230567085574, mean FNR diff:0.0589041788863538
-->mean fnr diff metric 0.1279284049099807
testing dataset
-->original metric score:
-->individual metric:0.13815789473684212, num_idi:168, num_all:1216
-->individual metric 0.13815789473684212
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8720173535791758
-->F1 0.8973913043478261
-->FPR 0.10559006211180125
-->FNR 0.14
-->positive probability:0.596529284164859, 275/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8701117318435754
-->F1 0.9158371040723982
-->FPR 0.18181818181818182
-->FNR 0.1169284467713787
-->positive probability:0.7430167597765364, 532/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8
-->FPR 0.04
-->FNR 0.2857142857142857
-->positive probability:0.28205128205128205, 11/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9545454545454546
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3181818181818182, 7/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.02682293882413002, 0.1030510585305106, 0.07876712328767123, 0.4212328767123288, 0.9212328767123288, 0.03876712328767123, 0.07876712328767123]
-->fnr_diff [0.052087912087912094, 0.029016358859290783, 0.03708791208791208, 0.08791208791208792, 0.08791208791208792, 0.03663003663003664, 0.19780219780219777, 0.03708791208791208]
-->FPR:[0.10559006211180125, 0.18181818181818182, 0.0, 0.5, 1.0, 0.04, 0.0], mean FPR:0.26105832056142614, mean FPR diff:0.23837730294890166
-->FNR:[0.14, 0.1169284467713787, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.10549059797096447, mean FNR diff:0.07069206317242965
-->mean fnr diff metric 0.23837730294890166
-->epoch 5
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1240, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1525, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1511, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.06382978707551956, FU:3.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1479, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.035087719559669495, FU:2.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1488, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1604, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0714285746216774, FU:4.0, P:56
-->FUR:0.16326530277729034, FU:8.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1605, bias_loss:nan
-->after epoch 5
-->overall baseline on training dataset
-->ACC 0.9839566395663957
-->F1 0.9835992907801417
-->FPR: 0.016535933856264576
-->FNR: 0.015527950310559006
-->overall baseline on testing dataset
-->ACC 0.9150442477876106
-->F1 0.9122715404699738
-->FPR: 0.08414872798434442
-->FNR: 0.08581894296180011
training dataset
-->original metric score:
-->individual metric:0.11624698171783374, num_idi:337, num_all:2899
-->individual metric 0.11624698171783374
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9379699248120301
-->F1 0.9499241274658573
-->FPR 0.03875968992248062
-->FNR 0.07533234859675036
-->positive probability:0.6024436090225563, 641/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9241815048822516
-->F1 0.950965824665676
-->FPR 0.07584269662921349
-->FNR 0.07581227436823104
-->positive probability:0.7507179781734635, 1307/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.022223756066216044, 0.05930676277294891, 0.016535933856264576, 0.650130732810402, 0.005686288365957647, 0.016535933856264576]
-->fnr_diff [0.05980439828619136, 0.060284324057672034, 0.1021191085129704, 0.015527950310559006, 0.013082962535497882, 0.009472049689440995, 0.0925801577975491, 0.10947204968944099]
-->FPR:[0.03875968992248062, 0.07584269662921349, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1339152125734305, mean FPR diff:0.12840323462134232
-->FNR:[0.07533234859675036, 0.07581227436823104, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.10810810810810811, 0.125], mean FNR:0.06616809720896, mean FNR diff:0.05779287510991522
-->mean fnr diff metric 0.12840323462134232
testing dataset
-->original metric score:
-->individual metric:0.13075657894736842, num_idi:159, num_all:1216
-->individual metric 0.13075657894736842
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8763557483731019
-->F1 0.9015544041450777
-->FPR 0.11180124223602485
-->FNR 0.13
-->positive probability:0.6052060737527115, 279/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8756983240223464
-->F1 0.9198919891989199
-->FPR 0.1888111888111888
-->FNR 0.1082024432809773
-->positive probability:0.7513966480446927, 538/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9487179487179487
-->F1 0.9736842105263158
-->FPR None
-->FNR 0.05128205128205128
-->positive probability:0.9487179487179487, 37/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.02765251425168043, 0.10466246082684438, 0.08414872798434442, 0.4158512720156556, 0.9158512720156555, 0.004148727984344416, 0.012720156555772993]
-->fnr_diff [0.0441810570381999, 0.0223835003191772, 0.03918105703819989, 0.08581894296180011, 0.08581894296180011, 0.03453689167974883, 0.1998953427524856, 0.03918105703819989]
-->FPR:[0.11180124223602485, 0.1888111888111888, 0.0, 0.5, 1.0, 0.08, 0.07142857142857142], mean FPR:0.27886300035368355, mean FPR diff:0.22357644737632826
-->FNR:[0.13, 0.1082024432809773, 0.125, 0.0, 0.0, 0.05128205128205128, 0.2857142857142857, 0.125], mean FNR:0.10314984753466427, mean FNR diff:0.06887459897370143
-->mean fnr diff metric 0.22357644737632826
-->epoch 6
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019629649817943573, FU:1.0011121034622192, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1298, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.06896551698446274, FU:4.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1585, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1523, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.06382978707551956, FU:3.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1421, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.035087719559669495, FU:2.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1366, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1509, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0714285746216774, FU:4.0, P:56
-->FUR:0.16326530277729034, FU:8.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1369, bias_loss:nan
-->after epoch 6
-->overall baseline on training dataset
-->ACC 0.9838482384823848
-->F1 0.9834903047091413
-->FPR: 0.016747933008267966
-->FNR: 0.015527950310559006
-->overall baseline on testing dataset
-->ACC 0.9147914032869785
-->F1 0.9121251629726207
-->FPR: 0.08561643835616438
-->FNR: 0.0847723704866562
training dataset
-->original metric score:
-->individual metric:0.11624698171783374, num_idi:337, num_all:2899
-->individual metric 0.11624698171783374
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9379699248120301
-->F1 0.9500756429652043
-->FPR 0.04392764857881137
-->FNR 0.0723781388478582
-->positive probability:0.606203007518797, 645/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9282021826536473
-->F1 0.9536865505742868
-->FPR 0.07584269662921349
-->FNR 0.07075812274368232
-->positive probability:0.7547386559448592, 1314/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.0271797155705434, 0.059094763620945526, 0.016747933008267966, 0.6499187336583987, 0.005474289213954257, 0.016747933008267966]
-->fnr_diff [0.05685018853729919, 0.05523017243312331, 0.1021191085129704, 0.015527950310559006, 0.013082962535497882, 0.009472049689440995, 0.0925801577975491, 0.10947204968944099]
-->FPR:[0.04392764857881137, 0.07584269662921349, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1347765390161523, mean FPR diff:0.12919389468006295
-->FNR:[0.0723781388478582, 0.07075812274368232, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.10810810810810811, 0.125], mean FNR:0.06516705203727989, mean FNR diff:0.05679182993823511
-->mean fnr diff metric 0.12919389468006295
testing dataset
-->original metric score:
-->individual metric:0.13240131578947367, num_idi:161, num_all:1216
-->individual metric 0.13240131578947367
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8828633405639913
-->F1 0.9072164948453608
-->FPR 0.11180124223602485
-->FNR 0.12
-->positive probability:0.6117136659436009, 282/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8812849162011173
-->F1 0.9237668161434978
-->FPR 0.1888111888111888
-->FNR 0.1012216404886562
-->positive probability:0.7569832402234636, 542/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9743589743589743
-->F1 0.9870129870129869
-->FPR None
-->FNR 0.02564102564102564
-->positive probability:0.9743589743589743, 38/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.02618480387986047, 0.10319475045502442, 0.08105022831050228, 0.4143835616438356, 0.9143835616438356, 0.005616438356164377, 0.05724070450097847]
-->fnr_diff [0.035227629513343794, 0.016449270002, 0.0402276295133438, 0.0847723704866562, 0.0847723704866562, 0.05913134484563056, 0.2009419152276295, 0.0402276295133438]
-->FPR:[0.11180124223602485, 0.1888111888111888, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.3128766057958604, mean FPR diff:0.22886486411288587
-->FNR:[0.12, 0.1012216404886562, 0.125, 0.0, 0.0, 0.02564102564102564, 0.2857142857142857, 0.125], mean FNR:0.09782211898049595, mean FNR diff:0.07021876994857548
-->mean fnr diff metric 0.22886486411288587
-->epoch 7
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1093, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1474, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1401, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.06382978707551956, FU:3.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1333, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.035087719559669495, FU:2.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1307, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1493, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0714285746216774, FU:4.0, P:56
-->FUR:0.16326530277729034, FU:8.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1252, bias_loss:nan
-->after epoch 7
-->overall baseline on training dataset
-->ACC 0.9829810298102981
-->F1 0.9826231322634201
-->FPR: 0.018655925376298496
-->FNR: 0.015306122448979591
-->overall baseline on testing dataset
-->ACC 0.9120101137800253
-->F1 0.9095634095634094
-->FPR: 0.09148727984344422
-->FNR: 0.08424908424908426
training dataset
-->original metric score:
-->individual metric:0.11693687478440842, num_idi:339, num_all:2899
-->individual metric 0.11693687478440842
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9426691729323309
-->F1 0.9540316503391107
-->FPR 0.04392764857881137
-->FNR 0.06499261447562776
-->positive probability:0.6109022556390977, 650/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9327972429638139
-->F1 0.9568106312292359
-->FPR 0.07865168539325842
-->FNR 0.06425992779783393
-->positive probability:0.7604824813325675, 1324/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.02527172320251287, 0.05999576001695993, 0.018655925376298496, 0.6480107412903682, 0.003566296845923727, 0.018655925376298496]
-->fnr_diff [0.04968649202664817, 0.04895380534885434, 0.10234093637454982, 0.015306122448979591, 0.012861134673918466, 0.00969387755102041, 0.09280198565912852, 0.1096938775510204]
-->FPR:[0.04392764857881137, 0.07865168539325842, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13524470381015977, mean FPR diff:0.12902606201806027
-->FNR:[0.06499261447562776, 0.06425992779783393, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.10810810810810811, 0.125], mean FNR:0.06343158712252003, mean FNR diff:0.055167278954264966
-->mean fnr diff metric 0.12902606201806027
testing dataset
-->original metric score:
-->individual metric:0.1299342105263158, num_idi:158, num_all:1216
-->individual metric 0.1299342105263158
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8806941431670282
-->F1 0.9056603773584906
-->FPR 0.11801242236024845
-->FNR 0.12
-->positive probability:0.613882863340564, 283/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.88268156424581
-->F1 0.925
-->FPR 0.20279720279720279
-->FNR 0.09598603839441536
-->positive probability:0.7639664804469274, 547/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.7727272727272727
-->F1 0.7368421052631579
-->FPR 0.2857142857142857
-->FNR 0.125
-->positive probability:0.5, 11/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.026525142516804226, 0.11130992295375856, 0.07517938682322244, 0.40851272015655576, 0.9085127201565558, 0.01148727984344422, 0.19422700587084146]
-->fnr_diff [0.03575091575091574, 0.011736954145331102, 0.040750915750915745, 0.08424908424908426, 0.08424908424908426, 0.08424908424908426, 0.20146520146520144, 0.040750915750915745]
-->FPR:[0.11801242236024845, 0.20279720279720279, 0.16666666666666666, 0.5, 1.0, 0.08, 0.2857142857142857], mean FPR:0.3361700825054862, mean FPR diff:0.24796488261731178
-->FNR:[0.12, 0.09598603839441536, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09396254051358763, mean FNR diff:0.07290026945131657
-->mean fnr diff metric 0.24796488261731178
-->epoch 8
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.0979, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.125, FU:6.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1530, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.09259258210659027, FU:4.999999523162842, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1419, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.06382978707551956, FU:3.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1263, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.035087719559669495, FU:2.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1264, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1376, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0714285746216774, FU:4.0, P:56
-->FUR:0.18367347121238708, FU:9.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1223, bias_loss:nan
-->after epoch 8
-->overall baseline on training dataset
-->ACC 0.9822222222222222
-->F1 0.9818704399734689
-->FPR: 0.020563917744329023
-->FNR: 0.014862466725820762
-->overall baseline on testing dataset
-->ACC 0.911504424778761
-->F1 0.9095139607032058
-->FPR: 0.09686888454011741
-->FNR: 0.07953950811093669
training dataset
-->original metric score:
-->individual metric:0.11693687478440842, num_idi:339, num_all:2899
-->individual metric 0.11693687478440842
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.943609022556391
-->F1 0.9548872180451128
-->FPR 0.046511627906976744
-->FNR 0.0620384047267356
-->positive probability:0.6137218045112782, 653/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9327972429638139
-->F1 0.9569694740713499
-->FPR 0.09269662921348315
-->FNR 0.06064981949458484
-->positive probability:0.7662263067202757, 1334/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.02594771016264772, 0.07213271146915412, 0.020563917744329023, 0.6461027489223377, 0.0016583044778932, 0.020563917744329023]
-->fnr_diff [0.04717593800091484, 0.04578735276876408, 0.10278459209770865, 0.014862466725820762, 0.012417478950759637, 0.010137533274179239, 0.09324564138228736, 0.11013753327417924]
-->FPR:[0.046511627906976744, 0.09269662921348315, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13801619100155813, mean FPR diff:0.13116155175344843
-->FNR:[0.0620384047267356, 0.06064981949458484, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.10810810810810811, 0.125], mean FNR:0.06261104736600238, mean FNR diff:0.05456856705932672
-->mean fnr diff metric 0.13116155175344843
testing dataset
-->original metric score:
-->individual metric:0.13240131578947367, num_idi:161, num_all:1216
-->individual metric 0.13240131578947367
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8915401301518439
-->F1 0.9149659863945578
-->FPR 0.11801242236024845
-->FNR 0.10333333333333333
-->positive probability:0.6247288503253796, 288/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8840782122905028
-->F1 0.9259589652096343
-->FPR 0.20279720279720279
-->FNR 0.09424083769633508
-->positive probability:0.7653631284916201, 548/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.7727272727272727
-->F1 0.7368421052631579
-->FPR 0.2857142857142857
-->FNR 0.125
-->positive probability:0.5, 11/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.021143537820131036, 0.10592831825708537, 0.06979778212654925, 0.40313111545988256, 0.9031311154598826, 0.01686888454011741, 0.1888454011741683]
-->fnr_diff [0.023793825222396647, 0.014701329585398396, 0.045460491889063315, 0.07953950811093669, 0.07953950811093669, 0.07953950811093669, 0.206174777603349, 0.045460491889063315]
-->FPR:[0.11801242236024845, 0.20279720279720279, 0.16666666666666666, 0.5, 1.0, 0.08, 0.2857142857142857], mean FPR:0.3361700825054862, mean FPR diff:0.2441208792625452
-->FNR:[0.10333333333333333, 0.09424083769633508, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09166105709299427, mean FNR diff:0.0717761800652601
-->mean fnr diff metric 0.2441208792625452
-->epoch 9
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.0902, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.1249999925494194, FU:5.999999523162842, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1541, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1419, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.0625, FU:4.0, P:64
-->FUR:0.1270298808813095, FU:5.970404148101807, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1220, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.035087719559669495, FU:2.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1256, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.059966377913951874, FU:2.998318910598755, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1320, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.07142840325832367, FU:3.999990463256836, P:56
-->FUR:0.10204081982374191, FU:5.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1224, bias_loss:nan
-->after epoch 9
-->overall baseline on training dataset
-->ACC 0.9802710027100271
-->F1 0.9797867614393603
-->FPR: 0.01801992792028832
-->FNR: 0.021517302573203195
-->overall baseline on testing dataset
-->ACC 0.9092288242730721
-->F1 0.9062907856956408
-->FPR: 0.09001956947162426
-->FNR: 0.09157509157509157
training dataset
-->original metric score:
-->individual metric:0.12073128665056916, num_idi:350, num_all:2899
-->individual metric 0.12073128665056916
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.943609022556391
-->F1 0.9546827794561933
-->FPR 0.03875968992248062
-->FNR 0.06646971935007386
-->positive probability:0.6080827067669173, 647/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9316484778862723
-->F1 0.9558769002595476
-->FPR 0.06460674157303371
-->FNR 0.06931407942238267
-->positive probability:0.7535898908673176, 1312/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.0207397620021923, 0.04658681365274539, 0.01801992792028832, 0.6486467387463783, 0.004202294301933904, 0.01801992792028832]
-->fnr_diff [0.04495241677687066, 0.047796776849179476, 0.09612975625032621, 0.021517302573203195, 0.01907231479814207, 0.003482697426796806, 0.08659080553490492, 0.1034826974267968]
-->FPR:[0.03875968992248062, 0.06460674157303371, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13204255339740054, mean FPR diff:0.12603591075730441
-->FNR:[0.06646971935007386, 0.06931407942238267, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.10810810810810811, 0.125], mean FNR:0.0642479941848944, mean FNR diff:0.05287809595452752
-->mean fnr diff metric 0.12603591075730441
testing dataset
-->original metric score:
-->individual metric:0.13322368421052633, num_idi:162, num_all:1216
-->individual metric 0.13322368421052633
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8937093275488069
-->F1 0.9162393162393163
-->FPR 0.10559006211180125
-->FNR 0.10666666666666667
-->positive probability:0.6182212581344902, 285/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8798882681564246
-->F1 0.9228007181328546
-->FPR 0.1888111888111888
-->FNR 0.10296684118673648
-->positive probability:0.755586592178771, 541/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.015570492640176986, 0.09879161933956454, 0.0766470971950424, 0.40998043052837574, 0.9099804305283757, 0.01001956947162426, 0.12426614481409001]
-->fnr_diff [0.015091575091575105, 0.011391749611644908, 0.03342490842490843, 0.09157509157509157, 0.09157509157509157, 0.09157509157509157, 0.1227106227106227, 0.03342490842490843]
-->FPR:[0.10559006211180125, 0.1888111888111888, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3221933759821959, mean FPR diff:0.2350365406453214
-->FNR:[0.10666666666666667, 0.10296684118673648, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.08423990276738968, mean FNR diff:0.06134612987361679
-->mean fnr diff metric 0.2350365406453214
-->epoch 10
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.0969, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1598, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1508, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.046875, FU:3.0, P:64
-->FUR:0.08510638028383255, FU:4.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1309, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1304, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1321, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.10204081982374191, FU:5.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1218, bias_loss:nan
-->after epoch 10
-->overall baseline on training dataset
-->ACC 0.9814634146341463
-->F1 0.9810189810189811
-->FPR: 0.017383930464278143
-->FNR: 0.01974267968056788
-->overall baseline on testing dataset
-->ACC 0.9104930467762327
-->F1 0.9076682316118935
-->FPR: 0.08953033268101761
-->FNR: 0.08948194662480377
training dataset
-->original metric score:
-->individual metric:0.11521214211797172, num_idi:334, num_all:2899
-->individual metric 0.11521214211797172
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9407894736842105
-->F1 0.9523088569265709
-->FPR 0.03875968992248062
-->FNR 0.07090103397341212
-->positive probability:0.6052631578947368, 644/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9310740953475014
-->F1 0.9554896142433235
-->FPR 0.06460674157303371
-->FNR 0.07003610108303249
-->positive probability:0.7530155083285468, 1311/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.9
-->F1 0.9206349206349206
-->FPR 0.0
-->FNR 0.14705882352941177
-->positive probability:0.58, 29/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.021375759458202477, 0.04722281110875557, 0.017383930464278143, 0.6492827362023885, 0.0048382917579440805, 0.017383930464278143]
-->fnr_diff [0.05115835429284424, 0.05029342140246461, 0.12731614384884388, 0.006584784943725774, 0.017297691905506753, 0.0052573203194321225, 0.08836542842754024, 0.10525732031943212]
-->FPR:[0.03875968992248062, 0.06460674157303371, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13204255339740054, mean FPR diff:0.12624790990930781
-->FNR:[0.07090103397341212, 0.07003610108303249, 0.14705882352941177, 0.013157894736842105, 0.0024449877750611247, 0.025, 0.10810810810810811, 0.125], mean FNR:0.07021336865073347, mean FNR diff:0.05644130818247371
-->mean fnr diff metric 0.12624790990930781
testing dataset
-->original metric score:
-->individual metric:0.13157894736842105, num_idi:160, num_all:1216
-->individual metric 0.13157894736842105
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8937093275488069
-->F1 0.9159519725557461
-->FPR 0.09937888198757763
-->FNR 0.11
-->positive probability:0.613882863340564, 283/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8770949720670391
-->F1 0.9207207207207208
-->FPR 0.18181818181818182
-->FNR 0.1082024432809773
-->positive probability:0.75, 537/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.009848549306560025, 0.09228784913716422, 0.07713633398564905, 0.4104696673189824, 0.9104696673189824, 0.009530332681017606, 0.12475538160469667]
-->fnr_diff [0.02051805337519623, 0.018720496656173535, 0.03551805337519623, 0.08948194662480377, 0.08948194662480377, 0.08948194662480377, 0.1248037676609105, 0.03551805337519623]
-->FPR:[0.09937888198757763, 0.18181818181818182, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3203070635368772, mean FPR diff:0.23349968305043609
-->FNR:[0.11, 0.1082024432809773, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.08531101969583646, mean FNR diff:0.06294053303963551
-->mean fnr diff metric 0.23349968305043609
-->epoch 11
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.0882, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1535, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.036350395530462265, FU:1.9629212617874146, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1443, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.06382978707551956, FU:3.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1249, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1300, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1343, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.08163265138864517, FU:4.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1247, bias_loss:nan
-->after epoch 11
-->overall baseline on training dataset
-->ACC 0.9778861788617886
-->F1 0.9771761020362497
-->FPR: 0.013355946576213695
-->FNR: 0.03127772848269743
-->overall baseline on testing dataset
-->ACC 0.9089759797724399
-->F1 0.9051133368476542
-->FPR: 0.0812133072407045
-->FNR: 0.10151753008895865
training dataset
-->original metric score:
-->individual metric:0.11590203518454639, num_idi:336, num_all:2899
-->individual metric 0.11590203518454639
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9360902255639098
-->F1 0.9481707317073171
-->FPR 0.03359173126614987
-->FNR 0.08124076809453472
-->positive probability:0.5968045112781954, 635/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.919586444572085
-->F1 0.9475262368815591
-->FPR 0.05337078651685393
-->FNR 0.08736462093862817
-->positive probability:0.7369327972429638, 1283/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.9
-->F1 0.9206349206349206
-->FPR 0.0
-->FNR 0.14705882352941177
-->positive probability:0.58, 29/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.020235784689936177, 0.040014839940640236, 0.013355946576213695, 0.6533107200904529, 0.008866275646008528, 0.013355946576213695]
-->fnr_diff [0.04996303961183729, 0.05608689245593074, 0.11578109504671434, 0.018119833745855324, 0.028832740707636303, 0.0020556048506359045, 0.10385740665243771, 0.09372227151730257]
-->FPR:[0.03359173126614987, 0.05337078651685393, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12930856777864877, mean FPR diff:0.12485658558657753
-->FNR:[0.08124076809453472, 0.08736462093862817, 0.14705882352941177, 0.013157894736842105, 0.0024449877750611247, 0.03333333333333333, 0.13513513513513514, 0.125], mean FNR:0.0780919454428683, mean FNR diff:0.05855236057354377
-->mean fnr diff metric 0.12485658558657753
testing dataset
-->original metric score:
-->individual metric:0.13075657894736842, num_idi:159, num_all:1216
-->individual metric 0.13075657894736842
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8915401301518439
-->F1 0.9137931034482758
-->FPR 0.09316770186335403
-->FNR 0.11666666666666667
-->positive probability:0.6073752711496746, 280/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8701117318435754
-->F1 0.9155313351498638
-->FPR 0.16783216783216784
-->FNR 0.12041884816753927
-->positive probability:0.7374301675977654, 528/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.011954394622649536, 0.08661886059146334, 0.08545335942596216, 0.4187866927592955, 0.9187866927592955, 0.0012133072407044948, 0.13307240704500978]
-->fnr_diff [0.015149136577708014, 0.018901318078580615, 0.023482469911041345, 0.10151753008895865, 0.10151753008895865, 0.10151753008895865, 0.18419675562532706, 0.023482469911041345]
-->FPR:[0.09316770186335403, 0.16783216783216784, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3174217500925575, mean FPR diff:0.23655510206348287
-->FNR:[0.11666666666666667, 0.12041884816753927, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09659997506856145, mean FNR diff:0.07122059254632179
-->mean fnr diff metric 0.23655510206348287
-->epoch 12
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.0974, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1588, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:1.4281105192627552e-16, FU:7.711797068716674e-15, P:54
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1553, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1435, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1407, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1362, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.08163265138864517, FU:4.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1275, bias_loss:nan
-->after epoch 12
-->overall baseline on training dataset
-->ACC 0.9774525745257453
-->F1 0.9767025089605735
-->FPR: 0.012719949120203519
-->FNR: 0.032830523513753325
-->overall baseline on testing dataset
-->ACC 0.9092288242730721
-->F1 0.9053519641444766
-->FPR: 0.08072407045009784
-->FNR: 0.10151753008895865
training dataset
-->original metric score:
-->individual metric:0.11555708865125905, num_idi:335, num_all:2899
-->individual metric 0.11555708865125905
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9370300751879699
-->F1 0.9489718202589489
-->FPR 0.03359173126614987
-->FNR 0.07976366322008863
-->positive probability:0.5977443609022557, 636/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9190120620333142
-->F1 0.947091932457786
-->FPR 0.05056179775280899
-->FNR 0.0888086642599278
-->positive probability:0.7352096496266514, 1280/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.9
-->F1 0.9206349206349206
-->FPR 0.0
-->FNR 0.14705882352941177
-->positive probability:0.58, 29/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.020871782145946354, 0.037841848632605465, 0.012719949120203519, 0.6539467175464632, 0.009502273102018705, 0.012719949120203519]
-->fnr_diff [0.0469331397063353, 0.05597814074617447, 0.11422830001565845, 0.01967262877691122, 0.0303855357386922, 0.0005028098195800079, 0.10230461162138182, 0.09216947648624668]
-->FPR:[0.03359173126614987, 0.05056179775280899, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1288404029846413, mean FPR diff:0.12460041994457344
-->FNR:[0.07976366322008863, 0.0888086642599278, 0.14705882352941177, 0.013157894736842105, 0.0024449877750611247, 0.03333333333333333, 0.13513513513513514, 0.125], mean FNR:0.07808781274872499, mean FNR diff:0.057771830363872526
-->mean fnr diff metric 0.12460041994457344
testing dataset
-->original metric score:
-->individual metric:0.13075657894736842, num_idi:159, num_all:1216
-->individual metric 0.13075657894736842
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.89587852494577
-->F1 0.9175257731958764
-->FPR 0.09316770186335403
-->FNR 0.11
-->positive probability:0.6117136659436009, 282/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8715083798882681
-->F1 0.9165154264972777
-->FPR 0.16783216783216784
-->FNR 0.11867364746945899
-->positive probability:0.7388268156424581, 529/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.01244363141325619, 0.08710809738207, 0.08594259621656881, 0.41927592954990217, 0.9192759295499021, 0.0007240704500978412, 0.13356164383561642]
-->fnr_diff [0.008482469911041346, 0.017156117380500338, 0.023482469911041345, 0.10151753008895865, 0.10151753008895865, 0.10151753008895865, 0.18419675562532706, 0.023482469911041345]
-->FPR:[0.09316770186335403, 0.16783216783216784, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3174217500925575, mean FPR diff:0.23690455691391626
-->FNR:[0.11, 0.11867364746945899, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09554849164796808, mean FNR diff:0.07016910912572842
-->mean fnr diff metric 0.23690455691391626
-->epoch 13
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.0979, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1543, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1459, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.04687124118208885, FU:2.9997594356536865, P:64
-->FUR:0.06382466852664948, FU:2.9997594356536865, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1333, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1314, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.03560049831867218, FU:1.7800250053405762, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1281, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.08163265138864517, FU:4.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1239, bias_loss:nan
-->after epoch 13
-->overall baseline on training dataset
-->ACC 0.9811382113821138
-->F1 0.9806020066889631
-->FPR: 0.013567945728217087
-->FNR: 0.024401064773735583
-->overall baseline on testing dataset
-->ACC 0.9099873577749684
-->F1 0.9064634787178141
-->FPR: 0.08317025440313111
-->FNR: 0.09733124018838304
training dataset
-->original metric score:
-->individual metric:0.11866160745084511, num_idi:344, num_all:2899
-->individual metric 0.11866160745084511
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9417293233082706
-->F1 0.952959028831563
-->FPR 0.03359173126614987
-->FNR 0.0723781388478582
-->positive probability:0.6024436090225563, 641/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9304997128087306
-->F1 0.9549012299664554
-->FPR 0.047752808988764044
-->FNR 0.07509025270758123
-->positive probability:0.7455485353245261, 1298/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.9
-->F1 0.9206349206349206
-->FPR 0.0
-->FNR 0.14705882352941177
-->positive probability:0.58, 29/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.020023785537932784, 0.034184863260546955, 0.013567945728217087, 0.6530987209384496, 0.008654276494005136, 0.013567945728217087]
-->fnr_diff [0.04797707407412261, 0.05068918793384564, 0.1226577587556762, 0.011243170036893478, 0.021956076998674457, 0.0005989352262644188, 0.08370704333437254, 0.10059893522626442]
-->FPR:[0.03359173126614987, 0.047752808988764044, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1283722381906338, mean FPR diff:0.12384958961456144
-->FNR:[0.0723781388478582, 0.07509025270758123, 0.14705882352941177, 0.013157894736842105, 0.0024449877750611247, 0.025, 0.10810810810810811, 0.125], mean FNR:0.07102977571310781, mean FNR diff:0.054928522698264225
-->mean fnr diff metric 0.12384958961456144
testing dataset
-->original metric score:
-->individual metric:0.13322368421052633, num_idi:162, num_all:1216
-->individual metric 0.13322368421052633
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8828633405639913
-->F1 0.9065743944636678
-->FPR 0.09937888198757763
-->FNR 0.12666666666666668
-->positive probability:0.6030368763557483, 278/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8743016759776536
-->F1 0.9187725631768953
-->FPR 0.18181818181818182
-->FNR 0.11169284467713787
-->positive probability:0.7472067039106145, 535/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.016208627584446522, 0.09864792741505071, 0.08349641226353555, 0.4168297455968689, 0.9168297455968689, 0.003170254403131109, 0.13111545988258316]
-->fnr_diff [0.029335426478283633, 0.014361604488754828, 0.027668759811616955, 0.09733124018838304, 0.09733124018838304, 0.09733124018838304, 0.18838304552590265, 0.027668759811616955]
-->FPR:[0.09937888198757763, 0.18181818181818182, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3203070635368772, mean FPR diff:0.2380425961060693
-->FNR:[0.12666666666666668, 0.11169284467713787, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09675922463226128, mean FNR diff:0.07242641458516552
-->mean fnr diff metric 0.2380425961060693
-->epoch 14
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.0926, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1444, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1385, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1282, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1301, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1391, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.08163265138864517, FU:4.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1252, bias_loss:nan
-->after epoch 14
-->overall baseline on training dataset
-->ACC 0.9826558265582656
-->F1 0.9821786589440855
-->FPR: 0.012931948272206912
-->FNR: 0.021960958296362024
-->overall baseline on testing dataset
-->ACC 0.9130214917825538
-->F1 0.9095688748685594
-->FPR: 0.07974559686888454
-->FNR: 0.09471480900052329
training dataset
-->original metric score:
-->individual metric:0.11486719558468438, num_idi:333, num_all:2899
-->individual metric 0.11486719558468438
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9379699248120301
-->F1 0.9496183206106871
-->FPR 0.028423772609819122
-->FNR 0.08124076809453472
-->positive probability:0.5949248120300752, 633/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9241815048822516
-->F1 0.950561797752809
-->FPR 0.0449438202247191
-->FNR 0.08375451263537906
-->positive probability:0.7380815623205055, 1285/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.9
-->F1 0.9206349206349206
-->FPR 0.0
-->FNR 0.14705882352941177
-->positive probability:0.58, 29/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.01549182433761221, 0.03201187195251219, 0.012931948272206912, 0.6537347183944597, 0.009290273950015311, 0.012931948272206912]
-->fnr_diff [0.0592798097981727, 0.06179355433901704, 0.12509786523304975, 0.00880306355951992, 0.0195159705213009, 0.003039041703637977, 0.0861471498117461, 0.10303904170363798]
-->FPR:[0.028423772609819122, 0.0449438202247191, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12704274695390452, mean FPR diff:0.12273209752983555
-->FNR:[0.08124076809453472, 0.08375451263537906, 0.14705882352941177, 0.013157894736842105, 0.0024449877750611247, 0.025, 0.10810810810810811, 0.125], mean FNR:0.07322063685991712, mean FNR diff:0.0583394370837603
-->mean fnr diff metric 0.12273209752983555
testing dataset
-->original metric score:
-->individual metric:0.13157894736842105, num_idi:160, num_all:1216
-->individual metric 0.13157894736842105
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8850325379609545
-->F1 0.9078260869565218
-->FPR 0.08695652173913043
-->FNR 0.13
-->positive probability:0.596529284164859, 275/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8756983240223464
-->F1 0.9193109700815958
-->FPR 0.16083916083916083
-->FNR 0.11518324607329843
-->positive probability:0.7402234636871509, 530/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.007210924870245897, 0.0810935639702763, 0.08692106979778212, 0.42025440313111545, 0.9202544031311155, 0.000254403131115466, 0.008317025440313111]
-->fnr_diff [0.03528519099947672, 0.02046843707277514, 0.030285190999476713, 0.09471480900052329, 0.09471480900052329, 0.09471480900052329, 0.1909994767137624, 0.030285190999476713]
-->FPR:[0.08695652173913043, 0.16083916083916083, 0.16666666666666666, 0.5, 1.0, 0.08, 0.07142857142857142], mean FPR:0.29512727438193276, mean FPR diff:0.21775797049599485
-->FNR:[0.13, 0.11518324607329843, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09761219147344802, mean FNR diff:0.07393348922331719
-->mean fnr diff metric 0.21775797049599485
-->epoch 15
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.0961, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.0416666679084301, FU:2.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1441, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1427, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1280, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1288, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1383, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.08163265138864517, FU:4.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1254, bias_loss:nan
-->after epoch 15
-->overall baseline on training dataset
-->ACC 0.9827642276422764
-->F1 0.9822998998107538
-->FPR: 0.013355946576213695
-->FNR: 0.02129547471162378
-->overall baseline on testing dataset
-->ACC 0.9147914032869785
-->F1 0.9114788547412661
-->FPR: 0.07876712328767123
-->FNR: 0.09209837781266353
training dataset
-->original metric score:
-->individual metric:0.11555708865125905, num_idi:335, num_all:2899
-->individual metric 0.11555708865125905
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9398496240601504
-->F1 0.9511450381679389
-->FPR 0.025839793281653745
-->FNR 0.07976366322008863
-->positive probability:0.5949248120300752, 633/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9241815048822516
-->F1 0.950561797752809
-->FPR 0.0449438202247191
-->FNR 0.08375451263537906
-->positive probability:0.7380815623205055, 1285/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.01248384670544005, 0.031587873648505405, 0.013355946576213695, 0.6533107200904529, 0.008866275646008528, 0.013355946576213695]
-->fnr_diff [0.058468188508464844, 0.062459037923755276, 0.09635158411190563, 0.02129547471162378, 0.018850486936562653, 0.0037045252883762224, 0.11383966042351136, 0.10370452528837622]
-->FPR:[0.025839793281653745, 0.0449438202247191, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12661208373254362, mean FPR diff:0.12216010154047237
-->FNR:[0.07976366322008863, 0.08375451263537906, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.13513513513513514, 0.125], mean FNR:0.07109316969864918, mean FNR diff:0.059834185399071996
-->mean fnr diff metric 0.12216010154047237
testing dataset
-->original metric score:
-->individual metric:0.13404605263157895, num_idi:163, num_all:1216
-->individual metric 0.13404605263157895
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8806941431670282
-->F1 0.9046793760831889
-->FPR 0.09937888198757763
-->FNR 0.13
-->positive probability:0.6008676789587852, 277/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8743016759776536
-->F1 0.9184782608695652
-->FPR 0.16783216783216784
-->FNR 0.11518324607329843
-->positive probability:0.7416201117318436, 531/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.020611758699906405, 0.08906504454449661, 0.08789954337899543, 0.4212328767123288, 0.9212328767123288, 0.0012328767123287732, 0.007338551859099804]
-->fnr_diff [0.037901622187336476, 0.023084868260634897, 0.03290162218733647, 0.09209837781266353, 0.09209837781266353, 0.09209837781266353, 0.19361590790162217, 0.03290162218733647]
-->FPR:[0.09937888198757763, 0.16783216783216784, 0.16666666666666666, 0.5, 1.0, 0.08, 0.07142857142857142], mean FPR:0.29790089827356914, mean FPR diff:0.22123050408849781
-->FNR:[0.13, 0.11518324607329843, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09761219147344802, mean FNR diff:0.07458759702028214
-->mean fnr diff metric 0.22123050408849781
-->epoch 16
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.0965, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.0416666679084301, FU:2.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1422, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1439, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1261, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1264, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1343, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.08163265138864517, FU:4.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1247, bias_loss:nan
-->after epoch 16
-->overall baseline on training dataset
-->ACC 0.9826558265582656
-->F1 0.982202447163515
-->FPR: 0.014203943184227264
-->FNR: 0.020629991126885537
-->overall baseline on testing dataset
-->ACC 0.91378002528445
-->F1 0.9105691056910569
-->FPR: 0.0812133072407045
-->FNR: 0.09157509157509157
training dataset
-->original metric score:
-->individual metric:0.11521214211797172, num_idi:334, num_all:2899
-->individual metric 0.11521214211797172
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9407894736842105
-->F1 0.9519450800915331
-->FPR 0.025839793281653745
-->FNR 0.07828655834564253
-->positive probability:0.5958646616541353, 634/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9264790350373349
-->F1 0.9521316379955124
-->FPR 0.0449438202247191
-->FNR 0.08086642599277978
-->positive probability:0.7403790924755888, 1289/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.011635850097426481, 0.030739877040491838, 0.014203943184227264, 0.6524627234824394, 0.00801827903799496, 0.014203943184227264]
-->fnr_diff [0.057656567218757, 0.060236434865894244, 0.09701706769664387, 0.020629991126885537, 0.01818500335182441, 0.004370008873114464, 0.1145051440082496, 0.10437000887311446]
-->FPR:[0.025839793281653745, 0.0449438202247191, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12661208373254362, mean FPR diff:0.12187743600446788
-->FNR:[0.07828655834564253, 0.08086642599277978, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.13513513513513514, 0.125], mean FNR:0.07054752075901849, mean FNR diff:0.05962127825181045
-->mean fnr diff metric 0.12187743600446788
testing dataset
-->original metric score:
-->individual metric:0.13322368421052633, num_idi:162, num_all:1216
-->individual metric 0.13322368421052633
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8785249457700651
-->F1 0.9031141868512111
-->FPR 0.10559006211180125
-->FNR 0.13
-->positive probability:0.6030368763557483, 278/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8743016759776536
-->F1 0.918625678119349
-->FPR 0.17482517482517482
-->FNR 0.11343804537521815
-->positive probability:0.744413407821229, 533/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.02437675487109675, 0.09361186758447032, 0.08545335942596216, 0.4187866927592955, 0.9187866927592955, 0.0012133072407044948, 0.009784735812133072]
-->fnr_diff [0.038424908424908436, 0.02186295380012658, 0.03342490842490843, 0.09157509157509157, 0.09157509157509157, 0.09157509157509157, 0.19413919413919412, 0.03342490842490843]
-->FPR:[0.10559006211180125, 0.17482517482517482, 0.16666666666666666, 0.5, 1.0, 0.08, 0.07142857142857142], mean FPR:0.2997872107188878, mean FPR diff:0.2217162014932797
-->FNR:[0.13, 0.11343804537521815, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09739404138618799, mean FNR diff:0.07450026849241509
-->mean fnr diff metric 0.2217162014932797
-->epoch 17
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.0963, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.0416666679084301, FU:2.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1403, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1433, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1242, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1244, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1313, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.08163265138864517, FU:4.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1230, bias_loss:nan
-->after epoch 17
-->overall baseline on training dataset
-->ACC 0.9825474254742548
-->F1 0.9820971867007673
-->FPR: 0.014627941488234047
-->FNR: 0.02040816326530612
-->overall baseline on testing dataset
-->ACC 0.913527180783818
-->F1 0.9104243059193295
-->FPR: 0.08268101761252446
-->FNR: 0.09052851909994768
training dataset
-->original metric score:
-->individual metric:0.1176267678509831, num_idi:341, num_all:2899
-->individual metric 0.1176267678509831
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9407894736842105
-->F1 0.9519450800915331
-->FPR 0.025839793281653745
-->FNR 0.07828655834564253
-->positive probability:0.5958646616541353, 634/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9276278001148766
-->F1 0.952914798206278
-->FPR 0.0449438202247191
-->FNR 0.07942238267148015
-->positive probability:0.7415278575531303, 1291/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.011211851793419698, 0.03031587873648505, 0.014627941488234047, 0.6520387251784325, 0.007594280733988176, 0.014627941488234047]
-->fnr_diff [0.05787839508033642, 0.05901421940617403, 0.09723889555822329, 0.02040816326530612, 0.017963175490244995, 0.004591836734693881, 0.11472697186982903, 0.10459183673469388]
-->FPR:[0.025839793281653745, 0.0449438202247191, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12661208373254362, mean FPR diff:0.1217361032364656
-->FNR:[0.07828655834564253, 0.07942238267148015, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.13513513513513514, 0.125], mean FNR:0.07036701534385603, mean FNR diff:0.0595516867674377
-->mean fnr diff metric 0.1217361032364656
testing dataset
-->original metric score:
-->individual metric:0.1356907894736842, num_idi:165, num_all:1216
-->individual metric 0.1356907894736842
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8763557483731019
-->F1 0.9015544041450777
-->FPR 0.11180124223602485
-->FNR 0.13
-->positive probability:0.6052060737527115, 279/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8729050279329609
-->F1 0.9177958446251129
-->FPR 0.18181818181818182
-->FNR 0.11343804537521815
-->positive probability:0.7458100558659218, 534/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.02912022462350039, 0.09913716420565737, 0.0839856490541422, 0.41731898238747556, 0.9173189823874756, 0.0026810176125244556, 0.011252446183953033]
-->fnr_diff [0.03947148090005233, 0.022909526275270473, 0.03447148090005232, 0.09052851909994768, 0.09052851909994768, 0.09052851909994768, 0.195185766614338, 0.03447148090005232]
-->FPR:[0.11180124223602485, 0.18181818181818182, 0.16666666666666666, 0.5, 1.0, 0.08, 0.07142857142857142], mean FPR:0.3016735231642064, mean FPR diff:0.22297349520781834
-->FNR:[0.13, 0.11343804537521815, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09739404138618799, mean FNR diff:0.07476191161120106
-->mean fnr diff metric 0.22297349520781834
-->epoch 18
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.0953, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.0416666679084301, FU:2.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1386, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1416, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1221, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1224, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.020149288699030876, FU:1.0074644088745117, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1294, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.08163265138864517, FU:4.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1210, bias_loss:nan
-->after epoch 18
-->overall baseline on training dataset
-->ACC 0.9826558265582656
-->F1 0.9822143174744331
-->FPR: 0.014839940640237439
-->FNR: 0.019964507542147295
-->overall baseline on testing dataset
-->ACC 0.9127686472819216
-->F1 0.9097095001308557
-->FPR: 0.08414872798434442
-->FNR: 0.09052851909994768
training dataset
-->original metric score:
-->individual metric:0.11866160745084511, num_idi:344, num_all:2899
-->individual metric 0.11866160745084511
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9417293233082706
-->F1 0.9527439024390244
-->FPR 0.025839793281653745
-->FNR 0.07680945347119646
-->positive probability:0.5968045112781954, 635/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9299253302699598
-->F1 0.9544776119402986
-->FPR 0.0449438202247191
-->FNR 0.07653429602888087
-->positive probability:0.7438253877082137, 1295/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.010999852641416306, 0.03010387958448166, 0.014839940640237439, 0.6518267260264292, 0.007382281581984784, 0.014839940640237439]
-->fnr_diff [0.056844945929049165, 0.05656978848673358, 0.09768255128138212, 0.019964507542147295, 0.01751951976708617, 0.005035492457852706, 0.11517062759298785, 0.10503549245785271]
-->FPR:[0.025839793281653745, 0.0449438202247191, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12661208373254362, mean FPR diff:0.12166543685246446
-->FNR:[0.07680945347119646, 0.07653429602888087, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.13513513513513514, 0.125], mean FNR:0.06982136640422537, mean FNR diff:0.05922786568938645
-->mean fnr diff metric 0.12166543685246446
testing dataset
-->original metric score:
-->individual metric:0.1356907894736842, num_idi:165, num_all:1216
-->individual metric 0.1356907894736842
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8763557483731019
-->F1 0.9015544041450777
-->FPR 0.11180124223602485
-->FNR 0.13
-->positive probability:0.6052060737527115, 279/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8729050279329609
-->F1 0.9177958446251129
-->FPR 0.18181818181818182
-->FNR 0.11343804537521815
-->positive probability:0.7458100558659218, 534/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.02765251425168043, 0.0976694538338374, 0.08251793868232224, 0.4158512720156556, 0.9158512720156555, 0.004148727984344416, 0.012720156555772993]
-->fnr_diff [0.03947148090005233, 0.022909526275270473, 0.03447148090005232, 0.09052851909994768, 0.09052851909994768, 0.09052851909994768, 0.195185766614338, 0.03447148090005232]
-->FPR:[0.11180124223602485, 0.18181818181818182, 0.16666666666666666, 0.5, 1.0, 0.08, 0.07142857142857142], mean FPR:0.3016735231642064, mean FPR diff:0.2223444764770384
-->FNR:[0.13, 0.11343804537521815, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09739404138618799, mean FNR diff:0.07476191161120106
-->mean fnr diff metric 0.2223444764770384
-->epoch 19
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.0938, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.0416666679084301, FU:2.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1376, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1404, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1203, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1208, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1282, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.08163265138864517, FU:4.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1192, bias_loss:nan
-->after epoch 19
-->overall baseline on training dataset
-->ACC 0.9828726287262872
-->F1 0.982448344812264
-->FPR: 0.015263938944244222
-->FNR: 0.019077196095829637
-->overall baseline on testing dataset
-->ACC 0.9127686472819216
-->F1 0.9097567355479989
-->FPR: 0.08463796477495107
-->FNR: 0.09000523286237572
training dataset
-->original metric score:
-->individual metric:0.1176267678509831, num_idi:341, num_all:2899
-->individual metric 0.1176267678509831
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.943609022556391
-->F1 0.954337899543379
-->FPR 0.025839793281653745
-->FNR 0.07385524372230429
-->positive probability:0.5986842105263158, 637/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9310740953475014
-->F1 0.9552572706935124
-->FPR 0.0449438202247191
-->FNR 0.07509025270758123
-->positive probability:0.7449741527857553, 1297/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.010575854337409523, 0.029679881280474878, 0.015263938944244222, 0.6514027277224224, 0.006958283277978001, 0.015263938944244222]
-->fnr_diff [0.054778047626474646, 0.056013056611751585, 0.09856986272769977, 0.019077196095829637, 0.01663220832076851, 0.005922803904170364, 0.1160579390393055, 0.10592280390417036]
-->FPR:[0.025839793281653745, 0.0449438202247191, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12661208373254362, mean FPR diff:0.1215241040844622
-->FNR:[0.07385524372230429, 0.07509025270758123, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.13513513513513514, 0.125], mean FNR:0.0692715847704514, mean FNR diff:0.0591217397787713
-->mean fnr diff metric 0.1215241040844622
testing dataset
-->original metric score:
-->individual metric:0.1356907894736842, num_idi:165, num_all:1216
-->individual metric 0.1356907894736842
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8763557483731019
-->F1 0.9015544041450777
-->FPR 0.11180124223602485
-->FNR 0.13
-->positive probability:0.6052060737527115, 279/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8715083798882681
-->F1 0.9169675090252707
-->FPR 0.1888111888111888
-->FNR 0.11343804537521815
-->positive probability:0.7472067039106145, 535/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.027163277461073776, 0.10417322403623773, 0.08202870189171559, 0.41536203522504894, 0.9153620352250489, 0.00463796477495107, 0.013209393346379647]
-->fnr_diff [0.03999476713762429, 0.023432812512842432, 0.03499476713762428, 0.09000523286237572, 0.09000523286237572, 0.09000523286237572, 0.19570905285190998, 0.03499476713762428]
-->FPR:[0.11180124223602485, 0.1888111888111888, 0.16666666666666666, 0.5, 1.0, 0.08, 0.07142857142857142], mean FPR:0.3026725241632074, mean FPR diff:0.2231338045657794
-->FNR:[0.13, 0.11343804537521815, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09739404138618799, mean FNR diff:0.07489273317059406
-->mean fnr diff metric 0.2231338045657794
    train_ind  train_acc  ...  test_fnr_mean  test_fnr_diff
0    0.117282   0.983306  ...       0.103804       0.068744
1    0.114867   0.982547  ...       0.093328       0.072920
2    0.119696   0.978645  ...       0.081027       0.061011
3    0.116592   0.984065  ...       0.104201       0.069664
4    0.116592   0.984173  ...       0.105491       0.070692
5    0.116247   0.983957  ...       0.103150       0.068875
6    0.116247   0.983848  ...       0.097822       0.070219
7    0.116937   0.982981  ...       0.093963       0.072900
8    0.116937   0.982222  ...       0.091661       0.071776
9    0.120731   0.980271  ...       0.084240       0.061346
10   0.115212   0.981463  ...       0.085311       0.062941
11   0.115902   0.977886  ...       0.096600       0.071221
12   0.115557   0.977453  ...       0.095548       0.070169
13   0.118662   0.981138  ...       0.096759       0.072426
14   0.114867   0.982656  ...       0.097612       0.073933
15   0.115557   0.982764  ...       0.097612       0.074588
16   0.115212   0.982656  ...       0.097394       0.074500
17   0.117627   0.982547  ...       0.097394       0.074762
18   0.118662   0.982656  ...       0.097394       0.074762
19   0.117627   0.982873  ...       0.097394       0.074893

[20 rows x 22 columns]
-->gamma 1.3
-->model.parameters() <generator object Module.parameters at 0x7f167ebde430>
-->classifier <generator object Module.parameters at 0x7f167ebde430>
-->orig_weight tensor([[-0.0128,  0.0071, -0.0342,  ...,  0.0017,  0.0474, -0.0482],
        [-0.0089, -0.0056,  0.0271,  ..., -0.0030,  0.0003,  0.0368],
        [-0.0148, -0.0207, -0.0035,  ...,  0.0077,  0.0116, -0.0043],
        ...,
        [-0.0165, -0.0131, -0.0050,  ...,  0.0157,  0.0250,  0.0323],
        [ 0.0465, -0.0500, -0.0112,  ...,  0.0066,  0.0030,  0.0309],
        [ 0.0098,  0.0351,  0.0099,  ...,  0.0321,  0.0228,  0.0092]],
       device='cuda:0', grad_fn=<CloneBackward0>)
-->orig_bias tensor([-0.0235, -0.0189,  0.0211,  0.0237, -0.0313,  0.0475,  0.0263,  0.0088,
         0.0033,  0.0252, -0.0217,  0.0221,  0.0067, -0.0180,  0.0307, -0.0247,
         0.0061, -0.0182,  0.0038, -0.0151, -0.0155, -0.0334, -0.0376,  0.0294,
         0.0079, -0.0026,  0.0086,  0.0091,  0.0387, -0.0082, -0.0197, -0.0365,
        -0.0046, -0.0015,  0.0128,  0.0361, -0.0101, -0.0082, -0.0288,  0.0126,
        -0.0260, -0.0406, -0.0170,  0.0164, -0.0502,  0.0189, -0.0008, -0.0251,
         0.0177, -0.0128, -0.0280, -0.0045,  0.0258,  0.0194, -0.0212, -0.0299,
        -0.0268, -0.0250, -0.0266, -0.0300, -0.0063], device='cuda:0',
       grad_fn=<CloneBackward0>)
-->MinValue:-3.2998316455372216, MaxValue:3.9719170089423623
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9144736842105263
-->F1 0.9298380878951426
-->FPR 0.04392764857881137
-->FNR 0.10930576070901034
-->positive probability:0.5827067669172933, 620/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9092475588742103
-->F1 0.9406461307287755
-->FPR 0.0702247191011236
-->FNR 0.096028880866426
-->positive probability:0.7334865020103389, 1277/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9605263157894737
-->F1 0.9798657718120806
-->FPR None
-->FNR 0.039473684210526314
-->positive probability:0.9605263157894737, 73/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9684466019417476
-->F1 0.9839307787391842
-->FPR 0.6666666666666666
-->FNR 0.02689486552567237
-->positive probability:0.970873786407767, 400/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.029087708578811367, 0.055384779101123605, 0.01483994, 0.6518267266666666, 0.007382282222222224, 0.01483994]
-->fnr_diff [0.09333415070901034, 0.080057270866426, 0.10167544882352941, 0.023502074210526313, 0.01092325552567237, 0.017361723333333332, 0.11916352513513515, 0.10902839]
-->FPR: [0.04392764857881137, 0.0702247191011236, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13384020942813732, mean FPR diff:0.12889356276147065
-->FNR: [0.10930576070901034, 0.096028880866426, 0.11764705882352941, 0.039473684210526314, 0.02689486552567237, 0.03333333333333333, 0.13513513513513514, 0.125], mean FNR:0.08535233982545412, mean FNR diff:0.06938072982545412
-->base group metric 0.12889356276147065 0.13384020942813732
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8655097613882863
-->F1 0.8912280701754387
-->FPR 0.09937888198757763
-->FNR 0.15333333333333332
-->positive probability:0.5856832971800434, 270/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8603351955307262
-->F1 0.9087591240875912
-->FPR 0.17482517482517482
-->FNR 0.13089005235602094
-->positive probability:0.7304469273743017, 523/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9807692307692307
-->F1 0.9902912621359222
-->FPR 1.0
-->FNR 0.012903225806451613
-->positive probability:0.9871794871794872, 154/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9230769230769231
-->F1 0.9600000000000001
-->FPR None
-->FNR 0.07692307692307693
-->positive probability:0.9230769230769231, 36/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.75
-->FPR 0.04
-->FNR 0.35714285714285715
-->positive probability:0.2564102564102564, 10/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.08453894198757764, 0.15998523482517482, 0.01483994, 0.48516006, 0.98516006, 0.02516006, 0.12801720285714285]
-->fnr_diff [0.13736172333333332, 0.11491844235602094, 0.10902839, 0.01597161, 0.0030683841935483878, 0.06095146692307693, 0.3411712471428571, 0.10902839]
-->FPR: [0.09937888198757763, 0.17482517482517482, 0.0, 0.5, 1.0, 0.04, 0.14285714285714285], mean FPR:0.2795801713814136, mean FPR diff:0.26898021423855645
-->FNR: [0.15333333333333332, 0.13089005235602094, 0.125, 0.0, 0.012903225806451613, 0.07692307692307693, 0.35714285714285715, 0.125], mean FNR:0.1226490681952175, mean FNR diff:0.1114374567436046
-->base group metric 0.26898021423855645 0.2795801713814136
-->epoch 0
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.0921, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1653, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.055555541068315506, FU:2.9999992847442627, P:54
-->FUR:0.12962962687015533, FU:7.0, P:54
-->FUR:9.847752124869658e-08, FU:3.939100849947863e-07, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.1717363205070666e-24, FU:5.858681405320107e-24, P:5
-->FUR:4.315522801334737e-06, FU:2.1577614461421035e-05, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1524, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.046875, FU:3.0, P:64
-->FUR:0.08510638028383255, FU:4.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1165, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.02003519982099533, FU:1.0017600059509277, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1247, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1260, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0892857164144516, FU:5.0, P:56
-->FUR:0.34693869948387146, FU:16.999996185302734, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.25, FU:1.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1295, bias_loss:nan
-->after epoch 0
-->overall baseline on training dataset
-->ACC 0.9704065040650407
-->F1 0.9703357600782354
-->FPR: 0.048759804960780154
-->FNR: 0.009538598047914819
-->overall baseline on testing dataset
-->ACC 0.8973451327433628
-->F1 0.8990049751243782
-->FPR: 0.14774951076320939
-->FNR: 0.05442176870748299
training dataset
-->original metric score:
-->individual metric:0.12556053811659193, num_idi:364, num_all:2899
-->individual metric 0.12556053811659193
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9464285714285714
-->F1 0.9585454545454545
-->FPR 0.10077519379844961
-->FNR 0.026587887740029542
-->positive probability:0.6560150375939849, 698/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9442848937392303
-->F1 0.9653447659878527
-->FPR 0.17696629213483145
-->FNR 0.02454873646209386
-->positive probability:0.8121769098219415, 1414/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.94
-->F1 0.9565217391304348
-->FPR 0.125
-->FNR 0.029411764705882353
-->positive probability:0.7, 35/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963459196102314
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 412/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9833333333333333
-->F1 0.9915966386554621
-->FPR None
-->FNR 0.016666666666666666
-->positive probability:0.9833333333333333, 118/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9512195121951219
-->F1 0.9473684210526315
-->FPR 0.06666666666666667
-->FNR 0.02702702702702703
-->positive probability:0.47560975609756095, 39/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9310344827586207
-->F1 0.9166666666666666
-->FPR 0.058823529411764705
-->FNR 0.08333333333333333
-->positive probability:0.41379310344827586, 24/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.05201538883766946, 0.1282064871740513, 0.07624019503921985, 0.9512401950392199, 0.017906861705886512, 0.010063724450984551]
-->fnr_diff [0.017049289692114722, 0.015010138414179043, 0.019873166657967532, 0.009538598047914819, 0.009538598047914819, 0.007128068618751848, 0.01748842897911221, 0.07379473528541851]
-->FPR:[0.10077519379844961, 0.17696629213483145, 0.125, 1.0, 0.06666666666666667, 0.058823529411764705], mean FPR:0.2547052803352854, mean FPR diff:0.20594547537450525
-->FNR:[0.026587887740029542, 0.02454873646209386, 0.029411764705882353, 0.0, 0.0, 0.016666666666666666, 0.02702702702702703, 0.08333333333333333], mean FNR:0.0259469269918791, mean FNR diff:0.021177627967921688
-->mean fnr diff metric 0.20594547537450525
testing dataset
-->original metric score:
-->individual metric:0.13157894736842105, num_idi:160, num_all:1216
-->individual metric 0.13157894736842105
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8828633405639913
-->F1 0.9129032258064517
-->FPR 0.22981366459627328
-->FNR 0.056666666666666664
-->positive probability:0.6941431670281996, 320/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8924581005586593
-->F1 0.9343563512361466
-->FPR 0.36363636363636365
-->FNR 0.04363001745200698
-->positive probability:0.8379888268156425, 600/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9545454545454546
-->F1 0.9696969696969697
-->FPR 0.16666666666666666
-->FNR 0.0
-->positive probability:0.7727272727272727, 17/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7999999999999999
-->FPR 0.16
-->FNR 0.14285714285714285
-->positive probability:0.41025641025641024, 16/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.6818181818181818
-->F1 0.6956521739130436
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.0820641538330639, 0.21588685287315426, 0.018917155903457272, 0.3522504892367906, 0.8522504892367906, 0.012250489236790618, 0.3522504892367906]
-->fnr_diff [0.0022448979591836726, 0.01079175125547601, 0.05442176870748299, 0.05442176870748299, 0.05442176870748299, 0.05442176870748299, 0.08843537414965985, 0.05442176870748299]
-->FPR:[0.22981366459627328, 0.36363636363636365, 0.16666666666666666, 0.5, 1.0, 0.16, 0.5], mean FPR:0.41715952784275767, mean FPR diff:0.26941001707954826
-->FNR:[0.056666666666666664, 0.04363001745200698, 0.0, 0.0, 0.0, 0.0, 0.14285714285714285, 0.0], mean FNR:0.030394228371977063, mean FNR diff:0.046697608362716816
-->mean fnr diff metric 0.26941001707954826
-->epoch 1
-->start_index 0
-->batch_size 98
-->FUR:0.09090187400579453, FU:4.999603271484375, P:55
-->FUR:0.11763928085565567, FU:5.999603271484375, P:51
-->FUR:5.108366065162079e-37, FU:2.0433464260648315e-36, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.20000000298023224, FU:1.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.0907, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.1551724076271057, FU:9.0, P:58
-->FUR:0.2083333283662796, FU:10.0, P:48
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1320, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.12962962687015533, FU:7.0, P:54
-->FUR:4.013760644738795e-06, FU:1.605504257895518e-05, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.20000000298023224, FU:1.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1301, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.046875, FU:3.0, P:64
-->FUR:0.08510638028383255, FU:4.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:3.348660847768539e-16, FU:3.348660847768539e-16, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1138, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.04000177979469299, FU:2.000088930130005, P:50
-->FUR:0.03508928045630455, FU:2.000088930130005, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1131, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.10000000149011612, FU:5.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1198, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.08943989127874374, FU:5.008634090423584, P:56
-->FUR:0.3265306055545807, FU:16.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.25, FU:1.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1263, bias_loss:nan
-->after epoch 1
-->overall baseline on training dataset
-->ACC 0.9770189701897019
-->F1 0.9767492871243694
-->FPR: 0.033283866864532545
-->FNR: 0.012200532386867791
-->overall baseline on testing dataset
-->ACC 0.9049304677623262
-->F1 0.9047136340598074
-->FPR: 0.1223091976516634
-->FNR: 0.06593406593406594
training dataset
-->original metric score:
-->individual metric:0.12038634011728182, num_idi:349, num_all:2899
-->individual metric 0.12038634011728182
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9558270676691729
-->F1 0.9655172413793103
-->FPR 0.07235142118863049
-->FNR 0.028064992614475627
-->positive probability:0.6447368421052632, 686/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9494543365881677
-->F1 0.9681851048445408
-->FPR 0.11797752808988764
-->FNR 0.0332129963898917
-->positive probability:0.7932222860425043, 1381/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.94
-->F1 0.955223880597015
-->FPR 0.0625
-->FNR 0.058823529411764705
-->positive probability:0.66, 33/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9902912621359223
-->F1 0.9951219512195123
-->FPR 1.0
-->FNR 0.0024449877750611247
-->positive probability:0.9975728155339806, 411/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9833333333333333
-->F1 0.9915966386554621
-->FPR None
-->FNR 0.016666666666666666
-->positive probability:0.9833333333333333, 118/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9634146341463414
-->F1 0.9599999999999999
-->FPR 0.044444444444444446
-->FNR 0.02702702702702703
-->positive probability:0.4634146341463415, 38/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9361702127659574
-->FPR 0.029411764705882353
-->FNR 0.08333333333333333
-->positive probability:0.39655172413793105, 23/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.03906755432409794, 0.0846936612253551, 0.029216133135467455, 0.9667161331354674, 0.011160577579911901, 0.0038721021586501925]
-->fnr_diff [0.015864460227607836, 0.021012464003023906, 0.04662299702489692, 0.012200532386867791, 0.009755544611806666, 0.004466134279798875, 0.014826494640159237, 0.07113280094646554]
-->FPR:[0.07235142118863049, 0.11797752808988764, 0.0625, 1.0, 0.044444444444444446, 0.029411764705882353], mean FPR:0.22111419307147415, mean FPR diff:0.18912102692649166
-->FNR:[0.028064992614475627, 0.0332129963898917, 0.058823529411764705, 0.0, 0.0024449877750611247, 0.016666666666666666, 0.02702702702702703, 0.08333333333333333], mean FNR:0.031196691652277522, mean FNR diff:0.024485178515078344
-->mean fnr diff metric 0.18912102692649166
testing dataset
-->original metric score:
-->individual metric:0.14144736842105263, num_idi:172, num_all:1216
-->individual metric 0.14144736842105263
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.9002169197396963
-->F1 0.9243421052631579
-->FPR 0.16770186335403728
-->FNR 0.06333333333333334
-->positive probability:0.6681127982646421, 308/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8966480446927374
-->F1 0.935763888888889
-->FPR 0.27972027972027974
-->FNR 0.059336823734729496
-->positive probability:0.8086592178770949, 579/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9545454545454546
-->F1 0.9696969696969697
-->FPR 0.16666666666666666
-->FNR 0.0
-->positive probability:0.7727272727272727, 17/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8205128205128205
-->F1 0.7407407407407408
-->FPR 0.12
-->FNR 0.2857142857142857
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.7272727272727273
-->F1 0.7272727272727273
-->FPR 0.42857142857142855
-->FNR 0.0
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.04539266570237388, 0.15741108206861634, 0.04435746901500326, 0.37769080234833663, 0.8776908023483366, 0.0023091976516634027, 0.3062622309197651]
-->fnr_diff [0.002600732600732597, 0.006597242199336439, 0.06593406593406594, 0.06593406593406594, 0.06593406593406594, 0.06593406593406594, 0.21978021978021978, 0.06593406593406594]
-->FPR:[0.16770186335403728, 0.27972027972027974, 0.16666666666666666, 0.5, 1.0, 0.12, 0.42857142857142855], mean FPR:0.38038003404463033, mean FPR diff:0.25873060715058505
-->FNR:[0.06333333333333334, 0.059336823734729496, 0.0, 0.0, 0.0, 0.0, 0.2857142857142857, 0.0], mean FNR:0.05104805534779357, mean FNR diff:0.06983106553132731
-->mean fnr diff metric 0.25873060715058505
-->epoch 2
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.03921568766236305, FU:2.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.0804, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.13488197326660156, FU:7.823154449462891, P:58
-->FUR:0.12500005960464478, FU:6.000002861022949, P:48
-->FUR:5.4239932069322094e-05, FU:0.00016271979256998748, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1299, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1309, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.046875, FU:3.0, P:64
-->FUR:0.06382978707551956, FU:3.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1259, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:1.1836486853158564e-20, FU:5.918243604293867e-19, P:50
-->FUR:0.035087719559669495, FU:2.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1365, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.058741819113492966, FU:2.9370908737182617, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1638, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.08163265138864517, FU:4.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1195, bias_loss:nan
-->after epoch 2
-->overall baseline on training dataset
-->ACC 0.9833062330623307
-->F1 0.9828888888888888
-->FPR: 0.014627941488234047
-->FNR: 0.01885536823425022
-->overall baseline on testing dataset
-->ACC 0.9127686472819216
-->F1 0.9098510582701855
-->FPR: 0.08561643835616438
-->FNR: 0.08895866038723181
training dataset
-->original metric score:
-->individual metric:0.11383235598482236, num_idi:330, num_all:2899
-->individual metric 0.11383235598482236
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9464285714285714
-->F1 0.9569160997732425
-->FPR 0.03359173126614987
-->FNR 0.06499261447562776
-->positive probability:0.6071428571428571, 646/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9339460080413555
-->F1 0.9572331721829677
-->FPR 0.047752808988764044
-->FNR 0.07075812274368232
-->positive probability:0.7489948305571511, 1304/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.975
-->F1 0.9873417721518987
-->FPR None
-->FNR 0.025
-->positive probability:0.975, 117/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.018963789777915824, 0.033124867500529995, 0.014627941488234047, 0.6520387251784325, 0.007594280733988176, 0.014627941488234047]
-->fnr_diff [0.04613724624137754, 0.051902754509432096, 0.0987916905892792, 0.01885536823425022, 0.016410380459189095, 0.006144631765749781, 0.0892527398738579, 0.10614463176574979]
-->FPR:[0.03359173126614987, 0.047752808988764044, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1283722381906338, mean FPR diff:0.12349625769455579
-->FNR:[0.06499261447562776, 0.07075812274368232, 0.11764705882352941, 0.0, 0.0024449877750611247, 0.025, 0.10810810810810811, 0.125], mean FNR:0.06424386149075109, mean FNR diff:0.0542049304298607
-->mean fnr diff metric 0.12349625769455579
testing dataset
-->original metric score:
-->individual metric:0.13322368421052633, num_idi:162, num_all:1216
-->individual metric 0.13322368421052633
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8806941431670282
-->F1 0.9050086355785838
-->FPR 0.10559006211180125
-->FNR 0.12666666666666668
-->positive probability:0.6052060737527115, 279/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8729050279329609
-->F1 0.9177958446251129
-->FPR 0.18181818181818182
-->FNR 0.11343804537521815
-->positive probability:0.7458100558659218, 534/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.01997362375563687, 0.09620174346201744, 0.08105022831050228, 0.4143835616438356, 0.9143835616438356, 0.005616438356164377, 0.05724070450097847]
-->fnr_diff [0.037708006279434866, 0.02447938498798634, 0.03604133961276819, 0.08895866038723181, 0.08895866038723181, 0.08895866038723181, 0.19675562532705387, 0.03604133961276819]
-->FPR:[0.10559006211180125, 0.18181818181818182, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.3109902933505418, mean FPR diff:0.22697855166756722
-->FNR:[0.12666666666666668, 0.11343804537521815, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09697737471952131, mean FNR diff:0.07473770962271337
-->mean fnr diff metric 0.22697855166756722
-->epoch 3
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1020, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.0625, FU:3.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1491, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1498, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:3.0774191928384387e-16, FU:1.446387023281044e-14, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1275, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1305, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1392, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.09776709228754044, FU:4.790587425231934, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1282, bias_loss:nan
-->after epoch 3
-->overall baseline on training dataset
-->ACC 0.9795121951219512
-->F1 0.978950885399265
-->FPR: 0.016111935552257792
-->FNR: 0.025066548358473825
-->overall baseline on testing dataset
-->ACC 0.9089759797724399
-->F1 0.9050632911392406
-->FPR: 0.08072407045009784
-->FNR: 0.10204081632653061
training dataset
-->original metric score:
-->individual metric:0.11728182131769575, num_idi:340, num_all:2899
-->individual metric 0.11728182131769575
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9351503759398496
-->F1 0.9472073450650345
-->FPR 0.028423772609819122
-->FNR 0.08567208271787297
-->positive probability:0.5921052631578947, 630/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9264790350373349
-->F1 0.9520239880059971
-->FPR 0.03651685393258427
-->FNR 0.08303249097472924
-->positive probability:0.7369327972429638, 1283/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.86
-->F1 0.8852459016393442
-->FPR 0.0
-->FNR 0.20588235294117646
-->positive probability:0.54, 27/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9146341463414634
-->F1 0.8985507246376812
-->FPR 0.022222222222222223
-->FNR 0.16216216216216217
-->positive probability:0.3902439024390244, 32/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.01231183705756133, 0.020404918380326476, 0.016111935552257792, 0.6505547311144089, 0.006110286669964431, 0.016111935552257792]
-->fnr_diff [0.06060553435939914, 0.057965942616255414, 0.18081580458270263, 0.01190865362163172, 0.0226215605834127, 0.01660011830819284, 0.13709561380368834, 0.09993345164152617]
-->FPR:[0.028423772609819122, 0.03651685393258427, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12563825257188205, mean FPR diff:0.12026760738779611
-->FNR:[0.08567208271787297, 0.08303249097472924, 0.20588235294117646, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.16216216216216217, 0.125], mean FNR:0.08987732974681384, mean FNR diff:0.07344333493960112
-->mean fnr diff metric 0.12026760738779611
testing dataset
-->original metric score:
-->individual metric:0.12828947368421054, num_idi:156, num_all:1216
-->individual metric 0.12828947368421054
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8915401301518439
-->F1 0.9131944444444445
-->FPR 0.08074534161490683
-->FNR 0.12333333333333334
-->positive probability:0.5986984815618221, 276/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8701117318435754
-->F1 0.9150684931506848
-->FPR 0.14685314685314685
-->FNR 0.1256544502617801
-->positive probability:0.729050279329609, 522/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [2.1271164808989163e-05, 0.066129076403049, 0.08594259621656881, 0.41927592954990217, 0.9192759295499021, 0.0007240704500978412, 0.062133072407045006]
-->fnr_diff [0.021292517006802722, 0.023613633935249484, 0.022959183673469385, 0.10204081632653061, 0.10204081632653061, 0.10204081632653061, 0.11224489795918366, 0.022959183673469385]
-->FPR:[0.08074534161490683, 0.14685314685314685, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.3024460425702662, mean FPR diff:0.22192884939162488
-->FNR:[0.12333333333333334, 0.1256544502617801, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.08915918723510347, mean FNR diff:0.06364898315347081
-->mean fnr diff metric 0.22192884939162488
-->epoch 4
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:8.081047069473629e-30, FU:4.121334080663189e-28, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1041, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.06896551698446274, FU:4.0, P:58
-->FUR:0.0625, FU:3.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1543, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1692, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:3.7879256274051257e-20, FU:1.780325115966243e-18, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1366, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1419, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1519, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714216530323, FU:2.999999523162842, P:56
-->FUR:0.04081631451845169, FU:1.9999994039535522, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1288, bias_loss:nan
-->after epoch 4
-->overall baseline on training dataset
-->ACC 0.9800542005420054
-->F1 0.9794597008260773
-->FPR: 0.013355946576213695
-->FNR: 0.02684117125110914
-->overall baseline on testing dataset
-->ACC 0.9109987357774968
-->F1 0.9067796610169491
-->FPR: 0.074853228962818
-->FNR: 0.10413396127681843
training dataset
-->original metric score:
-->individual metric:0.11245256985167298, num_idi:326, num_all:2899
-->individual metric 0.11245256985167298
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9276315789473685
-->F1 0.9405405405405406
-->FPR 0.023255813953488372
-->FNR 0.10044313146233383
-->positive probability:0.5808270676691729, 618/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9178632969557725
-->F1 0.9459357277882797
-->FPR 0.025280898876404494
-->FNR 0.09675090252707581
-->positive probability:0.7237219988512349, 1260/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9736842105263158
-->F1 0.9866666666666666
-->FPR None
-->FNR 0.02631578947368421
-->positive probability:0.9736842105263158, 74/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9146341463414634
-->F1 0.8985507246376812
-->FPR 0.022222222222222223
-->FNR 0.16216216216216217
-->positive probability:0.3902439024390244, 32/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.009899867377274676, 0.011924952300190798, 0.013355946576213695, 0.6533107200904529, 0.008866275646008528, 0.013355946576213695]
-->fnr_diff [0.07360196021122468, 0.06990973127596667, 0.2084529463959497, 0.0005253817774249318, 0.024396183476048015, 0.014825495415557523, 0.13532099091105304, 0.09815882874889086]
-->FPR:[0.023255813953488372, 0.025280898876404494, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1229042669531303, mean FPR diff:0.11845228476105903
-->FNR:[0.10044313146233383, 0.09675090252707581, 0.23529411764705882, 0.02631578947368421, 0.0024449877750611247, 0.041666666666666664, 0.16216216216216217, 0.125], mean FNR:0.09875971971425533, mean FNR diff:0.07814893977651442
-->mean fnr diff metric 0.11845228476105903
testing dataset
-->original metric score:
-->individual metric:0.1225328947368421, num_idi:149, num_all:1216
-->individual metric 0.1225328947368421
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8828633405639913
-->F1 0.9052631578947369
-->FPR 0.07453416149068323
-->FNR 0.14
-->positive probability:0.5856832971800434, 270/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.86731843575419
-->F1 0.9129239230064161
-->FPR 0.13986013986013987
-->FNR 0.13089005235602094
-->positive probability:0.723463687150838, 518/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.00031906747213476805, 0.06500691089732187, 0.09181343770384866, 0.425146771037182, 0.925146771037182, 0.005146771037182002, 0.003424657534246575]
-->fnr_diff [0.03586603872318159, 0.026756091079202515, 0.020866038723181574, 0.10413396127681843, 0.10413396127681843, 0.10413396127681843, 0.11015175300889585, 0.020866038723181574]
-->FPR:[0.07453416149068323, 0.13986013986013987, 0.16666666666666666, 0.5, 1.0, 0.08, 0.07142857142857142], mean FPR:0.2903556484922945, mean FPR diff:0.2165720552455854
-->FNR:[0.14, 0.13089005235602094, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.0918969708302169, mean FNR diff:0.0658634805110123
-->mean fnr diff metric 0.2165720552455854
-->epoch 5
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.0, FU:0.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1045, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.0416666679084301, FU:2.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1537, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1756, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.0, FU:0.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1388, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1400, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1609, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.020408162847161293, FU:1.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1249, bias_loss:nan
-->after epoch 5
-->overall baseline on training dataset
-->ACC 0.9801626016260162
-->F1 0.9795872838817624
-->FPR: 0.01399194403222387
-->FNR: 0.025953859804791483
-->overall baseline on testing dataset
-->ACC 0.9122629582806574
-->F1 0.9082253372123776
-->FPR: 0.074853228962818
-->FNR: 0.10151753008895865
training dataset
-->original metric score:
-->individual metric:0.11314246291824767, num_idi:328, num_all:2899
-->individual metric 0.11314246291824767
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9257518796992481
-->F1 0.9389961389961389
-->FPR 0.025839793281653745
-->FNR 0.1019202363367799
-->positive probability:0.5808270676691729, 618/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9167145318782309
-->F1 0.9451381006432085
-->FPR 0.025280898876404494
-->FNR 0.09819494584837545
-->positive probability:0.7225732337736933, 1258/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9736842105263158
-->F1 0.9866666666666666
-->FPR None
-->FNR 0.02631578947368421
-->positive probability:0.9736842105263158, 74/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.011847849249429875, 0.011288954844180623, 0.01399194403222387, 0.6526747226344427, 0.008230278189998353, 0.01399194403222387]
-->fnr_diff [0.07596637653198843, 0.07224108604358397, 0.20934025784226734, 0.00036192966889272635, 0.023508872029730357, 0.01571280686187518, 0.10918127533034366, 0.09904614019520852]
-->FPR:[0.025839793281653745, 0.025280898876404494, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1233349301744912, mean FPR diff:0.11867094883041655
-->FNR:[0.1019202363367799, 0.09819494584837545, 0.23529411764705882, 0.02631578947368421, 0.0024449877750611247, 0.041666666666666664, 0.13513513513513514, 0.125], mean FNR:0.09574648486034516, mean FNR diff:0.07566984306298627
-->mean fnr diff metric 0.11867094883041655
testing dataset
-->original metric score:
-->individual metric:0.125, num_idi:152, num_all:1216
-->individual metric 0.125
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8785249457700651
-->F1 0.9017543859649123
-->FPR 0.08074534161490683
-->FNR 0.14333333333333334
-->positive probability:0.5856832971800434, 270/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.86731843575419
-->F1 0.9129239230064161
-->FPR 0.13986013986013987
-->FNR 0.13089005235602094
-->positive probability:0.723463687150838, 518/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.005892112652088832, 0.06500691089732187, 0.09181343770384866, 0.425146771037182, 0.925146771037182, 0.005146771037182002, 0.003424657534246575]
-->fnr_diff [0.041815803244374686, 0.029372522267062287, 0.023482469911041345, 0.10151753008895865, 0.10151753008895865, 0.10151753008895865, 0.11276818419675562, 0.023482469911041345]
-->FPR:[0.08074534161490683, 0.13986013986013987, 0.16666666666666666, 0.5, 1.0, 0.08, 0.07142857142857142], mean FPR:0.29124295993861216, mean FPR diff:0.2173682045570074
-->FNR:[0.14333333333333334, 0.13089005235602094, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.09231363749688357, mean FNR diff:0.0669342549746439
-->mean fnr diff metric 0.2173682045570074
-->epoch 6
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.0, FU:0.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1039, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.0416666679084301, FU:2.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1558, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1776, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.0, FU:0.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1362, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1354, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1521, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1251, bias_loss:nan
-->after epoch 6
-->overall baseline on training dataset
-->ACC 0.9797289972899729
-->F1 0.9791689874122759
-->FPR: 0.015687937248251006
-->FNR: 0.025066548358473825
-->overall baseline on testing dataset
-->ACC 0.9104930467762327
-->F1 0.9066455696202532
-->FPR: 0.07925636007827788
-->FNR: 0.10047095761381476
training dataset
-->original metric score:
-->individual metric:0.11590203518454639, num_idi:336, num_all:2899
-->individual metric 0.11590203518454639
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9266917293233082
-->F1 0.9399075500770416
-->FPR 0.028423772609819122
-->FNR 0.09896602658788774
-->positive probability:0.5836466165413534, 621/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.919586444572085
-->F1 0.9471698113207547
-->FPR 0.028089887640449437
-->FNR 0.09386281588447654
-->positive probability:0.726593911545089, 1265/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9736842105263158
-->F1 0.9866666666666666
-->FPR None
-->FNR 0.02631578947368421
-->positive probability:0.9736842105263158, 74/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.012735835361568117, 0.012401950392198432, 0.015687937248251006, 0.6509787294184156, 0.0065342849739712175, 0.015687937248251006]
-->fnr_diff [0.07389947822941391, 0.06879626752600271, 0.210227569288585, 0.0012492411152103845, 0.0226215605834127, 0.01660011830819284, 0.11006858677666131, 0.09993345164152617]
-->FPR:[0.028423772609819122, 0.028089887640449437, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12423375818985959, mean FPR diff:0.1190044457737759
-->FNR:[0.09896602658788774, 0.09386281588447654, 0.23529411764705882, 0.02631578947368421, 0.0024449877750611247, 0.041666666666666664, 0.13513513513513514, 0.125], mean FNR:0.09483569239624628, mean FNR diff:0.07542453418362563
-->mean fnr diff metric 0.1190044457737759
testing dataset
-->original metric score:
-->individual metric:0.12664473684210525, num_idi:154, num_all:1216
-->individual metric 0.12664473684210525
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8828633405639913
-->F1 0.9055944055944056
-->FPR 0.08074534161490683
-->FNR 0.13666666666666666
-->positive probability:0.5900216919739696, 272/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.86731843575419
-->F1 0.9129239230064161
-->FPR 0.13986013986013987
-->FNR 0.13089005235602094
-->positive probability:0.723463687150838, 518/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.00148898153662895, 0.06060377978186199, 0.08741030658838878, 0.42074363992172215, 0.9207436399217221, 0.0007436399217221196, 0.06360078277886497]
-->fnr_diff [0.036195709052851896, 0.03041909474220618, 0.024529042386185237, 0.10047095761381476, 0.10047095761381476, 0.10047095761381476, 0.11381475667189951, 0.024529042386185237]
-->FPR:[0.08074534161490683, 0.13986013986013987, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.3014470415712652, mean FPR diff:0.22219068149298732
-->FNR:[0.13666666666666666, 0.13089005235602094, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.09148030416355024, mean FNR diff:0.06636256476009655
-->mean fnr diff metric 0.22219068149298732
-->epoch 7
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.0, FU:0.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1009, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.04173241928219795, FU:2.0031561851501465, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1516, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1711, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.0, FU:0.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1313, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1309, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1447, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.040816400200128555, FU:2.0000035762786865, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1243, bias_loss:nan
-->after epoch 7
-->overall baseline on training dataset
-->ACC 0.9794037940379404
-->F1 0.9788748054258396
-->FPR: 0.017807928768284926
-->FNR: 0.023513753327417924
-->overall baseline on testing dataset
-->ACC 0.9112515802781289
-->F1 0.9075585988938636
-->FPR: 0.07974559686888454
-->FNR: 0.09837781266352695
training dataset
-->original metric score:
-->individual metric:0.11728182131769575, num_idi:340, num_all:2899
-->individual metric 0.11728182131769575
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9285714285714286
-->F1 0.9415384615384615
-->FPR 0.028423772609819122
-->FNR 0.09601181683899557
-->positive probability:0.5855263157894737, 623/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9218839747271683
-->F1 0.9488721804511276
-->FPR 0.03651685393258427
-->FNR 0.0888086642599278
-->positive probability:0.7323377369327972, 1275/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9736842105263158
-->F1 0.9866666666666666
-->FPR None
-->FNR 0.02631578947368421
-->positive probability:0.9736842105263158, 74/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9951456310679612
-->F1 0.9975609756097561
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.9975728155339806, 411/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.010615843841534196, 0.018708925164299343, 0.017807928768284926, 0.6488587378983817, 0.004414293453937297, 0.017807928768284926]
-->fnr_diff [0.07249806351157764, 0.06529491093250987, 0.2117803643196409, 0.0028020361462662846, 0.023513753327417924, 0.01815291333924874, 0.11162138180771722, 0.10148624667258208]
-->FPR:[0.028423772609819122, 0.03651685393258427, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12563825257188205, mean FPR diff:0.11970227631578706
-->FNR:[0.09601181683899557, 0.0888086642599278, 0.23529411764705882, 0.02631578947368421, 0.0, 0.041666666666666664, 0.13513513513513514, 0.125], mean FNR:0.09352902375268353, mean FNR diff:0.07589370875712009
-->mean fnr diff metric 0.11970227631578706
testing dataset
-->original metric score:
-->individual metric:0.12582236842105263, num_idi:153, num_all:1216
-->individual metric 0.12582236842105263
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8872017353579176
-->F1 0.9094076655052264
-->FPR 0.08074534161490683
-->FNR 0.13
-->positive probability:0.5943600867678959, 274/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8701117318435754
-->F1 0.9149130832570906
-->FPR 0.13986013986013987
-->FNR 0.1273996509598604
-->positive probability:0.7262569832402235, 520/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.0009997447460222963, 0.060114542991255335, 0.08692106979778212, 0.42025440313111545, 0.9202544031311155, 0.000254403131115466, 0.06311154598825831]
-->fnr_diff [0.031622187336473054, 0.029021838296333438, 0.02662218733647305, 0.09837781266352695, 0.09837781266352695, 0.09837781266352695, 0.11590790162218732, 0.02662218733647305]
-->FPR:[0.08074534161490683, 0.13986013986013987, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.3014470415712652, mean FPR diff:0.22170144470238062
-->FNR:[0.13, 0.1273996509598604, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.09021067065569684, mean FNR diff:0.0656162174898151
-->mean fnr diff metric 0.22170144470238062
-->epoch 8
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.0, FU:0.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.0979, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.0625, FU:3.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1484, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1658, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.0, FU:0.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1263, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1262, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1403, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0714285746216774, FU:4.0, P:56
-->FUR:0.10204081982374191, FU:5.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1207, bias_loss:nan
-->after epoch 8
-->overall baseline on training dataset
-->ACC 0.9800542005420054
-->F1 0.9795510113358523
-->FPR: 0.017595929616281536
-->FNR: 0.022404614019520853
-->overall baseline on testing dataset
-->ACC 0.911504424778761
-->F1 0.9080399369416712
-->FPR: 0.08170254403131115
-->FNR: 0.09576138147566719
training dataset
-->original metric score:
-->individual metric:0.1176267678509831, num_idi:341, num_all:2899
-->individual metric 0.1176267678509831
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9304511278195489
-->F1 0.9433384379785604
-->FPR 0.03359173126614987
-->FNR 0.09010339734121123
-->positive probability:0.5911654135338346, 629/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9236071223434807
-->F1 0.9501312335958007
-->FPR 0.042134831460674156
-->FNR 0.0851985559566787
-->positive probability:0.7363584147041929, 1282/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9736842105263158
-->F1 0.9866666666666666
-->FPR None
-->FNR 0.02631578947368421
-->positive probability:0.9736842105263158, 74/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9951456310679612
-->F1 0.9975609756097561
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.9975728155339806, 411/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.015995801649868337, 0.02453890184439262, 0.017595929616281536, 0.6490707370503851, 0.004626292605940687, 0.017595929616281536]
-->fnr_diff [0.06769878332169038, 0.06279394193715784, 0.21288950362753797, 0.003911175454163356, 0.022404614019520853, 0.01926205264714581, 0.1127305211156143, 0.10259538598047915]
-->FPR:[0.03359173126614987, 0.042134831460674156, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1274359086026188, mean FPR diff:0.12157059873052496
-->FNR:[0.09010339734121123, 0.0851985559566787, 0.23529411764705882, 0.02631578947368421, 0.0, 0.041666666666666664, 0.13513513513513514, 0.125], mean FNR:0.09233920777755436, mean FNR diff:0.0755357472629137
-->mean fnr diff metric 0.12157059873052496
testing dataset
-->original metric score:
-->individual metric:0.12828947368421054, num_idi:156, num_all:1216
-->individual metric 0.12828947368421054
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8872017353579176
-->F1 0.9094076655052264
-->FPR 0.08074534161490683
-->FNR 0.13
-->positive probability:0.5943600867678959, 274/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8715083798882681
-->F1 0.9159049360146252
-->FPR 0.13986013986013987
-->FNR 0.1256544502617801
-->positive probability:0.7276536312849162, 521/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.000957202416404318, 0.05815759582882872, 0.08496412263535551, 0.41829745596868884, 0.9182974559686888, 0.0017025440313111484, 0.0611545988258317]
-->fnr_diff [0.03423861852433281, 0.029893068786112906, 0.029238618524332807, 0.09576138147566719, 0.09576138147566719, 0.09576138147566719, 0.11852433281004708, 0.029238618524332807]
-->FPR:[0.08074534161490683, 0.13986013986013987, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.3014470415712652, mean FPR diff:0.22050442509644413
-->FNR:[0.13, 0.1256544502617801, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.0899925205684368, mean FNR diff:0.06605217519952
-->mean fnr diff metric 0.22050442509644413
-->epoch 9
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:1.6943821109801803e-24, FU:8.641348963214146e-23, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.0927, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.07224654406309128, FU:3.467833995819092, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1467, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1600, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.0, FU:0.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1261, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1309, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1468, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1286, bias_loss:nan
-->after epoch 9
-->overall baseline on training dataset
-->ACC 0.9752845528455285
-->F1 0.9744795164539959
-->FPR: 0.015475938096247616
-->FNR: 0.03438331854480923
-->overall baseline on testing dataset
-->ACC 0.9054361567635903
-->F1 0.9005847953216375
-->FPR: 0.07681017612524461
-->FNR: 0.11355311355311355
training dataset
-->original metric score:
-->individual metric:0.11728182131769575, num_idi:340, num_all:2899
-->individual metric 0.11728182131769575
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.924812030075188
-->F1 0.9381761978361669
-->FPR 0.025839793281653745
-->FNR 0.103397341211226
-->positive probability:0.5798872180451128, 617/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9109707064905227
-->F1 0.9410870391486127
-->FPR 0.02247191011235955
-->FNR 0.10613718411552346
-->positive probability:0.7156806433084434, 1246/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9736842105263158
-->F1 0.9866666666666666
-->FPR None
-->FNR 0.02631578947368421
-->positive probability:0.9736842105263158, 74/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9951456310679612
-->F1 0.9975609756097561
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.9975728155339806, 411/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9146341463414634
-->F1 0.8985507246376812
-->FPR 0.022222222222222223
-->FNR 0.16216216216216217
-->positive probability:0.3902439024390244, 32/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.01036385518540613, 0.006995972016111934, 0.015475938096247616, 0.651190728570419, 0.0067462841259746074, 0.015475938096247616]
-->fnr_diff [0.06901402266641676, 0.07175386557071423, 0.2009107991022496, 0.00806752907112502, 0.03438331854480923, 0.007283348121857436, 0.12777884361735295, 0.09061668145519078]
-->FPR:[0.025839793281653745, 0.02247191011235955, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12286676538048369, mean FPR diff:0.11770811934840114
-->FNR:[0.103397341211226, 0.10613718411552346, 0.23529411764705882, 0.02631578947368421, 0.0, 0.041666666666666664, 0.16216216216216217, 0.125], mean FNR:0.09999665765954016, mean FNR diff:0.0762260510187145
-->mean fnr diff metric 0.11770811934840114
testing dataset
-->original metric score:
-->individual metric:0.12417763157894737, num_idi:151, num_all:1216
-->individual metric 0.12417763157894737
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8806941431670282
-->F1 0.9029982363315697
-->FPR 0.06832298136645963
-->FNR 0.14666666666666667
-->positive probability:0.579175704989154, 267/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8645251396648045
-->F1 0.9105990783410138
-->FPR 0.1258741258741259
-->FNR 0.13787085514834205
-->positive probability:0.7150837988826816, 512/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.008487194758784983, 0.04906394974888127, 0.08985649054142204, 0.4231898238747554, 0.9231898238747553, 0.0031898238747553875, 0.06604696673189824]
-->fnr_diff [0.033113553113553115, 0.024317741595228495, 0.011446886446886448, 0.11355311355311355, 0.11355311355311355, 0.11355311355311355, 0.10073260073260072, 0.011446886446886448]
-->FPR:[0.06832298136645963, 0.1258741258741259, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.2976744166806279, mean FPR diff:0.2232891533436075
-->FNR:[0.14666666666666667, 0.13787085514834205, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.09360290451259037, mean FNR diff:0.06521462612431199
-->mean fnr diff metric 0.2232891533436075
-->epoch 10
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.0008206817437894642, FU:0.04185476899147034, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.008389330469071865, FU:0.0419466532766819, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1103, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.06896551698446274, FU:4.0, P:58
-->FUR:0.0416666679084301, FU:2.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1662, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1824, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.06916654109954834, FU:4.426658630371094, P:64
-->FUR:0.06382978707551956, FU:3.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1638, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1619, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1643, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.125, FU:7.0, P:56
-->FUR:0.06124697998166084, FU:3.0011019706726074, P:49
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1868, bias_loss:nan
-->after epoch 10
-->overall baseline on training dataset
-->ACC 0.9482926829268292
-->F1 0.9474727452923687
-->FPR: 0.05745177019291923
-->FNR: 0.04569653948535936
-->overall baseline on testing dataset
-->ACC 0.8783817951959545
-->F1 0.875291677469536
-->FPR: 0.12622309197651663
-->FNR: 0.11669283097854527
training dataset
-->original metric score:
-->individual metric:0.1279751638496033, num_idi:371, num_all:2899
-->individual metric 0.1279751638496033
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.8984962406015038
-->F1 0.9173047473200613
-->FPR 0.07751937984496124
-->FNR 0.11521418020679468
-->positive probability:0.5911654135338346, 629/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.8920160827110856
-->F1 0.9289493575207861
-->FPR 0.0898876404494382
-->FNR 0.11263537906137185
-->positive probability:0.7242963813900057, 1261/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.82
-->F1 0.8524590163934426
-->FPR 0.0625
-->FNR 0.23529411764705882
-->positive probability:0.54, 27/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9736842105263158
-->F1 0.9866666666666666
-->FPR None
-->FNR 0.02631578947368421
-->positive probability:0.9736842105263158, 74/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963459196102314
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 412/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.8902439024390244
-->F1 0.88
-->FPR 0.1111111111111111
-->FNR 0.10810810810810811
-->positive probability:0.4634146341463415, 38/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.8793103448275862
-->F1 0.851063829787234
-->FPR 0.08823529411764706
-->FNR 0.16666666666666666
-->positive probability:0.39655172413793105, 23/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.02006760965204201, 0.03243587025651897, 0.005048229807080772, 0.9425482298070808, 0.053659340918191877, 0.030783523924727836]
-->fnr_diff [0.06951764072143532, 0.06693883957601249, 0.18959757816169948, 0.01938075001167515, 0.04569653948535936, 0.004029872818692694, 0.062411568622748756, 0.1209701271813073]
-->FPR:[0.07751937984496124, 0.0898876404494382, 0.0625, 1.0, 0.1111111111111111, 0.08823529411764706], mean FPR:0.23820890425385957, mean FPR diff:0.18075713406094038
-->FNR:[0.11521418020679468, 0.11263537906137185, 0.23529411764705882, 0.02631578947368421, 0.0, 0.041666666666666664, 0.10810810810810811, 0.16666666666666666], mean FNR:0.10073761347879387, mean FNR diff:0.07231786457236632
-->mean fnr diff metric 0.18075713406094038
testing dataset
-->original metric score:
-->individual metric:0.13157894736842105, num_idi:160, num_all:1216
-->individual metric 0.13157894736842105
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8720173535791758
-->F1 0.8977469670710572
-->FPR 0.11180124223602485
-->FNR 0.13666666666666666
-->positive probability:0.6008676789587852, 277/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8463687150837989
-->F1 0.8985239852398523
-->FPR 0.16783216783216784
-->FNR 0.15008726003490402
-->positive probability:0.7136871508379888, 511/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.01442184974049178, 0.04160907585565121, 0.04044357469015003, 0.3737769080234834, 0.8737769080234834, 0.046223091976516625, 0.08806262230919765]
-->fnr_diff [0.01997383568812139, 0.033394429056358754, 0.00830716902145473, 0.11669283097854527, 0.11669283097854527, 0.11669283097854527, 0.097592883307169, 0.00830716902145473]
-->FPR:[0.11180124223602485, 0.16783216783216784, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.32008368443151053, mean FPR diff:0.21118771865985342
-->FNR:[0.13666666666666666, 0.15008726003490402, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.09387995512341063, mean FNR diff:0.0647067473787743
-->mean fnr diff metric 0.21118771865985342
-->epoch 11
-->start_index 0
-->batch_size 98
-->FUR:0.072727270424366, FU:4.0, P:55
-->FUR:0.13725490868091583, FU:7.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.4000000059604645, FU:2.0, P:5
-->FUR:0.4285714328289032, FU:3.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1568, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.12068965286016464, FU:7.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.2032, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.1111498773097992, FU:6.002093315124512, P:54
-->FUR:0.25, FU:1.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.4000000059604645, FU:2.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.2255, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.078125, FU:5.0, P:64
-->FUR:0.08510638028383255, FU:4.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1929, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.07017543911933899, FU:4.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1844, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.2826141086094778e-19, FU:5.130456434437911e-19, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1803, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.125, FU:7.0, P:56
-->FUR:0.10204081982374191, FU:5.0, P:49
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.2120, bias_loss:nan
-->after epoch 11
-->overall baseline on training dataset
-->ACC 0.9412466124661246
-->F1 0.9407909110771248
-->FPR: 0.07207971168115328
-->FNR: 0.04480922803904171
-->overall baseline on testing dataset
-->ACC 0.8705436156763591
-->F1 0.8685831622176591
-->FPR: 0.14334637964774952
-->FNR: 0.11459968602825746
training dataset
-->original metric score:
-->individual metric:0.128665056916178, num_idi:373, num_all:2899
-->individual metric 0.128665056916178
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.8919172932330827
-->F1 0.9126803340926348
-->FPR 0.10077519379844961
-->FNR 0.11225997045790251
-->positive probability:0.6015037593984962, 640/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.8891441700172314
-->F1 0.9273616861121565
-->FPR 0.11235955056179775
-->FNR 0.11046931407942238
-->positive probability:0.7306145893164848, 1272/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.78
-->F1 0.8253968253968255
-->FPR 0.1875
-->FNR 0.23529411764705882
-->positive probability:0.58, 29/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9736842105263158
-->F1 0.9866666666666666
-->FPR None
-->FNR 0.02631578947368421
-->positive probability:0.9736842105263158, 74/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963459196102314
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 412/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.8780487804878049
-->F1 0.868421052631579
-->FPR 0.13333333333333333
-->FNR 0.10810810810810811
-->positive probability:0.47560975609756095, 39/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.8793103448275862
-->F1 0.851063829787234
-->FPR 0.08823529411764706
-->FNR 0.16666666666666666
-->positive probability:0.39655172413793105, 23/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.028695482117296334, 0.04027983888064447, 0.11542028831884672, 0.9279202883188468, 0.061253621652180054, 0.016155582436493787]
-->fnr_diff [0.0674507424188608, 0.06566008604038068, 0.19048488960801713, 0.018493438565357498, 0.04480922803904171, 0.0031425613723750426, 0.06329888006906641, 0.12185743862762495]
-->FPR:[0.10077519379844961, 0.11235955056179775, 0.1875, 1.0, 0.13333333333333333, 0.08823529411764706], mean FPR:0.2703672286352046, mean FPR diff:0.19828751695405133
-->FNR:[0.11225997045790251, 0.11046931407942238, 0.23529411764705882, 0.02631578947368421, 0.0, 0.041666666666666664, 0.10810810810810811, 0.16666666666666666], mean FNR:0.10009757913743866, mean FNR diff:0.07189965809259052
-->mean fnr diff metric 0.19828751695405133
testing dataset
-->original metric score:
-->individual metric:0.13733552631578946, num_idi:167, num_all:1216
-->individual metric 0.13733552631578946
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8655097613882863
-->F1 0.8931034482758621
-->FPR 0.13043478260869565
-->FNR 0.13666666666666666
-->positive probability:0.6073752711496746, 280/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8449720670391061
-->F1 0.8976958525345622
-->FPR 0.17482517482517482
-->FNR 0.15008726003490402
-->positive probability:0.7150837988826816, 512/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.012911597039053868, 0.0314787951774253, 0.02332028701891714, 0.35665362035225046, 0.8566536203522505, 0.06334637964774952, 0.07093933463796476]
-->fnr_diff [0.0220669806384092, 0.035487574006646566, 0.010400313971742542, 0.11459968602825746, 0.11459968602825746, 0.11459968602825746, 0.09968602825745682, 0.010400313971742542]
-->FPR:[0.13043478260869565, 0.17482517482517482, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3237446197694645, mean FPR diff:0.20218623346080164
-->FNR:[0.13666666666666666, 0.15008726003490402, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.09387995512341063, mean FNR diff:0.06523003361634626
-->mean fnr diff metric 0.20218623346080164
-->epoch 12
-->start_index 0
-->batch_size 98
-->FUR:0.12727272510528564, FU:7.0, P:55
-->FUR:0.19607843458652496, FU:10.0, P:51
-->FUR:0.25, FU:1.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.4000000059604645, FU:2.0, P:5
-->FUR:0.4285714328289032, FU:3.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1790, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.12068965286016464, FU:7.0, P:58
-->FUR:0.104166679084301, FU:5.000000476837158, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.2121, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.12962962687015533, FU:7.0, P:54
-->FUR:0.25, FU:1.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.4000000059604645, FU:2.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.2309, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.09374997764825821, FU:5.999998569488525, P:64
-->FUR:0.08510638028383255, FU:4.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1928, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0800132155418396, FU:4.0006608963012695, P:50
-->FUR:0.08422686904668808, FU:4.800931453704834, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1828, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1756, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.125, FU:7.0, P:56
-->FUR:0.06122449040412903, FU:3.0, P:49
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1969, bias_loss:nan
-->after epoch 12
-->overall baseline on training dataset
-->ACC 0.9546883468834688
-->F1 0.9539647577092512
-->FPR: 0.05109179563281747
-->FNR: 0.039263531499556345
-->overall baseline on testing dataset
-->ACC 0.8826801517067003
-->F1 0.8794178794178795
-->FPR: 0.11986301369863013
-->FNR: 0.11459968602825746
training dataset
-->original metric score:
-->individual metric:0.12969989651604003, num_idi:376, num_all:2899
-->individual metric 0.12969989651604003
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9069548872180451
-->F1 0.9246001523229246
-->FPR 0.07493540051679587
-->FNR 0.103397341211226
-->positive probability:0.5977443609022557, 636/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.8977599080987938
-->F1 0.93293142426526
-->FPR 0.08707865168539326
-->FNR 0.10613718411552346
-->positive probability:0.7288914417001723, 1269/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.82
-->F1 0.8524590163934426
-->FPR 0.0625
-->FNR 0.23529411764705882
-->positive probability:0.54, 27/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9736842105263158
-->F1 0.9866666666666666
-->FPR None
-->FNR 0.02631578947368421
-->positive probability:0.9736842105263158, 74/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963459196102314
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 412/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.8780487804878049
-->F1 0.8648648648648649
-->FPR 0.1111111111111111
-->FNR 0.13513513513513514
-->positive probability:0.45121951219512196, 37/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.8793103448275862
-->F1 0.851063829787234
-->FPR 0.08823529411764706
-->FNR 0.16666666666666666
-->positive probability:0.39655172413793105, 23/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.023843604883978402, 0.035986856052575796, 0.011408204367182533, 0.9489082043671825, 0.06001931547829364, 0.0371434984848296]
-->fnr_diff [0.06413380971166965, 0.06687365261596712, 0.19603058614750246, 0.012947742025872136, 0.039263531499556345, 0.0024031351671103193, 0.0958716036355788, 0.12740313516711033]
-->FPR:[0.07493540051679587, 0.08707865168539326, 0.0625, 1.0, 0.1111111111111111, 0.08823529411764706], mean FPR:0.2373100762384912, mean FPR diff:0.18621828060567372
-->FNR:[0.103397341211226, 0.10613718411552346, 0.23529411764705882, 0.02631578947368421, 0.0, 0.041666666666666664, 0.13513513513513514, 0.16666666666666666], mean FNR:0.10182661261449513, mean FNR diff:0.0756158994962959
-->mean fnr diff metric 0.18621828060567372
testing dataset
-->original metric score:
-->individual metric:0.13157894736842105, num_idi:160, num_all:1216
-->individual metric 0.13157894736842105
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8698481561822126
-->F1 0.8961937716262975
-->FPR 0.11801242236024845
-->FNR 0.13666666666666666
-->positive probability:0.6030368763557483, 278/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8463687150837989
-->F1 0.8987108655616943
-->FPR 0.17482517482517482
-->FNR 0.14834205933682373
-->positive probability:0.7164804469273743, 513/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.0018505913383816824, 0.05496216112654469, 0.04680365296803653, 0.3801369863013699, 0.8801369863013698, 0.03986301369863013, 0.09442270058708414]
-->fnr_diff [0.0220669806384092, 0.033742373308566276, 0.010400313971742542, 0.11459968602825746, 0.11459968602825746, 0.11459968602825746, 0.09968602825745682, 0.010400313971742542]
-->FPR:[0.11801242236024845, 0.17482517482517482, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3219699968768292, mean FPR diff:0.2140251560459167
-->FNR:[0.13666666666666666, 0.14834205933682373, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.09366180503615058, mean FNR diff:0.06501188352908623
-->mean fnr diff metric 0.2140251560459167
-->epoch 13
-->start_index 0
-->batch_size 98
-->FUR:0.05454545468091965, FU:3.0, P:55
-->FUR:0.13725490868091583, FU:7.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.4000000059604645, FU:2.0, P:5
-->FUR:0.4285714328289032, FU:3.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1469, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.12068965286016464, FU:7.0, P:58
-->FUR:0.125, FU:6.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1892, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:4.96704752481352e-18, FU:2.48352376240676e-17, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1917, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.0625, FU:4.0, P:64
-->FUR:0.06382978707551956, FU:3.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1568, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1539, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1612, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.12499984353780746, FU:6.999991416931152, P:56
-->FUR:0.06122449040412903, FU:3.0, P:49
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1640, bias_loss:nan
-->after epoch 13
-->overall baseline on training dataset
-->ACC 0.967479674796748
-->F1 0.966696269982238
-->FPR: 0.03095187619249523
-->FNR: 0.034161490683229816
-->overall baseline on testing dataset
-->ACC 0.8981036662452592
-->F1 0.8939752696658774
-->FPR: 0.09344422700587084
-->FNR: 0.1109366823652538
training dataset
-->original metric score:
-->individual metric:0.12314591238358054, num_idi:357, num_all:2899
-->individual metric 0.12314591238358054
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9191729323308271
-->F1 0.934250764525994
-->FPR 0.05167958656330749
-->FNR 0.09748892171344166
-->positive probability:0.5930451127819549, 631/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9063756461803562
-->F1 0.9384208537967511
-->FPR 0.056179775280898875
-->FNR 0.10324909747292418
-->positive probability:0.7248707639287766, 1262/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.82
-->F1 0.8524590163934426
-->FPR 0.0625
-->FNR 0.23529411764705882
-->positive probability:0.54, 27/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9736842105263158
-->F1 0.9866666666666666
-->FPR None
-->FNR 0.02631578947368421
-->positive probability:0.9736842105263158, 74/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963459196102314
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 412/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9024390243902439
-->F1 0.888888888888889
-->FPR 0.06666666666666667
-->FNR 0.13513513513513514
-->positive probability:0.4268292682926829, 35/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9137931034482759
-->F1 0.888888888888889
-->FPR 0.029411764705882353
-->FNR 0.16666666666666666
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.02072771037081226, 0.025227899088403644, 0.03154812380750477, 0.9690481238075048, 0.035714790474171434, 0.0015401114866128787]
-->fnr_diff [0.06332743103021185, 0.06908760678969436, 0.201132626963829, 0.007845701209545607, 0.034161490683229816, 0.007505175983436849, 0.10097364445190532, 0.13250517598343683]
-->FPR:[0.05167958656330749, 0.056179775280898875, 0.0625, 1.0, 0.06666666666666667, 0.029411764705882353], mean FPR:0.21107296553612587, mean FPR diff:0.1806344598391683
-->FNR:[0.09748892171344166, 0.10324909747292418, 0.23529411764705882, 0.02631578947368421, 0.0, 0.041666666666666664, 0.13513513513513514, 0.16666666666666666], mean FNR:0.10072704934694718, mean FNR diff:0.07706735663691121
-->mean fnr diff metric 0.1806344598391683
testing dataset
-->original metric score:
-->individual metric:0.12746710526315788, num_idi:155, num_all:1216
-->individual metric 0.12746710526315788
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8698481561822126
-->F1 0.8958333333333334
-->FPR 0.11180124223602485
-->FNR 0.14
-->positive probability:0.5986984815618221, 276/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8589385474860335
-->F1 0.9070837166513339
-->FPR 0.14685314685314685
-->FNR 0.13961605584642234
-->positive probability:0.7178770949720671, 514/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.01835701523015401, 0.05340891984727601, 0.07322243966079582, 0.40655577299412915, 0.9065557729941291, 0.013444227005870835, 0.12084148727984344]
-->fnr_diff [0.02906331763474622, 0.028679373481168544, 0.014063317634746206, 0.1109366823652538, 0.1109366823652538, 0.1109366823652538, 0.10334903192046048, 0.014063317634746206]
-->FPR:[0.11180124223602485, 0.14685314685314685, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3170866814345076, mean FPR diff:0.22748366214459975
-->FNR:[0.14, 0.13961605584642234, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.09298772126651708, mean FNR diff:0.06525355067520364
-->mean fnr diff metric 0.22748366214459975
-->epoch 14
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.05882352963089943, FU:3.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.20000000298023224, FU:1.0, P:5
-->FUR:0.1428571492433548, FU:1.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1173, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1736, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518565222620964, FU:1.0000025033950806, P:54
-->FUR:0.09259208291769028, FU:4.999972343444824, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1724, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.046875, FU:3.0, P:64
-->FUR:0.06382978707551956, FU:3.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1412, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1469, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1577, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0892857164144516, FU:5.0, P:56
-->FUR:0.06122449040412903, FU:3.0, P:49
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1510, bias_loss:nan
-->after epoch 14
-->overall baseline on training dataset
-->ACC 0.9713821138211383
-->F1 0.9706601466992665
-->FPR: 0.026075895696417214
-->FNR: 0.03127772848269743
-->overall baseline on testing dataset
-->ACC 0.9003792667509481
-->F1 0.8962611901000528
-->FPR: 0.09050880626223091
-->FNR: 0.10936682365253794
training dataset
-->original metric score:
-->individual metric:0.12556053811659193, num_idi:364, num_all:2899
-->individual metric 0.12556053811659193
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9191729323308271
-->F1 0.9340490797546012
-->FPR 0.046511627906976744
-->FNR 0.10044313146233383
-->positive probability:0.5892857142857143, 627/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.909821941412981
-->F1 0.94082171127026
-->FPR 0.056179775280898875
-->FNR 0.09891696750902527
-->positive probability:0.7283170591614015, 1268/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.82
-->F1 0.8524590163934426
-->FPR 0.0625
-->FNR 0.23529411764705882
-->positive probability:0.54, 27/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9736842105263158
-->F1 0.9866666666666666
-->FPR None
-->FNR 0.02631578947368421
-->positive probability:0.9736842105263158, 74/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963459196102314
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 412/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9146341463414634
-->F1 0.9014084507042254
-->FPR 0.044444444444444446
-->FNR 0.13513513513513514
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9310344827586207
-->F1 0.9130434782608695
-->FPR 0.029411764705882353
-->FNR 0.125
-->positive probability:0.3793103448275862, 22/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.02043573221055953, 0.03010387958448166, 0.03642410430358278, 0.9739241043035828, 0.018368548748027232, 0.0033358690094651387]
-->fnr_diff [0.0691654029796364, 0.06763923902632785, 0.20401638916436138, 0.004961939009013219, 0.03127772848269743, 0.010388938183969236, 0.10385740665243771, 0.09372227151730257]
-->FPR:[0.046511627906976744, 0.056179775280898875, 0.0625, 1.0, 0.044444444444444446, 0.029411764705882353], mean FPR:0.2065079353897004, mean FPR diff:0.18043203969328317
-->FNR:[0.10044313146233383, 0.09891696750902527, 0.23529411764705882, 0.02631578947368421, 0.0, 0.041666666666666664, 0.13513513513513514, 0.125], mean FNR:0.095346475986738, mean FNR diff:0.07312866437696822
-->mean fnr diff metric 0.18043203969328317
testing dataset
-->original metric score:
-->individual metric:0.125, num_idi:152, num_all:1216
-->individual metric 0.125
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8806941431670282
-->F1 0.9043478260869566
-->FPR 0.09316770186335403
-->FNR 0.13333333333333333
-->positive probability:0.596529284164859, 275/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8659217877094972
-->F1 0.9119266055045873
-->FPR 0.13986013986013987
-->FNR 0.13263525305410123
-->positive probability:0.7220670391061452, 517/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.002658895601123118, 0.049351333597908956, 0.07615786040443574, 0.4094911937377691, 0.9094911937377691, 0.010508806262230913, 0.052348336594911934]
-->fnr_diff [0.02396650968079539, 0.02326842940156329, 0.015633176347462058, 0.10936682365253794, 0.10936682365253794, 0.10936682365253794, 0.10491889063317633, 0.015633176347462058]
-->FPR:[0.09316770186335403, 0.13986013986013987, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.3032216644639005, mean FPR diff:0.2157153742765927
-->FNR:[0.13333333333333333, 0.13263525305410123, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.09128178758414361, mean FNR diff:0.06394008167100912
-->mean fnr diff metric 0.2157153742765927
-->epoch 15
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.03921568766236305, FU:2.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.20000000298023224, FU:1.0, P:5
-->FUR:0.1428571492433548, FU:1.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1086, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1681, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1660, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.046875, FU:3.0, P:64
-->FUR:0.06375820934772491, FU:2.996635675430298, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1346, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:1.7822672320182836e-13, FU:8.911336078776255e-12, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1433, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1555, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0714285746216774, FU:4.0, P:56
-->FUR:0.06122449040412903, FU:3.0, P:49
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1442, bias_loss:nan
-->after epoch 15
-->overall baseline on training dataset
-->ACC 0.9734417344173442
-->F1 0.9727687006780038
-->FPR: 0.023955904176383293
-->FNR: 0.029281277728482696
-->overall baseline on testing dataset
-->ACC 0.9031605562579014
-->F1 0.8989712476919018
-->FPR: 0.08610567514677103
-->FNR: 0.10832025117739404
training dataset
-->original metric score:
-->individual metric:0.12280096585029321, num_idi:356, num_all:2899
-->individual metric 0.12280096585029321
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9238721804511278
-->F1 0.937740199846272
-->FPR 0.03617571059431524
-->FNR 0.09896602658788774
-->positive probability:0.5864661654135338, 624/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.913268236645606
-->F1 0.9430833019223521
-->FPR 0.047752808988764044
-->FNR 0.09675090252707581
-->positive probability:0.7283170591614015, 1268/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.82
-->F1 0.8524590163934426
-->FPR 0.0625
-->FNR 0.23529411764705882
-->positive probability:0.54, 27/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9736842105263158
-->F1 0.9866666666666666
-->FPR None
-->FNR 0.02631578947368421
-->positive probability:0.9736842105263158, 74/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963459196102314
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 412/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9024390243902439
-->F1 0.8857142857142858
-->FPR 0.044444444444444446
-->FNR 0.16216216216216217
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9310344827586207
-->F1 0.9130434782608695
-->FPR 0.029411764705882353
-->FNR 0.125
-->positive probability:0.3793103448275862, 22/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.01221980641793195, 0.02379690481238075, 0.0385440958236167, 0.9760440958236167, 0.020488540268061153, 0.005455860529499059]
-->fnr_diff [0.06968474885940504, 0.06746962479859311, 0.20601283991857613, 0.0029654882547984866, 0.029281277728482696, 0.012385388938183969, 0.13288088443367949, 0.0957187222715173]
-->FPR:[0.03617571059431524, 0.047752808988764044, 0.0625, 1.0, 0.044444444444444446, 0.029411764705882353], mean FPR:0.20338078812223434, mean FPR diff:0.17942488394585107
-->FNR:[0.09896602658788774, 0.09675090252707581, 0.23529411764705882, 0.02631578947368421, 0.0, 0.041666666666666664, 0.16216216216216217, 0.125], mean FNR:0.09826945813306692, mean FNR diff:0.07704987190040453
-->mean fnr diff metric 0.17942488394585107
testing dataset
-->original metric score:
-->individual metric:0.12171052631578948, num_idi:148, num_all:1216
-->individual metric 0.12171052631578948
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8872017353579176
-->F1 0.9097222222222222
-->FPR 0.08695652173913043
-->FNR 0.12666666666666668
-->positive probability:0.5986984815618221, 276/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8701117318435754
-->F1 0.9147571035747022
-->FPR 0.13286713286713286
-->FNR 0.12914485165794065
-->positive probability:0.723463687150838, 518/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.0008508465923594, 0.04676145772036183, 0.08056099151989563, 0.41389432485322897, 0.913894324853229, 0.006105675146771031, 0.05675146771037182]
-->fnr_diff [0.01834641548927264, 0.020824600480546615, 0.016679748822605964, 0.10832025117739404, 0.10832025117739404, 0.10832025117739404, 0.10596546310832024, 0.016679748822605964]
-->FPR:[0.08695652173913043, 0.13286713286713286, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.3013353520185818, mean FPR diff:0.21697415548517393
-->FNR:[0.12666666666666668, 0.12914485165794065, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.09001215407629021, mean FNR diff:0.06293209128194169
-->mean fnr diff metric 0.21697415548517393
-->epoch 16
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.03921568766236305, FU:2.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.20000000298023224, FU:1.0, P:5
-->FUR:0.1428571492433548, FU:1.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1039, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.06896551698446274, FU:4.0, P:58
-->FUR:0.0625, FU:3.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1645, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1626, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.021276595070958138, FU:1.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1308, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1406, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1533, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0714285746216774, FU:4.0, P:56
-->FUR:0.06122449040412903, FU:3.0, P:49
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1407, bias_loss:nan
-->after epoch 16
-->overall baseline on training dataset
-->ACC 0.9744173441734417
-->F1 0.9737661182747889
-->FPR: 0.022895908416366333
-->FNR: 0.02839396628216504
-->overall baseline on testing dataset
-->ACC 0.9046776232616941
-->F1 0.9005539435505143
-->FPR: 0.08463796477495107
-->FNR: 0.10675039246467818
training dataset
-->original metric score:
-->individual metric:0.12211107278371852, num_idi:354, num_all:2899
-->individual metric 0.12211107278371852
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9238721804511278
-->F1 0.937740199846272
-->FPR 0.03617571059431524
-->FNR 0.09896602658788774
-->positive probability:0.5864661654135338, 624/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9138426191843768
-->F1 0.9434815373021853
-->FPR 0.047752808988764044
-->FNR 0.096028880866426
-->positive probability:0.7288914417001723, 1269/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.82
-->F1 0.8524590163934426
-->FPR 0.0625
-->FNR 0.23529411764705882
-->positive probability:0.54, 27/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9736842105263158
-->F1 0.9866666666666666
-->FPR None
-->FNR 0.02631578947368421
-->positive probability:0.9736842105263158, 74/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963459196102314
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 412/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9024390243902439
-->F1 0.8857142857142858
-->FPR 0.044444444444444446
-->FNR 0.16216216216216217
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9310344827586207
-->F1 0.9130434782608695
-->FPR 0.029411764705882353
-->FNR 0.125
-->positive probability:0.3793103448275862, 22/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.01327980217794891, 0.02485690057239771, 0.03960409158363366, 0.9771040915836336, 0.021548536028078113, 0.006515856289516019]
-->fnr_diff [0.07057206030572269, 0.06763491458426096, 0.2069001513648938, 0.002078176808480832, 0.02839396628216504, 0.013272700384501623, 0.13376819587999714, 0.09660603371783497]
-->FPR:[0.03617571059431524, 0.047752808988764044, 0.0625, 1.0, 0.044444444444444446, 0.029411764705882353], mean FPR:0.20338078812223434, mean FPR diff:0.18048487970586802
-->FNR:[0.09896602658788774, 0.096028880866426, 0.23529411764705882, 0.02631578947368421, 0.0, 0.041666666666666664, 0.16216216216216217, 0.125], mean FNR:0.09817920542548571, mean FNR diff:0.07740327491598213
-->mean fnr diff metric 0.18048487970586802
testing dataset
-->original metric score:
-->individual metric:0.12417763157894737, num_idi:151, num_all:1216
-->individual metric 0.12417763157894737
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8872017353579176
-->F1 0.9097222222222222
-->FPR 0.08695652173913043
-->FNR 0.12666666666666668
-->positive probability:0.5986984815618221, 276/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8701117318435754
-->F1 0.9149130832570906
-->FPR 0.13986013986013987
-->FNR 0.1273996509598604
-->positive probability:0.7262569832402235, 520/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.0023185569641793607, 0.0552221750851888, 0.08202870189171559, 0.41536203522504894, 0.9153620352250489, 0.00463796477495107, 0.05821917808219178]
-->fnr_diff [0.019916274201988493, 0.020649258495182204, 0.018249607535321816, 0.10675039246467818, 0.10675039246467818, 0.10675039246467818, 0.10753532182103609, 0.018249607535321816]
-->FPR:[0.08695652173913043, 0.13986013986013987, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.3023343530175828, mean FPR diff:0.2190215210354749
-->FNR:[0.12666666666666668, 0.1273996509598604, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.08979400398903017, mean FNR diff:0.06310640587286062
-->mean fnr diff metric 0.2190215210354749
-->epoch 17
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.03921568766236305, FU:2.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.20000000298023224, FU:1.0, P:5
-->FUR:0.1428571492433548, FU:1.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1015, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.06896551698446274, FU:4.0, P:58
-->FUR:0.0625, FU:3.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1621, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.07959559559822083, FU:4.29816198348999, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1606, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.021276595070958138, FU:1.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:5.07635582363674e-34, FU:5.07635582363674e-34, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1282, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1388, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1517, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0714285746216774, FU:4.0, P:56
-->FUR:0.06122449040412903, FU:3.0, P:49
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1337, bias_loss:nan
-->after epoch 17
-->overall baseline on training dataset
-->ACC 0.9770189701897019
-->F1 0.9763867231009133
-->FPR: 0.018443926224295103
-->FNR: 0.027728482697426796
-->overall baseline on testing dataset
-->ACC 0.9074589127686473
-->F1 0.9032258064516129
-->FPR: 0.07974559686888454
-->FNR: 0.10622710622710622
training dataset
-->original metric score:
-->individual metric:0.1193515005174198, num_idi:346, num_all:2899
-->individual metric 0.1193515005174198
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9229323308270677
-->F1 0.9367283950617283
-->FPR 0.031007751937984496
-->FNR 0.103397341211226
-->positive probability:0.581766917293233, 619/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9149913842619184
-->F1 0.9441930618401206
-->FPR 0.042134831460674156
-->FNR 0.096028880866426
-->positive probability:0.7277426766226307, 1267/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.82
-->F1 0.8524590163934426
-->FPR 0.0625
-->FNR 0.23529411764705882
-->positive probability:0.54, 27/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9736842105263158
-->F1 0.9866666666666666
-->FPR None
-->FNR 0.02631578947368421
-->positive probability:0.9736842105263158, 74/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9951456310679612
-->F1 0.9975609756097561
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.9975728155339806, 411/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9024390243902439
-->F1 0.8857142857142858
-->FPR 0.044444444444444446
-->FNR 0.16216216216216217
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.012563825713689393, 0.023690905236379053, 0.0440560737757049, 0.6482227404423715, 0.026000518220149343, 0.018443926224295103]
-->fnr_diff [0.0756688585137992, 0.0683003981689992, 0.20756563494963204, 0.0014126932237425865, 0.027728482697426796, 0.013938183969239869, 0.1344336794647354, 0.0972715173025732]
-->FPR:[0.031007751937984496, 0.042134831460674156, 0.0625, 0.6666666666666666, 0.044444444444444446, 0.0], mean FPR:0.14112561575162827, mean FPR diff:0.12882966493543155
-->FNR:[0.103397341211226, 0.096028880866426, 0.23529411764705882, 0.02631578947368421, 0.0, 0.041666666666666664, 0.16216216216216217, 0.125], mean FNR:0.09873311975340299, mean FNR diff:0.07828993103626855
-->mean fnr diff metric 0.12882966493543155
testing dataset
-->original metric score:
-->individual metric:0.12664473684210525, num_idi:154, num_all:1216
-->individual metric 0.12664473684210525
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8828633405639913
-->F1 0.9059233449477352
-->FPR 0.08695652173913043
-->FNR 0.13333333333333333
-->positive probability:0.5943600867678959, 274/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8687150837988827
-->F1 0.913919413919414
-->FPR 0.13986013986013987
-->FNR 0.12914485165794065
-->positive probability:0.7248603351955307, 519/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.007210924870245897, 0.060114542991255335, 0.08692106979778212, 0.42025440313111545, 0.9202544031311155, 0.000254403131115466, 0.06311154598825831]
-->fnr_diff [0.027106227106227107, 0.022917745430834427, 0.018772893772893776, 0.10622710622710622, 0.10622710622710622, 0.10622710622710622, 0.10805860805860805, 0.018772893772893776]
-->FPR:[0.08695652173913043, 0.13986013986013987, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.3023343530175828, mean FPR diff:0.22258875614869833
-->FNR:[0.13333333333333333, 0.12914485165794065, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.09084548740962353, mean FNR diff:0.06428871085284699
-->mean fnr diff metric 0.22258875614869833
-->epoch 18
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.20000000298023224, FU:1.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.0994, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.0625, FU:3.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1584, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1570, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.021276595070958138, FU:1.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1276, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1379, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1508, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1297, bias_loss:nan
-->after epoch 18
-->overall baseline on training dataset
-->ACC 0.9786449864498645
-->F1 0.9780354554576877
-->FPR: 0.0158999364002544
-->FNR: 0.027062999112688554
-->overall baseline on testing dataset
-->ACC 0.9084702907711757
-->F1 0.9042328042328043
-->FPR: 0.07827788649706457
-->FNR: 0.10570381998953428
training dataset
-->original metric score:
-->individual metric:0.11797171438427044, num_idi:342, num_all:2899
-->individual metric 0.11797171438427044
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9238721804511278
-->F1 0.9374517374517374
-->FPR 0.028423772609819122
-->FNR 0.103397341211226
-->positive probability:0.5808270676691729, 618/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9149913842619184
-->F1 0.9441087613293051
-->FPR 0.03651685393258427
-->FNR 0.09747292418772563
-->positive probability:0.7254451464675474, 1263/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.82
-->F1 0.8524590163934426
-->FPR 0.0625
-->FNR 0.23529411764705882
-->positive probability:0.54, 27/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9736842105263158
-->F1 0.9866666666666666
-->FPR None
-->FNR 0.02631578947368421
-->positive probability:0.9736842105263158, 74/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9951456310679612
-->F1 0.9975609756097561
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.9975728155339806, 411/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9024390243902439
-->F1 0.8857142857142858
-->FPR 0.044444444444444446
-->FNR 0.16216216216216217
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.012523836209564723, 0.02061691753232987, 0.0466000635997456, 0.6507667302664122, 0.028544508044190047, 0.0158999364002544]
-->fnr_diff [0.07633434209853744, 0.07040992507503707, 0.20823111853437026, 0.0007472096390043446, 0.027062999112688554, 0.01460366755397811, 0.13509916304947361, 0.09793700088731144]
-->FPR:[0.028423772609819122, 0.03651685393258427, 0.0625, 0.6666666666666666, 0.044444444444444446, 0.0], mean FPR:0.13975862294225241, mean FPR diff:0.1291586653420828
-->FNR:[0.103397341211226, 0.09747292418772563, 0.23529411764705882, 0.02631578947368421, 0.0, 0.041666666666666664, 0.16216216216216217, 0.125], mean FNR:0.09891362516856544, mean FNR diff:0.07880317824380012
-->mean fnr diff metric 0.1291586653420828
testing dataset
-->original metric score:
-->individual metric:0.125, num_idi:152, num_all:1216
-->individual metric 0.125
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8828633405639913
-->F1 0.9055944055944056
-->FPR 0.08074534161490683
-->FNR 0.13666666666666666
-->positive probability:0.5900216919739696, 272/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8687150837988827
-->F1 0.9137614678899082
-->FPR 0.13286713286713286
-->FNR 0.13089005235602094
-->positive probability:0.7220670391061452, 517/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.002467455117842257, 0.05458924637006829, 0.08838878016960208, 0.4217221135029354, 0.9217221135029354, 0.0017221135029354268, 0.06457925636007827]
-->fnr_diff [0.03096284667713238, 0.025186232366486663, 0.01929618001046572, 0.10570381998953428, 0.10570381998953428, 0.10570381998953428, 0.10858189429618, 0.01929618001046572]
-->FPR:[0.08074534161490683, 0.13286713286713286, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.30044804057226415, mean FPR diff:0.2221701540751996
-->FNR:[0.13666666666666666, 0.13089005235602094, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.09148030416355024, mean FNR diff:0.06505434916616668
-->mean fnr diff metric 0.2221701540751996
-->epoch 19
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.20000000298023224, FU:1.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.0990, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.0416666679084301, FU:2.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1564, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1554, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.021276595070958138, FU:1.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1276, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1366, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1492, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1281, bias_loss:nan
-->after epoch 19
-->overall baseline on training dataset
-->ACC 0.9787533875338753
-->F1 0.9781347612672913
-->FPR: 0.015263938944244222
-->FNR: 0.027506654835847383
-->overall baseline on testing dataset
-->ACC 0.9099873577749684
-->F1 0.9057203389830508
-->FPR: 0.07583170254403131
-->FNR: 0.10518053375196232
training dataset
-->original metric score:
-->individual metric:0.11555708865125905, num_idi:335, num_all:2899
-->individual metric 0.11555708865125905
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9238721804511278
-->F1 0.9374517374517374
-->FPR 0.028423772609819122
-->FNR 0.103397341211226
-->positive probability:0.5808270676691729, 618/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9144170017231477
-->F1 0.943709860219116
-->FPR 0.03651685393258427
-->FNR 0.09819494584837545
-->positive probability:0.7248707639287766, 1262/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.82
-->F1 0.8524590163934426
-->FPR 0.0625
-->FNR 0.23529411764705882
-->positive probability:0.54, 27/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9736842105263158
-->F1 0.9866666666666666
-->FPR None
-->FNR 0.02631578947368421
-->positive probability:0.9736842105263158, 74/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9024390243902439
-->F1 0.8857142857142858
-->FPR 0.044444444444444446
-->FNR 0.16216216216216217
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.0131598336655749, 0.021252914988340046, 0.04723606105575578, 0.6514027277224224, 0.029180505500200224, 0.015263938944244222]
-->fnr_diff [0.07589068637537862, 0.07068829101252806, 0.20778746281121144, 0.0011908653621631737, 0.025061667060786257, 0.014160011830819282, 0.1346555073263148, 0.09749334516415262]
-->FPR:[0.028423772609819122, 0.03651685393258427, 0.0625, 0.6666666666666666, 0.044444444444444446, 0.0], mean FPR:0.13975862294225241, mean FPR diff:0.12958266364608959
-->FNR:[0.103397341211226, 0.09819494584837545, 0.23529411764705882, 0.02631578947368421, 0.0024449877750611247, 0.041666666666666664, 0.16216216216216217, 0.125], mean FNR:0.0993095013480293, mean FNR diff:0.07836597961791927
-->mean fnr diff metric 0.12958266364608959
testing dataset
-->original metric score:
-->individual metric:0.12746710526315788, num_idi:155, num_all:1216
-->individual metric 0.12746710526315788
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8806941431670282
-->F1 0.9036777583187391
-->FPR 0.08074534161490683
-->FNR 0.14
-->positive probability:0.5878524945770065, 271/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8687150837988827
-->F1 0.9137614678899082
-->FPR 0.13286713286713286
-->FNR 0.13089005235602094
-->positive probability:0.7220670391061452, 517/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.004913639070875525, 0.05703543032310156, 0.09083496412263535, 0.4241682974559687, 0.9241682974559687, 0.004168297455968695, 0.06702544031311154]
-->fnr_diff [0.034819466248037695, 0.025709518604058623, 0.01981946624803768, 0.10518053375196232, 0.10518053375196232, 0.10518053375196232, 0.10910518053375196, 0.01981946624803768]
-->FPR:[0.08074534161490683, 0.13286713286713286, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.30044804057226415, mean FPR diff:0.2246163380282329
-->FNR:[0.14, 0.13089005235602094, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.0918969708302169, mean FNR diff:0.06560183739222633
-->mean fnr diff metric 0.2246163380282329
    train_ind  train_acc  ...  test_fnr_mean  test_fnr_diff
0    0.125561   0.970407  ...       0.030394       0.046698
1    0.120386   0.977019  ...       0.051048       0.069831
2    0.113832   0.983306  ...       0.096977       0.074738
3    0.117282   0.979512  ...       0.089159       0.063649
4    0.112453   0.980054  ...       0.091897       0.065863
5    0.113142   0.980163  ...       0.092314       0.066934
6    0.115902   0.979729  ...       0.091480       0.066363
7    0.117282   0.979404  ...       0.090211       0.065616
8    0.117627   0.980054  ...       0.089993       0.066052
9    0.117282   0.975285  ...       0.093603       0.065215
10   0.127975   0.948293  ...       0.093880       0.064707
11   0.128665   0.941247  ...       0.093880       0.065230
12   0.129700   0.954688  ...       0.093662       0.065012
13   0.123146   0.967480  ...       0.092988       0.065254
14   0.125561   0.971382  ...       0.091282       0.063940
15   0.122801   0.973442  ...       0.090012       0.062932
16   0.122111   0.974417  ...       0.089794       0.063106
17   0.119352   0.977019  ...       0.090845       0.064289
18   0.117972   0.978645  ...       0.091480       0.065054
19   0.115557   0.978753  ...       0.091897       0.065602

[20 rows x 22 columns]
-->gamma 1.4
-->model.parameters() <generator object Module.parameters at 0x7f167ed30900>
-->classifier <generator object Module.parameters at 0x7f167ed30900>
-->orig_weight tensor([[-1.8623e-02,  1.2338e-02, -3.0041e-02,  ...,  3.9703e-03,
          4.6897e-02, -5.2919e-02],
        [-1.3463e-02, -3.2775e-03,  3.0866e-02,  ..., -8.2385e-04,
         -2.9158e-03,  3.8653e-02],
        [-1.3898e-02, -2.3013e-02, -3.9943e-03,  ...,  9.8061e-03,
          1.5029e-02,  4.8953e-06],
        ...,
        [-1.9317e-02, -1.3705e-02, -1.4288e-03,  ...,  1.9444e-02,
          2.5554e-02,  3.0395e-02],
        [ 4.5935e-02, -4.6035e-02, -1.5518e-02,  ...,  2.7111e-03,
          9.4047e-03,  4.1312e-02],
        [ 1.5371e-02,  2.7302e-02,  4.8132e-03,  ...,  2.9204e-02,
          2.2703e-02, -2.8652e-03]], device='cuda:0', grad_fn=<CloneBackward0>)
-->orig_bias tensor([-0.0234, -0.0171,  0.0198,  0.0220, -0.0377,  0.0522,  0.0208,  0.0082,
        -0.0010,  0.0287, -0.0195,  0.0245, -0.0014, -0.0127,  0.0355, -0.0191,
         0.0021, -0.0207, -0.0005, -0.0191, -0.0157, -0.0288, -0.0329,  0.0256,
         0.0072, -0.0035,  0.0078,  0.0138,  0.0450, -0.0074, -0.0118, -0.0404,
         0.0022, -0.0088,  0.0138,  0.0428, -0.0113, -0.0135, -0.0280,  0.0062,
        -0.0296, -0.0310, -0.0098,  0.0175, -0.0581,  0.0237, -0.0096, -0.0222,
         0.0107, -0.0104, -0.0282, -0.0035,  0.0234,  0.0204, -0.0182, -0.0289,
        -0.0295, -0.0240, -0.0234, -0.0364, -0.0082], device='cuda:0',
       grad_fn=<CloneBackward0>)
-->MinValue:-3.2998316455372216, MaxValue:3.9719170089423623
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9144736842105263
-->F1 0.9298380878951426
-->FPR 0.04392764857881137
-->FNR 0.10930576070901034
-->positive probability:0.5827067669172933, 620/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9103963239517519
-->F1 0.9413533834586466
-->FPR 0.06460674157303371
-->FNR 0.096028880866426
-->positive probability:0.7323377369327972, 1275/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9605263157894737
-->F1 0.9798657718120806
-->FPR None
-->FNR 0.039473684210526314
-->positive probability:0.9605263157894737, 73/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9684466019417476
-->F1 0.9839307787391842
-->FPR 0.6666666666666666
-->FNR 0.02689486552567237
-->positive probability:0.970873786407767, 400/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.029087708578811367, 0.04976680157303372, 0.01483994, 0.6518267266666666, 0.007382282222222224, 0.01483994]
-->fnr_diff [0.09333415070901034, 0.080057270866426, 0.10167544882352941, 0.023502074210526313, 0.01092325552567237, 0.017361723333333332, 0.11916352513513515, 0.10902839]
-->FPR: [0.04392764857881137, 0.06460674157303371, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13290387984012234, mean FPR diff:0.12795723317345567
-->FNR: [0.10930576070901034, 0.096028880866426, 0.11764705882352941, 0.039473684210526314, 0.02689486552567237, 0.03333333333333333, 0.13513513513513514, 0.125], mean FNR:0.08535233982545412, mean FNR diff:0.06938072982545412
-->base group metric 0.12795723317345567 0.13290387984012234
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8655097613882863
-->F1 0.8912280701754387
-->FPR 0.09937888198757763
-->FNR 0.15333333333333332
-->positive probability:0.5856832971800434, 270/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8561452513966481
-->F1 0.9057639524245196
-->FPR 0.17482517482517482
-->FNR 0.13612565445026178
-->positive probability:0.7262569832402235, 520/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9230769230769231
-->F1 0.9600000000000001
-->FPR None
-->FNR 0.07692307692307693
-->positive probability:0.9230769230769231, 36/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.75
-->FPR 0.04
-->FNR 0.35714285714285715
-->positive probability:0.2564102564102564, 10/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.08453894198757764, 0.15998523482517482, 0.01483994, 0.48516006, 0.98516006, 0.02516006, 0.12801720285714285]
-->fnr_diff [0.13736172333333332, 0.12015404445026179, 0.10902839, 0.01597161, 0.01597161, 0.06095146692307693, 0.3411712471428571, 0.10902839]
-->FPR: [0.09937888198757763, 0.17482517482517482, 0.0, 0.5, 1.0, 0.04, 0.14285714285714285], mean FPR:0.2795801713814136, mean FPR diff:0.26898021423855645
-->FNR: [0.15333333333333332, 0.13612565445026178, 0.125, 0.0, 0.0, 0.07692307692307693, 0.35714285714285715, 0.125], mean FNR:0.12169061523119115, mean FNR diff:0.11370481023119114
-->base group metric 0.26898021423855645 0.2795801713814136
-->epoch 0
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.20000000298023224, FU:1.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.0987, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.06896551698446274, FU:4.0, P:58
-->FUR:0.0625, FU:3.0, P:48
-->FUR:3.3174343588784354e-26, FU:9.952303076635306e-26, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1739, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:0.25, FU:1.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:7.097065099515021e-05, FU:0.00035485325497575104, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1626, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.12499941885471344, FU:7.99996280670166, P:64
-->FUR:0.19148856401443481, FU:8.99996280670166, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1276, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.07017543911933899, FU:4.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1219, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.0600033774971962, FU:3.000168800354004, P:50
-->FUR:0.10000000149011612, FU:5.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1370, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0714285746216774, FU:4.0, P:56
-->FUR:0.3061225116252899, FU:15.00000286102295, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.25, FU:1.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1268, bias_loss:nan
-->after epoch 0
-->overall baseline on training dataset
-->ACC 0.9753929539295393
-->F1 0.9751885451961962
-->FPR: 0.03815984736061056
-->FNR: 0.010425909494232475
-->overall baseline on testing dataset
-->ACC 0.9056890012642225
-->F1 0.9062107115916521
-->FPR: 0.12915851272015655
-->FNR: 0.05703819989534275
training dataset
-->original metric score:
-->individual metric:0.1279751638496033, num_idi:371, num_all:2899
-->individual metric 0.1279751638496033
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9492481203007519
-->F1 0.9604685212298683
-->FPR 0.08527131782945736
-->FNR 0.0310192023633678
-->positive probability:0.6475563909774437, 689/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9460080413555428
-->F1 0.9662598707824839
-->FPR 0.1544943820224719
-->FNR 0.02815884476534296
-->positive probability:0.8047099368179207, 1401/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9411764705882353
-->FPR 0.125
-->FNR 0.058823529411764705
-->positive probability:0.68, 34/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9833333333333333
-->F1 0.9915966386554621
-->FPR None
-->FNR 0.016666666666666666
-->positive probability:0.9833333333333333, 118/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9634146341463414
-->F1 0.9599999999999999
-->FPR 0.044444444444444446
-->FNR 0.02702702702702703
-->positive probability:0.4634146341463415, 38/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9310344827586207
-->F1 0.9166666666666666
-->FPR 0.058823529411764705
-->FNR 0.08333333333333333
-->positive probability:0.41379310344827586, 24/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.047111470468846804, 0.11633453466186133, 0.08684015263938943, 0.6285068193060561, 0.006284597083833887, 0.020663682051154146]
-->fnr_diff [0.020593292869135325, 0.017732935271110487, 0.048397619917532234, 0.010425909494232475, 0.00798092171917135, 0.0062407571724341915, 0.016601117532794554, 0.07290742383910086]
-->FPR:[0.08527131782945736, 0.1544943820224719, 0.125, 0.6666666666666666, 0.044444444444444446, 0.058823529411764705], mean FPR:0.18911672339580085, mean FPR diff:0.15095687603519028
-->FNR:[0.0310192023633678, 0.02815884476534296, 0.058823529411764705, 0.0, 0.0024449877750611247, 0.016666666666666666, 0.02702702702702703, 0.08333333333333333], mean FNR:0.03093419891782045, mean FNR diff:0.025109997226938935
-->mean fnr diff metric 0.15095687603519028
testing dataset
-->original metric score:
-->individual metric:0.13486842105263158, num_idi:164, num_all:1216
-->individual metric 0.13486842105263158
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8915401301518439
-->F1 0.9190938511326862
-->FPR 0.2111801242236025
-->FNR 0.05333333333333334
-->positive probability:0.6898047722342733, 318/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8924581005586593
-->F1 0.934018851756641
-->FPR 0.34265734265734266
-->FNR 0.04886561954624782
-->positive probability:0.8296089385474861, 594/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9545454545454546
-->F1 0.9696969696969697
-->FPR 0.16666666666666666
-->FNR 0.0
-->positive probability:0.7727272727272727, 17/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7999999999999999
-->FPR 0.16
-->FNR 0.14285714285714285
-->positive probability:0.41025641025641024, 16/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.6818181818181818
-->F1 0.6956521739130436
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.08202161150344595, 0.2134988299371861, 0.03750815394651011, 0.37084148727984345, 0.8708414872798435, 0.030841487279843455, 0.37084148727984345]
-->fnr_diff [0.0037048665620094123, 0.008172580349094932, 0.05703819989534275, 0.05703819989534275, 0.05703819989534275, 0.05703819989534275, 0.0858189429618001, 0.05703819989534275]
-->FPR:[0.2111801242236025, 0.34265734265734266, 0.16666666666666666, 0.5, 1.0, 0.16, 0.5], mean FPR:0.4115005905068017, mean FPR diff:0.2823420777866451
-->FNR:[0.05333333333333334, 0.04886561954624782, 0.0, 0.0, 0.0, 0.0, 0.14285714285714285, 0.0], mean FNR:0.0306320119670905, mean FNR diff:0.047860923668702274
-->mean fnr diff metric 0.2823420777866451
-->epoch 1
-->start_index 0
-->batch_size 98
-->FUR:0.05454545468091965, FU:3.0, P:55
-->FUR:0.0784313753247261, FU:4.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.0850, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.1551724076271057, FU:9.0, P:58
-->FUR:0.20723994076251984, FU:9.947517395019531, P:48
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1344, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:0.14814814925193787, FU:8.0, P:54
-->FUR:0.25, FU:1.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.20000000298023224, FU:1.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1386, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.1093708723783493, FU:6.9997358322143555, P:64
-->FUR:0.17091375589370728, FU:8.032946586608887, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1057, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.09987787157297134, FU:4.993893623352051, P:50
-->FUR:0.07006830722093582, FU:3.993893623352051, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1133, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.057128679007291794, FU:2.856433868408203, P:50
-->FUR:0.071186363697052, FU:3.5593180656433105, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1187, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.06122449040412903, FU:3.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1156, bias_loss:nan
-->after epoch 1
-->overall baseline on training dataset
-->ACC 0.9786449864498645
-->F1 0.9781232648528595
-->FPR: 0.019715921136315456
-->FNR: 0.023070097604259095
-->overall baseline on testing dataset
-->ACC 0.9074589127686473
-->F1 0.9042386185243328
-->FPR: 0.08953033268101761
-->FNR: 0.09576138147566719
training dataset
-->original metric score:
-->individual metric:0.1176267678509831, num_idi:341, num_all:2899
-->individual metric 0.1176267678509831
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9342105263157895
-->F1 0.9467275494672756
-->FPR 0.03875968992248062
-->FNR 0.08124076809453472
-->positive probability:0.5986842105263158, 637/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9276278001148766
-->F1 0.9530201342281879
-->FPR 0.05337078651685393
-->FNR 0.07725631768953069
-->positive probability:0.7449741527857553, 1297/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963459196102314
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 412/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9146341463414634
-->F1 0.9014084507042254
-->FPR 0.044444444444444446
-->FNR 0.13513513513513514
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.019043768786165163, 0.033654865380538475, 0.019715921136315456, 0.9802840788636845, 0.02472852330812899, 0.019715921136315456]
-->fnr_diff [0.05817067049027562, 0.05418622008527159, 0.21222402004279972, 0.00991220286741699, 0.023070097604259095, 0.01859656906240757, 0.11206503753087604, 0.1019299023957409]
-->FPR:[0.03875968992248062, 0.05337078651685393, 0.0, 1.0, 0.044444444444444446, 0.0], mean FPR:0.18942915348062983, mean FPR diff:0.18285717976852464
-->FNR:[0.08124076809453472, 0.07725631768953069, 0.23529411764705882, 0.013157894736842105, 0.0, 0.041666666666666664, 0.13513513513513514, 0.125], mean FNR:0.08859386249622102, mean FNR diff:0.07376934000988095
-->mean fnr diff metric 0.18285717976852464
testing dataset
-->original metric score:
-->individual metric:0.1299342105263158, num_idi:158, num_all:1216
-->individual metric 0.1299342105263158
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8915401301518439
-->F1 0.9131944444444445
-->FPR 0.08074534161490683
-->FNR 0.12333333333333334
-->positive probability:0.5986984815618221, 276/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8729050279329609
-->F1 0.9170464904284411
-->FPR 0.14685314685314685
-->FNR 0.12216404886561955
-->positive probability:0.7318435754189944, 524/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.008784991066110776, 0.05732281417212924, 0.07713633398564905, 0.4104696673189824, 0.9104696673189824, 0.009530332681017606, 0.12475538160469667]
-->fnr_diff [0.027571951857666144, 0.026402667389952353, 0.029238618524332807, 0.09576138147566719, 0.09576138147566719, 0.09576138147566719, 0.11852433281004708, 0.029238618524332807]
-->FPR:[0.08074534161490683, 0.14685314685314685, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.31265012420291927, mean FPR diff:0.22835274116393833
-->FNR:[0.12333333333333334, 0.12216404886561955, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.0887228870605834, mean FNR diff:0.0647825416916666
-->mean fnr diff metric 0.22835274116393833
-->epoch 2
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.03921568766236305, FU:2.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.20000000298023224, FU:1.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.0853, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.0625, FU:3.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1460, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1635, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.046875, FU:3.0, P:64
-->FUR:0.042733050882816315, FU:2.008453369140625, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1233, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:2.125122348069454e-36, FU:1.0625611417488104e-34, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1342, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1460, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1174, bias_loss:nan
-->after epoch 2
-->overall baseline on training dataset
-->ACC 0.980379403794038
-->F1 0.9798058685707911
-->FPR: 0.013567945728217087
-->FNR: 0.025953859804791483
-->overall baseline on testing dataset
-->ACC 0.9094816687737042
-->F1 0.9051906779661018
-->FPR: 0.07632093933463796
-->FNR: 0.10570381998953428
training dataset
-->original metric score:
-->individual metric:0.11383235598482236, num_idi:330, num_all:2899
-->individual metric 0.11383235598482236
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9295112781954887
-->F1 0.9422632794457274
-->FPR 0.025839793281653745
-->FNR 0.09601181683899557
-->positive probability:0.5845864661654135, 622/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9224583572659392
-->F1 0.9491142103279308
-->FPR 0.025280898876404494
-->FNR 0.09097472924187726
-->positive probability:0.7283170591614015, 1268/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9146341463414634
-->F1 0.8985507246376812
-->FPR 0.022222222222222223
-->FNR 0.16216216216216217
-->positive probability:0.3902439024390244, 32/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.012271847553436658, 0.011712953148187407, 0.013567945728217087, 0.6530987209384496, 0.008654276494005136, 0.013567945728217087]
-->fnr_diff [0.07005795703420409, 0.06502086943708578, 0.20934025784226734, 0.012795965067949378, 0.023508872029730357, 0.01571280686187518, 0.1362083023573707, 0.09904614019520852]
-->FPR:[0.025839793281653745, 0.025280898876404494, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1233349301744912, mean FPR diff:0.11881228159841883
-->FNR:[0.09601181683899557, 0.09097472924187726, 0.23529411764705882, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.16216216216216217, 0.125], mean FNR:0.09583904688358297, mean FNR diff:0.07896139635321142
-->mean fnr diff metric 0.11881228159841883
testing dataset
-->original metric score:
-->individual metric:0.12335526315789473, num_idi:150, num_all:1216
-->individual metric 0.12335526315789473
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8850325379609545
-->F1 0.9075043630017452
-->FPR 0.08074534161490683
-->FNR 0.13333333333333333
-->positive probability:0.5921908893709328, 273/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8659217877094972
-->F1 0.9120879120879121
-->FPR 0.14685314685314685
-->FNR 0.13089005235602094
-->positive probability:0.7248603351955307, 519/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.0044244022802688715, 0.07053220751850889, 0.0903457273320287, 0.42367906066536204, 0.923679060665362, 0.003679060665362041, 0.06653620352250489]
-->fnr_diff [0.027629513343799053, 0.025186232366486663, 0.01929618001046572, 0.10570381998953428, 0.10570381998953428, 0.10570381998953428, 0.10858189429618, 0.01929618001046572]
-->FPR:[0.08074534161490683, 0.14685314685314685, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.3024460425702662, mean FPR diff:0.22612510323562818
-->FNR:[0.13333333333333333, 0.13089005235602094, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.09106363749688356, mean FNR diff:0.0646376824995
-->mean fnr diff metric 0.22612510323562818
-->epoch 3
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.0, FU:0.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.0966, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.06896551698446274, FU:4.0, P:58
-->FUR:0.0416666679084301, FU:2.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1449, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1678, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.0, FU:0.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1290, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1355, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1434, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.020408162847161293, FU:1.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1234, bias_loss:nan
-->after epoch 3
-->overall baseline on training dataset
-->ACC 0.9813550135501355
-->F1 0.9808121374386435
-->FPR: 0.012719949120203519
-->FNR: 0.024844720496894408
-->overall baseline on testing dataset
-->ACC 0.9120101137800253
-->F1 0.9078877713075703
-->FPR: 0.07436399217221135
-->FNR: 0.10256410256410256
training dataset
-->original metric score:
-->individual metric:0.11279751638496033, num_idi:327, num_all:2899
-->individual metric 0.11279751638496033
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9285714285714286
-->F1 0.9414483821263482
-->FPR 0.025839793281653745
-->FNR 0.09748892171344166
-->positive probability:0.5836466165413534, 621/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9236071223434807
-->F1 0.949868073878628
-->FPR 0.02247191011235955
-->FNR 0.09025270758122744
-->positive probability:0.7283170591614015, 1268/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9951456310679612
-->F1 0.9975550122249389
-->FPR 0.3333333333333333
-->FNR 0.0024449877750611247
-->positive probability:0.9927184466019418, 409/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9146341463414634
-->F1 0.8985507246376812
-->FPR 0.022222222222222223
-->FNR 0.16216216216216217
-->positive probability:0.3902439024390244, 32/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.013119844161450227, 0.009751960992156031, 0.012719949120203519, 0.3206133842131298, 0.009502273102018705, 0.012719949120203519]
-->fnr_diff [0.07264420121654724, 0.06540798708433304, 0.21044939715016442, 0.011686825760052304, 0.022399732721833283, 0.016821946169772256, 0.13731744166526777, 0.1001552795031056]
-->FPR:[0.025839793281653745, 0.02247191011235955, 0.0, 0.3333333333333333, 0.022222222222222223, 0.0], mean FPR:0.06731120982492814, mean FPR diff:0.0630712267848603
-->FNR:[0.09748892171344166, 0.09025270758122744, 0.23529411764705882, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.16216216216216217, 0.125], mean FNR:0.09593343228530749, mean FNR diff:0.07961035140888449
-->mean fnr diff metric 0.0630712267848603
testing dataset
-->original metric score:
-->individual metric:0.12335526315789473, num_idi:150, num_all:1216
-->individual metric 0.12335526315789473
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8763557483731019
-->F1 0.9001751313485115
-->FPR 0.08695652173913043
-->FNR 0.14333333333333334
-->positive probability:0.5878524945770065, 271/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8631284916201117
-->F1 0.9102564102564102
-->FPR 0.15384615384615385
-->FNR 0.13263525305410123
-->positive probability:0.7248603351955307, 519/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.012592529566919086, 0.07948216167394251, 0.09230267449445531, 0.42563600782778865, 0.9256360078277887, 0.0056360078277886555, 0.0684931506849315]
-->fnr_diff [0.04076923076923078, 0.03007115048999867, 0.02243589743589744, 0.10256410256410256, 0.10256410256410256, 0.10256410256410256, 0.18315018315018314, 0.02243589743589744]
-->FPR:[0.08695652173913043, 0.15384615384615385, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.30433235501558487, mean FPR diff:0.2299683628433735
-->FNR:[0.14333333333333334, 0.13263525305410123, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.10146035901271504, mean FNR diff:0.07581933337168939
-->mean fnr diff metric 0.2299683628433735
-->threshold 0.1
-->epoch 4
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.0, FU:0.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1027, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.02083333395421505, FU:1.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:2.548790165621766e-16, FU:2.548790165621766e-16, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1418, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1716, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.0, FU:0.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1288, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1326, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1371, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.017857173457741737, FU:1.0000016689300537, P:56
-->FUR:0.020408162847161293, FU:1.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.719660190246941e-06, FU:1.719660190246941e-06, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1199, bias_loss:nan
-->after epoch 4
-->overall baseline on training dataset
-->ACC 0.9815718157181572
-->F1 0.981052162282657
-->FPR: 0.013355946576213695
-->FNR: 0.023735581188997337
-->overall baseline on testing dataset
-->ACC 0.9117572692793932
-->F1 0.907842619487721
-->FPR: 0.07681017612524461
-->FNR: 0.10047095761381476
training dataset
-->original metric score:
-->individual metric:0.11348740945153502, num_idi:329, num_all:2899
-->individual metric 0.11348740945153502
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9323308270676691
-->F1 0.9446153846153846
-->FPR 0.023255813953488372
-->FNR 0.0930576070901034
-->positive probability:0.5855263157894737, 623/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9253302699597932
-->F1 0.9510542168674698
-->FPR 0.02247191011235955
-->FNR 0.08808664259927798
-->positive probability:0.730040206777714, 1271/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9975728155339806
-->F1 0.9987760097919216
-->FPR 0.0
-->FNR 0.0024449877750611247
-->positive probability:0.9902912621359223, 408/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9146341463414634
-->F1 0.8985507246376812
-->FPR 0.022222222222222223
-->FNR 0.16216216216216217
-->positive probability:0.3902439024390244, 32/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.009899867377274676, 0.009115963536145855, 0.013355946576213695, 0.013355946576213695, 0.008866275646008528, 0.013355946576213695]
-->fnr_diff [0.06932202590110606, 0.06435106141028064, 0.2115585364580615, 0.010577686452155233, 0.02129059341393621, 0.017931085477669327, 0.13842658097316485, 0.10126441881100266]
-->FPR:[0.023255813953488372, 0.02247191011235955, 0.0, 0.0, 0.022222222222222223, 0.0], mean FPR:0.011324991048011691, mean FPR diff:0.011324991048011691
-->FNR:[0.0930576070901034, 0.08808664259927798, 0.23529411764705882, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.16216216216216217, 0.125], mean FNR:0.09510875983464653, mean FNR diff:0.07934024861217207
-->mean fnr diff metric 0.011324991048011691
testing dataset
-->original metric score:
-->individual metric:0.1225328947368421, num_idi:149, num_all:1216
-->individual metric 0.1225328947368421
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8806941431670282
-->F1 0.9040139616055846
-->FPR 0.08695652173913043
-->FNR 0.13666666666666666
-->positive probability:0.5921908893709328, 273/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8659217877094972
-->F1 0.9122486288848264
-->FPR 0.15384615384615385
-->FNR 0.12914485165794065
-->positive probability:0.7276536312849162, 521/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.010146345613885818, 0.07703597772090924, 0.08985649054142204, 0.4231898238747554, 0.9231898238747553, 0.0031898238747553875, 0.06604696673189824]
-->fnr_diff [0.036195709052851896, 0.02867389404412589, 0.024529042386185237, 0.10047095761381476, 0.10047095761381476, 0.10047095761381476, 0.18524332810047095, 0.024529042386185237]
-->FPR:[0.08695652173913043, 0.15384615384615385, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.30433235501558487, mean FPR diff:0.22752217889034018
-->FNR:[0.13666666666666666, 0.12914485165794065, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.10019072550486163, mean FNR diff:0.07507298610140793
-->mean fnr diff metric 0.22752217889034018
-->threshold 0.1
-->epoch 5
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.0, FU:0.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.0962, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.02083333395421505, FU:1.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.9669930653665445e-30, FU:1.9669930653665445e-30, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1385, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1671, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.0, FU:0.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1212, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1227, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1275, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.01785714365541935, FU:1.0, P:56
-->FUR:0.03437059745192528, FU:1.684159278869629, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:6.100879739958818e-16, FU:6.100879739958818e-16, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1137, bias_loss:nan
-->after epoch 5
-->overall baseline on training dataset
-->ACC 0.9805962059620597
-->F1 0.9800423681569852
-->FPR: 0.01399194403222387
-->FNR: 0.025066548358473825
-->overall baseline on testing dataset
-->ACC 0.9102402022756005
-->F1 0.9061591329632566
-->FPR: 0.07729941291585127
-->FNR: 0.10308738880167452
training dataset
-->original metric score:
-->individual metric:0.11245256985167298, num_idi:326, num_all:2899
-->individual metric 0.11245256985167298
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9332706766917294
-->F1 0.9454265949269792
-->FPR 0.023255813953488372
-->FNR 0.0915805022156573
-->positive probability:0.5864661654135338, 624/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9253302699597932
-->F1 0.9511278195488722
-->FPR 0.028089887640449437
-->FNR 0.08664259927797834
-->positive probability:0.7323377369327972, 1275/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9975728155339806
-->F1 0.9987760097919216
-->FPR 0.0
-->FNR 0.0024449877750611247
-->positive probability:0.9902912621359223, 408/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9146341463414634
-->F1 0.8985507246376812
-->FPR 0.022222222222222223
-->FNR 0.16216216216216217
-->positive probability:0.3902439024390244, 32/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.009263869921264501, 0.014097943608225567, 0.01399194403222387, 0.01399194403222387, 0.008230278189998353, 0.01399194403222387]
-->fnr_diff [0.06651395385718348, 0.06157605091950451, 0.210227569288585, 0.01190865362163172, 0.0226215605834127, 0.01660011830819284, 0.13709561380368834, 0.09993345164152617]
-->FPR:[0.023255813953488372, 0.028089887640449437, 0.0, 0.0, 0.022222222222222223, 0.0], mean FPR:0.012261320636026673, mean FPR diff:0.012261320636026673
-->FNR:[0.0915805022156573, 0.08664259927797834, 0.23529411764705882, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.16216216216216217, 0.125], mean FNR:0.0947436163101783, mean FNR diff:0.0783096215029656
-->mean fnr diff metric 0.012261320636026673
testing dataset
-->original metric score:
-->individual metric:0.12911184210526316, num_idi:157, num_all:1216
-->individual metric 0.12911184210526316
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8937093275488069
-->F1 0.9150779896013864
-->FPR 0.08074534161490683
-->FNR 0.12
-->positive probability:0.6008676789587852, 277/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8715083798882681
-->F1 0.9160583941605839
-->FPR 0.14685314685314685
-->FNR 0.12390924956369982
-->positive probability:0.7304469273743017, 523/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.0034459286990555643, 0.06955373393729558, 0.08936725375081539, 0.4227005870841487, 0.9227005870841487, 0.002700587084148734, 0.06555772994129158]
-->fnr_diff [0.016912611198325475, 0.0208218607620253, 0.02191261119832548, 0.10308738880167452, 0.10308738880167452, 0.10308738880167452, 0.1826268969126112, 0.02191261119832548]
-->FPR:[0.08074534161490683, 0.14685314685314685, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.3024460425702662, mean FPR diff:0.2251466296544149
-->FNR:[0.12, 0.12390924956369982, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09745294190974818, mean FNR diff:0.07168109470932957
-->mean fnr diff metric 0.2251466296544149
-->threshold 0.1
-->epoch 6
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.0, FU:0.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.0908, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.06896551698446274, FU:4.0, P:58
-->FUR:0.0625, FU:3.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1473, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1688, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.0156250037252903, FU:1.000000238418579, P:64
-->FUR:0.0, FU:0.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:3.9897656733955955e-08, FU:2.792835971376917e-07, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1378, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1428, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1452, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:7.615780783787329e-10, FU:7.615780783787329e-10, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1328, bias_loss:nan
-->after epoch 6
-->overall baseline on training dataset
-->ACC 0.9670460704607046
-->F1 0.9655485040797825
-->FPR: 0.011871952512189952
-->FNR: 0.055013309671694766
-->overall baseline on testing dataset
-->ACC 0.9006321112515803
-->F1 0.8947227431020626
-->FPR: 0.07436399217221135
-->FNR: 0.1261119832548404
training dataset
-->original metric score:
-->individual metric:0.11176267678509831, num_idi:324, num_all:2899
-->individual metric 0.11176267678509831
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9107142857142857
-->F1 0.9257232212666145
-->FPR 0.025839793281653745
-->FNR 0.1255539143279173
-->positive probability:0.5657894736842105, 602/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.8920160827110856
-->F1 0.9278587874136608
-->FPR 0.033707865168539325
-->FNR 0.12707581227436823
-->positive probability:0.7013210798391729, 1221/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.82
-->F1 0.8474576271186441
-->FPR 0.0
-->FNR 0.2647058823529412
-->positive probability:0.5, 25/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9951456310679612
-->F1 0.9975550122249389
-->FPR 0.3333333333333333
-->FNR 0.0024449877750611247
-->positive probability:0.9927184466019418, 409/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.8902439024390244
-->F1 0.8656716417910447
-->FPR 0.022222222222222223
-->FNR 0.21621621621621623
-->positive probability:0.36585365853658536, 30/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9137931034482759
-->F1 0.8837209302325582
-->FPR 0.0
-->FNR 0.20833333333333334
-->positive probability:0.3275862068965517, 19/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.013967840769463793, 0.021835912656349373, 0.011871952512189952, 0.32146138082114334, 0.010350269710032271, 0.011871952512189952]
-->fnr_diff [0.07054060465622253, 0.07206250260267347, 0.20969257268124641, 0.04185541493485266, 0.052568321896633644, 0.013346643005028101, 0.16120290654452146, 0.15332002366163858]
-->FPR:[0.025839793281653745, 0.033707865168539325, 0.0, 0.3333333333333333, 0.022222222222222223, 0.0], mean FPR:0.06918386900095809, mean FPR diff:0.06522655149689478
-->FNR:[0.1255539143279173, 0.12707581227436823, 0.2647058823529412, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.21621621621621623, 0.20833333333333334], mean FNR:0.12489433846041828, mean FNR diff:0.09682362374785211
-->mean fnr diff metric 0.06522655149689478
testing dataset
-->original metric score:
-->individual metric:0.11759868421052631, num_idi:143, num_all:1216
-->individual metric 0.11759868421052631
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8850325379609545
-->F1 0.9068541300527241
-->FPR 0.06832298136645963
-->FNR 0.14
-->positive probability:0.5835140997830802, 269/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8491620111731844
-->F1 0.8992537313432836
-->FPR 0.11888111888111888
-->FNR 0.15881326352530542
-->positive probability:0.696927374301676, 499/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.006041010805751715, 0.044517126708907534, 0.09230267449445531, 0.42563600782778865, 0.9256360078277887, 0.0056360078277886555, 0.13992172211350293]
-->fnr_diff [0.013888016745159604, 0.03270128027046501, 0.0011119832548404096, 0.1261119832548404, 0.1261119832548404, 0.1261119832548404, 0.08817373103087386, 0.0011119832548404096]
-->FPR:[0.06832298136645963, 0.11888111888111888, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.30687949731427994, mean FPR diff:0.23424150822942622
-->FNR:[0.14, 0.15881326352530542, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.09538737222637747, mean FNR diff:0.06441536804008757
-->mean fnr diff metric 0.23424150822942622
-->threshold 0.1
-->epoch 7
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.0, FU:0.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1164, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.06896551698446274, FU:4.0, P:58
-->FUR:0.0625, FU:3.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.2747271682655992e-07, FU:1.2747271682655992e-07, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1914, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.0, FU:0.0, P:54
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.2037, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.021276595070958138, FU:1.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1700, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:3.5687382563732723e-29, FU:1.7843690860569186e-27, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1637, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1508, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1357, bias_loss:nan
-->after epoch 7
-->overall baseline on training dataset
-->ACC 0.9656368563685637
-->F1 0.9640140765126575
-->FPR: 0.01165995336018656
-->FNR: 0.058118899733806566
-->overall baseline on testing dataset
-->ACC 0.8996207332490518
-->F1 0.8933082504703037
-->FPR: 0.07240704500978473
-->FNR: 0.130298273155416
training dataset
-->original metric score:
-->individual metric:0.1065884787857882, num_idi:309, num_all:2899
-->individual metric 0.1065884787857882
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9078947368421053
-->F1 0.923556942277691
-->FPR 0.03359173126614987
-->FNR 0.1255539143279173
-->positive probability:0.568609022556391, 605/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.8879954049396899
-->F1 0.9250288350634371
-->FPR 0.03651685393258427
-->FNR 0.13140794223826716
-->positive probability:0.6984491671453188, 1216/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.82
-->F1 0.8474576271186441
-->FPR 0.0
-->FNR 0.2647058823529412
-->positive probability:0.5, 25/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9024390243902439
-->F1 0.8823529411764706
-->FPR 0.022222222222222223
-->FNR 0.1891891891891892
-->positive probability:0.3780487804878049, 31/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9137931034482759
-->F1 0.8837209302325582
-->FPR 0.0
-->FNR 0.20833333333333334
-->positive probability:0.3275862068965517, 19/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.02193177790596331, 0.024856900572397707, 0.01165995336018656, 0.6550067133064801, 0.010562268862035663, 0.01165995336018656]
-->fnr_diff [0.06743501459411072, 0.07328904250446058, 0.2065869826191346, 0.04496100499696446, 0.055673911958745444, 0.0164522330671399, 0.13107028945538263, 0.15021443359952677]
-->FPR:[0.03359173126614987, 0.03651685393258427, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12649957901460382, mean FPR diff:0.12261292789454165
-->FNR:[0.1255539143279173, 0.13140794223826716, 0.2647058823529412, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.1891891891891892, 0.20833333333333334], mean FNR:0.12205747632752725, mean FNR diff:0.09321036409943313
-->mean fnr diff metric 0.12261292789454165
testing dataset
-->original metric score:
-->individual metric:0.11266447368421052, num_idi:137, num_all:1216
-->individual metric 0.11266447368421052
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8850325379609545
-->F1 0.9068541300527241
-->FPR 0.06832298136645963
-->FNR 0.14
-->positive probability:0.5835140997830802, 269/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8435754189944135
-->F1 0.8951310861423221
-->FPR 0.11888111888111888
-->FNR 0.16579406631762653
-->positive probability:0.6913407821229051, 495/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.0040840636433251, 0.04647407387133415, 0.09425962165688193, 0.42759295499021527, 0.9275929549902153, 0.00759295499021527, 0.14187866927592954]
-->fnr_diff [0.009701726844584008, 0.03549579316221052, 0.005298273155416006, 0.130298273155416, 0.130298273155416, 0.130298273155416, 0.08398744113029827, 0.005298273155416006]
-->FPR:[0.06832298136645963, 0.11888111888111888, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.30687949731427994, mean FPR diff:0.2356393276311595
-->FNR:[0.14, 0.16579406631762653, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.0962599725754176, mean FNR diff:0.0663345408642716
-->mean fnr diff metric 0.2356393276311595
-->epoch 8
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.0, FU:0.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1136, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.1034482792019844, FU:6.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1883, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.0, FU:0.0, P:54
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1933, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.046875, FU:3.0, P:64
-->FUR:0.021276595070958138, FU:1.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:4.375424154275757e-34, FU:4.375424154275757e-34, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1650, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1594, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1447, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.020408162847161293, FU:1.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1302, bias_loss:nan
-->after epoch 8
-->overall baseline on training dataset
-->ACC 0.9697560975609756
-->F1 0.968421052631579
-->FPR: 0.010387958448166206
-->FNR: 0.05102040816326531
-->overall baseline on testing dataset
-->ACC 0.904424778761062
-->F1 0.8987680771290841
-->FPR: 0.07093933463796477
-->FNR: 0.12192569335426479
training dataset
-->original metric score:
-->individual metric:0.11245256985167298, num_idi:326, num_all:2899
-->individual metric 0.11245256985167298
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9154135338345865
-->F1 0.9301242236024845
-->FPR 0.031007751937984496
-->FNR 0.11521418020679468
-->positive probability:0.5742481203007519, 611/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.8977599080987938
-->F1 0.9319571865443426
-->FPR 0.033707865168539325
-->FNR 0.11985559566787003
-->positive probability:0.7070649052268811, 1231/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.82
-->F1 0.8474576271186441
-->FPR 0.0
-->FNR 0.2647058823529412
-->positive probability:0.5, 25/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9310344827586207
-->F1 0.9090909090909091
-->FPR 0.0
-->FNR 0.16666666666666666
-->positive probability:0.3448275862068966, 20/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.020619793489818287, 0.023319906720373117, 0.010387958448166206, 0.6562787082185004, 0.011834263774056017, 0.010387958448166206]
-->fnr_diff [0.06419377204352937, 0.06883518750460473, 0.21368547418967587, 0.0378625134264232, 0.048575420388204185, 0.009353741496598643, 0.08411472697186984, 0.11564625850340135]
-->FPR:[0.031007751937984496, 0.033707865168539325, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12560075099923546, mean FPR diff:0.12213809818318005
-->FNR:[0.11521418020679468, 0.11985559566787003, 0.2647058823529412, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.13513513513513514, 0.16666666666666666], mean FNR:0.1073558761509972, mean FNR diff:0.0802833868155384
-->mean fnr diff metric 0.12213809818318005
testing dataset
-->original metric score:
-->individual metric:0.11595394736842106, num_idi:141, num_all:1216
-->individual metric 0.11595394736842106
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8872017353579176
-->F1 0.9084507042253521
-->FPR 0.062111801242236024
-->FNR 0.14
-->positive probability:0.5813449023861171, 268/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8505586592178771
-->F1 0.9002795899347623
-->FPR 0.11888111888111888
-->FNR 0.15706806282722513
-->positive probability:0.6983240223463687, 500/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.008827533395728747, 0.04794178424315411, 0.09572733202870189, 0.42906066536203524, 0.9290606653620352, 0.00906066536203523, 0.1433463796477495]
-->fnr_diff [0.018074306645735227, 0.035142369472960344, 0.003074306645735214, 0.12192569335426479, 0.12192569335426479, 0.12192569335426479, 0.1637885923600209, 0.003074306645735214]
-->FPR:[0.062111801242236024, 0.11888111888111888, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3059921858679623, mean FPR diff:0.23757500362877715
-->FNR:[0.14, 0.15706806282722513, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.10409779356768886, mean FNR diff:0.07361637022912265
-->mean fnr diff metric 0.23757500362877715
-->epoch 9
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.0, FU:0.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1048, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.10343258827924728, FU:5.999090194702148, P:58
-->FUR:0.10414770990610123, FU:4.999090194702148, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1716, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.0, FU:0.0, P:54
-->FUR:0.037037044763565063, FU:2.000000476837158, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1713, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.0, FU:0.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1494, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1479, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1393, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.03925200551748276, FU:1.9233481884002686, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1265, bias_loss:nan
-->after epoch 9
-->overall baseline on training dataset
-->ACC 0.9736585365853658
-->F1 0.9725764586389798
-->FPR: 0.009327962688149248
-->FNR: 0.04414374445430346
-->overall baseline on testing dataset
-->ACC 0.9064475347661188
-->F1 0.9009105516871987
-->FPR: 0.06898238747553816
-->FNR: 0.11983254840397697
training dataset
-->original metric score:
-->individual metric:0.1107278371852363, num_idi:321, num_all:2899
-->individual metric 0.1107278371852363
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9238721804511278
-->F1 0.9373549883990719
-->FPR 0.025839793281653745
-->FNR 0.10487444608567208
-->positive probability:0.5789473684210527, 616/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.909821941412981
-->F1 0.9402814758463295
-->FPR 0.02247191011235955
-->FNR 0.10758122743682311
-->positive probability:0.7145318782309018, 1244/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9310344827586207
-->F1 0.9090909090909091
-->FPR 0.0
-->FNR 0.16666666666666666
-->positive probability:0.3448275862068966, 20/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.016511830593504497, 0.013143947424210302, 0.009327962688149248, 0.6573387039785173, 0.012894259534072975, 0.009327962688149248]
-->fnr_diff [0.060730701631368615, 0.06343748298251964, 0.19115037319275535, 0.030985849717461357, 0.04169875667924234, 0.002477077787636797, 0.09099139068083167, 0.12252292221236319]
-->FPR:[0.025839793281653745, 0.02247191011235955, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12286676538048369, mean FPR diff:0.11975744448443394
-->FNR:[0.10487444608567208, 0.10758122743682311, 0.23529411764705882, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.13513513513513514, 0.16666666666666666], mean FNR:0.1008526427687407, mean FNR diff:0.07549931936052237
-->mean fnr diff metric 0.11975744448443394
testing dataset
-->original metric score:
-->individual metric:0.12006578947368421, num_idi:146, num_all:1216
-->individual metric 0.12006578947368421
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8850325379609545
-->F1 0.9068541300527241
-->FPR 0.06832298136645963
-->FNR 0.14
-->positive probability:0.5835140997830802, 269/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8589385474860335
-->F1 0.9067405355493997
-->FPR 0.13286713286713286
-->FNR 0.1431064572425829
-->positive probability:0.7122905027932961, 510/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.0006594061090785253, 0.06388474539159471, 0.0976842791911285, 0.43101761252446186, 0.9310176125244618, 0.011017612524461845, 0.1453033268101761]
-->fnr_diff [0.02016745159602304, 0.023273908838605917, 0.005167451596023026, 0.11983254840397697, 0.11983254840397697, 0.11983254840397697, 0.16588173731030872, 0.005167451596023026]
-->FPR:[0.06832298136645963, 0.13286713286713286, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.308877499312282, mean FPR diff:0.24008351358219476
-->FNR:[0.14, 0.1431064572425829, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.10235259286960857, mean FNR diff:0.07239445576861434
-->mean fnr diff metric 0.24008351358219476
-->epoch 10
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.0, FU:0.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1002, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.06897573918104172, FU:4.0005927085876465, P:58
-->FUR:0.0625123456120491, FU:3.0005927085876465, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1599, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.0, FU:0.0, P:54
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1652, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.0, FU:0.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1467, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1497, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1346, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.020408162847161293, FU:1.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1272, bias_loss:nan
-->after epoch 10
-->overall baseline on training dataset
-->ACC 0.9722493224932249
-->F1 0.9710669077757685
-->FPR: 0.009327962688149248
-->FNR: 0.04702750665483585
-->overall baseline on testing dataset
-->ACC 0.9054361567635903
-->F1 0.8997319034852548
-->FPR: 0.06898238747553816
-->FNR: 0.12192569335426479
training dataset
-->original metric score:
-->individual metric:0.11176267678509831, num_idi:324, num_all:2899
-->individual metric 0.11176267678509831
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9163533834586466
-->F1 0.9306313328137178
-->FPR 0.023255813953488372
-->FNR 0.11816838995568685
-->positive probability:0.5695488721804511, 606/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9023549684089603
-->F1 0.9349655700076511
-->FPR 0.019662921348314606
-->FNR 0.11768953068592057
-->positive probability:0.7059161401493395, 1229/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.82
-->F1 0.8474576271186441
-->FPR 0.0
-->FNR 0.2647058823529412
-->positive probability:0.5, 25/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9137931034482759
-->F1 0.8837209302325582
-->FPR 0.0
-->FNR 0.20833333333333334
-->positive probability:0.3275862068965517, 19/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.013927851265339124, 0.010334958660165358, 0.009327962688149248, 0.6573387039785173, 0.012894259534072975, 0.009327962688149248]
-->fnr_diff [0.071140883300851, 0.07066202403108472, 0.21767837569810533, 0.033869611917993744, 0.04458251887977473, 0.0053608399881691846, 0.0881076284802993, 0.1613058266784975]
-->FPR:[0.023255813953488372, 0.019662921348314606, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12196793736511531, mean FPR diff:0.11885861646906555
-->FNR:[0.11816838995568685, 0.11768953068592057, 0.2647058823529412, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.13513513513513514, 0.20833333333333334], mean FNR:0.11266272758019838, mean FNR diff:0.08658846362184694
-->mean fnr diff metric 0.11885861646906555
testing dataset
-->original metric score:
-->individual metric:0.11759868421052631, num_idi:143, num_all:1216
-->individual metric 0.11759868421052631
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8850325379609545
-->F1 0.9065255731922398
-->FPR 0.062111801242236024
-->FNR 0.14333333333333334
-->positive probability:0.579175704989154, 267/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8491620111731844
-->F1 0.8992537313432836
-->FPR 0.11888111888111888
-->FNR 0.15881326352530542
-->positive probability:0.696927374301676, 499/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.0068705862333021325, 0.049898731405580724, 0.0976842791911285, 0.43101761252446186, 0.9310176125244618, 0.011017612524461845, 0.07387475538160469]
-->fnr_diff [0.021407639979068555, 0.036887570171040635, 0.003074306645735214, 0.12192569335426479, 0.12192569335426479, 0.12192569335426479, 0.1637885923600209, 0.003074306645735214]
-->FPR:[0.062111801242236024, 0.11888111888111888, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.2957881042353092, mean FPR diff:0.22876874139785736
-->FNR:[0.14333333333333334, 0.15881326352530542, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.10473261032161556, mean FNR diff:0.07425118698304936
-->mean fnr diff metric 0.22876874139785736
-->epoch 11
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.0, FU:0.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1031, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.05172441899776459, FU:3.000016212463379, P:58
-->FUR:0.0625, FU:3.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.61104544531554e-05, FU:1.61104544531554e-05, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1588, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.0, FU:0.0, P:54
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1699, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.0, FU:0.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1474, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1493, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1318, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.017924025654792786, FU:1.003745436668396, P:56
-->FUR:0.020408162847161293, FU:1.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.003746814327314496, FU:0.003746814327314496, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1266, bias_loss:nan
-->after epoch 11
-->overall baseline on training dataset
-->ACC 0.9725745257452575
-->F1 0.9714285714285714
-->FPR: 0.009751960992156031
-->FNR: 0.04591836734693878
-->overall baseline on testing dataset
-->ACC 0.9054361567635903
-->F1 0.89978563772776
-->FPR: 0.06947162426614481
-->FNR: 0.12140240711669283
training dataset
-->original metric score:
-->individual metric:0.11279751638496033, num_idi:327, num_all:2899
-->individual metric 0.11279751638496033
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9201127819548872
-->F1 0.933954933954934
-->FPR 0.023255813953488372
-->FNR 0.11225997045790251
-->positive probability:0.5733082706766918, 610/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9052268811028145
-->F1 0.9369507069163164
-->FPR 0.016853932584269662
-->FNR 0.1148014440433213
-->positive probability:0.7076392877656519, 1232/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.82
-->F1 0.8474576271186441
-->FPR 0.0
-->FNR 0.2647058823529412
-->positive probability:0.5, 25/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9137931034482759
-->F1 0.8837209302325582
-->FPR 0.0
-->FNR 0.20833333333333334
-->positive probability:0.3275862068965517, 19/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.01350385296133234, 0.007101971592113631, 0.009751960992156031, 0.6569147056745106, 0.012470261230066192, 0.009751960992156031]
-->fnr_diff [0.06634160311096374, 0.06888307669638252, 0.2187875150060024, 0.03276047261009667, 0.043473379571877656, 0.0042517006802721136, 0.08921676778819637, 0.16241496598639457]
-->FPR:[0.023255813953488372, 0.016853932584269662, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12149977257110782, mean FPR diff:0.1182491189070558
-->FNR:[0.11225997045790251, 0.1148014440433213, 0.2647058823529412, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.13513513513513514, 0.20833333333333334], mean FNR:0.11156316431265043, mean FNR diff:0.08576618518127326
-->mean fnr diff metric 0.1182491189070558
testing dataset
-->original metric score:
-->individual metric:0.11842105263157894, num_idi:144, num_all:1216
-->individual metric 0.11842105263157894
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8850325379609545
-->F1 0.9065255731922398
-->FPR 0.062111801242236024
-->FNR 0.14333333333333334
-->positive probability:0.579175704989154, 267/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8533519553072626
-->F1 0.9023255813953488
-->FPR 0.11888111888111888
-->FNR 0.15357766143106458
-->positive probability:0.7011173184357542, 502/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.007359823023908786, 0.04940949461497407, 0.09719504240052185, 0.43052837573385516, 0.9305283757338552, 0.010528375733855191, 0.07338551859099804]
-->fnr_diff [0.021930926216640514, 0.03217525431437175, 0.003597592883307174, 0.12140240711669283, 0.12140240711669283, 0.12140240711669283, 0.1643118785975929, 0.003597592883307174]
-->FPR:[0.062111801242236024, 0.11888111888111888, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.2957881042353092, mean FPR diff:0.22841928654742402
-->FNR:[0.14333333333333334, 0.15357766143106458, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.10407816005983545, mean FNR diff:0.07372755828066224
-->mean fnr diff metric 0.22841928654742402
-->epoch 12
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.0, FU:0.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.0992, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.06896551698446274, FU:4.0, P:58
-->FUR:0.0625, FU:3.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1565, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.0, FU:0.0, P:54
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1625, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.0, FU:0.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1390, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:4.0305938048170005e-34, FU:2.0152969024085003e-32, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1442, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1292, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.020408162847161293, FU:1.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1275, bias_loss:nan
-->after epoch 12
-->overall baseline on training dataset
-->ACC 0.9747425474254743
-->F1 0.9737760270118176
-->FPR: 0.010811956752172992
-->FNR: 0.040372670807453416
-->overall baseline on testing dataset
-->ACC 0.9069532237673831
-->F1 0.9019189765458422
-->FPR: 0.07289628180039139
-->FNR: 0.11459968602825746
training dataset
-->original metric score:
-->individual metric:0.11417730251810969, num_idi:331, num_all:2899
-->individual metric 0.11417730251810969
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9229323308270677
-->F1 0.9367283950617283
-->FPR 0.031007751937984496
-->FNR 0.103397341211226
-->positive probability:0.581766917293233, 619/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9086731763354394
-->F1 0.9395667046750286
-->FPR 0.028089887640449437
-->FNR 0.10758122743682311
-->positive probability:0.7156806433084434, 1246/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9310344827586207
-->F1 0.9090909090909091
-->FPR 0.0
-->FNR 0.16666666666666666
-->positive probability:0.3448275862068966, 20/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.020195795185811504, 0.017277930888276446, 0.010811956752172992, 0.6558547099144937, 0.011410265470049231, 0.010811956752172992]
-->fnr_diff [0.06302467040377258, 0.0672085566293697, 0.1949214468396054, 0.02721477607061131, 0.037927683032392294, 0.0012939958592132483, 0.09476246432768173, 0.12629399585921325]
-->FPR:[0.031007751937984496, 0.028089887640449437, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12466442141122047, mean FPR diff:0.12106043582716279
-->FNR:[0.103397341211226, 0.10758122743682311, 0.23529411764705882, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.13513513513513514, 0.16666666666666666], mean FNR:0.10066800465943496, mean FNR diff:0.07658094862773243
-->mean fnr diff metric 0.12106043582716279
testing dataset
-->original metric score:
-->individual metric:0.12417763157894737, num_idi:151, num_all:1216
-->individual metric 0.12417763157894737
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8828633405639913
-->F1 0.9052631578947369
-->FPR 0.07453416149068323
-->FNR 0.14
-->positive probability:0.5856832971800434, 270/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8561452513966481
-->F1 0.9048938134810712
-->FPR 0.13986013986013987
-->FNR 0.14485165794066318
-->positive probability:0.7122905027932961, 510/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.0016378796902918463, 0.06696385805974849, 0.09377038486627527, 0.42710371819960863, 0.9271037181996086, 0.007103718199608616, 0.14138943248532287]
-->fnr_diff [0.025400313971742555, 0.030251971912405723, 0.010400313971742542, 0.11459968602825746, 0.11459968602825746, 0.11459968602825746, 0.17111459968602824, 0.010400313971742542]
-->FPR:[0.07453416149068323, 0.13986013986013987, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.31076381175760065, mean FPR diff:0.23786752995720914
-->FNR:[0.14, 0.14485165794066318, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.1025707429568686, mean FNR diff:0.07392082144980425
-->mean fnr diff metric 0.23786752995720914
-->epoch 13
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.0, FU:0.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.0920, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.103447325527668, FU:5.999944686889648, P:58
-->FUR:0.10416551679372787, FU:4.999944686889648, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1589, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.0, FU:0.0, P:54
-->FUR:0.05390908569097519, FU:2.911090612411499, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1543, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.0, FU:0.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1340, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:1.7230339951180183e-27, FU:8.6151696674413e-26, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1426, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1399, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.020408162847161293, FU:1.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1316, bias_loss:nan
-->after epoch 13
-->overall baseline on training dataset
-->ACC 0.9772357723577236
-->F1 0.9763991908293999
-->FPR: 0.009751960992156031
-->FNR: 0.03637976929902396
-->overall baseline on testing dataset
-->ACC 0.9084702907711757
-->F1 0.9032602886157135
-->FPR: 0.06898238747553816
-->FNR: 0.11564625850340136
training dataset
-->original metric score:
-->individual metric:0.11038289065194895, num_idi:320, num_all:2899
-->individual metric 0.11038289065194895
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9285714285714286
-->F1 0.9412673879443585
-->FPR 0.020671834625323
-->FNR 0.10044313146233383
-->positive probability:0.5798872180451128, 617/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9086731763354394
-->F1 0.9393361312476154
-->FPR 0.014044943820224719
-->FNR 0.1111913357400722
-->positive probability:0.7099368179207353, 1236/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9146341463414634
-->F1 0.8985507246376812
-->FPR 0.022222222222222223
-->FNR 0.16216216216216217
-->positive probability:0.3902439024390244, 32/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9310344827586207
-->F1 0.9090909090909091
-->FPR 0.0
-->FNR 0.16666666666666666
-->positive probability:0.3448275862068966, 20/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.010919873633166967, 0.004292982828068687, 0.009751960992156031, 0.6569147056745106, 0.012470261230066192, 0.009751960992156031]
-->fnr_diff [0.06406336216330988, 0.07481156644104825, 0.19891434834803487, 0.023221874562181853, 0.033934781523962836, 0.005286897367642707, 0.12578239286313822, 0.1302868973676427]
-->FPR:[0.020671834625323, 0.014044943820224719, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12060094455573943, mean FPR diff:0.11735029089168741
-->FNR:[0.10044313146233383, 0.1111913357400722, 0.23529411764705882, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.16216216216216217, 0.16666666666666666], mean FNR:0.10412837035710794, mean FNR diff:0.08203776507962017
-->mean fnr diff metric 0.11735029089168741
testing dataset
-->original metric score:
-->individual metric:0.1225328947368421, num_idi:149, num_all:1216
-->individual metric 0.1225328947368421
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8676789587852495
-->F1 0.891651865008881
-->FPR 0.07453416149068323
-->FNR 0.16333333333333333
-->positive probability:0.5704989154013015, 263/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8519553072625698
-->F1 0.901669758812616
-->FPR 0.13286713286713286
-->FNR 0.1518324607329843
-->positive probability:0.7053072625698324, 505/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.005551774015145075, 0.06388474539159471, 0.0976842791911285, 0.43101761252446186, 0.9310176125244618, 0.011017612524461845, 0.07387475538160469]
-->fnr_diff [0.047687074829931966, 0.03618620222958292, 0.009353741496598636, 0.11564625850340136, 0.11564625850340136, 0.11564625850340136, 0.17006802721088432, 0.009353741496598636]
-->FPR:[0.07453416149068323, 0.13286713286713286, 0.16666666666666666, 0.5, 1.0, 0.08, 0.14285714285714285], mean FPR:0.2995607291259465, mean FPR diff:0.23057834165040836
-->FNR:[0.16333333333333333, 0.1518324607329843, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.10636000997257541, mean FNR diff:0.07744844534672507
-->mean fnr diff metric 0.23057834165040836
-->epoch 14
-->start_index 0
-->batch_size 98
-->FUR:1.444164117086187e-35, FU:7.942902572227547e-34, P:55
-->FUR:0.0, FU:0.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1024, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.0416666679084301, FU:2.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1594, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.0, FU:0.0, P:54
-->FUR:3.1364911592390854e-06, FU:0.00016937052714638412, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1526, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.0, FU:0.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1406, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:3.2071470539816214e-21, FU:1.6035734987180359e-19, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1459, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1543, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.020408162847161293, FU:1.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:1.8295973594913038e-31, FU:7.318389437965215e-31, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1377, bias_loss:nan
-->after epoch 14
-->overall baseline on training dataset
-->ACC 0.9785365853658536
-->F1 0.9777528089887642
-->FPR: 0.008691965232139071
-->FNR: 0.034826974267968054
-->overall baseline on testing dataset
-->ACC 0.9109987357774968
-->F1 0.9056806002143623
-->FPR: 0.06409001956947162
-->FNR: 0.11564625850340136
training dataset
-->original metric score:
-->individual metric:0.11417730251810969, num_idi:331, num_all:2899
-->individual metric 0.11417730251810969
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.924812030075188
-->F1 0.937888198757764
-->FPR 0.01808785529715762
-->FNR 0.10782865583456426
-->positive probability:0.5742481203007519, 611/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9092475588742103
-->F1 0.9398324447829398
-->FPR 0.019662921348314606
-->FNR 0.10902527075812274
-->positive probability:0.7128087306145893, 1241/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9146341463414634
-->F1 0.8985507246376812
-->FPR 0.022222222222222223
-->FNR 0.16216216216216217
-->positive probability:0.3902439024390244, 32/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.00939589006501855, 0.010970956116175535, 0.008691965232139071, 0.6579747014345275, 0.013530256990083152, 0.008691965232139071]
-->fnr_diff [0.0730016815665962, 0.07419829649015469, 0.20046714337909077, 0.02166907953112595, 0.03238198649290693, 0.00683969239869861, 0.12733518789419412, 0.09017302573203195]
-->FPR:[0.01808785529715762, 0.019662921348314606, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12110661092239351, mean FPR diff:0.11820928917834715
-->FNR:[0.10782865583456426, 0.10902527075812274, 0.23529411764705882, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.16216216216216217, 0.125], mean FNR:0.09957246944755974, mean FNR diff:0.0782582616855999
-->mean fnr diff metric 0.11820928917834715
testing dataset
-->original metric score:
-->individual metric:0.12911184210526316, num_idi:157, num_all:1216
-->individual metric 0.12911184210526316
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8698481561822126
-->F1 0.8932384341637011
-->FPR 0.06832298136645963
-->FNR 0.16333333333333333
-->positive probability:0.5683297180043384, 262/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8561452513966481
-->F1 0.9048938134810712
-->FPR 0.13986013986013987
-->FNR 0.14485165794066318
-->positive probability:0.7122905027932961, 510/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8
-->FPR 0.04
-->FNR 0.2857142857142857
-->positive probability:0.28205128205128205, 11/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.004232961796988011, 0.07577012029066825, 0.06409001956947162, 0.43590998043052837, 0.9359099804305284, 0.02409001956947162, 0.007338551859099804]
-->fnr_diff [0.047687074829931966, 0.029205399437261817, 0.009353741496598636, 0.11564625850340136, 0.11564625850340136, 0.11564625850340136, 0.17006802721088432, 0.009353741496598636]
-->FPR:[0.06832298136645963, 0.13986013986013987, 0.0, 0.5, 1.0, 0.04, 0.07142857142857142], mean FPR:0.2599445275221673, mean FPR diff:0.22104880484953657
-->FNR:[0.16333333333333333, 0.14485165794066318, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.10548740962353528, mean FNR diff:0.07657584499768494
-->mean fnr diff metric 0.22104880484953657
-->epoch 15
-->start_index 0
-->batch_size 98
-->FUR:2.9240776122119254e-27, FU:1.6082427156055081e-25, P:55
-->FUR:0.0, FU:0.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1066, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.03448275849223137, FU:2.0, P:58
-->FUR:0.0416666679084301, FU:2.0, P:48
-->FUR:8.482985075364419e-31, FU:2.5448956166488737e-30, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1575, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:9.243947829418175e-08, FU:4.991731657355558e-06, P:54
-->FUR:0.03703713044524193, FU:2.000005006790161, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1489, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:1.0731599061800355e-38, FU:5.04385162911109e-37, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1372, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:8.967725218620858e-16, FU:4.4838627575411946e-14, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1399, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1478, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.020408162847161293, FU:1.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:3.6164518916418503e-14, FU:1.4465807566567401e-13, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1381, bias_loss:nan
-->after epoch 15
-->overall baseline on training dataset
-->ACC 0.9791869918699186
-->F1 0.9784463403682084
-->FPR: 0.008903964384142463
-->FNR: 0.03327417923691216
-->overall baseline on testing dataset
-->ACC 0.9109987357774968
-->F1 0.9057815845824411
-->FPR: 0.06506849315068493
-->FNR: 0.11459968602825746
training dataset
-->original metric score:
-->individual metric:0.11417730251810969, num_idi:331, num_all:2899
-->individual metric 0.11417730251810969
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9238721804511278
-->F1 0.9371605896043446
-->FPR 0.020671834625323
-->FNR 0.10782865583456426
-->positive probability:0.575187969924812, 612/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9103963239517519
-->F1 0.9406844106463879
-->FPR 0.02247191011235955
-->FNR 0.10685920577617329
-->positive probability:0.7151062607696727, 1245/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9146341463414634
-->F1 0.8985507246376812
-->FPR 0.022222222222222223
-->FNR 0.16216216216216217
-->positive probability:0.3902439024390244, 32/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.011767870241180535, 0.013567945728217087, 0.008903964384142463, 0.6577627022825242, 0.01331825783807976, 0.008903964384142463]
-->fnr_diff [0.0745544765976521, 0.07358502653926113, 0.20201993841014665, 0.020116284500070053, 0.030829191461851032, 0.008392487429754507, 0.12888798292525, 0.09172582076308784]
-->FPR:[0.020671834625323, 0.02247191011235955, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1220054389377619, mean FPR diff:0.1190374508097144
-->FNR:[0.10782865583456426, 0.10685920577617329, 0.23529411764705882, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.16216216216216217, 0.125], mean FNR:0.09930171132481605, mean FNR diff:0.07876390107838416
-->mean fnr diff metric 0.1190374508097144
testing dataset
-->original metric score:
-->individual metric:0.12664473684210525, num_idi:154, num_all:1216
-->individual metric 0.12664473684210525
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8741865509761388
-->F1 0.896797153024911
-->FPR 0.062111801242236024
-->FNR 0.16
-->positive probability:0.5683297180043384, 262/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8575418994413407
-->F1 0.9057301293900185
-->FPR 0.13286713286713286
-->FNR 0.14485165794066318
-->positive probability:0.7108938547486033, 509/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8
-->FPR 0.04
-->FNR 0.2857142857142857
-->positive probability:0.28205128205128205, 11/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9545454545454546
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3181818181818182, 7/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.0029566919084489038, 0.06779863971644794, 0.06506849315068493, 0.4349315068493151, 0.934931506849315, 0.025068493150684927, 0.06506849315068493]
-->fnr_diff [0.045400313971742545, 0.030251971912405723, 0.010400313971742542, 0.11459968602825746, 0.11459968602825746, 0.11459968602825746, 0.17111459968602824, 0.010400313971742542]
-->FPR:[0.062111801242236024, 0.13286713286713286, 0.0, 0.5, 1.0, 0.04, 0.0], mean FPR:0.24785413344419555, mean FPR diff:0.22797483211079733
-->FNR:[0.16, 0.14485165794066318, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.1050707429568686, mean FNR diff:0.07642082144980425
-->mean fnr diff metric 0.22797483211079733
-->epoch 16
-->start_index 0
-->batch_size 98
-->FUR:3.644174794285028e-18, FU:2.0042962113030205e-16, P:55
-->FUR:6.467192584537612e-32, FU:3.2982682533790126e-30, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1032, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.03448275849223137, FU:2.0, P:58
-->FUR:0.0416666679084301, FU:2.0, P:48
-->FUR:8.438064293516193e-15, FU:2.5314192880548578e-14, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1526, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:4.739455913702338e-19, FU:1.895782365480935e-18, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1451, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:2.2896711553462995e-20, FU:1.076145433319238e-18, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1343, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:3.925691369199846e-12, FU:1.9628455805165146e-10, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.5574643357124912e-23, FU:1.0902250823303981e-22, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1380, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1430, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.035714488476514816, FU:2.000011444091797, P:56
-->FUR:0.020477375015616417, FU:1.0033913850784302, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:2.014094661717536e-06, FU:8.056378646870144e-06, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1389, bias_loss:nan
-->after epoch 16
-->overall baseline on training dataset
-->ACC 0.9800542005420054
-->F1 0.979367571204306
-->FPR: 0.009115963536145855
-->FNR: 0.03127772848269743
-->overall baseline on testing dataset
-->ACC 0.9109987357774968
-->F1 0.9058319957196361
-->FPR: 0.06555772994129158
-->FNR: 0.1140763997906855
training dataset
-->original metric score:
-->individual metric:0.11279751638496033, num_idi:327, num_all:2899
-->individual metric 0.11279751638496033
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.924812030075188
-->F1 0.937984496124031
-->FPR 0.020671834625323
-->FNR 0.10635155096011817
-->positive probability:0.5761278195488722, 613/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9109707064905227
-->F1 0.9410870391486127
-->FPR 0.02247191011235955
-->FNR 0.10613718411552346
-->positive probability:0.7156806433084434, 1246/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9146341463414634
-->F1 0.8985507246376812
-->FPR 0.022222222222222223
-->FNR 0.16216216216216217
-->positive probability:0.3902439024390244, 32/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.011555871089177144, 0.013355946576213695, 0.009115963536145855, 0.6575507031305208, 0.013106258686076368, 0.009115963536145855]
-->fnr_diff [0.07507382247742074, 0.07485945563282603, 0.20401638916436138, 0.018119833745855324, 0.028832740707636303, 0.010388938183969236, 0.13088443367946473, 0.09372227151730257]
-->FPR:[0.020671834625323, 0.02247191011235955, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1220054389377619, mean FPR diff:0.11896678442571329
-->FNR:[0.10635155096011817, 0.10613718411552346, 0.23529411764705882, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.16216216216216217, 0.125], mean FNR:0.09902682050792906, mean FNR diff:0.07948723563860453
-->mean fnr diff metric 0.11896678442571329
testing dataset
-->original metric score:
-->individual metric:0.125, num_idi:152, num_all:1216
-->individual metric 0.125
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8763557483731019
-->F1 0.8987566607460037
-->FPR 0.062111801242236024
-->FNR 0.15666666666666668
-->positive probability:0.5704989154013015, 263/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8603351955307262
-->F1 0.9077490774907748
-->FPR 0.13286713286713286
-->FNR 0.14136125654450263
-->positive probability:0.7136871508379888, 511/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8
-->FPR 0.04
-->FNR 0.2857142857142857
-->positive probability:0.28205128205128205, 11/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9545454545454546
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3181818181818182, 7/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.0034459286990555574, 0.06730940292584128, 0.06555772994129158, 0.4344422700587084, 0.9344422700587084, 0.02555772994129158, 0.06555772994129158]
-->fnr_diff [0.04259026687598118, 0.02728485675381713, 0.010923600209314502, 0.1140763997906855, 0.1140763997906855, 0.1140763997906855, 0.1716378859236002, 0.010923600209314502]
-->FPR:[0.062111801242236024, 0.13286713286713286, 0.0, 0.5, 1.0, 0.04, 0.0], mean FPR:0.24785413344419555, mean FPR diff:0.22804472308088403
-->FNR:[0.15666666666666668, 0.14136125654450263, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.10421777611568188, mean FNR diff:0.0756986761680105
-->mean fnr diff metric 0.22804472308088403
-->epoch 17
-->start_index 0
-->batch_size 98
-->FUR:1.7632210524542308e-13, FU:9.697715720735633e-12, P:55
-->FUR:6.412391552164692e-23, FU:3.2703195401426994e-21, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1022, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.03448275849223137, FU:2.0, P:58
-->FUR:0.0416666679084301, FU:2.0, P:48
-->FUR:1.118449421966261e-08, FU:3.355348354716625e-08, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1511, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:3.0612712885458304e-12, FU:1.2245085154183322e-11, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1442, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:4.308073520722889e-15, FU:2.024794584385911e-13, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1330, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:7.19580672825515e-10, FU:3.5979034862521075e-08, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.9425724572154566e-17, FU:1.359800753138044e-16, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1369, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1404, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.03574332594871521, FU:2.0016262531280518, P:56
-->FUR:0.03162751719355583, FU:1.549748420715332, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0002765664248727262, FU:0.0011062656994909048, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1378, bias_loss:nan
-->after epoch 17
-->overall baseline on training dataset
-->ACC 0.9800542005420054
-->F1 0.979372197309417
-->FPR: 0.009327962688149248
-->FNR: 0.031055900621118012
-->overall baseline on testing dataset
-->ACC 0.9107458912768648
-->F1 0.905589729874298
-->FPR: 0.06604696673189824
-->FNR: 0.1140763997906855
training dataset
-->original metric score:
-->individual metric:0.11210762331838565, num_idi:325, num_all:2899
-->individual metric 0.11210762331838565
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9257518796992481
-->F1 0.9388071262587142
-->FPR 0.020671834625323
-->FNR 0.10487444608567208
-->positive probability:0.5770676691729323, 614/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9126938541068351
-->F1 0.9422930903568717
-->FPR 0.02247191011235955
-->FNR 0.10397111913357401
-->positive probability:0.7174037909247559, 1249/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9146341463414634
-->F1 0.8985507246376812
-->FPR 0.022222222222222223
-->FNR 0.16216216216216217
-->positive probability:0.3902439024390244, 32/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.01134387193717375, 0.013143947424210302, 0.009327962688149248, 0.6573387039785173, 0.012894259534072975, 0.009327962688149248]
-->fnr_diff [0.07381854546455406, 0.072915218512456, 0.2042382170259408, 0.017898005884275908, 0.028610912846056887, 0.010610766045548652, 0.13110626154104416, 0.09394409937888198]
-->FPR:[0.020671834625323, 0.02247191011235955, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1220054389377619, mean FPR diff:0.11889611804171214
-->FNR:[0.10487444608567208, 0.10397111913357401, 0.23529411764705882, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.16216216216216217, 0.125], mean FNR:0.09857142427587962, mean FNR diff:0.0791427533373448
-->mean fnr diff metric 0.11889611804171214
testing dataset
-->original metric score:
-->individual metric:0.12582236842105263, num_idi:153, num_all:1216
-->individual metric 0.12582236842105263
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8763557483731019
-->F1 0.8987566607460037
-->FPR 0.062111801242236024
-->FNR 0.15666666666666668
-->positive probability:0.5704989154013015, 263/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8603351955307262
-->F1 0.9077490774907748
-->FPR 0.13286713286713286
-->FNR 0.14136125654450263
-->positive probability:0.7136871508379888, 511/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8
-->FPR 0.04
-->FNR 0.2857142857142857
-->positive probability:0.28205128205128205, 11/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.9090909090909091
-->F1 0.875
-->FPR 0.07142857142857142
-->FNR 0.125
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.003935165489662211, 0.06682016613523463, 0.10061969993476842, 0.43395303326810175, 0.9339530332681018, 0.026046966731898234, 0.0053816046966731895]
-->fnr_diff [0.04259026687598118, 0.02728485675381713, 0.010923600209314502, 0.1140763997906855, 0.1140763997906855, 0.1140763997906855, 0.1716378859236002, 0.010923600209314502]
-->FPR:[0.062111801242236024, 0.13286713286713286, 0.16666666666666666, 0.5, 1.0, 0.04, 0.07142857142857142], mean FPR:0.28186773888637245, mean FPR diff:0.2243870956463486
-->FNR:[0.15666666666666668, 0.14136125654450263, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.10421777611568188, mean FNR diff:0.0756986761680105
-->mean fnr diff metric 0.2243870956463486
-->epoch 18
-->start_index 0
-->batch_size 98
-->FUR:4.1176214447854304e-16, FU:2.2646918316896782e-14, P:55
-->FUR:9.283733444624788e-28, FU:4.734704018240043e-26, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1004, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.03448275849223137, FU:2.0, P:58
-->FUR:0.0416666679084301, FU:2.0, P:48
-->FUR:4.0908933222027725e-19, FU:1.2272680225102259e-18, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1500, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:9.499918479029147e-29, FU:3.799967391611659e-28, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1443, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:7.510701481448075e-36, FU:3.530029739328484e-34, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1321, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:2.017745380404992e-27, FU:1.0088726709431965e-25, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.1595106123047295e-34, FU:8.116574515721847e-34, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1357, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1405, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.020408162847161293, FU:1.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:5.688740841196594e-36, FU:2.2754963364786376e-35, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1351, bias_loss:nan
-->after epoch 18
-->overall baseline on training dataset
-->ACC 0.9800542005420054
-->F1 0.979372197309417
-->FPR: 0.009327962688149248
-->FNR: 0.031055900621118012
-->overall baseline on testing dataset
-->ACC 0.9109987357774968
-->F1 0.9059326563335115
-->FPR: 0.06653620352250489
-->FNR: 0.1130298273155416
training dataset
-->original metric score:
-->individual metric:0.11245256985167298, num_idi:326, num_all:2899
-->individual metric 0.11245256985167298
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9266917293233082
-->F1 0.9396284829721362
-->FPR 0.020671834625323
-->FNR 0.103397341211226
-->positive probability:0.5780075187969925, 615/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9138426191843768
-->F1 0.9430955993930198
-->FPR 0.02247191011235955
-->FNR 0.10252707581227437
-->positive probability:0.7185525560022975, 1251/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9146341463414634
-->F1 0.8985507246376812
-->FPR 0.022222222222222223
-->FNR 0.16216216216216217
-->positive probability:0.3902439024390244, 32/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.01134387193717375, 0.013143947424210302, 0.009327962688149248, 0.6573387039785173, 0.012894259534072975, 0.009327962688149248]
-->fnr_diff [0.07234144059010798, 0.07147117519115635, 0.2042382170259408, 0.017898005884275908, 0.028610912846056887, 0.010610766045548652, 0.13110626154104416, 0.09394409937888198]
-->FPR:[0.020671834625323, 0.02247191011235955, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1220054389377619, mean FPR diff:0.11889611804171214
-->FNR:[0.103397341211226, 0.10252707581227437, 0.23529411764705882, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.16216216216216217, 0.125], mean FNR:0.09820628075141141, mean FNR diff:0.0787776098128766
-->mean fnr diff metric 0.11889611804171214
testing dataset
-->original metric score:
-->individual metric:0.125, num_idi:152, num_all:1216
-->individual metric 0.125
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8763557483731019
-->F1 0.8991150442477875
-->FPR 0.06832298136645963
-->FNR 0.15333333333333332
-->positive probability:0.5748373101952278, 265/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8589385474860335
-->F1 0.9069124423963133
-->FPR 0.13986013986013987
-->FNR 0.14136125654450263
-->positive probability:0.7150837988826816, 512/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8
-->FPR 0.04
-->FNR 0.2857142857142857
-->positive probability:0.28205128205128205, 11/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.0017867778439547427, 0.07332393633763498, 0.10013046314416177, 0.4334637964774951, 0.9334637964774951, 0.026536203522504888, 0.07632093933463796]
-->fnr_diff [0.040303506017791715, 0.028331429228961022, 0.011970172684458394, 0.1130298273155416, 0.1130298273155416, 0.1130298273155416, 0.17268445839874408, 0.011970172684458394]
-->FPR:[0.06832298136645963, 0.13986013986013987, 0.16666666666666666, 0.5, 1.0, 0.04, 0.14285714285714285], mean FPR:0.2939581329643442, mean FPR diff:0.23500370187684066
-->FNR:[0.15333333333333332, 0.14136125654450263, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.1038011094490152, mean FNR diff:0.0755436526201298
-->mean fnr diff metric 0.23500370187684066
-->epoch 19
-->start_index 0
-->batch_size 98
-->FUR:2.6402364252060735e-32, FU:1.4521301132092091e-30, P:55
-->FUR:0.0, FU:0.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.0996, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.03448275849223137, FU:2.0, P:58
-->FUR:0.0416666679084301, FU:2.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1496, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1450, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.0, FU:0.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1315, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:4.20114744668591e-39, FU:2.1005739755766787e-37, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1344, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1401, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.020408162847161293, FU:1.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1330, bias_loss:nan
-->after epoch 19
-->overall baseline on training dataset
-->ACC 0.9797289972899729
-->F1 0.9790429227838171
-->FPR: 0.009963960144159423
-->FNR: 0.031055900621118012
-->overall baseline on testing dataset
-->ACC 0.9109987357774968
-->F1 0.9059326563335115
-->FPR: 0.06653620352250489
-->FNR: 0.1130298273155416
training dataset
-->original metric score:
-->individual metric:0.11314246291824767, num_idi:328, num_all:2899
-->individual metric 0.11314246291824767
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9266917293233082
-->F1 0.9396284829721362
-->FPR 0.020671834625323
-->FNR 0.103397341211226
-->positive probability:0.5780075187969925, 615/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9144170017231477
-->F1 0.9434963974213121
-->FPR 0.02247191011235955
-->FNR 0.10180505415162455
-->positive probability:0.7191269385410684, 1252/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9146341463414634
-->F1 0.8985507246376812
-->FPR 0.022222222222222223
-->FNR 0.16216216216216217
-->positive probability:0.3902439024390244, 32/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.010707874481163575, 0.012507949968200127, 0.009963960144159423, 0.6567027065225072, 0.0122582620780628, 0.009963960144159423]
-->fnr_diff [0.07234144059010798, 0.07074915353050654, 0.2042382170259408, 0.017898005884275908, 0.028610912846056887, 0.010610766045548652, 0.13110626154104416, 0.09394409937888198]
-->FPR:[0.020671834625323, 0.02247191011235955, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1220054389377619, mean FPR diff:0.11868411888970876
-->FNR:[0.103397341211226, 0.10180505415162455, 0.23529411764705882, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.16216216216216217, 0.125], mean FNR:0.09811602804383018, mean FNR diff:0.07868735710529537
-->mean fnr diff metric 0.11868411888970876
testing dataset
-->original metric score:
-->individual metric:0.12417763157894737, num_idi:151, num_all:1216
-->individual metric 0.12417763157894737
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8763557483731019
-->F1 0.8991150442477875
-->FPR 0.06832298136645963
-->FNR 0.15333333333333332
-->positive probability:0.5748373101952278, 265/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8589385474860335
-->F1 0.9069124423963133
-->FPR 0.13986013986013987
-->FNR 0.14136125654450263
-->positive probability:0.7150837988826816, 512/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8
-->FPR 0.04
-->FNR 0.2857142857142857
-->positive probability:0.28205128205128205, 11/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.0017867778439547427, 0.07332393633763498, 0.10013046314416177, 0.4334637964774951, 0.9334637964774951, 0.026536203522504888, 0.07632093933463796]
-->fnr_diff [0.040303506017791715, 0.028331429228961022, 0.011970172684458394, 0.1130298273155416, 0.1130298273155416, 0.1130298273155416, 0.17268445839874408, 0.011970172684458394]
-->FPR:[0.06832298136645963, 0.13986013986013987, 0.16666666666666666, 0.5, 1.0, 0.04, 0.14285714285714285], mean FPR:0.2939581329643442, mean FPR diff:0.23500370187684066
-->FNR:[0.15333333333333332, 0.14136125654450263, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.1038011094490152, mean FNR diff:0.0755436526201298
-->mean fnr diff metric 0.23500370187684066
    train_ind  train_acc  ...  test_fnr_mean  test_fnr_diff
0    0.127975   0.975393  ...       0.030632       0.047861
1    0.117627   0.978645  ...       0.088723       0.064783
2    0.113832   0.980379  ...       0.091064       0.064638
3    0.112798   0.981355  ...       0.101460       0.075819
4    0.113487   0.981572  ...       0.100191       0.075073
5    0.112453   0.980596  ...       0.097453       0.071681
6    0.111763   0.967046  ...       0.095387       0.064415
7    0.106588   0.965637  ...       0.096260       0.066335
8    0.112453   0.969756  ...       0.104098       0.073616
9    0.110728   0.973659  ...       0.102353       0.072394
10   0.111763   0.972249  ...       0.104733       0.074251
11   0.112798   0.972575  ...       0.104078       0.073728
12   0.114177   0.974743  ...       0.102571       0.073921
13   0.110383   0.977236  ...       0.106360       0.077448
14   0.114177   0.978537  ...       0.105487       0.076576
15   0.114177   0.979187  ...       0.105071       0.076421
16   0.112798   0.980054  ...       0.104218       0.075699
17   0.112108   0.980054  ...       0.104218       0.075699
18   0.112453   0.980054  ...       0.103801       0.075544
19   0.113142   0.979729  ...       0.103801       0.075544

[20 rows x 22 columns]
-->gamma 1.5
-->model.parameters() <generator object Module.parameters at 0x7f167fb45660>
-->classifier <generator object Module.parameters at 0x7f167fb45660>
-->orig_weight tensor([[-0.0240,  0.0171, -0.0242,  ..., -0.0014,  0.0505, -0.0482],
        [-0.0056, -0.0042,  0.0331,  ...,  0.0021,  0.0004,  0.0416],
        [-0.0199, -0.0268,  0.0002,  ...,  0.0078,  0.0110, -0.0016],
        ...,
        [-0.0333, -0.0016, -0.0015,  ...,  0.0180,  0.0236,  0.0306],
        [ 0.0436, -0.0571, -0.0145,  ..., -0.0023,  0.0019,  0.0354],
        [ 0.0186,  0.0364,  0.0031,  ...,  0.0367,  0.0291,  0.0056]],
       device='cuda:0', grad_fn=<CloneBackward0>)
-->orig_bias tensor([-0.0321, -0.0126,  0.0150,  0.0176, -0.0273,  0.0535,  0.0194,  0.0085,
        -0.0014,  0.0257, -0.0179,  0.0247,  0.0077, -0.0068,  0.0377, -0.0171,
         0.0018, -0.0251, -0.0069, -0.0210, -0.0171, -0.0352, -0.0287,  0.0167,
         0.0115, -0.0026,  0.0061,  0.0137,  0.0516,  0.0009, -0.0143, -0.0342,
        -0.0017, -0.0132,  0.0127,  0.0379, -0.0145, -0.0180, -0.0219,  0.0012,
        -0.0263, -0.0385, -0.0087,  0.0135, -0.0650,  0.0257, -0.0180, -0.0278,
         0.0102, -0.0166, -0.0297, -0.0016,  0.0383,  0.0169, -0.0173, -0.0205,
        -0.0345, -0.0222, -0.0289, -0.0373, -0.0024], device='cuda:0',
       grad_fn=<CloneBackward0>)
-->MinValue:-3.2998316455372216, MaxValue:3.9719170089423623
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9135338345864662
-->F1 0.9291217257318952
-->FPR 0.046511627906976744
-->FNR 0.10930576070901034
-->positive probability:0.5836466165413534, 621/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9092475588742103
-->F1 0.9406906906906906
-->FPR 0.07303370786516854
-->FNR 0.09530685920577617
-->positive probability:0.7346352670878805, 1279/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.92
-->F1 0.9375
-->FPR 0.0
-->FNR 0.11764705882352941
-->positive probability:0.6, 30/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9605263157894737
-->F1 0.9798657718120806
-->FPR None
-->FNR 0.039473684210526314
-->positive probability:0.9605263157894737, 73/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9684466019417476
-->F1 0.9839307787391842
-->FPR 0.6666666666666666
-->FNR 0.02689486552567237
-->positive probability:0.970873786407767, 400/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.03167168790697675, 0.05819376786516854, 0.01483994, 0.6518267266666666, 0.007382282222222224, 0.01483994]
-->fnr_diff [0.09333415070901034, 0.07933524920577617, 0.10167544882352941, 0.023502074210526313, 0.01092325552567237, 0.017361723333333332, 0.11916352513513515, 0.10902839]
-->FPR: [0.046511627906976744, 0.07303370786516854, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.1347390374435057, mean FPR diff:0.12979239077683905
-->FNR: [0.10930576070901034, 0.09530685920577617, 0.11764705882352941, 0.039473684210526314, 0.02689486552567237, 0.03333333333333333, 0.13513513513513514, 0.125], mean FNR:0.08526208711787289, mean FNR diff:0.0692904771178729
-->base group metric 0.12979239077683905 0.1347390374435057
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8655097613882863
-->F1 0.8912280701754387
-->FPR 0.09937888198757763
-->FNR 0.15333333333333332
-->positive probability:0.5856832971800434, 270/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8603351955307262
-->F1 0.9087591240875912
-->FPR 0.17482517482517482
-->FNR 0.13089005235602094
-->positive probability:0.7304469273743017, 523/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.6363636363636364, 14/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9871794871794872
-->F1 0.9935483870967742
-->FPR 1.0
-->FNR 0.0064516129032258064
-->positive probability:0.9935897435897436, 155/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9230769230769231
-->F1 0.9600000000000001
-->FPR None
-->FNR 0.07692307692307693
-->positive probability:0.9230769230769231, 36/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.75
-->FPR 0.04
-->FNR 0.35714285714285715
-->positive probability:0.2564102564102564, 10/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8636363636363636
-->F1 0.823529411764706
-->FPR 0.14285714285714285
-->FNR 0.125
-->positive probability:0.4090909090909091, 9/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.08453894198757764, 0.15998523482517482, 0.01483994, 0.48516006, 0.98516006, 0.02516006, 0.12801720285714285]
-->fnr_diff [0.13736172333333332, 0.11491844235602094, 0.10902839, 0.01597161, 0.009519997096774195, 0.06095146692307693, 0.3411712471428571, 0.10902839]
-->FPR: [0.09937888198757763, 0.17482517482517482, 0.0, 0.5, 1.0, 0.04, 0.14285714285714285], mean FPR:0.2795801713814136, mean FPR diff:0.26898021423855645
-->FNR: [0.15333333333333332, 0.13089005235602094, 0.125, 0.0, 0.0064516129032258064, 0.07692307692307693, 0.35714285714285715, 0.125], mean FNR:0.12184261658231427, mean FNR diff:0.11224390835650783
-->base group metric 0.26898021423855645 0.2795801713814136
-->epoch 0
-->start_index 0
-->batch_size 98
-->FUR:2.8659286127447942e-39, FU:1.5762607790485908e-37, P:55
-->FUR:0.0, FU:0.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.0982, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.06896551698446274, FU:4.0, P:58
-->FUR:0.0625, FU:3.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1644, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.09259249269962311, FU:4.99999475479126, P:54
-->FUR:8.95236352821259e-24, FU:3.580945411285036e-23, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1578, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:5.188440761402113e-17, FU:2.4385671975636625e-15, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:2.7441442093169237e-35, FU:2.7441442093169237e-35, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1143, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.040150612592697144, FU:2.007530689239502, P:50
-->FUR:0.03521979600191116, FU:2.007528305053711, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1153, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1310, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0714285746216774, FU:4.0, P:56
-->FUR:0.12642277777194977, FU:6.194715976715088, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [1/20], Loss: nan, acc_loss, 0.1264, bias_loss:nan
-->after epoch 0
-->overall baseline on training dataset
-->ACC 0.9782113821138212
-->F1 0.9776343607432959
-->FPR: 0.01823192707229171
-->FNR: 0.025510204081632654
-->overall baseline on testing dataset
-->ACC 0.9079646017699115
-->F1 0.9042105263157895
-->FPR: 0.08365949119373776
-->FNR: 0.10099424385138671
training dataset
-->original metric score:
-->individual metric:0.11728182131769575, num_idi:340, num_all:2899
-->individual metric 0.11728182131769575
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9323308270676691
-->F1 0.9450381679389314
-->FPR 0.03617571059431524
-->FNR 0.08567208271787297
-->positive probability:0.5949248120300752, 633/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9276278001148766
-->F1 0.9528795811518324
-->FPR 0.042134831460674156
-->FNR 0.08014440433212996
-->positive probability:0.7403790924755888, 1289/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963459196102314
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 412/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9142857142857143
-->FPR 0.022222222222222223
-->FNR 0.13513513513513514
-->positive probability:0.4024390243902439, 33/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.017943783522023533, 0.023902904388382447, 0.01823192707229171, 0.9817680729277083, 0.003990295149930514, 0.01823192707229171]
-->fnr_diff [0.06016187863624031, 0.05463420025049731, 0.20978391356542617, 0.012352309344790549, 0.025510204081632654, 0.01615646258503401, 0.10962493105350249, 0.09948979591836735]
-->FPR:[0.03617571059431524, 0.042134831460674156, 0.0, 1.0, 0.022222222222222223, 0.0], mean FPR:0.18342212737953525, mean FPR diff:0.17734481835543803
-->FNR:[0.08567208271787297, 0.08014440433212996, 0.23529411764705882, 0.013157894736842105, 0.0, 0.041666666666666664, 0.13513513513513514, 0.125], mean FNR:0.08950878765446321, mean FNR diff:0.07346421192943636
-->mean fnr diff metric 0.17734481835543803
testing dataset
-->original metric score:
-->individual metric:0.12417763157894737, num_idi:151, num_all:1216
-->individual metric 0.12417763157894737
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.89587852494577
-->F1 0.9172413793103449
-->FPR 0.08695652173913043
-->FNR 0.11333333333333333
-->positive probability:0.6073752711496746, 280/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8743016759776536
-->F1 0.9181818181818182
-->FPR 0.15384615384615385
-->FNR 0.11867364746945899
-->positive probability:0.7360335195530726, 527/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.003297030545392668, 0.07018666265241609, 0.08300717547292889, 0.4163405088062622, 0.9163405088062623, 0.0036594911937377628, 0.13062622309197652]
-->fnr_diff [0.012339089481946619, 0.017679403618072284, 0.02400575614861329, 0.10099424385138671, 0.10099424385138671, 0.10099424385138671, 0.11329147043432757, 0.02400575614861329]
-->FPR:[0.08695652173913043, 0.15384615384615385, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.31453643664823794, mean FPR diff:0.23192251436699665
-->FNR:[0.11333333333333333, 0.11867364746945899, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.08703658688606333, mean FNR diff:0.06178802592321665
-->mean fnr diff metric 0.23192251436699665
-->epoch 1
-->start_index 0
-->batch_size 98
-->FUR:4.477347527190517e-28, FU:2.4625410195841628e-26, P:55
-->FUR:9.081077223527245e-08, FU:4.631349383998895e-06, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:9.268663916373043e-07, FU:4.634332071873359e-06, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.0860, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620689809322357, FU:5.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1381, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703539818525314, FU:1.9999114274978638, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1593, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.046875, FU:3.0, P:64
-->FUR:0.042553093284368515, FU:1.999995470046997, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1318, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:3.111964714281057e-34, FU:1.5559823295898796e-32, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1222, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1368, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.06122449040412903, FU:3.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [2/20], Loss: nan, acc_loss, 0.1255, bias_loss:nan
-->after epoch 1
-->overall baseline on training dataset
-->ACC 0.977669376693767
-->F1 0.9771770440948372
-->FPR: 0.022895908416366333
-->FNR: 0.021739130434782608
-->overall baseline on testing dataset
-->ACC 0.9079646017699115
-->F1 0.9050104384133612
-->FPR: 0.09148727984344422
-->FNR: 0.09262166405023547
training dataset
-->original metric score:
-->individual metric:0.11831666091755778, num_idi:343, num_all:2899
-->individual metric 0.11831666091755778
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9323308270676691
-->F1 0.945288753799392
-->FPR 0.04392764857881137
-->FNR 0.08124076809453472
-->positive probability:0.6005639097744361, 639/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9304997128087306
-->F1 0.9550018594272963
-->FPR 0.056179775280898875
-->FNR 0.07292418772563176
-->positive probability:0.7489948305571511, 1304/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963459196102314
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 412/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.021031740162445033, 0.03328386686453254, 0.022895908416366333, 0.9771040915836336, 0.0006736861941441102, 0.022895908416366333]
-->fnr_diff [0.05950163765975211, 0.051185057290849156, 0.21355498721227623, 0.008581235697940504, 0.021739130434782608, 0.019927536231884056, 0.0863689776733255, 0.10326086956521739]
-->FPR:[0.04392764857881137, 0.056179775280898875, 0.0, 1.0, 0.022222222222222223, 0.0], mean FPR:0.18705494101365538, mean FPR diff:0.17964753360624797
-->FNR:[0.08124076809453472, 0.07292418772563176, 0.23529411764705882, 0.013157894736842105, 0.0, 0.041666666666666664, 0.10810810810810811, 0.125], mean FNR:0.08467396787235527, mean FNR diff:0.07051492897075344
-->mean fnr diff metric 0.17964753360624797
testing dataset
-->original metric score:
-->individual metric:0.13157894736842105, num_idi:160, num_all:1216
-->individual metric 0.13157894736842105
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8915401301518439
-->F1 0.9140893470790379
-->FPR 0.09937888198757763
-->FNR 0.11333333333333333
-->positive probability:0.6117136659436009, 282/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8729050279329609
-->F1 0.9174977334542158
-->FPR 0.16783216783216784
-->FNR 0.1169284467713787
-->positive probability:0.7402234636871509, 530/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.007891602144133411, 0.07634488798872362, 0.07517938682322244, 0.40851272015655576, 0.9085127201565558, 0.01148727984344422, 0.12279843444227005]
-->fnr_diff [0.020711669283097853, 0.024306782721143227, 0.032378335949764525, 0.09262166405023547, 0.09262166405023547, 0.09262166405023547, 0.1216640502354788, 0.032378335949764525]
-->FPR:[0.09937888198757763, 0.16783216783216784, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3183090615388752, mean FPR diff:0.23010386165070076
-->FNR:[0.11333333333333333, 0.1169284467713787, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.0868184367988033, mean FNR diff:0.06366302078624442
-->mean fnr diff metric 0.23010386165070076
-->epoch 2
-->start_index 0
-->batch_size 98
-->FUR:0.0, FU:0.0, P:55
-->FUR:0.01961972936987877, FU:1.0006061792373657, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.00012135333236074075, FU:0.0006067666690796614, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.0867, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.12068965286016464, FU:7.0, P:58
-->FUR:0.125, FU:6.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1551, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.0555555559694767, FU:3.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.20000000298023224, FU:1.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1818, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.0625, FU:4.0, P:64
-->FUR:0.06382978707551956, FU:3.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1448, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1222, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1236, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.1071428582072258, FU:6.0, P:56
-->FUR:0.10204081982374191, FU:5.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [3/20], Loss: nan, acc_loss, 0.1230, bias_loss:nan
-->after epoch 2
-->overall baseline on training dataset
-->ACC 0.9753929539295393
-->F1 0.9749420465835082
-->FPR: 0.028619885520457918
-->FNR: 0.02040816326530612
-->overall baseline on testing dataset
-->ACC 0.9036662452591656
-->F1 0.901064658530252
-->FPR: 0.10029354207436399
-->FNR: 0.09209837781266353
training dataset
-->original metric score:
-->individual metric:0.12073128665056916, num_idi:350, num_all:2899
-->individual metric 0.12073128665056916
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9323308270676691
-->F1 0.945619335347432
-->FPR 0.05426356589147287
-->FNR 0.07533234859675036
-->positive probability:0.6080827067669173, 647/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9316484778862723
-->F1 0.9559748427672956
-->FPR 0.07303370786516854
-->FNR 0.06714801444043321
-->positive probability:0.7570361860999426, 1318/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.84
-->F1 0.8666666666666666
-->FPR 0.0
-->FNR 0.23529411764705882
-->positive probability:0.52, 26/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963459196102314
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 412/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9315068493150684
-->FPR 0.044444444444444446
-->FNR 0.08108108108108109
-->positive probability:0.43902439024390244, 36/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9655172413793104
-->F1 0.9565217391304348
-->FPR 0.0
-->FNR 0.08333333333333333
-->positive probability:0.3793103448275862, 22/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.02564368037101495, 0.04441382234471062, 0.028619885520457918, 0.9713801144795421, 0.01582455892398653, 0.028619885520457918]
-->fnr_diff [0.05492418533144425, 0.04673985117512709, 0.2148859543817527, 0.007250268528464016, 0.02040816326530612, 0.021258503401360544, 0.06067291781577497, 0.06292517006802721]
-->FPR:[0.05426356589147287, 0.07303370786516854, 0.0, 1.0, 0.044444444444444446, 0.0], mean FPR:0.19529028636684764, mean FPR diff:0.18575032452669502
-->FNR:[0.07533234859675036, 0.06714801444043321, 0.23529411764705882, 0.013157894736842105, 0.0, 0.041666666666666664, 0.08108108108108109, 0.08333333333333333], mean FNR:0.07462668206277069, mean FNR diff:0.06113312674590712
-->mean fnr diff metric 0.18575032452669502
testing dataset
-->original metric score:
-->individual metric:0.13404605263157895, num_idi:163, num_all:1216
-->individual metric 0.13404605263157895
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8937093275488069
-->F1 0.9159519725557461
-->FPR 0.09937888198757763
-->FNR 0.11
-->positive probability:0.613882863340564, 283/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8756983240223464
-->F1 0.9196025293586269
-->FPR 0.17482517482517482
-->FNR 0.11169284467713787
-->positive probability:0.7458100558659218, 534/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.0009146600867863536, 0.07453163275081083, 0.06637312459230267, 0.399706457925636, 0.899706457925636, 0.020293542074363985, 0.11399217221135029]
-->fnr_diff [0.01790162218733647, 0.019594466864474344, 0.03290162218733647, 0.09209837781266353, 0.09209837781266353, 0.09209837781266353, 0.12218733647305074, 0.03290162218733647]
-->FPR:[0.09937888198757763, 0.17482517482517482, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3193080625378762, mean FPR diff:0.22507400679526945
-->FNR:[0.11, 0.11169284467713787, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.08574731987035653, mean FNR diff:0.06272272541719064
-->mean fnr diff metric 0.22507400679526945
-->epoch 3
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.03921568766236305, FU:2.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.20000000298023224, FU:1.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.0908, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.1034482792019844, FU:6.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1389, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.09259262681007385, FU:5.000001907348633, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1575, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.046875, FU:3.0, P:64
-->FUR:0.021276595070958138, FU:1.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1272, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1129, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.07999999821186066, FU:4.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1216, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.10204081982374191, FU:5.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [4/20], Loss: nan, acc_loss, 0.1096, bias_loss:nan
-->after epoch 3
-->overall baseline on training dataset
-->ACC 0.9818970189701897
-->F1 0.9814999446106126
-->FPR: 0.018867924528301886
-->FNR: 0.01730257320319432
-->overall baseline on testing dataset
-->ACC 0.9107458912768648
-->F1 0.9084306095979248
-->FPR: 0.09442270058708414
-->FNR: 0.0837257980115123
training dataset
-->original metric score:
-->individual metric:0.11417730251810969, num_idi:331, num_all:2899
-->individual metric 0.11417730251810969
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9445488721804511
-->F1 0.9555388093443857
-->FPR 0.041343669250646
-->FNR 0.06351550960118169
-->positive probability:0.6109022556390977, 650/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9402642159678346
-->F1 0.9617083946980854
-->FPR 0.0702247191011236
-->FNR 0.05703971119133574
-->positive probability:0.7645031591039633, 1331/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.9
-->F1 0.9206349206349206
-->FPR 0.0
-->FNR 0.14705882352941177
-->positive probability:0.58, 29/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 76/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9666666666666667
-->F1 0.983050847457627
-->FPR None
-->FNR 0.03333333333333333
-->positive probability:0.9666666666666667, 116/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9634146341463414
-->F1 0.9589041095890412
-->FPR 0.022222222222222223
-->FNR 0.05405405405405406
-->positive probability:0.43902439024390244, 36/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9655172413793104
-->F1 0.9565217391304348
-->FPR 0.0
-->FNR 0.08333333333333333
-->positive probability:0.3793103448275862, 22/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.02247574472234411, 0.05135679457282172, 0.018867924528301886, 0.6477987421383647, 0.003354297693920337, 0.018867924528301886]
-->fnr_diff [0.04621293639798736, 0.03973713798814142, 0.12975625032621746, 0.01730257320319432, 0.014857585428133195, 0.016030760130139012, 0.03675148085085973, 0.066030760130139]
-->FPR:[0.041343669250646, 0.0702247191011236, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.13340954620677642, mean FPR diff:0.1271202380306758
-->FNR:[0.06351550960118169, 0.05703971119133574, 0.14705882352941177, 0.0, 0.0024449877750611247, 0.03333333333333333, 0.05405405405405406, 0.08333333333333333], mean FNR:0.05509746910221388, mean FNR diff:0.04583493555685143
-->mean fnr diff metric 0.1271202380306758
testing dataset
-->original metric score:
-->individual metric:0.12664473684210525, num_idi:154, num_all:1216
-->individual metric 0.12664473684210525
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8915401301518439
-->F1 0.9152542372881356
-->FPR 0.12422360248447205
-->FNR 0.1
-->positive probability:0.6290672451193059, 290/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8854748603351955
-->F1 0.926916221033868
-->FPR 0.20279720279720279
-->FNR 0.0924956369982548
-->positive probability:0.7667597765363129, 549/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.029800901897387905, 0.10837450221011864, 0.07224396607958251, 0.40557729941291587, 0.9055772994129159, 0.014422700587084142, 0.11986301369863013]
-->fnr_diff [0.01627420198848771, 0.00876983898674251, 0.041274201988487705, 0.0837257980115123, 0.0837257980115123, 0.0837257980115123, 0.2019884877027734, 0.041274201988487705]
-->FPR:[0.12422360248447205, 0.20279720279720279, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3268533123191508, mean FPR diff:0.2365513833283764
-->FNR:[0.1, 0.0924956369982548, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09102624033906756, mean FNR diff:0.0700947908361895
-->mean fnr diff metric 0.2365513833283764
-->epoch 4
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.0832, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.1034482792019844, FU:6.0, P:58
-->FUR:0.13988955318927765, FU:6.714698791503906, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1308, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1399, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.0, FU:0.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:5.354582879521508e-13, FU:5.354582879521508e-13, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1186, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1121, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1188, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [5/20], Loss: nan, acc_loss, 0.1084, bias_loss:nan
-->after epoch 4
-->overall baseline on training dataset
-->ACC 0.9782113821138212
-->F1 0.9776741086304566
-->FPR: 0.019927920288318846
-->FNR: 0.023735581188997337
-->overall baseline on testing dataset
-->ACC 0.9051833122629582
-->F1 0.9022164276401564
-->FPR: 0.0949119373776908
-->FNR: 0.09471480900052329
training dataset
-->original metric score:
-->individual metric:0.12245601931700587, num_idi:355, num_all:2899
-->individual metric 0.12245601931700587
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9389097744360902
-->F1 0.9507948523845572
-->FPR 0.041343669250646
-->FNR 0.0723781388478582
-->positive probability:0.6052631578947368, 644/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9345203905801264
-->F1 0.9576523031203565
-->FPR 0.05056179775280899
-->FNR 0.06931407942238267
-->positive probability:0.7507179781734635, 1307/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9902912621359223
-->F1 0.9951219512195123
-->FPR 1.0
-->FNR 0.0024449877750611247
-->positive probability:0.9975728155339806, 411/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9655172413793104
-->F1 0.9565217391304348
-->FPR 0.0
-->FNR 0.08333333333333333
-->positive probability:0.3793103448275862, 22/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.02141574896232715, 0.03063387746449014, 0.019927920288318846, 0.9800720797116812, 0.002294301933903377, 0.019927920288318846]
-->fnr_diff [0.04864255765886086, 0.045578498233385334, 0.15273500704629678, 0.010577686452155233, 0.02129059341393621, 0.017931085477669327, 0.08437252691911078, 0.05959775214433599]
-->FPR:[0.041343669250646, 0.05056179775280899, 0.0, 1.0, 0.022222222222222223, 0.0], mean FPR:0.1856879482042795, mean FPR diff:0.1790453081081733
-->FNR:[0.0723781388478582, 0.06931407942238267, 0.17647058823529413, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.10810810810810811, 0.08333333333333333], mean FNR:0.07085922464069329, mean FNR diff:0.05509071341821881
-->mean fnr diff metric 0.1790453081081733
testing dataset
-->original metric score:
-->individual metric:0.12911184210526316, num_idi:157, num_all:1216
-->individual metric 0.12911184210526316
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.9002169197396963
-->F1 0.9215017064846417
-->FPR 0.09937888198757763
-->FNR 0.1
-->positive probability:0.6203904555314533, 286/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8798882681564246
-->F1 0.9225225225225225
-->FPR 0.17482517482517482
-->FNR 0.10645724258289703
-->positive probability:0.75, 537/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.004466944609886836, 0.07991323744748402, 0.07175472928897586, 0.40508806262230923, 0.9050880626223092, 0.014911937377690795, 0.11937377690802348]
-->fnr_diff [0.005285190999476719, 0.011742433582373743, 0.030285190999476713, 0.09471480900052329, 0.09471480900052329, 0.09471480900052329, 0.11957090528519099, 0.030285190999476713]
-->FPR:[0.09937888198757763, 0.17482517482517482, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3193080625378762, mean FPR diff:0.22865667869666845
-->FNR:[0.1, 0.10645724258289703, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.08384286960857643, mean FNR diff:0.0601641673584456
-->mean fnr diff metric 0.22865667869666845
-->epoch 5
-->start_index 0
-->batch_size 98
-->FUR:0.0181818176060915, FU:1.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.0883, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.1034482792019844, FU:6.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1428, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1516, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.046875, FU:3.0, P:64
-->FUR:0.021276595070958138, FU:1.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1306, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1204, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1203, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0714285746216774, FU:4.0, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [6/20], Loss: nan, acc_loss, 0.1156, bias_loss:nan
-->after epoch 5
-->overall baseline on training dataset
-->ACC 0.9725745257452575
-->F1 0.9719044975013882
-->FPR: 0.02565189739241043
-->FNR: 0.029281277728482696
-->overall baseline on testing dataset
-->ACC 0.9003792667509481
-->F1 0.8974492451847995
-->FPR: 0.1012720156555773
-->FNR: 0.09785452642595499
training dataset
-->original metric score:
-->individual metric:0.1252155915833046, num_idi:363, num_all:2899
-->individual metric 0.1252155915833046
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9379699248120301
-->F1 0.9502262443438915
-->FPR 0.04909560723514212
-->FNR 0.06942392909896603
-->positive probability:0.6099624060150376, 649/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9282021826536473
-->F1 0.9534797171566803
-->FPR 0.05898876404494382
-->FNR 0.07509025270758123
-->positive probability:0.7478460654796094, 1302/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.9
-->F1 0.9206349206349206
-->FPR 0.0
-->FNR 0.14705882352941177
-->positive probability:0.58, 29/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963459196102314
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 412/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9655172413793104
-->F1 0.9565217391304348
-->FPR 0.0
-->FNR 0.08333333333333333
-->positive probability:0.3793103448275862, 22/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.02344370984273169, 0.03333686665253339, 0.02565189739241043, 0.9743481026075895, 0.0034296751701882074, 0.02565189739241043]
-->fnr_diff [0.040142651370483326, 0.04580897497909853, 0.11777754580092907, 0.01612338299164059, 0.029281277728482696, 0.012385388938183969, 0.07882683037962541, 0.05405205560485063]
-->FPR:[0.04909560723514212, 0.05898876404494382, 0.0, 1.0, 0.022222222222222223, 0.0], mean FPR:0.18838443225038468, mean FPR diff:0.18097702484297729
-->FNR:[0.06942392909896603, 0.07509025270758123, 0.14705882352941177, 0.013157894736842105, 0.0, 0.041666666666666664, 0.10810810810810811, 0.08333333333333333], mean FNR:0.06722987602261365, mean FNR diff:0.049299763474161776
-->mean fnr diff metric 0.18097702484297729
testing dataset
-->original metric score:
-->individual metric:0.1356907894736842, num_idi:165, num_all:1216
-->individual metric 0.1356907894736842
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.89587852494577
-->F1 0.9178082191780823
-->FPR 0.09937888198757763
-->FNR 0.10666666666666667
-->positive probability:0.6160520607375272, 284/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8743016759776536
-->F1 0.9187725631768953
-->FPR 0.18181818181818182
-->FNR 0.11169284467713787
-->positive probability:0.7472067039106145, 535/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.0018931336679996608, 0.08054616616260453, 0.06539465101108936, 0.3987279843444227, 0.8987279843444227, 0.021272015655577292, 0.11301369863013698]
-->fnr_diff [0.008812140240711683, 0.013838318251182882, 0.02714547357404501, 0.09785452642595499, 0.09785452642595499, 0.09785452642595499, 0.11643118785975928, 0.02714547357404501]
-->FPR:[0.09937888198757763, 0.18181818181818182, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3203070635368772, mean FPR diff:0.22565366197375042
-->FNR:[0.10666666666666667, 0.11169284467713787, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.08533065320368985, mean FNR diff:0.06086702159720111
-->mean fnr diff metric 0.22565366197375042
-->epoch 6
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.05882352963089943, FU:3.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.0891, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.1034482792019844, FU:6.0, P:58
-->FUR:0.1041666641831398, FU:5.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1481, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1506, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.0468769408762455, FU:3.000124216079712, P:64
-->FUR:0.021279241889715195, FU:1.0001243352890015, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1273, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.3294625123005943e-10, FU:9.306237447326282e-10, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1174, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1183, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [7/20], Loss: nan, acc_loss, 0.1130, bias_loss:nan
-->after epoch 6
-->overall baseline on training dataset
-->ACC 0.973550135501355
-->F1 0.9729609929078014
-->FPR: 0.02671189315242739
-->FNR: 0.026175687666370896
-->overall baseline on testing dataset
-->ACC 0.8993678887484198
-->F1 0.896730669434354
-->FPR: 0.10518590998043052
-->FNR: 0.09576138147566719
training dataset
-->original metric score:
-->individual metric:0.12901000344946534, num_idi:374, num_all:2899
-->individual metric 0.12901000344946534
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9417293233082706
-->F1 0.9533132530120482
-->FPR 0.046511627906976744
-->FNR 0.06499261447562776
-->positive probability:0.6118421052631579, 651/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9345203905801264
-->F1 0.9577777777777778
-->FPR 0.06179775280898876
-->FNR 0.0664259927797834
-->positive probability:0.7553130384836301, 1315/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.9
-->F1 0.9206349206349206
-->FPR 0.0
-->FNR 0.14705882352941177
-->positive probability:0.58, 29/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9902912621359223
-->F1 0.9951219512195123
-->FPR 1.0
-->FNR 0.0024449877750611247
-->positive probability:0.9975728155339806, 411/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.926829268292683
-->F1 0.9166666666666667
-->FPR 0.044444444444444446
-->FNR 0.10810810810810811
-->positive probability:0.4268292682926829, 35/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9655172413793104
-->F1 0.9565217391304348
-->FPR 0.0
-->FNR 0.08333333333333333
-->positive probability:0.3793103448275862, 22/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.019799734754549353, 0.03508585965656137, 0.02671189315242739, 0.9732881068475726, 0.017732551292017056, 0.02671189315242739]
-->fnr_diff [0.03881692680925687, 0.0402503051134125, 0.12088313586304088, 0.013017792929528791, 0.02373069989130977, 0.015490979000295769, 0.08193242044173722, 0.05715764566696244]
-->FPR:[0.046511627906976744, 0.06179775280898876, 0.0, 1.0, 0.044444444444444446, 0.0], mean FPR:0.19212563752673498, mean FPR diff:0.1832216731425925
-->FNR:[0.06499261447562776, 0.0664259927797834, 0.14705882352941177, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.10810810810810811, 0.08333333333333333], mean FNR:0.06589855267560428, mean FNR diff:0.048909988214443034
-->mean fnr diff metric 0.1832216731425925
testing dataset
-->original metric score:
-->individual metric:0.14473684210526316, num_idi:176, num_all:1216
-->individual metric 0.14473684210526316
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8980477223427332
-->F1 0.9202037351443124
-->FPR 0.11180124223602485
-->FNR 0.09666666666666666
-->positive probability:0.6268980477223427, 289/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8784916201117319
-->F1 0.9221128021486124
-->FPR 0.20279720279720279
-->FNR 0.1012216404886562
-->positive probability:0.7597765363128491, 544/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.006615332255594325, 0.09761129281677226, 0.061480756686236135, 0.39481409001956946, 0.8948140900195695, 0.02518590998043052, 0.10909980430528375]
-->fnr_diff [0.0009052851909994719, 0.005460259012989008, 0.029238618524332807, 0.09576138147566719, 0.09576138147566719, 0.09576138147566719, 0.11852433281004708, 0.029238618524332807]
-->FPR:[0.11180124223602485, 0.20279720279720279, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3250786894265155, mean FPR diff:0.227088753726208
-->FNR:[0.09666666666666666, 0.1012216404886562, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.08277175268012965, mean FNR diff:0.05883140731121285
-->mean fnr diff metric 0.227088753726208
-->epoch 7
-->start_index 0
-->batch_size 98
-->FUR:0.036387912929058075, FU:2.0013351440429688, P:55
-->FUR:0.039241865277290344, FU:2.0013351440429688, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.0821, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.08620508015155792, FU:4.999894618988037, P:58
-->FUR:0.12499780207872391, FU:5.999894618988037, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1419, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1447, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.046875, FU:3.0, P:64
-->FUR:0.04216332733631134, FU:1.981676459312439, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1194, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:6.228138888254031e-22, FU:3.114069403737337e-20, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:4.451590808211676e-21, FU:3.116113444579138e-20, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1137, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1250, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.01785714365541935, FU:1.0, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0408247597126774e-09, FU:1.0408247597126774e-09, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [8/20], Loss: nan, acc_loss, 0.1112, bias_loss:nan
-->after epoch 7
-->overall baseline on training dataset
-->ACC 0.9802710027100271
-->F1 0.979723707664884
-->FPR: 0.01505193979224083
-->FNR: 0.024622892635314995
-->overall baseline on testing dataset
-->ACC 0.9087231352718078
-->F1 0.9053735255570117
-->FPR: 0.08659491193737769
-->FNR: 0.09628466771323914
training dataset
-->original metric score:
-->individual metric:0.12004139358399447, num_idi:348, num_all:2899
-->individual metric 0.12004139358399447
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9454887218045113
-->F1 0.9559939301972685
-->FPR 0.028423772609819122
-->FNR 0.06942392909896603
-->positive probability:0.6024436090225563, 641/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9350947731188972
-->F1 0.9578829668281775
-->FPR 0.03651685393258427
-->FNR 0.07220216606498195
-->positive probability:0.7455485353245261, 1298/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9975728155339806
-->F1 0.9987760097919216
-->FPR 0.0
-->FNR 0.0024449877750611247
-->positive probability:0.9902912621359223, 408/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9655172413793104
-->F1 0.9565217391304348
-->FPR 0.0
-->FNR 0.08333333333333333
-->positive probability:0.3793103448275862, 22/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.013371832817578292, 0.02146491414034344, 0.01505193979224083, 0.01505193979224083, 0.0071702824299813925, 0.01505193979224083]
-->fnr_diff [0.04480103646365103, 0.04757927342966695, 0.15184769559997913, 0.011464997898472891, 0.02217790486025387, 0.01704377403135167, 0.08348521547279311, 0.05871044069801833]
-->FPR:[0.028423772609819122, 0.03651685393258427, 0.0, 0.0, 0.022222222222222223, 0.0], mean FPR:0.014527141460770936, mean FPR diff:0.014527141460770936
-->FNR:[0.06942392909896603, 0.07220216606498195, 0.17647058823529413, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.10810810810810811, 0.08333333333333333], mean FNR:0.07085095925240668, mean FNR diff:0.05463879230677337
-->mean fnr diff metric 0.014527141460770936
testing dataset
-->original metric score:
-->individual metric:0.13157894736842105, num_idi:160, num_all:1216
-->individual metric 0.13157894736842105
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.89587852494577
-->F1 0.9178082191780823
-->FPR 0.09937888198757763
-->FNR 0.10666666666666667
-->positive probability:0.6160520607375272, 284/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8770949720670391
-->F1 0.92057761732852
-->FPR 0.17482517482517482
-->FNR 0.1099476439790576
-->positive probability:0.7472067039106145, 535/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.012783970050199947, 0.08823026288779713, 0.08007175472928897, 0.41340508806262233, 0.9134050880626223, 0.006594911937377684, 0.12769080234833657]
-->fnr_diff [0.010381998953427535, 0.013662976265818458, 0.02871533228676086, 0.09628466771323914, 0.09628466771323914, 0.09628466771323914, 0.18942961800104657, 0.02871533228676086]
-->FPR:[0.09937888198757763, 0.17482517482517482, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3193080625378762, mean FPR diff:0.23459741115403498
-->FNR:[0.10666666666666667, 0.1099476439790576, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09404107454500124, mean FNR diff:0.06996990761669146
-->mean fnr diff metric 0.23459741115403498
-->threshold 0.1
-->epoch 8
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.0852, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.0625, FU:3.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1380, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1478, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.0, FU:0.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:4.177387602499749e-14, FU:4.177387602499749e-14, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1184, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.0, FU:0.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1109, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1154, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.01785714365541935, FU:1.0, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [9/20], Loss: nan, acc_loss, 0.1087, bias_loss:nan
-->after epoch 8
-->overall baseline on training dataset
-->ACC 0.9787533875338753
-->F1 0.9782222222222223
-->FPR: 0.01907992368030528
-->FNR: 0.023513753327417924
-->overall baseline on testing dataset
-->ACC 0.9069532237673831
-->F1 0.9037153322867608
-->FPR: 0.09001956947162426
-->FNR: 0.09628466771323914
training dataset
-->original metric score:
-->individual metric:0.11900655398413246, num_idi:345, num_all:2899
-->individual metric 0.11900655398413246
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9445488721804511
-->F1 0.9552691432903715
-->FPR 0.031007751937984496
-->FNR 0.06942392909896603
-->positive probability:0.6033834586466166, 642/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9379666858127513
-->F1 0.9598513011152416
-->FPR 0.03932584269662921
-->FNR 0.06787003610108304
-->positive probability:0.7495692130959218, 1305/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9951456310679612
-->F1 0.9975550122249389
-->FPR 0.3333333333333333
-->FNR 0.0024449877750611247
-->positive probability:0.9927184466019418, 409/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9655172413793104
-->F1 0.9565217391304348
-->FPR 0.0
-->FNR 0.08333333333333333
-->positive probability:0.3793103448275862, 22/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.011927828257679216, 0.020245919016323933, 0.01907992368030528, 0.31425340965302806, 0.0031422985419169436, 0.01907992368030528]
-->fnr_diff [0.0459101757715481, 0.044356282773665115, 0.1529568349078762, 0.01035585859057582, 0.0210687655523568, 0.01815291333924874, 0.08459435478069019, 0.059819580005915404]
-->FPR:[0.031007751937984496, 0.03932584269662921, 0.0, 0.3333333333333333, 0.022222222222222223, 0.0], mean FPR:0.07098152503169487, mean FPR diff:0.06462155047159311
-->FNR:[0.06942392909896603, 0.06787003610108304, 0.17647058823529413, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.10810810810810811, 0.08333333333333333], mean FNR:0.07030944300691931, mean FNR diff:0.05465184571523454
-->mean fnr diff metric 0.06462155047159311
testing dataset
-->original metric score:
-->individual metric:0.13075657894736842, num_idi:159, num_all:1216
-->individual metric 0.13075657894736842
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.9002169197396963
-->F1 0.9215017064846417
-->FPR 0.09937888198757763
-->FNR 0.1
-->positive probability:0.6203904555314533, 286/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.88268156424581
-->F1 0.9243243243243243
-->FPR 0.16783216783216784
-->FNR 0.10471204188481675
-->positive probability:0.75, 537/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8717948717948718
-->F1 0.8148148148148148
-->FPR 0.08
-->FNR 0.21428571428571427
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.009359312515953372, 0.07781259836054358, 0.0766470971950424, 0.40998043052837574, 0.9099804305283757, 0.01001956947162426, 0.12426614481409001]
-->fnr_diff [0.003715332286760867, 0.008427374171577615, 0.02871533228676086, 0.09628466771323914, 0.09628466771323914, 0.09628466771323914, 0.11800104657247514, 0.02871533228676086]
-->FPR:[0.09937888198757763, 0.16783216783216784, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3183090615388752, mean FPR diff:0.23115222620200074
-->FNR:[0.1, 0.10471204188481675, 0.125, 0.0, 0.0, 0.0, 0.21428571428571427, 0.125], mean FNR:0.08362471952131638, mean FNR diff:0.0595535525930066
-->mean fnr diff metric 0.23115222620200074
-->threshold 0.1
-->epoch 9
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.0831, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.06896551698446274, FU:4.0, P:58
-->FUR:0.0625, FU:3.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1338, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1441, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.01890253648161888, FU:1.2097623348236084, P:64
-->FUR:1.620472049000064e-18, FU:7.616218506223209e-17, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.030003052204847336, FU:0.21002136170864105, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1117, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:6.371025165208266e-07, FU:3.185512468917295e-05, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:8.836554382968965e-19, FU:6.185588378271005e-18, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1123, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.03999994322657585, FU:1.9999971389770508, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1196, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0535714291036129, FU:3.0, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [10/20], Loss: nan, acc_loss, 0.1480, bias_loss:nan
-->after epoch 9
-->overall baseline on training dataset
-->ACC 0.9717073170731707
-->F1 0.9709645121815552
-->FPR: 0.024803900784396864
-->FNR: 0.03194321206743567
-->overall baseline on testing dataset
-->ACC 0.8986093552465234
-->F1 0.8951633986928105
-->FPR: 0.09882583170254403
-->FNR: 0.10413396127681843
training dataset
-->original metric score:
-->individual metric:0.13901345291479822, num_idi:403, num_all:2899
-->individual metric 0.13901345291479822
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9398496240601504
-->F1 0.9512937595129376
-->FPR 0.031007751937984496
-->FNR 0.07680945347119646
-->positive probability:0.5986842105263158, 637/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9310740953475014
-->F1 0.9552572706935124
-->FPR 0.0449438202247191
-->FNR 0.07509025270758123
-->positive probability:0.7449741527857553, 1297/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.8
-->F1 0.8275862068965517
-->FPR 0.0
-->FNR 0.29411764705882354
-->positive probability:0.48, 24/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9951456310679612
-->F1 0.9975550122249389
-->FPR 0.3333333333333333
-->FNR 0.0024449877750611247
-->positive probability:0.9927184466019418, 409/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9416666666666667
-->F1 0.9699570815450643
-->FPR None
-->FNR 0.058333333333333334
-->positive probability:0.9416666666666667, 113/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9146341463414634
-->F1 0.9014084507042254
-->FPR 0.044444444444444446
-->FNR 0.13513513513513514
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9655172413793104
-->F1 0.9565217391304348
-->FPR 0.0
-->FNR 0.08333333333333333
-->positive probability:0.3793103448275862, 22/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.006203851153587632, 0.020139919440322236, 0.024803900784396864, 0.30852943254893644, 0.019640543660047582, 0.024803900784396864]
-->fnr_diff [0.04486624140376079, 0.04314704064014556, 0.2621744349913879, 0.018785317330593562, 0.02949822429237454, 0.026390121265897667, 0.10319192306769948, 0.05139012126589766]
-->FPR:[0.031007751937984496, 0.0449438202247191, 0.0, 0.3333333333333333, 0.044444444444444446, 0.0], mean FPR:0.07562155832341357, mean FPR diff:0.06735359139528127
-->FNR:[0.07680945347119646, 0.07509025270758123, 0.29411764705882354, 0.013157894736842105, 0.0024449877750611247, 0.058333333333333334, 0.13513513513513514, 0.08333333333333333], mean FNR:0.09230275469391327, mean FNR diff:0.07243042803221963
-->mean fnr diff metric 0.06735359139528127
testing dataset
-->original metric score:
-->individual metric:0.15296052631578946, num_idi:186, num_all:1216
-->individual metric 0.15296052631578946
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8720173535791758
-->F1 0.8970331588132635
-->FPR 0.09937888198757763
-->FNR 0.14333333333333334
-->positive probability:0.5921908893709328, 273/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8715083798882681
-->F1 0.9168173598553345
-->FPR 0.18181818181818182
-->FNR 0.11518324607329843
-->positive probability:0.744413407821229, 533/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9807692307692307
-->F1 0.9902912621359222
-->FPR 1.0
-->FNR 0.012903225806451613
-->positive probability:0.9871794871794872, 154/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8205128205128205
-->F1 0.7200000000000001
-->FPR 0.08
-->FNR 0.35714285714285715
-->positive probability:0.28205128205128205, 11/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.7272727272727273
-->F1 0.625
-->FPR 0.21428571428571427
-->FNR 0.375
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.0005530502850336072, 0.0829923501156378, 0.06784083496412263, 0.401174168297456, 0.901174168297456, 0.018825831702544024, 0.11545988258317025]
-->fnr_diff [0.039199372056514914, 0.01104928479648, 0.020866038723181574, 0.10413396127681843, 0.09123073547036681, 0.10413396127681843, 0.2530088958660387, 0.2708660387231816]
-->FPR:[0.09937888198757763, 0.18181818181818182, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3203070635368772, mean FPR diff:0.22686004089220294
-->FNR:[0.14333333333333334, 0.11518324607329843, 0.125, 0.0, 0.012903225806451613, 0.0, 0.35714285714285715, 0.375], mean FNR:0.14107033279449258, mean FNR diff:0.11181103602367506
-->mean fnr diff metric 0.22686004089220294
-->threshold 0.1
-->epoch 10
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.03921568766236305, FU:2.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.20000000298023224, FU:1.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.1567, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.0625, FU:3.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.2312, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.2589, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:1.4862724766195878e-12, FU:9.512143850365362e-11, P:64
-->FUR:2.0236674749124495e-12, FU:9.511236936932121e-11, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.2611, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.03994288295507431, FU:1.9971442222595215, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428312510251999, FU:0.999818742275238, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.2444, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.2659, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.06122449040412903, FU:3.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [11/20], Loss: nan, acc_loss, 0.2518, bias_loss:nan
-->after epoch 10
-->overall baseline on training dataset
-->ACC 0.9584823848238483
-->F1 0.9564426248151938
-->FPR: 0.01695993216027136
-->FNR: 0.06721384205856255
-->overall baseline on testing dataset
-->ACC 0.89102402022756
-->F1 0.8838587981676099
-->FPR: 0.07827788649706457
-->FNR: 0.14181057038199896
training dataset
-->original metric score:
-->individual metric:0.1541911003794412, num_idi:447, num_all:2899
-->individual metric 0.1541911003794412
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9097744360902256
-->F1 0.924646781789639
-->FPR 0.020671834625323
-->FNR 0.12998522895125553
-->positive probability:0.5610902255639098, 597/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9000574382538771
-->F1 0.9336384439359269
-->FPR 0.03651685393258427
-->FNR 0.11624548736462094
-->positive probability:0.710511200459506, 1237/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.72
-->F1 0.7407407407407407
-->FPR 0.0
-->FNR 0.4117647058823529
-->positive probability:0.4, 20/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9830097087378641
-->F1 0.991389913899139
-->FPR 0.3333333333333333
-->FNR 0.014669926650366748
-->positive probability:0.9805825242718447, 404/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.925
-->F1 0.961038961038961
-->FPR None
-->FNR 0.075
-->positive probability:0.925, 111/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.8658536585365854
-->F1 0.8253968253968255
-->FPR 0.0
-->FNR 0.2972972972972973
-->positive probability:0.3170731707317073, 26/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.8620689655172413
-->F1 0.8
-->FPR 0.0
-->FNR 0.3333333333333333
-->positive probability:0.27586206896551724, 16/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.003711902465051639, 0.01955692177231291, 0.01695993216027136, 0.31637340117306195, 0.01695993216027136, 0.01695993216027136]
-->fnr_diff [0.06277138689269297, 0.049031645306058386, 0.34455086382379035, 0.05405594732172045, 0.05254391540819581, 0.007786157941437444, 0.23008345523873475, 0.26611949127477075]
-->FPR:[0.020671834625323, 0.03651685393258427, 0.0, 0.3333333333333333, 0.0, 0.0], mean FPR:0.0650870036485401, mean FPR diff:0.0650870036485401
-->FNR:[0.12998522895125553, 0.11624548736462094, 0.4117647058823529, 0.013157894736842105, 0.014669926650366748, 0.075, 0.2972972972972973, 0.3333333333333333], mean FNR:0.1739317342770086, mean FNR diff:0.1333678579009251
-->mean fnr diff metric 0.0650870036485401
testing dataset
-->original metric score:
-->individual metric:0.17351973684210525, num_idi:211, num_all:1216
-->individual metric 0.17351973684210525
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8481561822125814
-->F1 0.8736462093862815
-->FPR 0.07453416149068323
-->FNR 0.19333333333333333
-->positive probability:0.5509761388286334, 254/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8575418994413407
-->F1 0.9059040590405905
-->FPR 0.13986013986013987
-->FNR 0.1431064572425829
-->positive probability:0.7136871508379888, 511/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.6818181818181818
-->F1 0.7407407407407406
-->FPR 0.16666666666666666
-->FNR 0.375
-->positive probability:0.5, 11/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9090909090909091
-->F1 0.9508196721311476
-->FPR 0.5
-->FNR 0.06451612903225806
-->positive probability:0.9090909090909091, 30/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.967948717948718
-->F1 0.9836065573770492
-->FPR 0.0
-->FNR 0.03225806451612903
-->positive probability:0.9615384615384616, 150/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 0.9743589743589743
-->F1 0.9870129870129869
-->FPR None
-->FNR 0.02564102564102564
-->positive probability:0.9743589743589743, 38/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.75
-->FPR 0.04
-->FNR 0.35714285714285715
-->positive probability:0.2564102564102564, 10/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.7272727272727273
-->F1 0.625
-->FPR 0.21428571428571427
-->FNR 0.375
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.003743725006381343, 0.061582253363075296, 0.08838878016960208, 0.4217221135029354, 0.07827788649706457, 0.038277886497064574, 0.1360078277886497]
-->fnr_diff [0.05152276295133437, 0.0012958868605839335, 0.23318942961800104, 0.0772944413497409, 0.10955250586586993, 0.11616954474097332, 0.2153322867608582, 0.23318942961800104]
-->FPR:[0.07453416149068323, 0.13986013986013987, 0.16666666666666666, 0.5, 0.0, 0.04, 0.21428571428571427], mean FPR:0.16219238318617202, mean FPR diff:0.11828578183211043
-->FNR:[0.19333333333333333, 0.1431064572425829, 0.375, 0.06451612903225806, 0.03225806451612903, 0.02564102564102564, 0.35714285714285715, 0.375], mean FNR:0.19574973336352325, mean FNR diff:0.12969328597067034
-->mean fnr diff metric 0.11828578183211043
-->threshold 0.1
-->epoch 11
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.2205, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.0416666679084301, FU:2.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.2511, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.07407407462596893, FU:4.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.2309, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:6.867235729721144e-13, FU:4.395030867021532e-11, P:64
-->FUR:9.351575503552256e-13, FU:4.39524042161743e-11, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1961, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:2.5685444565015415e-29, FU:1.2842722944546126e-27, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1550, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1635, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.01785714365541935, FU:1.0, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [12/20], Loss: nan, acc_loss, 0.1376, bias_loss:nan
-->after epoch 11
-->overall baseline on training dataset
-->ACC 0.9715989159891599
-->F1 0.9704954954954955
-->FPR: 0.013355946576213695
-->FNR: 0.04414374445430346
-->overall baseline on testing dataset
-->ACC 0.9026548672566371
-->F1 0.8977966551632598
-->FPR: 0.08072407045009784
-->FNR: 0.1151229722658294
training dataset
-->original metric score:
-->individual metric:0.13590893411521215, num_idi:394, num_all:2899
-->individual metric 0.13590893411521215
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9304511278195489
-->F1 0.9429012345679012
-->FPR 0.020671834625323
-->FNR 0.09748892171344166
-->positive probability:0.581766917293233, 619/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9184376794945434
-->F1 0.9464958553127354
-->FPR 0.03651685393258427
-->FNR 0.09314079422382672
-->positive probability:0.7288914417001723, 1269/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.8
-->F1 0.8275862068965517
-->FPR 0.0
-->FNR 0.29411764705882354
-->positive probability:0.48, 24/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9975728155339806
-->F1 0.9987760097919216
-->FPR 0.0
-->FNR 0.0024449877750611247
-->positive probability:0.9902912621359223, 408/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9416666666666667
-->F1 0.9699570815450643
-->FPR None
-->FNR 0.058333333333333334
-->positive probability:0.9416666666666667, 113/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9024390243902439
-->F1 0.8787878787878788
-->FPR 0.0
-->FNR 0.21621621621621623
-->positive probability:0.35365853658536583, 29/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9310344827586207
-->F1 0.9090909090909091
-->FPR 0.0
-->FNR 0.16666666666666666
-->positive probability:0.3448275862068966, 20/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.007315888049109303, 0.023160907356370573, 0.013355946576213695, 0.013355946576213695, 0.013355946576213695, 0.013355946576213695]
-->fnr_diff [0.0533451772591382, 0.04899704976952326, 0.24997390260452007, 0.030985849717461357, 0.04169875667924234, 0.014189588879029873, 0.17207247176191276, 0.12252292221236319]
-->FPR:[0.020671834625323, 0.03651685393258427, 0.0, 0.0, 0.0, 0.0], mean FPR:0.009531448092984543, mean FPR diff:0.013983430285055776
-->FNR:[0.09748892171344166, 0.09314079422382672, 0.29411764705882354, 0.013157894736842105, 0.0024449877750611247, 0.058333333333333334, 0.21621621621621623, 0.16666666666666666], mean FNR:0.11769580771552642, mean FNR diff:0.09172321486039889
-->mean fnr diff metric 0.013983430285055776
testing dataset
-->original metric score:
-->individual metric:0.14391447368421054, num_idi:175, num_all:1216
-->individual metric 0.14391447368421054
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8633405639913232
-->F1 0.888495575221239
-->FPR 0.08695652173913043
-->FNR 0.16333333333333333
-->positive probability:0.5748373101952278, 265/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.861731843575419
-->F1 0.909423604757548
-->FPR 0.16083916083916083
-->FNR 0.13263525305410123
-->positive probability:0.7262569832402235, 520/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.7727272727272727
-->F1 0.8275862068965517
-->FPR 0.16666666666666666
-->FNR 0.25
-->positive probability:0.5909090909090909, 13/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9871794871794872
-->F1 0.9935483870967742
-->FPR 1.0
-->FNR 0.0064516129032258064
-->positive probability:0.9935897435897436, 155/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.7948717948717948
-->F1 0.6666666666666666
-->FPR 0.08
-->FNR 0.42857142857142855
-->positive probability:0.2564102564102564, 10/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.7272727272727273
-->F1 0.625
-->FPR 0.21428571428571427
-->FNR 0.375
-->positive probability:0.36363636363636365, 8/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.0062324512890325895, 0.08011509038906299, 0.08594259621656881, 0.41927592954990217, 0.9192759295499021, 0.0007240704500978412, 0.13356164383561642]
-->fnr_diff [0.048210361067503926, 0.017512280788271828, 0.1348770277341706, 0.1151229722658294, 0.1086713593626036, 0.1151229722658294, 0.31344845630559914, 0.2598770277341706]
-->FPR:[0.08695652173913043, 0.16083916083916083, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3155354376472389, mean FPR diff:0.2350182444685976
-->FNR:[0.16333333333333333, 0.13263525305410123, 0.25, 0.0, 0.0064516129032258064, 0.0, 0.42857142857142855, 0.375], mean FNR:0.16949895348276112, mean FNR diff:0.1391053071904973
-->mean fnr diff metric 0.2350182444685976
-->threshold 0.1
-->epoch 12
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1210, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.03448275849223137, FU:2.0, P:58
-->FUR:0.0416666679084301, FU:2.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1661, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.07407864928245544, FU:4.000247001647949, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1689, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.015625, FU:1.0, P:64
-->FUR:0.021276595070958138, FU:1.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1413, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.017543859779834747, FU:1.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.6848712662066428e-35, FU:1.1794098719953537e-34, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1273, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1401, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.01785714365541935, FU:1.0, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [13/20], Loss: nan, acc_loss, 0.1147, bias_loss:nan
-->after epoch 12
-->overall baseline on training dataset
-->ACC 0.9746341463414634
-->F1 0.9738196464533453
-->FPR: 0.016535933856264576
-->FNR: 0.03460514640638864
-->overall baseline on testing dataset
-->ACC 0.9059418457648546
-->F1 0.9021567596002104
-->FPR: 0.08610567514677103
-->FNR: 0.10256410256410256
training dataset
-->original metric score:
-->individual metric:0.1331493618489134, num_idi:386, num_all:2899
-->individual metric 0.1331493618489134
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9398496240601504
-->F1 0.9510703363914372
-->FPR 0.023255813953488372
-->FNR 0.08124076809453472
-->positive probability:0.5930451127819549, 631/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9316484778862723
-->F1 0.9555804404628593
-->FPR 0.03932584269662921
-->FNR 0.07581227436823104
-->positive probability:0.7432510051694429, 1294/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.86
-->F1 0.8852459016393442
-->FPR 0.0
-->FNR 0.20588235294117646
-->positive probability:0.54, 27/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9975728155339806
-->F1 0.9987760097919216
-->FPR 0.0
-->FNR 0.0024449877750611247
-->positive probability:0.9902912621359223, 408/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.95
-->F1 0.9743589743589743
-->FPR None
-->FNR 0.05
-->positive probability:0.95, 114/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9146341463414634
-->F1 0.8955223880597014
-->FPR 0.0
-->FNR 0.1891891891891892
-->positive probability:0.36585365853658536, 30/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.006719880097223796, 0.022789908840364637, 0.016535933856264576, 0.016535933856264576, 0.016535933856264576, 0.016535933856264576]
-->fnr_diff [0.04663562168814608, 0.0412071279618424, 0.1712772065347878, 0.021447251669546537, 0.03216015863132752, 0.015394853593611361, 0.15458404278280055, 0.09039485359361135]
-->FPR:[0.023255813953488372, 0.03932584269662921, 0.0, 0.0, 0.0, 0.0], mean FPR:0.010430276108352931, mean FPR diff:0.015942254060441124
-->FNR:[0.08124076809453472, 0.07581227436823104, 0.20588235294117646, 0.013157894736842105, 0.0024449877750611247, 0.05, 0.1891891891891892, 0.125], mean FNR:0.09284093338812932, mean FNR diff:0.0716376395569592
-->mean fnr diff metric 0.015942254060441124
testing dataset
-->original metric score:
-->individual metric:0.14391447368421054, num_idi:175, num_all:1216
-->individual metric 0.14391447368421054
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8698481561822126
-->F1 0.8958333333333334
-->FPR 0.11180124223602485
-->FNR 0.14
-->positive probability:0.5986984815618221, 276/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8701117318435754
-->F1 0.9155313351498638
-->FPR 0.16783216783216784
-->FNR 0.12041884816753927
-->positive probability:0.7374301675977654, 528/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.8636363636363636
-->F1 0.9032258064516129
-->FPR 0.16666666666666666
-->FNR 0.125
-->positive probability:0.6818181818181818, 15/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.025695567089253815, 0.0817264926853968, 0.08056099151989563, 0.41389432485322897, 0.913894324853229, 0.006105675146771031, 0.12818003913894324]
-->fnr_diff [0.03743589743589745, 0.01785474560343671, 0.02243589743589744, 0.10256410256410256, 0.10256410256410256, 0.10256410256410256, 0.18315018315018314, 0.02243589743589744]
-->FPR:[0.11180124223602485, 0.16783216783216784, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.32008368443151053, mean FPR diff:0.2357224878981026
-->FNR:[0.14, 0.12041884816753927, 0.125, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.09951664173522812, mean FNR diff:0.07387561609420248
-->mean fnr diff metric 0.2357224878981026
-->threshold 0.1
-->epoch 13
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.0973, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.03448275849223137, FU:2.0, P:58
-->FUR:0.0416666679084301, FU:2.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1479, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1502, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.015625, FU:1.0, P:64
-->FUR:0.021276595070958138, FU:1.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1183, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.035087719559669495, FU:2.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1131, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1226, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.01785714365541935, FU:1.0, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [14/20], Loss: nan, acc_loss, 0.1089, bias_loss:nan
-->after epoch 13
-->overall baseline on training dataset
-->ACC 0.9742005420054201
-->F1 0.973567303420702
-->FPR: 0.023955904176383293
-->FNR: 0.027728482697426796
-->overall baseline on testing dataset
-->ACC 0.9008849557522124
-->F1 0.8983402489626556
-->FPR: 0.10420743639921722
-->FNR: 0.09366823652537938
training dataset
-->original metric score:
-->individual metric:0.13073473611590203, num_idi:379, num_all:2899
-->individual metric 0.13073473611590203
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9483082706766918
-->F1 0.9584905660377359
-->FPR 0.03359173126614987
-->FNR 0.0620384047267356
-->positive probability:0.6090225563909775, 648/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9425617461229179
-->F1 0.9630450849963046
-->FPR 0.05056179775280899
-->FNR 0.0592057761732852
-->positive probability:0.758759333716255, 1321/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.86
-->F1 0.8852459016393442
-->FPR 0.0
-->FNR 0.20588235294117646
-->positive probability:0.54, 27/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9951456310679612
-->F1 0.9975550122249389
-->FPR 0.3333333333333333
-->FNR 0.0024449877750611247
-->positive probability:0.9927184466019418, 409/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.95
-->F1 0.9743589743589743
-->FPR None
-->FNR 0.05
-->positive probability:0.95, 114/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9482758620689655
-->F1 0.9333333333333333
-->FPR 0.0
-->FNR 0.125
-->positive probability:0.3620689655172414, 21/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.00963582708976658, 0.026605893576425694, 0.023955904176383293, 0.30937742915695005, 0.0017336819541610704, 0.023955904176383293]
-->fnr_diff [0.034309922029308805, 0.031477293475858405, 0.17815387024374968, 0.014570587960584691, 0.02528349492236567, 0.022271517302573207, 0.08037962541068132, 0.0972715173025732]
-->FPR:[0.03359173126614987, 0.05056179775280899, 0.0, 0.3333333333333333, 0.022222222222222223, 0.0], mean FPR:0.07328484742908573, mean FPR diff:0.06587744002167832
-->FNR:[0.0620384047267356, 0.0592057761732852, 0.20588235294117646, 0.013157894736842105, 0.0024449877750611247, 0.05, 0.10810810810810811, 0.125], mean FNR:0.07822969055765108, mean FNR diff:0.06046472858096187
-->mean fnr diff metric 0.06587744002167832
testing dataset
-->original metric score:
-->individual metric:0.14802631578947367, num_idi:180, num_all:1216
-->individual metric 0.14802631578947367
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8785249457700651
-->F1 0.9041095890410958
-->FPR 0.12422360248447205
-->FNR 0.12
-->positive probability:0.6160520607375272, 284/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8770949720670391
-->F1 0.9207207207207208
-->FPR 0.18181818181818182
-->FNR 0.1082024432809773
-->positive probability:0.75, 537/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9375
-->FPR 0.16666666666666666
-->FNR 0.0625
-->positive probability:0.7272727272727273, 16/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.020016166085254833, 0.07761074541896461, 0.06245923026744944, 0.3957925636007828, 0.8957925636007827, 0.024207436399217214, 0.11007827788649706]
-->fnr_diff [0.026331763474620615, 0.014534206755597925, 0.03116823652537938, 0.09366823652537938, 0.09366823652537938, 0.09366823652537938, 0.19204604918890633, 0.03133176347462062]
-->FPR:[0.12422360248447205, 0.18181818181818182, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3238563093221479, mean FPR diff:0.22656528332270698
-->FNR:[0.12, 0.1082024432809773, 0.0625, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.08767709112440787, mean FNR diff:0.07205209112440787
-->mean fnr diff metric 0.22656528332270698
-->threshold 0.1
-->epoch 14
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.0857, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1415, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1429, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.06382978707551956, FU:3.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1072, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.035087719559669495, FU:2.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1088, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1144, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.01787490025162697, FU:1.0009944438934326, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:4.474089966681482e-16, FU:1.789635986672593e-15, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [15/20], Loss: nan, acc_loss, 0.1097, bias_loss:nan
-->after epoch 14
-->overall baseline on training dataset
-->ACC 0.9727913279132792
-->F1 0.9722682576510884
-->FPR: 0.030315878736485054
-->FNR: 0.023957409050576754
-->overall baseline on testing dataset
-->ACC 0.8983565107458913
-->F1 0.8966049382716049
-->FPR: 0.11448140900195694
-->FNR: 0.08791208791208792
training dataset
-->original metric score:
-->individual metric:0.13004484304932734, num_idi:377, num_all:2899
-->individual metric 0.13004484304932734
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9511278195488722
-->F1 0.960843373493976
-->FPR 0.03359173126614987
-->FNR 0.05760709010339734
-->positive probability:0.6118421052631579, 651/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9460080413555428
-->F1 0.9653902798232696
-->FPR 0.056179775280898875
-->FNR 0.053429602888086646
-->positive probability:0.7645031591039633, 1331/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9951456310679612
-->F1 0.9975550122249389
-->FPR 0.3333333333333333
-->FNR 0.0024449877750611247
-->positive probability:0.9927184466019418, 409/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.95
-->F1 0.9743589743589743
-->FPR None
-->FNR 0.05
-->positive probability:0.95, 114/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9655172413793104
-->F1 0.9565217391304348
-->FPR 0.0
-->FNR 0.08333333333333333
-->positive probability:0.3793103448275862, 22/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.003275852529664818, 0.02586389654441382, 0.030315878736485054, 0.30301745459684826, 0.008093656514262831, 0.030315878736485054]
-->fnr_diff [0.03364968105282058, 0.029472193837509892, 0.15251317918471738, 0.010799514313734649, 0.021512421275515628, 0.02604259094942325, 0.08415069905753136, 0.05937592428275658]
-->FPR:[0.03359173126614987, 0.056179775280898875, 0.0, 0.3333333333333333, 0.022222222222222223, 0.0], mean FPR:0.07422117701710071, mean FPR diff:0.0668137696096933
-->FNR:[0.05760709010339734, 0.053429602888086646, 0.17647058823529413, 0.013157894736842105, 0.0024449877750611247, 0.05, 0.10810810810810811, 0.08333333333333333], mean FNR:0.06806895064751535, mean FNR diff:0.05218952549425117
-->mean fnr diff metric 0.0668137696096933
testing dataset
-->original metric score:
-->individual metric:0.14638157894736842, num_idi:178, num_all:1216
-->individual metric 0.14638157894736842
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8850325379609545
-->F1 0.9103214890016921
-->FPR 0.13664596273291926
-->FNR 0.10333333333333333
-->positive probability:0.631236442516269, 291/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8798882681564246
-->F1 0.923076923076923
-->FPR 0.20279720279720279
-->FNR 0.09947643979057591
-->positive probability:0.7611731843575419, 545/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9375
-->FPR 0.16666666666666666
-->FNR 0.0625
-->positive probability:0.7272727272727273, 16/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7857142857142857
-->FPR 0.12
-->FNR 0.21428571428571427
-->positive probability:0.358974358974359, 14/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.8
-->FPR 0.2857142857142857
-->FNR 0.0
-->positive probability:0.5454545454545454, 12/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.022164553730962322, 0.08831579379524584, 0.05218525766470972, 0.3855185909980431, 0.8855185909980431, 0.005518590998043055, 0.17123287671232876]
-->fnr_diff [0.015421245421245414, 0.011564351878487991, 0.02541208791208792, 0.08791208791208792, 0.08791208791208792, 0.08791208791208792, 0.12637362637362637, 0.08791208791208792]
-->FPR:[0.13664596273291926, 0.20279720279720279, 0.16666666666666666, 0.5, 1.0, 0.12, 0.2857142857142857], mean FPR:0.3445463025587249, mean FPR diff:0.23006489355676799
-->FNR:[0.10333333333333333, 0.09947643979057591, 0.0625, 0.0, 0.0, 0.0, 0.21428571428571427, 0.0], mean FNR:0.05994943592620294, mean FNR diff:0.06630245790422493
-->mean fnr diff metric 0.23006489355676799
-->threshold 0.1
-->epoch 15
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.0828, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.0517241396009922, FU:3.0, P:58
-->FUR:0.0833333358168602, FU:4.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1389, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.1111111119389534, FU:6.0, P:54
-->FUR:3.940127980928457e-22, FU:1.5760511923713828e-21, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1406, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.06382978707551956, FU:3.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1028, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.035087719559669495, FU:2.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1068, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1129, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.01785714365541935, FU:1.0, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.7538396457823017e-19, FU:1.7538396457823017e-19, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:2.924202738201838e-15, FU:1.1696810952807352e-14, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [16/20], Loss: nan, acc_loss, 0.1073, bias_loss:nan
-->after epoch 15
-->overall baseline on training dataset
-->ACC 0.9748509485094851
-->F1 0.9743589743589745
-->FPR: 0.02798388806444774
-->FNR: 0.022182786157941437
-->overall baseline on testing dataset
-->ACC 0.900126422250316
-->F1 0.8983268983268984
-->FPR: 0.11203522504892367
-->FNR: 0.08686551543694401
training dataset
-->original metric score:
-->individual metric:0.13038978958261468, num_idi:378, num_all:2899
-->individual metric 0.13038978958261468
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9539473684210527
-->F1 0.963130173062453
-->FPR 0.031007751937984496
-->FNR 0.05465288035450517
-->positive probability:0.6127819548872181, 652/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.945433658816772
-->F1 0.9649834131957243
-->FPR 0.05337078651685393
-->FNR 0.054873646209386284
-->positive probability:0.7627800114876507, 1328/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9951456310679612
-->F1 0.9975550122249389
-->FPR 0.3333333333333333
-->FNR 0.0024449877750611247
-->positive probability:0.9927184466019418, 409/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9655172413793104
-->F1 0.9565217391304348
-->FPR 0.0
-->FNR 0.08333333333333333
-->positive probability:0.3793103448275862, 22/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.003023863873536755, 0.02538689845240619, 0.02798388806444774, 0.3053494452688856, 0.005761665842225518, 0.02798388806444774]
-->fnr_diff [0.03247009419656373, 0.03269086005144485, 0.15428780207735268, 0.009024891421099333, 0.01973779838288031, 0.019483880508725227, 0.08592532195016668, 0.061150547175391895]
-->FPR:[0.031007751937984496, 0.05337078651685393, 0.0, 0.3333333333333333, 0.022222222222222223, 0.0], mean FPR:0.07332234900173232, mean FPR diff:0.06591494159432491
-->FNR:[0.05465288035450517, 0.054873646209386284, 0.17647058823529413, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.10810810810810811, 0.08333333333333333], mean FNR:0.06683851317739961, mean FNR diff:0.051846399470453094
-->mean fnr diff metric 0.06591494159432491
testing dataset
-->original metric score:
-->individual metric:0.14226973684210525, num_idi:173, num_all:1216
-->individual metric 0.14226973684210525
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8893709327548807
-->F1 0.9139966273187183
-->FPR 0.13664596273291926
-->FNR 0.09666666666666666
-->positive probability:0.6355748373101953, 293/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8840782122905028
-->F1 0.9258266309204647
-->FPR 0.1958041958041958
-->FNR 0.09598603839441536
-->positive probability:0.7625698324022346, 546/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9375
-->FPR 0.16666666666666666
-->FNR 0.0625
-->positive probability:0.7272727272727273, 16/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8205128205128205
-->F1 0.7407407407407408
-->FPR 0.12
-->FNR 0.2857142857142857
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.7727272727272727
-->F1 0.7368421052631579
-->FPR 0.2857142857142857
-->FNR 0.125
-->positive probability:0.5, 11/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.02461073768399559, 0.08376897075527213, 0.054631441617742985, 0.38796477495107634, 0.8879647749510763, 0.007964774951076323, 0.17367906066536204]
-->fnr_diff [0.009801151229722652, 0.009120522957471344, 0.024365515436944013, 0.08686551543694401, 0.08686551543694401, 0.08686551543694401, 0.19884877027734169, 0.03813448456305599]
-->FPR:[0.13664596273291926, 0.1958041958041958, 0.16666666666666666, 0.5, 1.0, 0.12, 0.2857142857142857], mean FPR:0.3435473015597239, mean FPR diff:0.23151207651080022
-->FNR:[0.09666666666666666, 0.09598603839441536, 0.0625, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.08323337384692096, mean FNR diff:0.06760837384692096
-->mean fnr diff metric 0.23151207651080022
-->threshold 0.1
-->epoch 16
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.0806, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.03448275849223137, FU:2.0, P:58
-->FUR:0.0625, FU:3.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1357, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.036975353956222534, FU:1.996669054031372, P:54
-->FUR:0.09259819239377975, FU:5.000302314758301, P:54
-->FUR:8.001694265940692e-27, FU:3.200677706376277e-26, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1391, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.06382978707551956, FU:3.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1009, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.035087719559669495, FU:2.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1058, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1132, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.01785779371857643, FU:1.0000364780426025, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:3.654113970696926e-05, FU:3.654113970696926e-05, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:3.7677154595407414e-18, FU:1.5070861838162966e-17, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [17/20], Loss: nan, acc_loss, 0.1062, bias_loss:nan
-->after epoch 16
-->overall baseline on training dataset
-->ACC 0.9762601626016261
-->F1 0.97578237310627
-->FPR: 0.026075895696417214
-->FNR: 0.02129547471162378
-->overall baseline on testing dataset
-->ACC 0.9018963337547409
-->F1 0.8999484270242394
-->FPR: 0.1086105675146771
-->FNR: 0.08686551543694401
training dataset
-->original metric score:
-->individual metric:0.12728527078302862, num_idi:369, num_all:2899
-->individual metric 0.12728527078302862
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9530075187969925
-->F1 0.9624060150375939
-->FPR 0.03359173126614987
-->FNR 0.05465288035450517
-->positive probability:0.6137218045112782, 653/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9465824238943136
-->F1 0.9657206044968669
-->FPR 0.05056179775280899
-->FNR 0.05415162454873646
-->positive probability:0.7627800114876507, 1328/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9951456310679612
-->F1 0.9975550122249389
-->FPR 0.3333333333333333
-->FNR 0.0024449877750611247
-->positive probability:0.9927184466019418, 409/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9655172413793104
-->F1 0.9565217391304348
-->FPR 0.0
-->FNR 0.08333333333333333
-->positive probability:0.3793103448275862, 22/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.007515835569732659, 0.024485902056391774, 0.026075895696417214, 0.3072574376369161, 0.0038536734741949907, 0.026075895696417214]
-->fnr_diff [0.033357405642881394, 0.032856149837112686, 0.15517511352367036, 0.008137579974781674, 0.018850486936562653, 0.020371191955042885, 0.08681263339648433, 0.062037858621709546]
-->FPR:[0.03359173126614987, 0.05056179775280899, 0.0, 0.3333333333333333, 0.022222222222222223, 0.0], mean FPR:0.07328484742908573, mean FPR diff:0.06587744002167832
-->FNR:[0.05465288035450517, 0.05415162454873646, 0.17647058823529413, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.10810810810810811, 0.08333333333333333], mean FNR:0.06674826046981838, mean FNR diff:0.05219980248603069
-->mean fnr diff metric 0.06587744002167832
testing dataset
-->original metric score:
-->individual metric:0.14309210526315788, num_idi:174, num_all:1216
-->individual metric 0.14309210526315788
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8893709327548807
-->F1 0.9142857142857143
-->FPR 0.14285714285714285
-->FNR 0.09333333333333334
-->positive probability:0.6399132321041214, 295/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.88268156424581
-->F1 0.9248658318425761
-->FPR 0.1958041958041958
-->FNR 0.09773123909249563
-->positive probability:0.7611731843575419, 545/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9375
-->FPR 0.16666666666666666
-->FNR 0.0625
-->positive probability:0.7272727272727273, 16/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8205128205128205
-->F1 0.7407407407407408
-->FPR 0.12
-->FNR 0.2857142857142857
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.7727272727272727
-->F1 0.7368421052631579
-->FPR 0.2857142857142857
-->FNR 0.125
-->positive probability:0.5, 11/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.03424657534246575, 0.08719362828951871, 0.05805609915198956, 0.3913894324853229, 0.8913894324853229, 0.011389432485322898, 0.1771037181996086]
-->fnr_diff [0.006467817896389325, 0.01086572365555162, 0.024365515436944013, 0.08686551543694401, 0.08686551543694401, 0.08686551543694401, 0.19884877027734169, 0.03813448456305599]
-->FPR:[0.14285714285714285, 0.1958041958041958, 0.16666666666666666, 0.5, 1.0, 0.12, 0.2857142857142857], mean FPR:0.34443461300604156, mean FPR diff:0.2358240454913645
-->FNR:[0.09333333333333334, 0.09773123909249563, 0.0625, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.08303485726751433, mean FNR diff:0.06740985726751433
-->mean fnr diff metric 0.2358240454913645
-->threshold 0.1
-->epoch 17
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.0798, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.03448275849223137, FU:2.0, P:58
-->FUR:0.0625, FU:3.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1342, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.09259258955717087, FU:5.0, P:54
-->FUR:4.982182395345507e-27, FU:1.992872958138203e-26, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1385, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.06382978707551956, FU:3.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.0999, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.035087719559669495, FU:2.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1054, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1122, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.03572840616106987, FU:2.00079083442688, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:3.985226731950675e-11, FU:1.59409069278027e-10, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [18/20], Loss: nan, acc_loss, 0.1065, bias_loss:nan
-->after epoch 17
-->overall baseline on training dataset
-->ACC 0.9757181571815718
-->F1 0.9752540874944763
-->FPR: 0.027559889760440957
-->FNR: 0.02085181898846495
-->overall baseline on testing dataset
-->ACC 0.9008849557522124
-->F1 0.8991769547325102
-->FPR: 0.11203522504892367
-->FNR: 0.08529565672422815
training dataset
-->original metric score:
-->individual metric:0.12659537771645396, num_idi:367, num_all:2899
-->individual metric 0.12659537771645396
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9530075187969925
-->F1 0.9624624624624624
-->FPR 0.03617571059431524
-->FNR 0.053175775480059084
-->positive probability:0.6156015037593985, 655/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9483055715106261
-->F1 0.9668630338733433
-->FPR 0.05056179775280899
-->FNR 0.05198555956678701
-->positive probability:0.7645031591039633, 1331/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9655172413793104
-->F1 0.9565217391304348
-->FPR 0.0
-->FNR 0.08333333333333333
-->positive probability:0.3793103448275862, 22/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.008615820833874285, 0.02300190799236803, 0.027559889760440957, 0.6391067769062256, 0.005337667538218734, 0.027559889760440957]
-->fnr_diff [0.032323956491594134, 0.031133740578322057, 0.15561876924682919, 0.007693924251622845, 0.018406831213403824, 0.020814847678201714, 0.08725628911964317, 0.06248151434486838]
-->FPR:[0.03617571059431524, 0.05056179775280899, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12927106620600218, mean FPR diff:0.12186365879859477
-->FNR:[0.053175775480059084, 0.05198555956678701, 0.17647058823529413, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.10810810810810811, 0.08333333333333333], mean FNR:0.06629286423776895, mean FNR diff:0.051966234115560665
-->mean fnr diff metric 0.12186365879859477
testing dataset
-->original metric score:
-->individual metric:0.14226973684210525, num_idi:173, num_all:1216
-->individual metric 0.14226973684210525
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8893709327548807
-->F1 0.9142857142857143
-->FPR 0.14285714285714285
-->FNR 0.09333333333333334
-->positive probability:0.6399132321041214, 295/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8854748603351955
-->F1 0.926916221033868
-->FPR 0.20279720279720279
-->FNR 0.0924956369982548
-->positive probability:0.7667597765363129, 549/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9375
-->FPR 0.16666666666666666
-->FNR 0.0625
-->positive probability:0.7272727272727273, 16/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8205128205128205
-->F1 0.7407407407407408
-->FPR 0.12
-->FNR 0.2857142857142857
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.8
-->FPR 0.2857142857142857
-->FNR 0.0
-->positive probability:0.5454545454545454, 12/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.030821917808219176, 0.09076197774827911, 0.054631441617742985, 0.38796477495107634, 0.8879647749510763, 0.007964774951076323, 0.17367906066536204]
-->fnr_diff [0.00803767660910519, 0.007199980274026657, 0.022795656724228147, 0.08529565672422815, 0.08529565672422815, 0.08529565672422815, 0.20041862899005755, 0.08529565672422815]
-->FPR:[0.14285714285714285, 0.20279720279720279, 0.16666666666666666, 0.5, 1.0, 0.12, 0.2857142857142857], mean FPR:0.3454336140050426, mean FPR diff:0.23339838895611886
-->FNR:[0.09333333333333334, 0.0924956369982548, 0.0625, 0.0, 0.0, 0.0, 0.2857142857142857, 0.0], mean FNR:0.06675540700573424, mean FNR diff:0.07245432118679127
-->mean fnr diff metric 0.23339838895611886
-->epoch 18
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.0790, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.03448275849223137, FU:2.0, P:58
-->FUR:0.0625, FU:3.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1332, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.03703703731298447, FU:2.0, P:54
-->FUR:0.09259266406297684, FU:5.000003814697266, P:54
-->FUR:1.3894744183191181e-18, FU:5.5578976732764725e-18, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1380, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.06382978707551956, FU:3.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.0988, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.05161092430353165, FU:2.9418227672576904, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1051, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1116, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:8.513118799696901e-26, FU:3.4052475198787603e-25, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [19/20], Loss: nan, acc_loss, 0.1059, bias_loss:nan
-->after epoch 18
-->overall baseline on training dataset
-->ACC 0.9760433604336043
-->F1 0.9755612075638616
-->FPR: 0.026287894848420607
-->FNR: 0.021517302573203195
-->overall baseline on testing dataset
-->ACC 0.9016434892541088
-->F1 0.8996646891926748
-->FPR: 0.1086105675146771
-->FNR: 0.08738880167451596
training dataset
-->original metric score:
-->individual metric:0.12487064505001724, num_idi:362, num_all:2899
-->individual metric 0.12487064505001724
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9520676691729323
-->F1 0.9616829451540195
-->FPR 0.03617571059431524
-->FNR 0.05465288035450517
-->positive probability:0.6146616541353384, 654/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9465824238943136
-->F1 0.9657206044968669
-->FPR 0.05056179775280899
-->FNR 0.05415162454873646
-->positive probability:0.7627800114876507, 1328/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9655172413793104
-->F1 0.9565217391304348
-->FPR 0.0
-->FNR 0.08333333333333333
-->positive probability:0.3793103448275862, 22/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.009887815745894635, 0.02427390290438838, 0.026287894848420607, 0.640378771818246, 0.004065672626198384, 0.026287894848420607]
-->fnr_diff [0.033135577781301974, 0.032634321975533266, 0.15495328566209093, 0.00835940783636109, 0.01907231479814207, 0.02014936409346347, 0.08659080553490492, 0.06181603076013013]
-->FPR:[0.03617571059431524, 0.05056179775280899, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12927106620600218, mean FPR diff:0.12186365879859477
-->FNR:[0.05465288035450517, 0.05415162454873646, 0.17647058823529413, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.10810810810810811, 0.08333333333333333], mean FNR:0.06674826046981838, mean FNR diff:0.05208888855524098
-->mean fnr diff metric 0.12186365879859477
testing dataset
-->original metric score:
-->individual metric:0.14638157894736842, num_idi:178, num_all:1216
-->individual metric 0.14638157894736842
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8893709327548807
-->F1 0.9137055837563451
-->FPR 0.13043478260869565
-->FNR 0.1
-->positive probability:0.631236442516269, 291/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.88268156424581
-->F1 0.9248658318425761
-->FPR 0.1958041958041958
-->FNR 0.09773123909249563
-->positive probability:0.7611731843575419, 545/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9375
-->FPR 0.16666666666666666
-->FNR 0.0625
-->positive probability:0.7272727272727273, 16/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8205128205128205
-->F1 0.7407407407407408
-->FPR 0.12
-->FNR 0.2857142857142857
-->positive probability:0.3333333333333333, 13/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.7727272727272727
-->F1 0.7368421052631579
-->FPR 0.2857142857142857
-->FNR 0.125
-->positive probability:0.5, 11/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.02182421509401855, 0.08719362828951871, 0.05805609915198956, 0.3913894324853229, 0.8913894324853229, 0.011389432485322898, 0.1771037181996086]
-->fnr_diff [0.012611198325484047, 0.010342437417979675, 0.02488880167451596, 0.08738880167451596, 0.08738880167451596, 0.08738880167451596, 0.19832548403976974, 0.03761119832548404]
-->FPR:[0.13043478260869565, 0.1958041958041958, 0.16666666666666666, 0.5, 1.0, 0.12, 0.2857142857142857], mean FPR:0.34265999011340625, mean FPR diff:0.23404942259872916
-->FNR:[0.1, 0.09773123909249563, 0.0625, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.08386819060084766, mean FNR diff:0.06824319060084766
-->mean fnr diff metric 0.23404942259872916
-->epoch 19
-->start_index 0
-->batch_size 98
-->FUR:0.036363635212183, FU:2.0, P:55
-->FUR:0.019607843831181526, FU:1.0, P:51
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.0785, bias_loss:nan
-->start_index 420
-->batch_size 98
-->FUR:0.03448275849223137, FU:2.0, P:58
-->FUR:0.0625, FU:3.0, P:48
-->FUR:0.0, FU:0.0, P:3
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1330, bias_loss:nan
-->start_index 838
-->batch_size 98
-->FUR:0.018518518656492233, FU:1.0, P:54
-->FUR:0.09259574860334396, FU:5.0001702308654785, P:54
-->FUR:0.0, FU:0.0, P:4
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1393, bias_loss:nan
-->start_index 1237
-->batch_size 98
-->FUR:0.03125, FU:2.0, P:64
-->FUR:0.042553190141916275, FU:2.0, P:47
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:3
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1006, bias_loss:nan
-->start_index 1661
-->batch_size 98
-->FUR:0.05999999865889549, FU:3.0, P:50
-->FUR:0.035087719559669495, FU:2.0, P:57
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:7
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1047, bias_loss:nan
-->start_index 2029
-->batch_size 98
-->FUR:0.019999999552965164, FU:1.0, P:50
-->FUR:0.03999999910593033, FU:2.0, P:50
-->FUR:0.0, FU:0.0, P:2
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:5
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1143, bias_loss:nan
-->start_index 2524
-->batch_size 98
-->FUR:0.0357142873108387, FU:2.0, P:56
-->FUR:0.040816325694322586, FU:2.0, P:49
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:1.0, FU:1.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:4
-->z_score:nan, p_hat:nan, n:98.0
Epoch [20/20], Loss: nan, acc_loss, 0.1047, bias_loss:nan
-->after epoch 19
-->overall baseline on training dataset
-->ACC 0.9763685636856368
-->F1 0.9758529020824103
-->FPR: 0.024379902480390077
-->FNR: 0.02284826974267968
-->overall baseline on testing dataset
-->ACC 0.9029077117572692
-->F1 0.9006725297465081
-->FPR: 0.10469667318982387
-->FNR: 0.08895866038723181
training dataset
-->original metric score:
-->individual metric:0.12383580545015523, num_idi:359, num_all:2899
-->individual metric 0.12383580545015523
-->all_length: 2899
-->identity male
-->length 1064
-->ACC 0.9520676691729323
-->F1 0.9615674453654861
-->FPR 0.031007751937984496
-->FNR 0.05760709010339734
-->positive probability:0.6109022556390977, 650/1064
-->group-truth label positive probability:0.6362781954887218, 677/1064
-->identity female
-->length 1741
-->ACC 0.9448592762780011
-->F1 0.9645494830132938
-->FPR 0.047752808988764044
-->FNR 0.05703971119133574
-->positive probability:0.7599080987937966, 1323/1741
-->group-truth label positive probability:0.7955198161975876, 1385/1741
-->identity homosexual
-->length 50
-->ACC 0.88
-->F1 0.9032258064516129
-->FPR 0.0
-->FNR 0.17647058823529413
-->positive probability:0.56, 28/50
-->group-truth label positive probability:0.68, 34/50
-->identity christian
-->length 76
(FP + TN) is 0
-->ACC 0.9868421052631579
-->F1 0.9933774834437086
-->FPR None
-->FNR 0.013157894736842105
-->positive probability:0.9868421052631579, 75/76
-->group-truth label positive probability:1.0, 76/76
-->identity muslim
-->length 412
-->ACC 0.9927184466019418
-->F1 0.9963369963369964
-->FPR 0.6666666666666666
-->FNR 0.0024449877750611247
-->positive probability:0.9951456310679612, 410/412
-->group-truth label positive probability:0.9927184466019418, 409/412
-->identity jewish
-->length 120
(FP + TN) is 0
-->ACC 0.9583333333333334
-->F1 0.9787234042553191
-->FPR None
-->FNR 0.041666666666666664
-->positive probability:0.9583333333333334, 115/120
-->group-truth label positive probability:1.0, 120/120
-->identity black
-->length 82
-->ACC 0.9390243902439024
-->F1 0.9295774647887325
-->FPR 0.022222222222222223
-->FNR 0.10810810810810811
-->positive probability:0.4146341463414634, 34/82
-->group-truth label positive probability:0.45121951219512196, 37/82
-->identity white
-->length 58
-->ACC 0.9655172413793104
-->F1 0.9565217391304348
-->FPR 0.0
-->FNR 0.08333333333333333
-->positive probability:0.3793103448275862, 22/58
-->group-truth label positive probability:0.41379310344827586, 24/58
-->fpr_diff [0.006627849457594419, 0.023372906508373967, 0.024379902480390077, 0.6422867641862765, 0.0021576802581678538, 0.024379902480390077]
-->fnr_diff [0.03475882036071766, 0.03419144144865606, 0.15362231849261446, 0.009690375005837575, 0.020403281967618554, 0.018818396923986985, 0.08525983836542844, 0.06048506359065365]
-->FPR:[0.031007751937984496, 0.047752808988764044, 0.0, 0.6666666666666666, 0.022222222222222223, 0.0], mean FPR:0.12794157496927291, mean FPR diff:0.12053416756186548
-->FNR:[0.05760709010339734, 0.05703971119133574, 0.17647058823529413, 0.013157894736842105, 0.0024449877750611247, 0.041666666666666664, 0.10810810810810811, 0.08333333333333333], mean FNR:0.06747854751875482, mean FNR diff:0.052153692019439174
-->mean fnr diff metric 0.12053416756186548
testing dataset
-->original metric score:
-->individual metric:0.14144736842105263, num_idi:172, num_all:1216
-->individual metric 0.14144736842105263
-->all_length: 1216
-->identity male
-->length 461
-->ACC 0.8893709327548807
-->F1 0.9134125636672324
-->FPR 0.12422360248447205
-->FNR 0.10333333333333333
-->positive probability:0.6268980477223427, 289/461
-->group-truth label positive probability:0.6507592190889371, 300/461
-->identity female
-->length 716
-->ACC 0.8854748603351955
-->F1 0.9265232974910396
-->FPR 0.18181818181818182
-->FNR 0.09773123909249563
-->positive probability:0.7583798882681564, 543/716
-->group-truth label positive probability:0.8002793296089385, 573/716
-->identity homosexual
-->length 22
-->ACC 0.9090909090909091
-->F1 0.9375
-->FPR 0.16666666666666666
-->FNR 0.0625
-->positive probability:0.7272727272727273, 16/22
-->group-truth label positive probability:0.7272727272727273, 16/22
-->identity christian
-->length 33
-->ACC 0.9696969696969697
-->F1 0.9841269841269841
-->FPR 0.5
-->FNR 0.0
-->positive probability:0.9696969696969697, 32/33
-->group-truth label positive probability:0.9393939393939394, 31/33
-->identity muslim
-->length 156
-->ACC 0.9935897435897436
-->F1 0.9967845659163987
-->FPR 1.0
-->FNR 0.0
-->positive probability:1.0, 156/156
-->group-truth label positive probability:0.9935897435897436, 155/156
-->identity jewish
-->length 39
(FP + TN) is 0
-->ACC 1.0
-->F1 1.0
-->FPR None
-->FNR 0.0
-->positive probability:1.0, 39/39
-->group-truth label positive probability:1.0, 39/39
-->identity black
-->length 39
-->ACC 0.8461538461538461
-->F1 0.7692307692307692
-->FPR 0.08
-->FNR 0.2857142857142857
-->positive probability:0.3076923076923077, 12/39
-->group-truth label positive probability:0.358974358974359, 14/39
-->identity white
-->length 22
-->ACC 0.8181818181818182
-->F1 0.7777777777777777
-->FPR 0.21428571428571427
-->FNR 0.125
-->positive probability:0.45454545454545453, 10/22
-->group-truth label positive probability:0.36363636363636365, 8/22
-->fpr_diff [0.01952692929464818, 0.07712150862835795, 0.06196999347684279, 0.3953033268101761, 0.8953033268101761, 0.024696673189823867, 0.1095890410958904]
-->fnr_diff [0.014374672946101522, 0.008772578705263823, 0.02645866038723181, 0.08895866038723181, 0.08895866038723181, 0.08895866038723181, 0.19675562532705387, 0.03604133961276819]
-->FPR:[0.12422360248447205, 0.18181818181818182, 0.16666666666666666, 0.5, 1.0, 0.08, 0.21428571428571427], mean FPR:0.3238563093221479, mean FPR diff:0.22621582847227367
-->FNR:[0.10333333333333333, 0.09773123909249563, 0.0625, 0.0, 0.0, 0.0, 0.2857142857142857, 0.125], mean FNR:0.08428485726751433, mean FNR diff:0.06865985726751433
-->mean fnr diff metric 0.22621582847227367
    train_ind  train_acc  ...  test_fnr_mean  test_fnr_diff
0    0.117282   0.978211  ...       0.087037       0.061788
1    0.118317   0.977669  ...       0.086818       0.063663
2    0.120731   0.975393  ...       0.085747       0.062723
3    0.114177   0.981897  ...       0.091026       0.070095
4    0.122456   0.978211  ...       0.083843       0.060164
5    0.125216   0.972575  ...       0.085331       0.060867
6    0.129010   0.973550  ...       0.082772       0.058831
7    0.120041   0.980271  ...       0.094041       0.069970
8    0.119007   0.978753  ...       0.083625       0.059554
9    0.139013   0.971707  ...       0.141070       0.111811
10   0.154191   0.958482  ...       0.195750       0.129693
11   0.135909   0.971599  ...       0.169499       0.139105
12   0.133149   0.974634  ...       0.099517       0.073876
13   0.130735   0.974201  ...       0.087677       0.072052
14   0.130045   0.972791  ...       0.059949       0.066302
15   0.130390   0.974851  ...       0.083233       0.067608
16   0.127285   0.976260  ...       0.083035       0.067410
17   0.126595   0.975718  ...       0.066755       0.072454
18   0.124871   0.976043  ...       0.083868       0.068243
19   0.123836   0.976369  ...       0.084285       0.068660

[20 rows x 22 columns]
